import{p as M}from"./memoryEstimations-iHVpvWPf-Bcit1dlR.js";import{c as G}from"./OptimizedGeometry-1qDYm3YK-NqjQEvGQ.js";function q(t,e){return t?e?4:3:e?3:2}function P(t,e,s,i){if(!e?.lengths.length)return null;t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0);const r=t.coords,n=[],l=s?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:u,coords:h}=e,f=q(s,i);let m=0;for(const o of u){const I=S(l,h,m,o,s,i);I&&n.push(I),m+=o*f}if(n.sort((o,I)=>{let N=o[2]-I[2];return N===0&&s&&(N=o[4]-I[4]),N}),n.length){let o=6*n[0][2];r[0]=n[0][0]/o,r[1]=n[0][1]/o,s&&(o=6*n[0][4],r[2]=o!==0?n[0][3]/o:0),(r[0]<l[0]||r[0]>l[1]||r[1]<l[2]||r[1]>l[3]||s&&(r[2]<l[4]||r[2]>l[5]))&&(r.length=0)}if(!r.length){const o=e.lengths[0]?j(h,0,u[0],s,i):null;if(!o)return null;r[0]=o[0],r[1]=o[1],s&&o.length>2&&(r[2]=o[2])}return t}function S(t,e,s,i,r,n){const l=q(r,n);let u=s,h=s+l,f=0,m=0,o=0,I=0,N=0;for(let b=0,F=i-1;b<F;b++,u+=l,h+=l){const c=e[u],d=e[u+1],y=e[u+2],a=e[h],g=e[h+1],Y=e[h+2];let p=c*g-a*d;I+=p,f+=(c+a)*p,m+=(d+g)*p,r&&(p=c*Y-a*y,o+=(y+Y)*p,N+=p),c<t[0]&&(t[0]=c),c>t[1]&&(t[1]=c),d<t[2]&&(t[2]=d),d>t[3]&&(t[3]=d),r&&(y<t[4]&&(t[4]=y),y>t[5]&&(t[5]=y))}if(I>0&&(I*=-1),N>0&&(N*=-1),!I)return null;const T=[f,m,.5*I];return r&&(T[3]=o,T[4]=.5*N),T}function j(t,e,s,i,r){const n=q(i,r);let l=e,u=e+n,h=0,f=0,m=0,o=0;for(let I=0,N=s-1;I<N;I++,l+=n,u+=n){const T=t[l],b=t[l+1],F=t[l+2],c=t[u],d=t[u+1],y=t[u+2],a=i?O(T,b,F,c,d,y):w(T,b,c,d);if(a)if(h+=a,i){const g=A(T,b,F,c,d,y);f+=a*g[0],m+=a*g[1],o+=a*g[2]}else{const g=_(T,b,c,d);f+=a*g[0],m+=a*g[1]}}return h>0?i?[f/h,m/h,o/h]:[f/h,m/h]:s>0?i?[t[e],t[e+1],t[e+2]]:[t[e],t[e+1]]:null}function w(t,e,s,i){const r=s-t,n=i-e;return Math.sqrt(r*r+n*n)}function O(t,e,s,i,r,n){const l=i-t,u=r-e,h=n-s;return Math.sqrt(l*l+u*u+h*h)}function _(t,e,s,i){return[t+.5*(s-t),e+.5*(i-e)]}function A(t,e,s,i,r,n){return[t+.5*(i-t),e+.5*(r-e),s+.5*(n-s)]}class E{constructor(e=null,s={},i,r,n=0){this.geometry=e,this.attributes=s,this.centroid=i,this.objectId=r,this.displayId=n}static fromJSON(e){const s=e.geometry?G.fromJSON(e.geometry):null,i=e.centroid?G.fromJSON(e.centroid):null,r=e.objectId;return new E(s,e.attributes,i,r)}weakClone(){const e=new E(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e}clone(){const e=this.geometry?.clone(),s=new E(e,{...this.attributes},this.centroid?.clone(),this.objectId);return s.displayId=this.displayId,s}ensureCentroid(e){return this.centroid??=P(new G,this.geometry,e.hasZ,e.hasM),this.centroid}get usedMemory(){return 128+M(this.attributes)+(this.geometry?.usedMemory??0)}}function C(t){return!!t.geometry?.coords?.length}class V{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new V;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}export{E as F,P as M,V,C as x};
