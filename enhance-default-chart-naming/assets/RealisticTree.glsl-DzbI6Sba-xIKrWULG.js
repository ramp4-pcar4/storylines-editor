import{du as v,gP as G,kc as f}from"./main-C6b-f_Ao.js";import{o as T,_ as x,X as E,Q as M,K as b,E as P,Z as U}from"./dehydratedFeatureUtils-OR1UjA48-oUZhvl0v.js";import{c as V,l as j}from"./memoryEstimations-DeWfxwaV-D5-ZLxqi.js";import{t as p,s as B}from"./IntersectorType-D6ZupXNg-DQZQEhlR.js";import{k as R}from"./mat4-OOmHNWi7-BpUsQumW.js";import{n as I,u as C}from"./mat4f64-xsZDPPj0-Dq35B4BL.js";import{L as _,b as D,P as W,_ as h,l as z}from"./vec32-Cj8pVsU0-CLT8Sl3i.js";import{D as A}from"./vec42-D8CJyqHG-DnfLTeQH.js";import{o as k}from"./vec4f64-DD-nkcCV-CSNWKRqG.js";import{M as N,a as O}from"./sphere-zPMQWhGG-BD3JF-He.js";import{T as J}from"./VertexAttribute-hUz6pozM-Bx3V-z96.js";import"./glsl-Z5uYj8ka-BRgh2Cgo.js";import"./vec2-BnynUbeJ-CKtGJQAy.js";import"./vec2f64-CkowXrDb-3zFQ3LNH.js";import"./BindType-CKbZk6AG-Bqvzo9NX.js";import"./ShaderBuilder-CU5v4tk1-DIfCKwdH.js";import{y as K,O as Q,g as X,j as Z,V as q}from"./DefaultMaterial-7UvmJfZD-B3QmBl3b.js";import"./ShaderOutput-CUn9tpiG-CW1Nc608.js";import"./mat3f64-BnNZDR5l-Bz3OL2oI.js";import"./OutputColorHighlightOID.glsl-BdXTjs7_-DFkeDF1w.js";import"./mat3-DOnW3DjW-C3hbW9XY.js";import"./NormalAttribute.glsl-BnbqDItl-avPkZSi_.js";import"./boundedPlane-QDtjx5eO-CsBjj4Fb.js";import"./ViewingMode-CdRKcXnc-Dab70bGf.js";import"./basicInterfaces-Dsf65ICa-DkQ9Rsnx.js";import"./projectionUtils-B-CplN3q-D4aWrGSw.js";import"./meshVertexSpaceUtils-CCr86FVF-DNsklIkv.js";import"./MeshLocalVertexSpace-Cfxtmv6L-BqrKNleR.js";import"./projectVectorToVector-DcyiGOWJ-DCMkX7bD.js";import"./projectPointToVector-BZJhoF_5-NWo8NFlG.js";import"./hydratedFeatures-oobA80ei-BdgqZssx.js";import"./vec3f32-GX_cKsFD-UJPpzdNc.js";import"./Indices-BuIC5D20-ZyWxksp_.js";import"./plane-Cf3Koz3c-Dq5jyKQx.js";import"./vectorStacks-5ZZtmT9E-8O-x2Eob.js";import"./quatf64-C16JxGFv-BKWK1F8U.js";import"./orientedBoundingBox-CSC169JG-Z4XRWJtU.js";import"./quat-DQgq9Ar5-Dk476ERY.js";import"./common-CYWrYyJl-E8-sukrT.js";import"./spatialReferenceEllipsoidUtils-BK0OQJn2-Ar8DPgdv.js";import"./computeTranslationToOriginAndRotation-e-ft1lOz-BlVnHkQO.js";import"./BufferView-wDxx79o3-B777HWwQ.js";import"./InterleavedLayout-C2YUDwKf-DIlXsb75.js";import"./types-l27bT09Q-DE0QfIFp.js";import"./renderState-BM-MCKUz-CkGIEsl7.js";import"./enums-wEDHPbCF-Cf76M5_x.js";import"./Texture-D5XWO2GQ-D8NUXdTK.js";import"./getDataTypeBytes-DYbftOSj-BNZIboqJ.js";import"./videoUtils-Scb4DgCQ-D-mCT5D7.js";import"./requestImageUtils-B2YN5Eb9-diemfvY_.js";import"./TextureFormat-Cl0ugX3E-DD0Aw8RG.js";import"./triangle-BM89wdHY-41gyTMcr.js";import"./lineSegment-BAWQVP9P-E3PrCuIm.js";import"./lengthUtils-C61nRlXw-DbduT2t3.js";class F{get ray(){return this._ray}get distanceInRenderSpace(){return this.distance==null?null:(_(d,this.ray.direction,this.distance),D(d))}withinDistance(e){return!!L(this)&&this.distanceInRenderSpace<=e}getIntersectionPoint(e){return!!L(this)&&(_(d,this.ray.direction,this.distance),W(e,this.ray.origin,d),!0)}getTransformedNormal(e){return h(l,this.normal),l[3]=0,A(l,l,this.transformation),h(e,l),z(e,e)}constructor(e){this.intersector=p.OBJECT,this.normal=v(),this.transformation=I(),this._ray=N(),this.init(e)}init(e){this.distance=this.target=this.drapedLayerOrder=this.renderPriority=null,this.intersector=p.OBJECT,O(e,this._ray)}set(e,r,t,n,s,o,a){this.intersector=e,this.distance=t,h(this.normal,n??G),R(this.transformation,s??C),this.target=r,this.drapedLayerOrder=o,this.renderPriority=a}copy(e){O(e.ray,this._ray),this.intersector=e.intersector,this.distance=e.distance,this.target=e.target,this.drapedLayerOrder=e.drapedLayerOrder,this.renderPriority=e.renderPriority,h(this.normal,e.normal),R(this.transformation,e.transformation)}}function L(i){return i?.distance!=null}const d=v(),l=k();let H=class{constructor(i){this.layerViewUid=i}};class Y extends H{constructor(e,r){super(e),this.graphicUid=r}}class $ extends Y{constructor(e,r,t,n,s){super(e,r),this.layerViewUid=e,this.graphicUid=r,this.triangleNr=t,this.baseBoundingSphere=n,this.numLodLevels=s}}let ee=class{constructor(i,e,r,t){this.material=i,this.bufferWriter=i.createBufferWriter(),this.vertexBufferLayout=this.bufferWriter.vertexBufferLayout,this.buffer=e,this.elementCount=r,this.boundingInfo=t}get numTriangles(){return this.elementCount/3}get numVertices(){return this.elementCount}computeUsedMemory(){return this.buffer.byteLength+j}getRenderGeometry(){return this}intersect(i,e,r,t,n,s,o,a){const m=this.bufferWriter,c=this.buffer;m.intersect(c,this.material.parameters,null,i,r,t,(u,g,y)=>w(u,g,y,i,e,s,o,n,a))}};class te{constructor(e){this.engineGeometry=e}get material(){return this.engineGeometry.material}get numVertices(){return this.engineGeometry.attributes.get(J.POSITION).indices.length}get numTriangles(){return this.engineGeometry.indexCount/3}get boundingInfo(){return this.engineGeometry.boundingInfo}computeUsedMemory(){return Array.from(this.engineGeometry.attributes.values()).reduce((e,r)=>e+V(r.data,r.indices),0)}getRenderGeometry(){const e=this.material,r=this.engineGeometry,t=r.attributes,n=r.boundingInfo,s=e.createBufferWriter(),o=s.vertexBufferLayout,a=s.elementCount(t),m=o.createBuffer(a);return s.write(null,null,t,null,m,0),new ee(e,m.buffer,a,n)}intersect(e,r,t,n,s,o,a,m){const c=this.engineGeometry;this.material.intersect(c,e.transform.transform,e,t,n,(u,g,y)=>w(u,g,y,e,r,o,a,s,m))}}function w(i,e,r,t,n,s,o,a,m){if(i<0||n&&!n(t.rayBegin,t.rayEnd,i))return;const c=new $(s.layerViewUid,s.graphicUid(a),r,o,m);if((t.results.min.distance==null||i<t.results.min.distance)&&t.results.min.set(p.LOD,c,i,e,t.transform.transform),(t.results.max.distance==null||i>t.results.max.distance)&&t.results.max.set(p.LOD,c,i,e,t.transform.transform),t.options.store===B.ALL){const u=new F(t.results.min.ray);u.set(p.LOD,c,i,e,t.transform.transform),t.results.all.push(u)}}let re=class{constructor(i,e=null){this.geometry=i,this.textures=e}get material(){return this.geometry.material}get numTriangles(){return this.geometry.numTriangles}};class ie{constructor(e,r,t){this.components=e,this.minScreenSpaceRadius=r,this.pivotOffset=t;const n=f(this.components.map(s=>s.geometry));this.numVertices=n.reduce((s,o)=>s+o.numVertices,0)}}class se{constructor(e){this.levels=e,this.levels.sort((r,t)=>r.minScreenSpaceRadius===t.minScreenSpaceRadius?r.numVertices-t.numVertices:r.minScreenSpaceRadius-t.minScreenSpaceRadius)}getMaterials(){const e=[];return this.levels.forEach(r=>r.components.forEach(t=>e.push(t.geometry.material))),f(e)}getTextures(){const e=new Array;return this.levels.forEach(r=>r.components.forEach(t=>{t.textures!=null&&e.push(...t.textures)})),f(e)}getGeometries(){const e=new Array;return this.levels.forEach(r=>r.components.forEach(t=>{e.push(t.geometry)})),f(e)}getEngineGeometries(){return this.getGeometries().map(e=>e.engineGeometry).filter(e=>e!=null)}computeUsedMemory(){const e=this.getGeometries(),r=this.getTextures(),t=e.reduce((n,s)=>n+s.computeUsedMemory(),0);return r.reduce((n,s)=>n+s.usedMemory,0)+t}}function nt(i){switch(i){case"sphere":case"cube":case"diamond":case"cylinder":case"cone":case"inverted-cone":case"tetrahedron":return!0}return!1}function ot(i,e){const r=(t,n,s=!1)=>new se(t.map(o=>{const a=n(o.tesselation);return s&&T(a),new ie([new re(new te(a))],o.minScreenSpaceRadius)}));switch(i){case"sphere":return r([{tesselation:0,minScreenSpaceRadius:0},{tesselation:1,minScreenSpaceRadius:8},{tesselation:2,minScreenSpaceRadius:16},{tesselation:3,minScreenSpaceRadius:50},{tesselation:4,minScreenSpaceRadius:250}],t=>U(e,.5,t));case"cube":return r([{tesselation:0,minScreenSpaceRadius:0}],()=>P(e,1));case"cone":return r(S,t=>b(e,1,.5,t,!1),!0);case"inverted-cone":return r(S,t=>b(e,1,.5,t,!0),!0);case"cylinder":return r(S,t=>M(e,1,.5,t,[0,0,1],[0,0,.5]));case"tetrahedron":return r([{tesselation:0,minScreenSpaceRadius:0}],()=>E(e,1),!0);case"diamond":return r([{tesselation:0,minScreenSpaceRadius:0}],()=>x(e,1),!0);default:return}}const S=[{tesselation:6,minScreenSpaceRadius:0},{tesselation:18,minScreenSpaceRadius:7},{tesselation:64,minScreenSpaceRadius:65}],at=Object.freeze(Object.defineProperty({__proto__:null,build:K},Symbol.toStringTag,{value:"Module"})),mt=Object.freeze(Object.defineProperty({__proto__:null,build:Q,getRadius:X},Symbol.toStringTag,{value:"Module"})),ct=Object.freeze(Object.defineProperty({__proto__:null,build:Z},Symbol.toStringTag,{value:"Module"})),ut=Object.freeze(Object.defineProperty({__proto__:null,build:q},Symbol.toStringTag,{value:"Module"}));export{ct as D,ut as R,nt as S,re as a,te as b,at as c,mt as d,ie as f,se as h,ot as l,F as p};
