const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./intersectsOperator-ZBnSpPTv-kABmOjXE.js","./ProjectionTransformation-DQ4GElxa-CsEvA0Qr.js","./Envelope2D-DlBzXkgv-BnYfKOnq.js","./Point2D-CaHJVGk1-DPGpS6fb.js","./Transformation2D-CXWnDKXs-CSiy3rK5.js","./SimpleGeometryCursor-DSF_YyIm-TAMgMsbK.js","./main-D8UjLOIQ.js","./main-D2F5QhFW.css","./OperatorDefinitions-DJdq_wrt-DP7_WWTp.js","./jsonConverter-tsQ40CV0-CCpJf56u.js","./OperatorIntersects-u5auAqUh-BArPb8ch.js","./apiConverter-CSuukuP9-DgRHhT0x.js","./containsOperator-CnkxASyq-Dn_hNgL3.js"])))=>i.map(i=>d[i]);
import{_ as C,q as D,x as V,m as b}from"./main-D8UjLOIQ.js";import{V as R}from"./dataUtils-CfR0oe2x-9u0OiQkX.js";function L(e,h){if(e.spatialReference.equals(h))return e;const t=V(e.spatialReference),i=V(h);if(t===i)return e;const n=t/i;return{x:e.x*n,y:e.y*n}}async function H(e,h,t){if(t.type==="extent")return K(e,h,t);const{width:i,height:n}=e,a=new Uint8Array(i*n);return(await C(()=>import("./intersectsOperator-ZBnSpPTv-kABmOjXE.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url).then(r=>r.i)).execute(h,t)?t.type==="polyline"?N(e,h,t):(await C(()=>import("./containsOperator-CnkxASyq-Dn_hNgL3.js"),__vite__mapDeps([12,1,2,3,4,5,6,7,8,9,11]),import.meta.url).then(r=>r.c)).execute(t,h)?e:B(e,h,t):new R({pixelType:e.pixelType,width:i,height:n,mask:a,maskIsAlpha:!1,pixels:[...e.pixels]})}function B(e,h,t){if(!e)return e;const{width:i,height:n}=e,a=F({geometry:t,size:[i,n],srcExtent:h,srcMask:e.mask});return new R({pixelType:e.pixelType,width:i,height:n,mask:a,maskIsAlpha:!1,pixels:[...e.pixels]})}function F(e){const{geometry:h,size:t,srcExtent:i,srcMask:n}=e,[a,r]=t;let x;const s=i.width/a,u=i.height/r,{xmin:m,ymax:o}=i;if(h.type==="extent"){const f=(h.xmin-m)/s,p=(h.xmax-m)/s,c=(o-h.ymax)/u,y=(o-h.ymin)/u;x=[[[f,c],[f,y],[p,y],[p,c],[f,c]]]}else x=h.rings.map(f=>f.map(([p,c])=>[(p-m)/s,(o-c)/u]));return G(x,t,n)}function G(e,h,t){const[i,n]=h,a=new OffscreenCanvas(i,n).getContext("2d");a.fillStyle="#f00",a.beginPath(),e.forEach(m=>{a.moveTo(m[0][0],m[0][1]);for(let o=0;o<m.length;o++)a.lineTo(m[o][0],m[o][1]);a.closePath()}),a.fill();const r=a.getImageData(0,0,i,n).data,x=i*n,s=new Uint8Array(x);let u=!1;for(let m=0;m<x;m++)t&&!t[m]||(r[4*m+3]>127?s[m]=255:u=!0);return u||t?s:void 0}function K(e,h,t){const{width:i,height:n}=e,a=new Uint8Array(i*n),r=h.width/i,x=h.height/n;if(t.width/r<.5||t.height/x<.5)return new R({pixelType:e.pixelType,width:i,height:n,mask:a,pixels:[...e.pixels]});const{xmin:s,xmax:u,ymin:m,ymax:o}=h,{xmin:f,xmax:p,ymin:c,ymax:y}=t,l=Math.max(s,f),v=Math.min(u,p),g=Math.max(m,c),M=Math.min(o,y),d=.5*r,E=.5*x;if(v-l<d||M-g<E||v<s+d||l>u-d||g>o-E||M<m+E)return new R({pixelType:e.pixelType,width:i,height:n,mask:a,pixels:[...e.pixels]});const w=Math.max(0,(l-s)/r),z=Math.min(i,Math.max(0,(v-s)/r)),I=Math.max(0,(o-M)/x),_=Math.min(n,Math.max(0,(o-g)/x)),T=Math.round(w),A=Math.round(z)-1,k=Math.round(I),P=Math.round(_)-1;if(T===A&&w%1>.5&&z%1<.5||k===P&&I%1>.5&&_%1<.5)return new R({pixelType:e.pixelType,width:i,height:n,mask:a,pixels:[...e.pixels]});if(T===0&&k===0&&A===i&&P===n)return e;const O=e.mask;for(let S=k;S<=P;S++)for(let U=T;U<=A;U++){const q=S*i+U;a[q]=O?O[q]:255}return new R({pixelType:e.pixelType,width:i,height:n,mask:a,pixels:[...e.pixels]})}function N(e,h,t){const{width:i,height:n}=e,a=new Uint8Array(i*n),r=h.width/i,x=h.height/n,{xmin:s,ymax:u}=h,{paths:m}=t,o=e.mask;for(let f=0;f<m.length;f++){const p=m[f];for(let c=0;c<p.length-1;c++){const[y,l]=p[c],[v,g]=p[c+1];let M=Math.floor((u-l)/x),d=Math.floor((u-g)/x);if(d<M){const w=M;M=d,d=w}M=Math.max(0,M),d=Math.min(n-1,d);const E=(v-y)/(g-l);for(let w=M;w<=d;w++){const z=w===M?Math.max(l,g):(n+1-w)*x,I=w===d?Math.min(l,g):z-x;let _=Math.floor(g===l?(y-s)/r:(E*(z-l)+y-s)/r),T=Math.floor(g===l?(v-s)/r:(E*(I-l)+y-s)/r);if(T<_){const k=_;_=T,T=k}const A=w*i;_=Math.max(0,_),T=Math.min(i-1,T);for(let k=A+_;k<=A+T;k++)a[k]=o?o[k]:255}}}return new R({pixelType:e.pixelType,width:i,height:n,mask:a,pixels:[...e.pixels]})}function J(e,h){const{extent:t}=Z(e,h,new b({x:e.pixelSize.x,y:e.pixelSize.y,spatialReference:e.spatialReference})),{extent:i}=e.extent;if(t.xmax=Math.min(t.xmax,i.xmax),t.ymax=Math.min(t.ymax,i.ymax),t.xmin<t.xmax&&t.ymin<t.ymax){const{x:n,y:a}=e.pixelSize,r=Math.round(t.width/n),x=Math.round(t.height/a);e.extent=t,e.width=r,e.height=x}}function Z(e,h,t,i=!0){const{spatialReference:n}=e,{x:a,y:r}=L(t,n);let x,s,u;const m=h.type==="extent"?h:h.extent;let{xmin:o,xmax:f,ymax:p,ymin:c}=m;const{xmin:y,ymax:l}=e.extent;return i?(o=y+(o>y?a*Math.round((o-y)/a):0),p=l-(p<l?r*Math.round((l-p)/r):0),f=y+(f>y?a*Math.round((f-y)/a):0),c=l-(c<l?r*Math.round((l-c)/r):0),x=new D({xmin:o,ymax:p,xmax:f,ymin:c,spatialReference:n}),s=Math.round(x.width/a),u=Math.round(x.height/r)):(s=Math.floor((f-o)/a+.8),u=Math.floor((p-c)/r+.8),o=y+(o>y?a*Math.floor((o-y)/a+.1):0),p=l-(p<l?r*Math.floor((l-p)/r+.1):0),f=o+s*a,c=p-u*r,x=new D({xmin:o,ymax:p,xmax:f,ymin:c,spatialReference:n})),{extent:x,width:s,height:u}}export{Z as $,H as F,F as O,J as _};
