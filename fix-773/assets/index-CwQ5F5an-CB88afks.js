const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./point-icon-Dd_kLleb-CA9xHe5d.js","./main-D8UjLOIQ.js","./main-D2F5QhFW.css","./polyline-icon-BmsBSMJm-CzI6zeSo.js","./polygon-icon-CnplOIHx-CprcKzxB.js","./circle-icon-qM-Cul3g-C7ST3tMB.js","./rectangle-icon-DaWElXKE-BIv3-7O9.js","./edit-icon-BBpkepd0-w_TwMcGr.js"])))=>i.map(i=>d[i]);
import{fU as T,fw as W,g8 as P,fy as G,fv as F,fA as $,fZ as V,fC as R,fB as I,fD as J,fI as X,fG as ee,f_ as D,fJ as H,fL as i,fM as t,fK as B,fR as g,fY as h,fN as E,f$ as c,fO as k,fQ as b,fV as z,fS as j,fP as L,fT as M,h3 as Q,hi as N,g6 as _,hj as w,_ as y}from"./main-D8UjLOIQ.js";import{y as te}from"./draw-store-DnCf4IRI-CPdDcdAW.js";const oe={},ae={class:"border-b p-0 self-center w-2/3"};function ne(d,n){return t(),i("span",ae)}const Y=T(oe,[["render",ne]]),ie=F({__name:"zoom-nav",setup(d){const{t:n}=R(),o=V("iApi"),a=N(400,!0,()=>o.geo.map.zoomIn()),r=N(400,!0,()=>o.geo.map.zoomOut());return(e,p)=>{const s=D("mapnav-button");return t(),i("div",null,[E(s,{onClickFunction:h(a),tooltip:h(n)("mapnav.zoomIn")},{default:z(()=>p[0]||(p[0]=[c("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[c("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),c("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"]),E(Y),E(s,{onClickFunction:h(r),tooltip:h(n)("mapnav.zoomOut")},{default:z(()=>p[1]||(p[1]=[c("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[c("path",{d:"M19 13H5v-2h14v2z"}),c("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"])])}}}),se={class:"mapnav-section bg-white-75 hover:bg-white"},le=F({__name:"draw-nav-section",props:{showOutline:{type:Boolean,default:!1}},setup(d){const n=V("iApi"),{t:o}=R(),a=te(),r=[{type:"point",icon:_(w(()=>y(()=>import("./point-icon-Dd_kLleb-CA9xHe5d.js"),__vite__mapDeps([0,1,2]),import.meta.url)))},{type:"polyline",icon:_(w(()=>y(()=>import("./polyline-icon-BmsBSMJm-CzI6zeSo.js"),__vite__mapDeps([3,1,2]),import.meta.url)))},{type:"polygon",icon:_(w(()=>y(()=>import("./polygon-icon-CnplOIHx-CprcKzxB.js"),__vite__mapDeps([4,1,2]),import.meta.url)))},{type:"circle",icon:_(w(()=>y(()=>import("./circle-icon-qM-Cul3g-C7ST3tMB.js"),__vite__mapDeps([5,1,2]),import.meta.url)))},{type:"rectangle",icon:_(w(()=>y(()=>import("./rectangle-icon-DaWElXKE-BIv3-7O9.js"),__vite__mapDeps([6,1,2]),import.meta.url)))}],e=I(()=>{const l=r.filter(v=>a.supportedTypes.some(x=>x.type===v.type));return l.push({type:"edit",icon:_(w(()=>y(()=>import("./edit-icon-BBpkepd0-w_TwMcGr.js"),__vite__mapDeps([7,1,2]),import.meta.url)))}),l}),p=l=>{a.activeTool===l?a.setActiveTool(null):a.setActiveTool(l)},s=()=>{n.geo.map.setMouseFocus()};return(l,v)=>{const x=D("mapnav-button");return t(),i("div",se,[(t(!0),i(k,null,L(e.value,(m,A)=>(t(),b(x,{key:m.type,onMousedown:s,onClickFunction:()=>p(m.type),tooltip:h(o)(`draw.${m.type}.tooltip`),class:j({"active-tool":h(a).activeTool===m.type}),style:Q({marginBottom:A!==e.value.length-1?"0px":"0"}),showOutline:d.showOutline},{default:z(()=>[(t(),b(M(m.icon),{class:"fill-current w-32 h-20"}))]),_:2},1032,["onClickFunction","tooltip","class","style","showOutline"]))),128))])}}}),Z=T(le,[["__scopeId","data-v-0dac0135"]]),re={class:"mapnav absolute right-0 bottom-0 pb-36 sm:pb-48 pr-12"},pe=["content"],ue={class:"mapnav-section bg-white-75 hover:bg-white"},ce={key:1,class:"mapnav-section bg-white-75 hover:bg-white"},ve=["content"],me={key:0},he=F({__name:"mapnav",setup(d){const n=$(void 0),o=V("iApi"),a=P(),{t:r}=R(),e=$(),p=I(()=>o.getConfig().fixtures.mapnav.items.some(u=>u==="draw")),s=$(o.$rootEl?.clientHeight),l=$(!1),v=$(0),x=()=>{s.value=o.$rootEl?.clientHeight},m=()=>{e.value._tippy.hide()},A=u=>{u.key==="Tab"&&e.value?.matches(":focus")&&e.value._tippy.show()};J(()=>{e.value?.addEventListener("blur",m),e.value?.addEventListener("keyup",A),n.value=new ResizeObserver(x),n.value.observe(o.$rootEl),X(()=>{v.value=C.value.length*82})}),ee(()=>{e.value?.removeEventListener("blur",m),e.value?.removeEventListener("keyup",A),n.value.disconnect()});const C=I(()=>a.order.map(u=>a.items[u]).filter(u=>u.componentId&&u.id!=="draw"));return(u,f)=>{const q=D("mapnav-button"),K=H("focus-list"),S=H("tippy");return t(),i("div",re,[B((t(),i("div",{class:"mapnav-section flex flex-col",content:h(r)("panels.controls.items"),ref_key:"el",ref:e},[p.value&&s.value>v.value?(t(),i(k,{key:0},[E(Z),f[0]||(f[0]=c("span",{class:"py-1"},null,-1))],64)):g("",!0),E(ie,{class:"mapnav-section bg-white-75 hover:bg-white"}),f[2]||(f[2]=c("span",{class:"py-1"},null,-1)),c("div",ue,[s.value<=v.value?(t(),b(q,{key:0,class:"self-center",onClickFunction:()=>{l.value=!l.value},tooltip:l.value?u.$t("mapnav.closeMenu"):u.$t("mapnav.openMenu")},{default:z(()=>[(t(),i("svg",{xmlns:"http://www.w3.org/2000/svg","shape-rendering":"geometricPrecision","text-rendering":"geometricPrecision","image-rendering":"optimizeQuality","fill-rule":"evenodd","clip-rule":"evenodd",viewBox:"0 0 319 511.61",class:j(["fill-current w-6 mx-auto transition-all transform",{"rotate-180":l.value}])},f[1]||(f[1]=[c("path",{d:"m270.08 5.89 43.04 43.04c7.85 7.86 7.83 20.72 0 28.54L134.77 255.82l178.35 178.35c7.85 7.86 7.8 20.73 0 28.54l-43.04 43.04c-7.83 7.82-20.71 7.82-28.54 0L49.29 313.49l-.37-.36-43.04-43.04c-7.82-7.83-7.86-20.68 0-28.54l43.04-43.04.37-.36L241.54 5.89c7.85-7.85 20.68-7.85 28.54 0z"},null,-1)]),2))]),_:1},8,["onClickFunction","tooltip"])):g("",!0)]),s.value>v.value?(t(),i("div",ce,[(t(!0),i(k,null,L(C.value,(O,U)=>(t(),i(k,{key:O.id+"button"},[(t(),b(M(O.id+"-nav-button"))),U!==C.value.length-1?(t(),b(Y,{key:0,class:"mapnav-divider"})):g("",!0)],64))),128))])):g("",!0)],8,pe)),[[K],[S,{trigger:"manual",placement:"top-end",touch:!1,maxWidth:190}]]),s.value<=v.value&&l.value?B((t(),i("div",{key:0,class:"mapnav-section flex flex-col flex-wrap-reverse shadow-tm absolute right-56 bottom-36 sm:bottom-48 items-start z-50 gap-0.5",style:Q({maxHeight:`${(s.value-70)*.8}px`,height:"fit-content",width:"fit-content"}),content:h(r)("panels.controls.items")},[p.value?(t(),i("div",me,[E(Z,{showOutline:""})])):g("",!0),(t(!0),i(k,null,L(C.value,O=>(t(),b(M(O.id+"-nav-button"),{key:O.id+"button",class:"mapnav-section bg-white-75 hover:bg-white",showOutline:""}))),128))],12,ve)),[[S,{trigger:"manual",placement:"top-end",maxWidth:190}]]):g("",!0)])}}}),de=T(he,[["__scopeId","data-v-d62d1b77"]]);class fe extends G{mapnavStore=P(this.$vApp.$pinia);get config(){return super.config}_parseConfig(n){if(!n)return;const o=n.items.map(a=>({id:a}));this.mapnavStore.items=o.reduce((a,r)=>(a[r.id]=r,a),{}),this.mapnavStore.order=o.map(a=>a.id),this._validateItems()}_validateItems(){const n=["geolocator","zoom","home","fullscreen"];this.mapnavStore.order.forEach(o=>{(this.$iApi.fixture.exists(o)||n.includes(o))&&(this.mapnavStore.items[o].componentId=`${o}-nav-button`)})}}const ge={en:{"mapnav.openMenu":"Open navigation","mapnav.closeMenu":"Close navigation","mapnav.zoomIn":"Zoom In","mapnav.zoomOut":"Zoom Out","mapnav.home":"Home","mapnav.fullscreen":"Full Screen","mapnav.geolocator":"Your Location","mapnav.geolocator.error.permission":"The location request was denied. Please check your browser permission settings.","mapnav.geolocator.error.internal":"Your location could not be found."},fr:{"mapnav.openMenu":"Ouvrir la navigation","mapnav.closeMenu":"Fermer la navigation","mapnav.zoomIn":"Zoom avant","mapnav.zoomOut":"Zoom arrière","mapnav.home":"Accueil","mapnav.fullscreen":"Plein Écran","mapnav.geolocator":"Votre position","mapnav.geolocator.error.permission":"Demande de localisation refusée. Veuillez vérifier les paramètres d'autorisation de votre navigateur.","mapnav.geolocator.error.internal":"Votre emplacement n'a pu être trouvé."}};class ye extends fe{async added(){Object.entries(ge).forEach(e=>this.$iApi.$i18n.mergeLocaleMessage(...e));const{destroy:n,el:o}=this.mount(de,{app:this.$element});this.$vApp.$el.getElementsByClassName("inner-shell")[0].appendChild(o.childNodes[0]),this._parseConfig(this.config);const a=this.$vApp.$watch(()=>this.config,e=>this._parseConfig(e)),r=this.$iApi.event.on(W.COMPONENT,()=>{this._parseConfig(this.config)});this.removed=()=>{a(),this.$iApi.event.off(r);const e=P(this.$vApp.$pinia),p={...e.items};Object.keys(p).forEach(s=>e.removeItem(s)),e.$reset(),n()}}}export{ye as default};
