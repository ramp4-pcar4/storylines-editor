import{gL as z,dn as A,a2 as d}from"./main-D8UjLOIQ.js";import{X as G}from"./sphere-zPMQWhGG-C71NzDQ7.js";import{_ as B,r as X,y as l,v as J,P as M,L as P,p as L}from"./vec32-Cj8pVsU0-BmYyqgTW.js";import{q as g}from"./vectorStacks-5ZZtmT9E-D2GdqudT.js";function y(t){return t?{origin:z(t.origin),vector:z(t.vector)}:{origin:A(),vector:A()}}function Q(t,e){const n=T.get();return n.origin=t,n.vector=e,n}function _(t,e=y()){return R(t.origin,t.vector,e)}function R(t,e,n=y()){return B(n.origin,t),B(n.vector,e),n}function j(t,e,n=y()){return B(n.origin,t),X(n.vector,e,t),n}function k(t,e){const n=X(g.get(),e,t.origin),u=l(t.vector,n),i=l(t.vector,t.vector),f=d(u/i,0,1),c=X(g.get(),P(g.get(),t.vector,f),n);return l(c,c)}function C(t,e,n){return S(t,e,0,1,n)}function H(t,e,n){return M(n,t.origin,P(n,t.vector,e))}function S(t,e,n,u,i){const{vector:f,origin:c}=t,p=X(g.get(),e,c),s=l(f,p)/J(f);return P(i,f,d(s,n,u)),M(i,i,t.origin)}function I(t,e){if(E(t,Q(e.origin,e.direction),!1,x)){const{tA:n,pB:u,distance2:i}=x;if(n>=0&&n<=1)return i;if(n<0)return L(t.origin,u);if(n>1)return L(M(g.get(),t.origin,t.vector),u)}return null}function K(t,e,n){return!!E(t,e,!0,x)&&(B(n,x.pA),!0)}function E(t,e,n,u){const i=t.origin,f=M(g.get(),i,t.vector),c=e.origin,p=M(g.get(),c,e.vector),s=g.get(),r=g.get();if(s[0]=i[0]-c[0],s[1]=i[1]-c[1],s[2]=i[2]-c[2],r[0]=p[0]-c[0],r[1]=p[1]-c[1],r[2]=p[2]-c[2],Math.abs(r[0])<1e-6&&Math.abs(r[1])<1e-6&&Math.abs(r[2])<1e-6)return!1;const o=g.get();if(o[0]=f[0]-i[0],o[1]=f[1]-i[1],o[2]=f[2]-i[2],Math.abs(o[0])<1e-6&&Math.abs(o[1])<1e-6&&Math.abs(o[2])<1e-6)return!1;const q=s[0]*r[0]+s[1]*r[1]+s[2]*r[2],b=r[0]*o[0]+r[1]*o[1]+r[2]*o[2],F=s[0]*o[0]+s[1]*o[1]+s[2]*o[2],D=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],w=(o[0]*o[0]+o[1]*o[1]+o[2]*o[2])*D-b*b;if(Math.abs(w)<1e-6)return!1;let a=(q*b-F*D)/w,v=(q+b*a)/D;n&&(a=d(a,0,1),v=d(v,0,1));const h=g.get(),m=g.get();return h[0]=i[0]+a*o[0],h[1]=i[1]+a*o[1],h[2]=i[2]+a*o[2],m[0]=c[0]+v*r[0],m[1]=c[1]+v*r[1],m[2]=c[2]+v*r[2],u.tA=a,u.tB=v,u.pA=h,u.pB=m,u.distance2=L(h,m),!0}const x={tA:0,tB:0,pA:A(),pB:A(),distance2:0},T=new G(()=>y());export{R as D,S as E,y as M,_ as Q,j as R,k as S,C as T,H as U,I as V,K as W};
