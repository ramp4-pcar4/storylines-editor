import{a2 as z,dn as D}from"./main-D8UjLOIQ.js";import{y as T,P as y,L as v,R as p,r as E,l as U,S as d,A as h}from"./vec32-Cj8pVsU0-BmYyqgTW.js";import"./vec42-D8CJyqHG-DnfLTeQH.js";import{v as j,q as a,b as P}from"./vectorStacks-5ZZtmT9E-D2GdqudT.js";function rr(r){const t=r[0]*r[0]+r[4]*r[4]+r[8]*r[8],I=r[1]*r[1]+r[5]*r[5]+r[9]*r[9],e=r[2]*r[2]+r[6]*r[6]+r[10]*r[10];return Math.sqrt(Math.max(t,I,e))}function tr(r,t){const I=Math.sqrt(t[0]*t[0]+t[4]*t[4]+t[8]*t[8]),e=Math.sqrt(t[1]*t[1]+t[5]*t[5]+t[9]*t[9]),u=Math.sqrt(t[2]*t[2]+t[6]*t[6]+t[10]*t[10]);return h(r,I,e,u),r}function w(r,t,I){Math.abs(r[0])>Math.abs(r[1])?h(t,0,1,0):h(t,1,0,0),d(I,r,t),d(t,I,r),U(I,I),U(t,t)}function L(r=_){return[r[0],r[1],r[2],r[3]]}function Ir(r=_[0],t=_[1],I=_[2],e=_[3]){return X(r,t,I,e,j.get())}function B(r,t){return X(t[0],t[1],t[2],t[3],r)}function er(r){return r}function X(r,t,I,e,u=L()){return u[0]=r,u[1]=t,u[2]=I,u[3]=e,u}function G(r,t,I){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],u=Math.abs(e-1)>1e-5&&e>1e-12?1/Math.sqrt(e):1;return I[0]=t[0]*u,I[1]=t[1]*u,I[2]=t[2]*u,I[3]=-(I[0]*r[0]+I[1]*r[1]+I[2]*r[2]),I}function H(r,t,I,e=L()){const u=I[0]-t[0],i=I[1]-t[1],n=I[2]-t[2],c=r[0]-t[0],g=r[1]-t[1],O=r[2]-t[2],S=i*O-n*g,m=n*c-u*O,b=u*g-i*c,q=S*S+m*m+b*b,$=Math.abs(q-1)>1e-5&&q>1e-12?1/Math.sqrt(q):1;return e[0]=S*$,e[1]=m*$,e[2]=b*$,e[3]=-(e[0]*r[0]+e[1]*r[1]+e[2]*r[2]),e}function x(r,t,I,e=0,u=Math.floor(I*(1/3)),i=Math.floor(I*(2/3))){if(I<3)return!1;t(M,e);let n=u,c=!1;for(;n<I-1&&!c;)t(f,n),n++,c=!p(M,f);if(!c)return!1;for(n=Math.max(n,i),c=!1;n<I&&!c;)t(N,n),n++,E(l,M,f),U(l,l),E(C,f,N),U(C,C),c=!p(M,N)&&!p(f,N)&&Math.abs(T(l,C))<K;return c?(H(M,f,N,r),!0):(e!==0||u!==1||i!==2)&&x(r,t,I,0,1,2)}function ur(r,t,I=!0){const e=t.length/3;return x(r,(u,i)=>h(u,t[3*i+0],t[3*i+1],t[3*i+2]),I?e-1:e)}const K=.99619469809,M=D(),f=D(),N=D(),l=D(),C=D();function cr(r,t,I){return t!==r&&B(r,t),r[3]=-T(r,I),r}function nr(r,t){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=-r[3],t}function ir(r,t,I,e){return d(N,t,r),G(I,N,e)}function or(r,t,I,e){return R(F(r,t,E(a.get(),I,t),W,e))}function sr(r,t,I){return t!=null&&R(F(r,t.origin,t.direction,Y,I))}function ar(r,t,I){return R(F(r,t.origin,t.vector,s.NONE,I))}function Nr(r,t,I){return R(F(r,t.origin,t.vector,s.CLAMP,I))}function fr(r,t){return A(r,t)>=0}function Er(r,t){const I=T(r,t.ray.direction),e=-A(r,t.ray.origin);if(I>-1e-6&&I<1e-6)return e>0;const u=e/I;return I>0?u<t.c1&&(t.c1=u):u>t.c0&&(t.c0=u),t.c0<=t.c1}function Tr(r,t,I){const e=v(a.get(),r,-r[3]),u=V(r,E(a.get(),t,e),a.get());return y(I,u,e),I}function Sr(r,t,I,e){const u=r,i=a.get(),n=a.get();w(u,i,n);const c=E(a.get(),I,t),g=P(i,c),O=P(n,c),S=P(u,c);return h(e,g,O,S)}function V(r,t,I){const e=v(a.get(),r,T(r,t));return E(I,t,e),I}function Mr(r,t){return Math.abs(A(r,t))}function A(r,t){return T(r,t)+r[3]}var o;function R(r){return r===o.INTERSECTS_INSIDE_OUT||r===o.INTERSECTS_OUTSIDE_IN}function F(r,t,I,e,u){const i=T(r,I),n=A(r,t);if(i===0)return n>=0?o.INSIDE:o.OUTSIDE;let c=-n/i;return e&s.CLAMP&&(c=z(c,0,1)),!(e&s.INFINITE_MIN)&&c<0||!(e&s.INFINITE_MAX)&&c>1?n>=0?o.INSIDE:o.OUTSIDE:(y(u,t,v(u,I,c)),n>=0?o.INTERSECTS_INSIDE_OUT:o.INTERSECTS_OUTSIDE_IN)}(function(r){r[r.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",r[r.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",r[r.INSIDE=2]="INSIDE",r[r.OUTSIDE=3]="OUTSIDE"})(o||(o={}));const _=[0,0,1,0];var s;(function(r){r[r.NONE=0]="NONE",r[r.CLAMP=1]="CLAMP",r[r.INFINITE_MIN=4]="INFINITE_MIN",r[r.INFINITE_MAX=8]="INFINITE_MAX"})(s||(s={}));const W=s.INFINITE_MIN|s.INFINITE_MAX,Y=s.INFINITE_MAX;export{er as $,ur as B,H as G,x as H,Ir as K,Mr as N,A as O,rr as V,cr as Y,nr as Z,ar as a,Er as c,X as d,fr as e,Tr as i,tr as j,or as n,sr as o,Sr as r,Nr as s,ir as t,w as u,B as w,L as y,G as z};
