const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./unitConversion-BxD3RA9Y--0IbSiek.js","./enum-g1DWyQyu-C22wI6Gv.js","./main-D8UjLOIQ.js","./main-D2F5QhFW.css"])))=>i.map(i=>d[i]);
import{aE as m,aW as y,j as g,q as R,B as b,_ as Y,m as I,Z as F,o as M,cf as X,bp as V,U as $,N as k}from"./main-D8UjLOIQ.js";import{i as O,A as x,k as nn,U as en,T as an,m as tn,q as rn,r as on,t as B}from"./arcade-BoHTeCSG-BxKTtX2e.js";import{w,y as z,a as h,A as H,z as Q,p as W,b as v,J as E,K as L,M as _,H as Z,R as q,L as C,N as P,T as sn,q as D,j,i as U}from"./aiServices-u5nRiq9H-Dfd8u3BD.js";import{l as o,r as s}from"./enum-g1DWyQyu-C22wI6Gv.js";import{V as J}from"./TimeOnly-CGkId3bj-BgQ9WVmM.js";import{n as G}from"./portalUtils-COohlq76-CL5gSea4.js";import{n as d}from"./operatorsWorkerConnection-TmW3NQ3Q-BOhyH2qJ.js";import"./featureConversionUtils-Bjjlcfdo-BL25e0Vn.js";import"./OptimizedFeature-mIz_HhJg-D48m52Jl.js";import"./memoryEstimations-DeWfxwaV-DpFMiS4z.js";import"./OptimizedGeometry-pzfNw1AT-BMGedq_M.js";import"./OptimizedFeatureSet-Dz5hF8Qm-CgsRgxJh.js";import"./FieldsIndex-Bt0Y8aWr-DcDROz7E.js";import"./UnknownTimeZone-DxjyzFvs-DtNVLQoo.js";import"./timeZoneUtils-d5p0Jda1-BeP90iup.js";import"./ImmutableArray-CiJxhY8_-Kqx7aWRu.js";import"./shared-DttuBH5Z-B1MkhdGZ.js";import"./Field-BIQ-quF4-BPjMRpni.js";import"./fieldType-PhcL4ff8-B7j5aTWg.js";import"./WhereClause-D4rZJkVN-Bi-135nj.js";import"./unitConversion-BxD3RA9Y--0IbSiek.js";import"./number-mnL_JN3f-OAAcMkOv.js";import"./uuid-Dj9mdEVg-BaKSCiyT.js";import"./commonProperties-D1Pjvz5u-DHiB1uzW.js";import"./utils-BO8hgPs3-CT_Uv3UC.js";import"./workers-CeRXsnNJ-D6z4uDiD.js";import"./Queue-DV3gpSdl-Dg8OZOjE.js";import"./intl-BAA1onnp-D6KfQGxz.js";async function K(i,e,a){if(!$?.findCredential(i.restUrl))return null;if(i.loadStatus==="loaded"&&e===""&&i.user?.sourceJSON&&a===!1)return i.user.sourceJSON;const l={responseType:"json",query:{f:"json"}};if(a&&(l.query.returnUserLicenseTypeExtensions=!0),e===""){const n=await k(i.restUrl+"/community/self",l);if(n.data){const t=n.data;if(t?.username)return t}return null}const f=await k(i.restUrl+"/community/users/"+e,l);if(f.data){const n=f.data;return n.error?null:n}return null}function p(i){if(i==null)return i;switch(typeof i){case"string":case"number":return i;default:throw new o(null,s.InvalidParameter,null)}}function En(i){i.mode==="async"&&(i.functions.disjoint=function(e,a){return i.standardFunctionAsync(e,a,(l,f,n)=>(n=w(n),O(n,e,a),n[0]===null||n[1]===null||d("disjoint",[n[0].toJSON(),n[1].toJSON()])))},i.functions.intersects=function(e,a){return i.standardFunctionAsync(e,a,(l,f,n)=>(n=w(n),O(n,e,a),n[0]!==null&&n[1]!==null&&d("intersects",[n[0].toJSON(),n[1].toJSON()])))},i.functions.touches=function(e,a){return i.standardFunctionAsync(e,a,(l,f,n)=>(n=w(n),O(n,e,a),n[0]!==null&&n[1]!==null&&d("touches",[n[0].toJSON(),n[1].toJSON()])))},i.functions.crosses=function(e,a){return i.standardFunctionAsync(e,a,(l,f,n)=>(n=w(n),O(n,e,a),n[0]!==null&&n[1]!==null&&d("crosses",[n[0].toJSON(),n[1].toJSON()])))},i.functions.within=function(e,a){return i.standardFunctionAsync(e,a,(l,f,n)=>(n=w(n),O(n,e,a),n[0]!==null&&n[1]!==null&&d("within",[n[0].toJSON(),n[1].toJSON()])))},i.functions.contains=function(e,a){return i.standardFunctionAsync(e,a,(l,f,n)=>(n=w(n),O(n,e,a),n[0]!==null&&n[1]!==null&&d("contains",[n[0].toJSON(),n[1].toJSON()])))},i.functions.overlaps=function(e,a){return i.standardFunctionAsync(e,a,(l,f,n)=>(n=w(n),O(n,e,a),n[0]!==null&&n[1]!==null&&d("overlaps",[n[0].toJSON(),n[1].toJSON()])))},i.functions.equals=function(e,a){return i.standardFunctionAsync(e,a,(l,f,n)=>(h(n,2,2,e,a),n[0]===n[1]||(n[0]instanceof m&&n[1]instanceof m?d("equals",[n[0].toJSON(),n[1].toJSON()]):(z(n[0])&&z(n[1])||!!(H(n[0])&&H(n[1])||Q(n[0])&&Q(n[1])))&&n[0].equals(n[1]))))},i.functions.relate=function(e,a){return i.standardFunctionAsync(e,a,(l,f,n)=>{if(n=w(n),h(n,3,3,e,a),n[0]instanceof m&&n[1]instanceof m)return d("relate",[n[0].toJSON(),n[1].toJSON(),W(n[2])]);if(n[0]instanceof m&&n[1]===null||n[1]instanceof m&&n[0]===null||n[0]===null&&n[1]===null)return!1;throw new o(e,s.InvalidParameter,a)})},i.functions.intersection=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>(n=w(n),O(n,e,a),n[0]===null||n[1]===null?null:y(await d("intersection",[n[0].toJSON(),n[1].toJSON()]))))},i.functions.union=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if((n=w(n)).length===0)throw new o(e,s.WrongNumberOfParameters,a);const t=[];if(n.length===1)if(g(n[0])){for(const r of w(n[0]))if(r!==null){if(!(r instanceof m))throw new o(e,s.InvalidParameter,a);t.push(r.toJSON())}}else{if(!v(n[0])){if(n[0]instanceof m)return E(J(n[0]),e.spatialReference);if(n[0]===null)return null;throw new o(e,s.InvalidParameter,a)}for(const r of w(n[0].toArray()))if(r!==null){if(!(r instanceof m))throw new o(e,s.InvalidParameter,a);t.push(r.toJSON())}}else for(const r of n)if(r!==null){if(!(r instanceof m))throw new o(e,s.InvalidParameter,a);t.push(r.toJSON())}return t.length===0?null:y(await d("union",[t]))})},i.functions.difference=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>(n=w(n),O(n,e,a),n[0]===null?null:n[1]===null?J(n[0]):y(await d("difference",[n[0].toJSON(),n[1].toJSON()]))))},i.functions.symmetricdifference=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>(n=w(n),O(n,e,a),n[0]===null&&n[1]===null?null:n[0]===null?J(n[1]):n[1]===null?J(n[0]):y(await d("symmetricDifference",[n[0].toJSON(),n[1].toJSON()]))))},i.functions.clip=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if(n=w(n),h(n,2,2,e,a),!(n[1]instanceof R)&&n[1]!==null)throw new o(e,s.InvalidParameter,a);if(n[0]===null)return null;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);return n[1]===null?null:y(await d("clip",[n[0].toJSON(),n[1].toJSON()]))})},i.functions.cut=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if(n=w(n),h(n,2,2,e,a),!(n[1]instanceof b)&&n[1]!==null)throw new o(e,s.InvalidParameter,a);if(n[0]===null)return[];if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);return n[1]===null?[J(n[0])]:(await d("cut",[n[0].toJSON(),n[1].toJSON()])).map(t=>y(t))})},i.functions.area=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if(h(n,1,2,e,a),n=w(n),L(n[0])){const r=await n[0].sumArea(p(n[1]),null,e.abortSignal);if(e.abortSignal.aborted)throw new o(e,s.Cancelled,a);return r}let t=n[0];if((g(t)||v(t))&&(t=_(n[0],e.spatialReference)),t===null)return 0;if(!(t instanceof m))throw new o(e,s.InvalidParameter,a);return d("area",[t.toJSON(),p(n[1])])})},i.functions.areageodetic=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{h(n,1,3,e,a);let t=(n=w(n))[0];(g(t)||v(t))&&(t=_(t,e.spatialReference));const r=p(n[1]),u=x(n[2]);if(L(t)){const c=await t.sumArea(r,u,e.abortSignal);if(e.abortSignal.aborted)throw new o(e,s.Cancelled,a);return c}if(t==null)return 0;if(!Z(t))throw new o(e,s.InvalidParameter,a);return d("geodeticArea",[t.toJSON(),r,u])})},i.functions.length=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if(h(n,1,2,e,a),n=w(n),L(n[0])){const r=await n[0].sumLength(p(n[1]),null,e.abortSignal);if(e.abortSignal.aborted)throw new o(e,s.Cancelled,a);return r}let t=n[0];if((g(n[0])||v(n[0]))&&(t=q(n[0],e.spatialReference)),t===null)return 0;if(!(t instanceof m))throw new o(e,s.InvalidParameter,a);return d("length",[t.toJSON(),p(n[1])])})},i.functions.length3d=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if(h(n,1,2,e,a),(n=w(n))[0]===null)return 0;let t=n[0];if((g(n[0])||v(n[0]))&&(t=q(n[0],e.spatialReference)),t===null)return 0;if(!(t instanceof m))throw new o(e,s.InvalidParameter,a);if(t.hasZ===!0){const{convertFromSpatialReferenceUnit:r,toLengthUnit:u}=await Y(()=>import("./unitConversion-BxD3RA9Y--0IbSiek.js"),__vite__mapDeps([0,1,2,3]),import.meta.url),c=nn(t);return r(t.spatialReference,u(n[1]),c)}return d("length",[t.toJSON(),p(n[1])])})},i.functions.lengthgeodetic=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{h(n,1,3,e,a);let t=(n=w(n))[0];(g(n[0])||v(n[0]))&&(t=q(n[0],e.spatialReference));const r=p(n[1]),u=x(n[2]);if(L(t)){const c=await t.sumLength(r,u,e.abortSignal);if(e.abortSignal.aborted)throw new o(e,s.Cancelled,a);return c}if(t===null)return 0;if(!Z(t))throw new o(e,s.InvalidParameter,a);return d("geodeticLength",[t.toJSON(),r,u])})},i.functions.distance=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{n=w(n),h(n,2,3,e,a);let t=n[0];if((g(n[0])||v(n[0]))&&(t=C(n[0],e.spatialReference)),!(t instanceof m))throw new o(e,s.InvalidParameter,a);let r=n[1];if((g(n[1])||v(n[1]))&&(r=C(n[1],e.spatialReference)),!(r instanceof m))throw new o(e,s.InvalidParameter,a);return d("distance",[t.toJSON(),r.toJSON(),p(n[2])])})},i.functions.distancegeodetic=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{n=w(n),h(n,2,4,e,a);const t=n[0];if(!(t instanceof I))throw new o(e,s.InvalidParameter,a);const r=n[1];if(!(r instanceof I))throw new o(e,s.InvalidParameter,a);const u=new b({paths:[],spatialReference:t.spatialReference});return u.addPath([t,r]),d("geodeticLength",[u.toJSON(),p(n[2]),x(n[3])])})},i.functions.densify=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if(n=w(n),h(n,2,3,e,a),n[0]===null)return null;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);const t=P(n[1]);if(isNaN(t))throw new o(e,s.InvalidParameter,a);if(t<=0)throw new o(e,s.InvalidParameter,a);switch(n[0].type){case"polygon":case"polyline":case"extent":return y(await d("densify",[n[0].toJSON(),t,p(n[2])]));default:return n[0]}})},i.functions.densifygeodetic=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{n=w(n),h(n,2,4,e,a);const t=n[0];if(t==null)return null;if(!Z(t))throw new o(e,s.InvalidParameter,a);const r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,a);if(r<=0)throw new o(e,s.InvalidParameter,a);const u=p(n[2]),c=x(n[3]);switch(t.type){case"polygon":case"polyline":case"extent":return y(await d("geodeticDensify",[t.toJSON(),r,u,c]));default:return t}})},i.functions.generalize=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if(n=w(n),h(n,2,4,e,a),n[0]===null)return null;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);const t=P(n[1]);if(isNaN(t))throw new o(e,s.InvalidParameter,a);const r=sn(D(n[2],!0));return y(await d("generalize",[n[0].toJSON(),t,p(n[3]),{removeDegenerateParts:r}]))})},i.functions.buffer=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if(n=w(n),h(n,2,3,e,a),n[0]===null)return null;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);const t=P(n[1]);if(isNaN(t))throw new o(e,s.InvalidParameter,a);return t===0?J(n[0]):y(await d("buffer",[n[0].toJSON(),t,p(n[2])]))})},i.functions.buffergeodetic=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{n=w(n),h(n,2,4,e,a);const t=n[0];if(t==null)return null;if(!Z(t))throw new o(e,s.InvalidParameter,a);const r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,a);if(r===0)return J(t);const u=p(n[2]),c=x(n[3]);return y(await d("geodesicBuffer",[t.toJSON(),r,u,c]))})},i.functions.offset=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if(n=w(n),h(n,2,6,e,a),n[0]===null)return null;if(!(n[0]instanceof F||n[0]instanceof b))throw new o(e,s.InvalidParameter,a);const t=P(n[1]);if(isNaN(t))throw new o(e,s.InvalidParameter,a);const r=en(n[3]),u=P(D(n[4],10));if(isNaN(u))throw new o(e,s.InvalidParameter,a);const c=P(D(n[5],0));if(isNaN(c))throw new o(e,s.InvalidParameter,a);return y(await d("offset",[n[0].toJSON(),t,p(n[2]),{joins:r,miterLimit:u,flattenError:c}]))})},i.functions.rotate=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if(n=w(n),h(n,2,3,e,a),n[0]===null)return null;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);const t=n[0]instanceof R?F.fromExtent(n[0]):n[0],r=P(n[1]);if(isNaN(r))throw new o(e,s.InvalidParameter,a);const u=D(n[2],null);if(u===null){const c=t.type==="point"?t:t.extent?.center;return y(await d("rotate",[t.toJSON(),r,c?.x,c?.y]))}if(u instanceof I)return y(await d("rotate",[t.toJSON(),r,u.x,u.y]));throw new o(e,s.InvalidParameter,a)})},i.functions.centroid=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if(n=w(n),h(n,1,2,e,a),n[0]===null)return null;const t=an(n[1]);let r=n[0];if((g(n[0])||v(n[0]))&&(r=t==="geometric"?C(n[0],e.spatialReference):_(n[0],e.spatialReference),r===null))return null;if(!(r instanceof m))throw new o(e,s.InvalidParameter,a);return y(t==="geometric"?await d("centroid",[r.toJSON()]):await d("labelPoint",[r.toJSON()]))})},i.functions.measuretocoordinate=function(e,a){return i.standardFunctionAsync(e,a,tn)},i.functions.pointtocoordinate=function(e,a){return i.standardFunctionAsync(e,a,rn)},i.functions.distancetocoordinate=function(e,a){return i.standardFunctionAsync(e,a,on)},i.functions.multiparttosinglepart=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if(n=w(n),h(n,1,1,e,a),n[0]===null)return null;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);if(n[0]instanceof I)return[E(J(n[0]),e.spatialReference)];if(n[0]instanceof R)return[E(J(n[0]),e.spatialReference)];const t=y(await d("simplify",[n[0].toJSON()]));if(t instanceof F){const r=[],u=[];for(let c=0;c<t.rings.length;c++)if(t.isClockwise(t.rings[c])){const N=y({rings:[t.rings[c]],hasZ:t.hasZ===!0,hasM:t.hasM===!0,spatialReference:t.spatialReference.toJSON()});r.push(N)}else u.push({ring:t.rings[c],pt:t.getPoint(c,0)});for(let c=0;c<u.length;c++)for(let N=0;N<r.length;N++)if(r[N].contains(u[c].pt)){r[N].addRing(u[c].ring);break}return r}if(t instanceof b){const r=[];for(let u=0;u<t.paths.length;u++){const c=y({paths:[t.paths[u]],hasZ:t.hasZ===!0,hasM:t.hasM===!0,spatialReference:t.spatialReference.toJSON()});r.push(c)}return r}if(n[0]instanceof M){const r=[],u=E(J(n[0]),e.spatialReference);for(let c=0;c<u.points.length;c++)r.push(u.getPoint(c));return r}return null})},i.functions.isselfintersecting=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{h(n,1,1,l,f);let t=(n=w(n))[0];if((g(n[0])||v(n[0]))&&(t=q(n[0],l.spatialReference)),t instanceof M){const r=t.points;for(let u=0;u<r.length;u++)for(let c=u+1;c<r.length;c++)if(X(r[u],r[c]))return!0;return!1}return(t instanceof b||t instanceof F)&&await d("isSelfIntersecting",[t.toJSON()])})},i.functions.issimple=function(e,a){return i.standardFunctionAsync(e,a,(l,f,n)=>{if(n=w(n),h(n,1,1,e,a),n[0]===null)return!0;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);return d("isSimple",[n[0].toJSON()])})},i.functions.simplify=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if(n=w(n),h(n,1,1,e,a),n[0]===null)return null;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);return y(await d("simplify",[n[0].toJSON()]))})},i.functions.convexhull=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if(n=w(n),h(n,1,1,e,a),n[0]===null)return null;if(!(n[0]instanceof m))throw new o(e,s.InvalidParameter,a);return y(await d("convexHull",[n[0].toJSON()]))})},i.functions.getuser=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{h(n,0,2,e,a);let t=D(n[1],""),r=t===!0;if(t=t===!0||t===!1?"":W(t),n.length===0||n[0]instanceof B){let c;c=e.services?.portal?e.services.portal:V.getDefault(),n.length>0&&(c=G(n[0],c));const N=await K(c,t,r);if(N){const A=JSON.parse(JSON.stringify(N));for(const S of["lastLogin","created","modified"])A[S]!==void 0&&A[S]!==null&&(A[S]=new Date(A[S]));return j.convertObjectToArcadeDictionary(A,U(e))}return null}let u=null;if(L(n[0])&&(u=n[0]),u){if(r=!1,t)return null;await u.load();const c=await u.getOwningSystemUrl();if(!c){if(!t){const S=await u.getIdentityUser();return S?j.convertObjectToArcadeDictionary({username:S},U(e)):null}return null}let N;N=e.services?.portal?e.services.portal:V.getDefault(),N=G(new B(c),N);const A=await K(N,t,r);if(A){const S=JSON.parse(JSON.stringify(A));for(const T of["lastLogin","created","modified"])S[T]!==void 0&&S[T]!==null&&(S[T]=new Date(S[T]));return j.convertObjectToArcadeDictionary(S,U(e))}return null}throw new o(e,s.InvalidParameter,a)})},i.functions.nearestcoordinate=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if(n=w(n),h(n,2,2,e,a),!(n[0]instanceof m||n[0]===null))throw new o(e,s.InvalidParameter,a);if(!(n[1]instanceof I||n[1]===null))throw new o(e,s.InvalidParameter,a);if(n[0]===null||n[1]===null)return null;const t=n[0]instanceof R?F.fromExtent(n[0]):n[0],r=await d("getNearestCoordinate",[t.toJSON(),n[1].toJSON(),{calculateLeftRightSide:!0}]);return r===null?null:j.convertObjectToArcadeDictionary({coordinate:y(r.coordinate),distance:r.distance,sideOfLine:r.distance===0?"straddle":r.isRightSide?"right":"left"},U(e),!1,!0)})},i.functions.nearestvertex=function(e,a){return i.standardFunctionAsync(e,a,async(l,f,n)=>{if(n=w(n),h(n,2,2,e,a),!(n[0]instanceof m||n[0]===null))throw new o(e,s.InvalidParameter,a);if(!(n[1]instanceof I||n[1]===null))throw new o(e,s.InvalidParameter,a);if(n[0]===null||n[1]===null)return null;const t=n[0]instanceof R?F.fromExtent(n[0]):n[0],r=await d("getNearestVertex",[t.toJSON(),n[1].toJSON()]);return r===null?null:j.convertObjectToArcadeDictionary({coordinate:y(r.coordinate),distance:r.distance,sideOfLine:r.distance===0?"straddle":r.isRightSide?"right":"left"},U(e),!1,!0)})})}export{En as registerFunctions};
