import{fU as ie,fv as P,fC as Q,fZ as J,g9 as W,fA as w,fB as j,fE as X,g0 as U,fG as ee,f_ as Le,fQ as Y,fM as t,fV as de,f$ as b,fR as I,fL as a,fS as R,g4 as C,fY as _,h4 as ae,hQ as ue,fD as re,fJ as S,fK as D,fO as Z,fP as te,hB as ve,fN as se,fw as K,h3 as pe,fT as Te,hT as me,ge as Me,hR as je}from"./main-D8UjLOIQ.js";import{Y as ze}from"./toggle-switch-control-x7xAfM2r-DrNy1AH_.js";const Ee={key:0,class:"relative"},He={key:0,class:"relative"},$e=["innerHTML"],Ce=["src"],Ie={key:1,class:"w-32 h-32"},Oe={class:"symbologyIcon"},qe=["innerHTML"],Ne=["src"],De={class:"badge z-50 rounded-full text-white absolute h-10 w-10 p-8 inline-flex items-center justify-center"},Se={key:0,class:"px-5"},Ae={key:1,class:"inline-flex justify-center items-center relative"},Be=P({__name:"symbology-stack",props:{layer:{type:Object,required:!0},result:{type:Object,required:!0}},setup(c){const k=c,i=w([]);return re(()=>{i.value=k.layer.legend}),(d,v)=>c.result.loaded?(t(),a("div",Ee,[b("div",{class:R(c.result.items.length===0?"opacity-50":"")},[i.value.length>1?(t(),a("div",He,[(t(!0),a(Z,null,te(i.value.slice(0,3).reverse(),(L,y)=>(t(),a("div",{class:R(["absolute",[y==0?"symbol-0":y==1?"left-3":"left-6"]]),style:pe({"z-index":3-y}),key:y},[i.value[y].svgcode?(t(),a("span",{key:0,class:"symbologyIcon w-28 h-28",innerHTML:i.value[y].svgcode},null,8,$e)):i.value[y].imgUrl?(t(),a("img",{key:1,class:"symbologyIcon w-28 h-28",src:i.value[y].imgUrl},null,8,Ce)):I("",!0)],6))),128))])):i.value.length>0?(t(),a("div",Ie,[b("div",Oe,[i.value[0].svgcode?(t(),a("span",{key:0,innerHTML:i.value[0].svgcode},null,8,qe)):i.value[0].imgUrl?(t(),a("img",{key:1,class:"symbologyIcon w-full h-full",src:i.value[0].imgUrl},null,8,Ne)):I("",!0)])])):I("",!0)],2),b("div",De,[c.result.loaded?(t(),a("div",Se,C(c.result.items.length),1)):I("",!0)])])):(t(),a("div",Ae,v[0]||(v[0]=[b("div",{class:"symbologyIcon h-32 w-32"},[b("div",{class:"relative animate-spin spinner h-24 w-24"})],-1)])))}}),Fe=ie(Be,[["__scopeId","data-v-496d788d"]]),Pe=["content"],Ge={class:"symbologyLayerName truncate"},Ue=P({__name:"symbology-item",props:{layer:{type:Object,required:!0},result:{type:Object,required:!0},selected:{type:Boolean,required:!0}},setup(c){const k=W(),i=j(()=>k.properties),d=c,v=()=>{const L=d.layer;return L&&i.value[L.id]&&i.value[L.id].name?i.value[L.id].name:L?.name??""};return(L,y)=>{const x=S("tippy");return D((t(),a("button",{class:R(["flex flex-grow justify-start items-center px-7 py-10 default-focus-style symbologyStackButton truncate",c.selected?"detailsButtonSelected":"px-11"]),onClick:y[0]||(y[0]=ve(()=>{},["stop"])),content:v()},[se(Fe,{class:"symbStack w-32 h-32 mr-10",layer:c.layer,result:c.result},null,8,["layer","result"]),b("div",Ge,C(v()),1)],10,Pe)),[[x,{placement:"right",sticky:!0}]])}}}),Re=["content"],Ye=P({__name:"symbology-list",props:{results:{type:Object,required:!0},selected:{type:String,required:!0}},emits:["selection-changed"],setup(c,{emit:k}){const{t:i}=Q(),d=ue(),v=w(),L=()=>{v.value._tippy.hide()},y=g=>{g.key==="Tab"&&v.value?.matches(":focus")&&v.value._tippy.show()},x=k,m=c,l=w(""),f=w([]),r=w(!1),e=w(!1),n=g=>d.getLayerByUid(g),z=g=>{l.value=g,x("selection-changed",g),r.value=!1},q=()=>{e.value||setTimeout(()=>{r.value=e.value},500),e.value=!0},H=()=>{r.value=e.value=!1},p=()=>{e.value||(r.value=!0),e.value=!0},E=()=>{r.value=e.value=!1};return X(()=>{f.value.push(U(m,()=>{l.value=m.selected}))}),re(()=>{v.value?.addEventListener("blur",L),v.value?.addEventListener("keyup",y)}),ee(()=>{f.value.forEach(g=>g()),v.value?.removeEventListener("blur",L),v.value?.removeEventListener("keyup",y)}),(g,B)=>{const N=S("focus-item"),F=S("focus-list"),T=S("tippy");return D((t(),a("div",{class:R(["symbology-list absolute overflow-hidden z-50 p-0 w-48 bg-white text-sm inline-flex flex-col",{"symbology-list-expanded":r.value}]),onMouseover:q,onMouseleave:H,onFocus:p,onBlur:ve(E,["self"]),content:_(i)("details.layers.results.list.tooltip"),ref_key:"el",ref:v},[(t(!0),a(Z,null,te(m.results,(O,u)=>(t(),a("div",{class:"flex justify-start relative",key:u},[D((t(),Y(Ue,{key:O.uid,layer:n(O.uid),result:O,selected:O.uid===l.value,onClick:o=>z(O.uid)},null,8,["layer","result","selected","onClick"])),[[N]])]))),128))],42,Re)),[[F],[T,{trigger:"manual",placement:"top-start",touch:!1}]])}}}),Qe={class:"inline font-bold"},Ze=["innerHTML"],Ve=P({__name:"esri-default",props:{fixtureFields:{type:Object,required:!1},fields:{type:Object,required:!0},identifyData:{type:Object,required:!0}},setup(c){const{t:k}=Q(),i=J("iApi"),d=c,v=(l,f,r,e)=>{const n=l.find(z=>z[f].toLowerCase()===r.toLowerCase());n&&delete e[n.name]},L=()=>{const l=Object.assign({},d.identifyData.data);v(d.fields,"type","geometry",l),i.ui.exposeOids||v(d.fields,"type","oid",l),i.ui.exposeMeasurements||(v(d.fields,"name","shape_length",l),v(d.fields,"name","shape_area",l));const f={};d.fields.forEach(e=>{const n=d.fixtureFields?.find(z=>e.name===z.field);f[e.name]={name:n?.alias||e.alias||e.name,type:e.type,visible:n?.visible??!0}});const r={};Object.keys(l).forEach(e=>{const n=f[e];if(n&&n.visible){const z=l[e];r[e]={value:typeof z=="number"?i.ui.formatNumber(z):z,alias:n.name,type:n.type}}});for(const[e]of Object.entries(r))i.ui.isPlainText(r[e].value)&&(r[e].value=i.ui.escapeHtml(r[e].value));return r},y=(l,f,r)=>{switch(r){case"date":return m(l);default:return x(l,f)}},x=(l,f)=>{if(!l)return l;if(l.trim().match(/\.(jpeg|jpg|gif|png)$/)||l.trim().match(/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i))return`<img src="${l}" alt="${k("details.item.alert.defaultAltText",{alias:f})}" />`;const r="underline text-blue-700 break-all",e=document.createElement("div");return e.innerHTML=l.trim(),e.firstElementChild?.tagName=="A"?(e.firstElementChild.className=r,e.innerHTML):me(l,{className:r,target:"_blank",validate:{url:n=>/^https?:\/\//.test(n)}})},m=l=>{const f=parseInt(l);return isNaN(f)?l:new Date(f).toISOString().split("T")[0]};return(l,f)=>(t(),a("div",null,[(t(!0),a(Z,null,te(L(),(r,e,n)=>(t(),a("div",{class:"p-5 pl-3 flex justify-end flex-wrap even:bg-gray-300",key:n},[b("span",Qe,C(r.alias),1),f[0]||(f[0]=b("span",{class:"flex-auto"},null,-1)),b("span",{class:"inline",innerHTML:y(r.value,r.alias,r.type)},null,8,Ze)]))),128))]))}}),Ke=["innerHTML"],Je={key:1},We=P({__name:"html-default",props:{identifyData:{type:Object,required:!0}},setup(c){const{t:k}=Q();return(i,d)=>c.identifyData?(t(),a("div",{key:0,class:"whitespace-pre-wrap break-words h-full overflow-auto",innerHTML:c.identifyData.data.data??c.identifyData.data},null,8,Ke)):(t(),a("div",Je,C(_(k)("details.layers.results.empty")),1))}}),Xe={class:"relative flex flex-grow truncate"},et={key:0,class:"flex flex-grow items-center truncate"},tt={class:"flex p-8 items-center"},lt=["innerHTML"],at={key:1,class:"symbologyIcon p-6"},st=["content","innerHTML","tabindex"],it={key:1,class:"flex p-6 flex-grow"},ut={key:2,class:"zoomButton text-center p-3"},rt=["content","aria-label"],nt={key:0,class:"m-auto animate-spin spinner h-20 w-20"},ot={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"green",class:"m-auto w-20 h-20"},dt={key:2,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"red",class:"m-auto w-20 h-20"},ct=["innerHTML"],ce=P({__name:"result-item",props:{uid:{type:String,required:!0},data:{type:Object,required:!0},open:{type:Boolean,required:!1},inList:{type:Boolean,required:!1}},setup(c){const k=ue(),i=c,d=J("iApi"),v=w([]),L=W(),{t:y}=Q(),x=w(!1),m=w(""),l=w("none"),f=w(),r=()=>k.getLayerByUid(i.uid),e=j(()=>L.properties),n=j(()=>L.defaultTemplates),z=j(()=>r()?.supportsFeatures??!1),q=j(()=>r()?.mapLayer??!1),H=j(()=>{const u=r();let o=u&&i.data.loaded?u.nameValue(i.data.data):d.$i18n.t("details.items.title");return d.ui.isPlainText(o)&&(o=d.ui.escapeHtml(o)),o}),p=u=>{if(typeof u=="string"){const o="underline text-blue-700 break-all",h=document.createElement("div");return h.innerHTML=u.trim(),h.firstElementChild?.tagName=="A"?(h.firstElementChild.className=o,h.innerHTML):me(u,{className:o,target:"_blank",validate:{url:$=>/^https?:\/\//.test($)}})}return u},E=()=>{T("none"),i.data.loaded?g():i.data.load().then(()=>{g()})},g=()=>{if(m.value="",!(i.data&&i.data.loaded))return;const u=r();if(u===void 0){console.warn(`could not find layer for uid ${i.uid} during icon lookup`);return}if(u.supportsFeatures){const o=u.oidField;u.getIcon(i.data.data[o]).then(h=>{m.value=h})}},B=j(()=>{const u=r();return u&&e.value[u.id]&&e.value[u.id].template?e.value[u.id].template:n.value&&n.value[i.data.format]?n.value[i.data.format]:z.value?Ve:We}),N=j(()=>z.value?r()?.fields||[]:[]),F=j(()=>{const u=r();if(u&&e.value[u.id]&&e.value[u.id].fields)return e.value[u.id].fields}),T=u=>{u==="zoomed"||u==="error"?setTimeout(()=>{l.value=u,f.value?._tippy.show(),setTimeout(()=>{f.value?._tippy.hide(),l.value="none"},3e3)},300):l.value=u},O=()=>{if(l.value!=="none")return;T("zooming");const u=r();if(u===void 0||!u.isLoaded){console.warn(`Could not find layer for uid ${i.uid} during zoom geometry lookup`),T("error");return}if(!i.data.loaded){console.warn("Details zoomToFeature call on item that is still loading. Should be impossible, alert the devs."),T("error");return}const o=i.data.data[u.oidField],h=()=>{const $={getGeom:!0};u.getGraphic(o,$).then(A=>{A.geometry.invalid()?(console.error(`Could not find graphic for objectid ${o}`),T("error")):(d.geo.map.zoomMapTo(A.geometry),T("zoomed"),d.updateAlert(d.$i18n.t("details.item.alert.zoom")))}).catch(()=>{T("error")})};u.layerType===Me.FEATURE&&u.geomType!==je.POINT?u.getGraphicExtent(o).then($=>{d.geo.map.zoomMapTo($),T("zoomed"),d.updateAlert(d.$i18n.t("details.item.alert.zoom"))}).catch(()=>{h()}):h()};return X(()=>{v.value.push(U(i,()=>{E()},{deep:!1,immediate:!0}))}),ee(()=>{v.value.forEach(u=>u())}),(u,o)=>{const h=S("truncate"),$=S("tippy");return t(),a(Z,null,[b("div",Xe,[z.value?(t(),a("div",et,[b("div",tt,[c.data.loaded&&m.value?(t(),a("span",{key:0,class:"flex-none symbologyIcon",innerHTML:m.value},null,8,lt)):(t(),a("div",at,o[3]||(o[3]=[b("div",{class:"animate-spin spinner h-20 w-20"},null,-1)])))]),c.data.loaded?D((t(),a("span",{key:0,class:"pl-3 text-left flex-grow itemName",content:H.value,innerHTML:p(H.value),onTouchstart:o[0]||(o[0]=A=>x.value=!0),onTouchend:o[1]||(o[1]=A=>x.value=!1),tabindex:c.inList?-1:0},null,40,st)),[[h,{options:{placement:"top-start",offset:()=>x.value?[0,25]:[0,0]}}]]):(t(),a("div",it,C(_(y)("details.loading")),1)),c.data.loaded?(t(),a("span",ut,[q.value?D((t(),a("button",{key:0,type:"button",content:_(y)(`details.item.zoom${l.value==="none"?"":`.${l.value}`}`),"aria-label":_(y)(`grid.cells.zoom${l.value==="none"?"":`.${l.value}`}`),ref_key:"zoomButton",ref:f,onClick:o[2]||(o[2]=A=>{A.stopPropagation(),O()}),class:"text-gray-600 w-24 h-24 p-2 flex justify-center items-center"},[l.value==="zooming"?(t(),a("div",nt)):l.value==="zoomed"?(t(),a("svg",ot,o[4]||(o[4]=[b("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 12.75l6 6 9-13.5"},null,-1)]))):l.value==="error"?(t(),a("svg",dt,o[5]||(o[5]=[b("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"},null,-1)]))):(t(),a("span",{key:3,innerHTML:_(d).ui.getZoomIcon()},null,8,ct))],8,rt)),[[$,{placement:"bottom"}]]):I("",!0)])):I("",!0)])):I("",!0)]),c.open?(t(),Y(Te(B.value),{key:0,identifyData:c.data,fields:N.value,fixtureFields:F.value,class:"p-8"},null,8,["identifyData","fields","fixtureFields"])):I("",!0)],64)}}}),vt={key:0,class:"layerName w-full flex-grow p-5 pb-8 font-bold truncate",tabIndex:"0"},pt={key:1,class:"p-8 mb-8 bg-gray-100 flex justify-between"},mt={for:"toggle"},ft={key:2,class:"flex flex-col justify-between p-8 mb-8 bg-gray-100"},yt={class:"flex"},gt=["aria-label"],ht=["content","aria-label","disabled"],bt={class:"px-3 text-center flex-grow"},kt=["content","aria-label","disabled"],xt={key:3},wt={key:0},_t=["content"],Lt=["onClick"],Tt={key:1,class:"text-center"},Mt={key:4,class:"p-5"},jt=P({__name:"result-list",props:{uid:{type:String,required:!0},results:{type:Object,required:!0}},setup(c){const k=w(),i=()=>{k.value._tippy.hide()},d=s=>{s.key==="Tab"&&k.value?.matches(":focus")&&k.value._tippy.show()},v=J("iApi"),L=W(),y=ue(),x=c,{t:m}=Q(),l=w(!1),f=w(v.fixture.get("details")),r=w(!0),e=w(!1),n=w(0),z=w(20),q=w([]),H=w([]),p=j(()=>L.activeGreedy),E=j(()=>L.properties),g=j(()=>n.value+z.value),B=()=>y.getLayerByUid(x.uid),N=()=>x.results.find(s=>s.uid===x.uid),F=j(()=>N()?.loaded??!1),T=j(()=>N()?.requestTime),O=j(()=>l.value&&(!e.value&&h().length>1||e.value&&h().length>z.value)),u=j(()=>{const s=B();return s&&E.value[s.id]&&E.value[s.id].name?E.value[s.id].name:s?.name??""}),o=j(()=>x.uid),h=()=>{const s=N();return s?s.items:[]},$=j(()=>h()[n.value]),A=j(()=>{if(f.value.hasHilighter()){const s=B();if(s)return s.mapLayer&&s.supportsFeatures}return!1}),fe=s=>{r.value=s,L.hilightToggle=s,G()},ye=()=>{const s=B();n.value=n.value??0,r.value=L.hilightToggle??r.value,e.value=!1,l.value=!!s,G()},ne=s=>{e.value?(n.value+=s*z.value,G()):n.value+=s},G=()=>{const s=h();if(r.value&&F.value&&s.length>0&&A.value)if(e.value)f.value.hilightDetailsItems(s.slice(n.value,g.value),x.uid);else{const M=s[n.value];M&&f.value.hilightDetailsItems([M],x.uid)}else f.value.removeDetailsHilight()},ge=()=>{e.value=!0,n.value=Math.floor(n.value/z.value)*z.value,G()},he=()=>{f.value.removeDetailsHilight(),H.value.forEach(s=>s()),q.value.forEach(s=>v.event.off(s))},be=()=>{f.value.removeDetailsHilight()},ke=s=>{const M=n.value;n.value=s,e.value=!1,M===s&&G()};return re(()=>{q.value.push(v.event.on(K.LAYER_REMOVE,s=>{const M=v.panel.get("details");x.uid===s.uid&&M&&M.close()})),q.value.push(v.event.on(K.PANEL_CLOSED,s=>{s.id==="details"&&he()})),q.value.push(v.event.on(K.PANEL_MINIMIZED,s=>{s.id==="details"&&be()})),q.value.push(v.event.on(K.MAP_BASEMAPCHANGE,s=>{r.value&&s.schemaChanged&&G()})),k.value?.addEventListener("blur",i),k.value?.addEventListener("keyup",d)}),X(()=>{H.value.push(U($,()=>{e.value||(ye(),$.value===void 0&&f.value.removeDetailsHilight())},{deep:!1,immediate:!0})),H.value.push(U(o,()=>{const s=x.uid;if(e.value&&s){const M=N();M&&M.loading.then(()=>{x.uid===s&&e.value&&G()})}},{deep:!1,immediate:!0})),H.value.push(U(T,()=>{n.value=0})),H.value.push(U(()=>x.uid,()=>{n.value=0}))}),ee(()=>{k.value?.removeEventListener("blur",i),k.value?.removeEventListener("keyup",d)}),(s,M)=>{const xe=S("truncate"),le=S("tippy"),we=S("focus-item"),_e=S("focus-list");return F.value&&p.value===0?(t(),a("div",{key:0,class:"detailsContent relative flex flex-col flex-grow pl-5",style:pe(c.results.length>1?{"margin-left":"42px"}:"")},[l.value?D((t(),a("h1",vt,[ae(C(u.value),1)])),[[xe,{options:{placement:"top-start"}}]]):I("",!0),A.value?(t(),a("div",pt,[b("label",mt,C(_(m)("details.togglehilight.title")),1),se(ze,{config:{value:r.value,disabled:!1},onToggled:fe},null,8,["config"])])):I("",!0),O.value?(t(),a("div",ft,[b("div",yt,[e.value?I("",!0):(t(),a("button",{key:0,type:"button",class:"px-8 font-bold hover:bg-gray-200 focus:bg-gray-200","aria-label":_(m)("details.item.see.list"),onClick:M[0]||(M[0]=V=>ge())},C(_(m)("details.item.see.list")),9,gt)),b("div",{class:R(["flex ml-auto bg-gray-200 py-8 items-center",{"w-full":e.value}])},[D((t(),a("button",{type:"button",content:_(m)(e.value?"details.items.previous":"details.item.previous.item"),onClick:M[1]||(M[1]=V=>ne(-1)),class:"mx-2 opacity-60 hover:opacity-90 disabled:opacity-30 disabled:cursor-default","aria-label":_(m)(e.value?"details.items.previous":"details.item.previous.item"),disabled:n.value===0},M[3]||(M[3]=[b("svg",{height:"24",width:"24",viewBox:"0 0 23 23"},[b("g",null,[b("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"})])],-1)]),8,ht)),[[le,{placement:"top"}]]),b("span",bt,C(e.value?_(m)("details.items.range",[n.value+1,Math.min(g.value,h().length),h().length]):_(m)("details.item.count",[n.value+1,h().length])),1),D((t(),a("button",{type:"button",content:_(m)(e.value?"details.items.next":"details.item.next.item"),onClick:M[2]||(M[2]=V=>ne(1)),class:"mx-2 rotate-180 opacity-60 hover:opacity-90 disabled:opacity-30 disabled:cursor-default","aria-label":_(m)(e.value?"details.items.next":"details.item.next.item"),disabled:!e.value&&n.value===h().length-1||e.value&&g.value>=h().length},M[4]||(M[4]=[b("svg",{height:"24",width:"24",viewBox:"0 0 23 23"},[b("g",null,[b("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"})])],-1)]),8,kt)),[[le,{placement:"top"}]])],2)])])):I("",!0),l.value?(t(),a("div",xt,[h().length>0?(t(),a("div",wt,[e.value?D((t(),a("div",{key:0,class:"flex flex-col",content:_(m)("details.layers.results.list.tooltip"),ref_key:"el",ref:k},[(t(!0),a(Z,null,te(h().slice(n.value,g.value),(V,oe)=>D((t(),a("button",{class:"flex flex-grow truncate default-focus-style hover:bg-gray-200",key:oe,onClick:Ct=>ke(n.value+oe)},[se(ce,{data:V,uid:c.uid,open:!1,"in-list":!0},null,8,["data","uid"])],8,Lt)),[[we,"show-truncate"]])),128))],8,_t)),[[_e],[le,{trigger:"manual",placement:"top-start",touch:!1}]]):(t(),Y(ce,{key:1,data:$.value,uid:c.uid,open:!0,"in-list":!1},null,8,["data","uid"]))])):(t(),a("div",Tt,C(_(m)("details.layers.results.empty.currentLayer")),1))])):(t(),a("div",Mt,C(_(m)("details.item.no.data")),1))],4)):(t(),a("div",{key:1,class:R(["flex justify-center py-10 items-center",c.results.length>1?"ml-42":""])},[M[5]||(M[5]=b("span",{class:"animate-spin spinner h-20 w-20 px-5 mr-8"},null,-1)),ae(" "+C(_(m)("details.item.loading")),1)],2))}}}),zt=ie(jt,[["__scopeId","data-v-b02a05d4"]]),Et={class:"relative h-full"},Ht={class:"detailsContentSection overflow-y-auto h-full"},$t=P({__name:"details-screen",props:{panel:{type:Object}},setup(c){const{t:k}=Q(),i=J("iApi"),d=W(),v=w([]),L=w([]),y=w([]),x=w(!1),m=w(""),l=j(()=>d.activeGreedy),f=j(()=>d.payload),r=j(()=>d.properties),e=p=>{m.value=p},n=p=>y.value.find(E=>E.uid===p),z=p=>{p!==void 0&&(d.activeGreedy=p.length===0?0:p[0].requestTime,y.value=p,q(p))},q=p=>{if(m.value){const E=n(m.value);E?E.loading.then(()=>{E.requestTime===l.value&&(E.items.length>0?(d.activeGreedy=0,x.value=!1):H(p))}):H(p)}else H(p)},H=(p,E)=>{let g;if(E)g=E;else{const T=d.properties,O=p.map(o=>[T[o.layerId]?.priority??50,o.layerId]),u=new Set(O.map(o=>o[0]));g=[],u.forEach(o=>{const h=O.filter($=>$[0]===o).map($=>$[1]);g.push([o,h])}),g.sort((o,h)=>h[0]-o[0])}if(g.length===0){d.activeGreedy=0,x.value=!0;return}const B=g[g.length-1][1],N=p.filter(T=>B.includes(T.layerId)).map(T=>T.loading.then(()=>T.items.length>0?Promise.resolve(T):Promise.reject())),F=p.length===0?0:p[0].requestTime;Promise.any(N).then(T=>{T.requestTime===l.value&&(d.activeGreedy=0,m.value=T.uid,x.value=!1)}).catch(()=>{F===l.value&&(g.pop(),H(p,g))})};return X(()=>{L.value.push(U(f,p=>{z(p)},{deep:!1,immediate:!0}))}),ee(()=>{v.value.forEach(p=>i.event.off(p)),L.value.forEach(p=>p())}),(p,E)=>{const g=Le("panel-screen");return t(),Y(g,{panel:c.panel},{header:de(()=>[ae(C(_(d).origin==="toggleEvent"?_(k)("details.layers.title.gridOrigin"):_(k)("details.layers.title.identifyOrigin")),1)]),content:de(()=>[b("div",Et,[y.value.length>1?(t(),Y(Ye,{key:0,results:y.value,detailsProperties:r.value,selected:m.value,onSelectionChanged:e},null,8,["results","detailsProperties","selected"])):I("",!0),b("div",Ht,[x.value?(t(),a("div",{key:1,class:R(["text-center",{"ml-42":y.value.length>1}])},C(y.value.length>=1?_(k)("details.layers.results.empty"):_(k)("details.layers.results.empty.noLayers")),3)):(t(),Y(zt,{key:0,uid:m.value,results:y.value},null,8,["uid","results"]))])])]),_:1},8,["panel"])}}}),qt=ie($t,[["__scopeId","data-v-60c889f3"]]);export{qt as default};
