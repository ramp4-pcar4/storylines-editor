const O=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["«","»"],["»","«"],["‹","›"],["›","‹"],["⁽","⁾"],["⁾","⁽"],["₍","₎"],["₎","₍"],["≤","≥"],["≥","≤"],["〈","〉"],["〉","〈"],["﹙","﹚"],["﹚","﹙"],["﹛","﹜"],["﹜","﹛"],["﹝","﹞"],["﹞","﹝"],["﹤","﹥"],["﹥","﹤"]],N=["آ","أ","إ","ا"],X=["ﻵ","ﻷ","ﻹ","ﻻ"],uu=["ﻶ","ﻸ","ﻺ","ﻼ"],j=["ا","ب","ت","ث","ج","ح","خ","د","ذ","ر","ز","س","ش","ص","ض","ط","ظ","ع","غ","ف","ق","ك","ل","م","ن","ه","و","ي","إ","أ","آ","ة","ى","ل","م","ن","ه","و","ي","إ","أ","آ","ة","ى","ی","ئ","ؤ"],tu=["ﺍ","ﺏ","ﺕ","ﺙ","ﺝ","ﺡ","ﺥ","ﺩ","ﺫ","ﺭ","ﺯ","ﺱ","ﺵ","ﺹ","ﺽ","ﻁ","ﻅ","ﻉ","ﻍ","ﻑ","ﻕ","ﻙ","ﻝ","ﻡ","ﻥ","ﻩ","ﻭ","ﻱ","ﺇ","ﺃ","ﺁ","ﺓ","ﻯ","ﯼ","ﺉ","ﺅ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺉ","ﺅ"],ru=["ﺎ","ﺐ","ﺖ","ﺚ","ﺞ","ﺢ","ﺦ","ﺪ","ﺬ","ﺮ","ﺰ","ﺲ","ﺶ","ﺺ","ﺾ","ﻂ","ﻆ","ﻊ","ﻎ","ﻒ","ﻖ","ﻚ","ﻞ","ﻢ","ﻦ","ﻪ","ﻮ","ﻲ","ﺈ","ﺄ","ﺂ","ﺔ","ﻰ","ﯽ","ﺊ","ﺆ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺊ","ﺆ"],Fu=["ﺎ","ﺒ","ﺘ","ﺜ","ﺠ","ﺤ","ﺨ","ﺪ","ﺬ","ﺮ","ﺰ","ﺴ","ﺸ","ﺼ","ﻀ","ﻄ","ﻈ","ﻌ","ﻐ","ﻔ","ﻘ","ﻜ","ﻠ","ﻤ","ﻨ","ﻬ","ﻮ","ﻴ","ﺈ","ﺄ","ﺂ","ﺔ","ﻰ","ﯿ","ﺌ","ﺆ","ﹱ","ﹲ","ﹴ","ﹷ","ﹹ","ﹻ","ﹽ","ﹿ","ﺀ","ﺌ","ﺆ"],Eu=["ﺍ","ﺑ","ﺗ","ﺛ","ﺟ","ﺣ","ﺧ","ﺩ","ﺫ","ﺭ","ﺯ","ﺳ","ﺷ","ﺻ","ﺿ","ﻃ","ﻇ","ﻋ","ﻏ","ﻓ","ﻗ","ﻛ","ﻟ","ﻣ","ﻧ","ﻫ","ﻭ","ﻳ","ﺇ","ﺃ","ﺁ","ﺓ","ﻯ","ﯾ","ﺋ","ﺅ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺋ","ﺅ"],W=["ء","آ","أ","ؤ","إ","ا","ة","د","ذ","ر","ز","و","ى"],eu=["ً","ً","ٌ","؟","ٍ","؟","َ","َ","ُ","ُ","ِ","ِ","ّ","ّ","ْ","ْ","ء","آ","آ","أ","أ","ؤ","ؤ","إ","إ","ئ","ئ","ئ","ئ","ا","ا","ب","ب","ب","ب","ة","ة","ت","ت","ت","ت","ث","ث","ث","ث","ج","ج","ج","ج","ح","ح","ح","ح","خ","خ","خ","خ","د","د","ذ","ذ","ر","ر","ز","ز","س","س","س","س","ش","ش","ش","ش","ص","ص","ص","ص","ض","ض","ض","ض","ط","ط","ط","ط","ظ","ظ","ظ","ظ","ع","ع","ع","ع","غ","غ","غ","غ","ف","ف","ف","ف","ق","ق","ق","ق","ك","ك","ك","ك","ل","ل","ل","ل","م","م","م","م","ن","ن","ن","ن","ه","ه","ه","ه","و","و","ى","ى","ي","ي","ي","ي","ﻵ","ﻶ","ﻷ","ﻸ","ﻹ","ﻺ","ﻻ","ﻼ","؟","؟","؟"],Z=["ء","ف"],nu=["غ","ي"],iu=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],Au=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],r=0,n=1,s=2,L=3,u=4,D=5,I=6,t=7,d=8,g=9,m=10,B=11,F=12,cu=13,ou=14,fu=15,su=16,Bu=17,f=18,hu=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],R=100,Tu=[R+0,r,r,r,r,R+1,R+2,R+3,n,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,R+4,u,u,u,r,u,r,u,r,u,u,u,r,r,u,u,r,r,r,r,r,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,r,r,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,r,r,r,r,r,r,r,r,r,r,r,r,r,r,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,r,r,u,u,r,r,u,u,r,r,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,r,r,r,R+5,t,t,R+6,R+7],au=[[f,f,f,f,f,f,f,f,f,I,D,I,d,D,f,f,f,f,f,f,f,f,f,f,f,f,f,f,D,D,D,I,d,u,u,B,B,B,u,u,u,u,u,m,g,m,g,g,s,s,s,s,s,s,s,s,s,s,g,u,u,u,u,u,u,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,u,u,u,u,u,u,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,u,u,u,u,f,f,f,f,f,f,D,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,g,u,B,B,B,B,u,u,u,u,r,u,u,f,u,u,B,B,s,s,u,r,u,u,u,s,r,u,u,u,u,u,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,u,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,u,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,u,u,u,u,u,u,u,u,u,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,u,u,r,r,r,r,r,r,r,u,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,u,r,u,u,u,u,u,u,u,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,n,F,n,F,F,n,F,F,n,F,u,u,u,u,u,u,u,u,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,u,u,u,u,u,n,n,n,n,n,u,u,u,u,u,u,u,u,u,u,u],[L,L,L,L,u,u,u,u,t,B,B,t,g,t,u,u,F,F,F,F,F,F,F,F,F,F,F,t,u,u,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,L,L,L,L,L,L,L,L,L,L,B,L,L,t,t,t,F,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,F,F,F,F,F,F,F,L,u,F,F,F,F,F,F,t,t,F,F,u,F,F,F,F,t,t,s,s,s,s,s,s,s,s,s,s,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t,u,t,t,F,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,u,u,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,F,F,F,F,F,F,F,F,F,F,F,t,u,u,u,u,u,u,u,u,u,u,u,u,u,u,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,F,F,F,F,F,F,F,F,F,n,n,u,u,u,u,n,u,u,u,u,u],[d,d,d,d,d,d,d,d,d,d,d,f,f,f,r,n,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,d,D,cu,ou,fu,su,Bu,g,B,B,B,B,B,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,g,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,d,f,f,f,f,f,u,u,u,u,u,f,f,f,f,f,f,s,r,u,u,s,s,s,s,s,s,m,m,u,u,u,r,s,s,s,s,s,s,s,s,s,s,m,m,u,u,u,u,r,r,r,r,r,r,r,r,r,r,r,r,r,u,u,u,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,B,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u],[r,r,r,r,r,r,r,u,u,u,u,u,u,u,u,u,u,u,u,r,r,r,r,r,u,u,u,u,u,n,F,n,n,n,n,n,n,n,n,n,n,m,n,n,n,n,n,n,n,n,n,n,n,n,n,u,n,n,n,n,n,u,n,u,n,n,u,n,n,u,n,n,n,n,n,n,n,n,n,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,F,F,F,F,F,F,F,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,g,u,g,u,u,g,u,u,u,u,u,u,u,u,u,B,u,u,m,m,u,u,u,u,u,B,B,u,u,u,u,u,t,t,t,t,t,u,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,u,u,f],[u,u,u,B,B,B,u,u,u,u,u,m,g,m,g,g,s,s,s,s,s,s,s,s,s,s,g,u,u,u,u,u,u,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,u,u,u,u,u,u,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,u,u,u,u,u,u,u,u,u,u,u,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,u,u,u,r,r,r,r,r,r,u,u,r,r,r,r,r,r,u,u,r,r,r,r,r,r,u,u,r,r,r,u,u,u,B,B,u,u,u,B,B,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u,u]];class Pu{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(E,i,A){if(this.sourceToTarget=[],this.targetToSource=[],!E)return"";if(Vu(this.sourceToTarget,this.targetToSource,E.length),!this.checkParameters(i,A))return E;i=this.inputFormat,A=this.outputFormat;let c=E;const o=Ou,T=G(i.charAt(1)),h=G(A.charAt(1)),a=(i.charAt(0)==="I"?"L":i.charAt(0))+T,l=(A.charAt(0)==="I"?"L":A.charAt(0))+h,C=i.charAt(2)+A.charAt(2);o.defInFormat=a,o.defOutFormat=l,o.defSwap=C;const _=v(E,a,l,C,o);let S=!1;return A.charAt(1)==="R"?S=!0:A.charAt(1)!=="C"&&A.charAt(1)!=="D"||(S=this.checkContextual(_)==="rtl"),this.sourceToTarget=U,this.targetToSource=xu(this.sourceToTarget),P=this.targetToSource,c=i.charAt(3)===A.charAt(3)?_:A.charAt(3)==="S"?Lu(S,_):gu(_,S,!0),this.sourceToTarget=U,this.targetToSource=P,this.levels=y,c}_inputFormatSetter(E){if(!H.test(E))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=E}_outputFormatSetter(E){if(!H.test(E))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=E}checkParameters(E,i){return E?this._inputFormatSetter(E):E=this.inputFormat,i?this._outputFormatSetter(i):i=this.outputFormat,E!==i}checkContextual(E){let i=k(E);if(i!=="ltr"&&i!=="rtl"){try{i=document.dir.toLowerCase()}catch{}i!=="ltr"&&i!=="rtl"&&(i="ltr")}return i}hasBidiChar(E){return ku.test(E)}}function v(e,E,i,A,c){const o=lu(e,{inFormat:E,outFormat:i,swap:A},c);if(o.inFormat===o.outFormat)return e;E=o.inFormat,i=o.outFormat,A=o.swap;const T=E.slice(0,1),h=E.slice(1,4),a=i.slice(0,1),l=i.slice(1,4);if(c.inFormat=E,c.outFormat=i,c.swap=A,T==="L"&&i==="VLTR"){if(h==="LTR")return c.dir=w,p(e,c);if(h==="RTL")return c.dir=V,p(e,c)}if(T==="V"&&a==="V")return c.dir=h==="RTL"?V:w,M(e,c);if(T==="L"&&i==="VRTL")return h==="LTR"?(c.dir=w,e=p(e,c)):(c.dir=V,e=p(e,c)),M(e);if(E==="VLTR"&&i==="LLTR")return c.dir=w,p(e,c);if(T==="V"&&a==="L"&&h!==l)return e=M(e),h==="RTL"?v(e,"LLTR","VLTR",A,c):v(e,"LRTL","VRTL",A,c);if(E==="VRTL"&&i==="LRTL")return v(e,"LRTL","VRTL",A,c);if(T==="L"&&a==="L"){const C=c.swap;return c.swap=C.slice(0,1)+"N",h==="RTL"?(c.dir=V,e=p(e,c),c.swap="N"+C.slice(1,3),c.dir=w,e=p(e,c)):(c.dir=w,e=p(e,c),c.swap="N"+C.slice(1,3),e=v(e,"VLTR","LRTL",c.swap,c)),e}return e}function lu(e,E,i){if(E.inFormat===void 0&&(E.inFormat=i.defInFormat),E.outFormat===void 0&&(E.outFormat=i.defOutFormat),E.swap===void 0&&(E.swap=i.defSwap),E.inFormat===E.outFormat)return E;const A=E.inFormat.slice(0,1),c=E.outFormat.slice(0,1);let o,T=E.inFormat.slice(1,4),h=E.outFormat.slice(1,4);return T.charAt(0)==="C"&&(o=k(e),T=o==="ltr"||o==="rtl"?o.toUpperCase():E.inFormat.charAt(2)==="L"?"LTR":"RTL",E.inFormat=A+T),h.charAt(0)==="C"&&(o=k(e),o==="rtl"?h="RTL":o==="ltr"?(o=du(e),h=o.toUpperCase()):h=E.outFormat.charAt(2)==="L"?"LTR":"RTL",E.outFormat=c+h),E}function Lu(e,E,i){if(E.length===0)return"";e===void 0&&(e=!0);const A=(E=String(E)).split("");let c=0,o=1,T=A.length;e||(c=A.length-1,o=-1,T=1);const h=Cu(A,c,o,T);let a="";for(let l=0;l<A.length;l++)Du(h,h.length,l)>-1?(Q(P,l,!e,-1),U.splice(l,1)):a+=A[l];return a}function Cu(e,E,i,A,c){let o=0;const T=[];let h=0;for(let a=E;a*i<A;a+=i)if(K(e[a])||x(e[a])){if(e[a]==="ل"&&pu(e,a+i,i,A)){e[a]=vu(e[a+i],o===0?X:uu),a+=i,Nu(e,a,i,A),T[h]=a,h++,o=0;continue}const l=e[a];o===1?e[a]=$(e,a+i,i,A)?wu(e[a]):z(e[a],ru):$(e,a+i,i,A)===!0?e[a]=z(e[a],Eu):e[a]=z(e[a],tu),x(l)||(o=1),bu(l)===!0&&(o=0)}else o=0;return T}function k(e){const E=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(e);return E?E[0]<="z"?"ltr":"rtl":""}function du(e){const E=e.split("");return E.reverse(),k(E.join(""))}function gu(e,E,i){if(e.length===0)return"";E===void 0&&(E=!0);let A="";const c=(e=String(e)).split("");for(let o=0;o<e.length;o++){let T=!1;if(c[o]>="ﹰ"&&c[o]<"\uFEFF"){const h=e.charCodeAt(o);c[o]>="ﻵ"&&c[o]<="ﻼ"?(E?(o>0&&i&&c[o-1]===" "?A=A.slice(0,-1)+"ل":(A+="ل",T=!0),A+=N[(h-65269)/2]):(A+=N[(h-65269)/2],A+="ل",o+1<e.length&&i&&c[o+1]===" "?o++:T=!0),T&&(Q(P,o,!0,1),U.splice(o,0,U[o]))):A+=eu[h-65136]}else A+=c[o]}return A}function p(e,E){const i=e.split(""),A=[];return J(i,A,E),mu(i,A,E),q(2,i,A,E),q(1,i,A,E),y=A,i.join("")}function J(e,E,i){const A=e.length,c=i.dir?Au:iu;let o=0,T=-1;const h=[],a=[];i.hiLevel=i.dir,i.lastArabic=!1,i.hasUbatAl=!1,i.hasUbatB=!1,i.hasUbatS=!1;for(let l=0;l<A;l++)h[l]=Ru(e[l]);for(let l=0;l<A;l++){const C=o,_=_u(e,h,a,l,i);a[l]=_,o=c[C][_];const S=240&o;o&=15;const Y=c[o][Iu];if(E[l]=Y,S>0)if(S===16){for(let b=T;b<l;b++)E[b]=1;T=-1}else T=-1;if(c[o][ju])T===-1&&(T=l);else if(T>-1){for(let b=T;b<l;b++)E[b]=Y;T=-1}h[l]===D&&(E[l]=0),i.hiLevel|=Y}i.hasUbatS&&Uu(h,E,A,i)}function Uu(e,E,i,A){for(let c=0;c<i;c++)if(e[c]===I){E[c]=A.dir;for(let o=c-1;o>=0&&e[o]===d;o--)E[o]=A.dir}}function mu(e,E,i){if(i.hiLevel!==0&&i.swap[0]!==i.swap[1])for(let A=0;A<e.length;A++)E[A]===1&&(e[A]=Su(e[A]))}function Ru(e){const E=e.charCodeAt(0),i=Tu[E>>8];return i<R?i:au[i-R][255&E]}function M(e,E){const i=e.split("");if(E){const A=[];J(i,A,E),y=A}return i.reverse(),U.reverse(),i.join("")}function Du(e,E,i){for(let A=0;A<E;A++)if(e[A]===i)return A;return-1}function K(e){for(let E=0;E<Z.length;E++)if(e>=Z[E]&&e<=nu[E])return!0;return!1}function $(e,E,i,A){for(;E*i<A&&x(e[E]);)E+=i;return!!(E*i<A&&K(e[E]))}function pu(e,E,i,A){for(;E*i<A&&x(e[E]);)E+=i;let c=" ";if(!(E*i<A))return!1;c=e[E];for(let o=0;o<N.length;o++)if(N[o]===c)return!0;return!1}function q(e,E,i,A){if(A.hiLevel<e)return;if(e===1&&A.dir===V&&!A.hasUbatB)return E.reverse(),void U.reverse();const c=E.length;let o,T,h,a,l,C=0;for(;C<c;){if(i[C]>=e){for(o=C+1;o<c&&i[o]>=e;)o++;for(T=C,h=o-1;T<h;T++,h--)a=E[T],E[T]=E[h],E[h]=a,l=U[T],U[T]=U[h],U[h]=l;C=o}C++}}function _u(e,E,i,A,c){const o=E[A];return{UBAT_L:()=>(c.lastArabic=!1,r),UBAT_R:()=>(c.lastArabic=!1,n),UBAT_ON:()=>u,UBAT_AN:()=>L,UBAT_EN:()=>c.lastArabic?L:s,UBAT_AL:()=>(c.lastArabic=!0,c.hasUbatAl=!0,n),UBAT_WS:()=>u,UBAT_CS:()=>{let T,h;return A<1||A+1>=E.length||(T=i[A-1])!==s&&T!==L||(h=E[A+1])!==s&&h!==L?u:(c.lastArabic&&(h=L),h===T?h:u)},UBAT_ES:()=>(A>0?i[A-1]:D)===s&&A+1<E.length&&E[A+1]===s?s:u,UBAT_ET:()=>{if(A>0&&i[A-1]===s)return s;if(c.lastArabic)return u;let T=A+1;const h=E.length;for(;T<h&&E[T]===B;)T++;return T<h&&E[T]===s?s:u},UBAT_NSM:()=>{if(c.inFormat==="VLTR"){const T=E.length;let h=A+1;for(;h<T&&E[h]===F;)h++;if(h<T){const a=e[A].charCodeAt(0),l=a>=1425&&a<=2303||a===64286,C=E[h];if(l&&(C===n||C===t))return n}}return A<1||E[A-1]===D?u:i[A-1]},UBAT_B:()=>(c.lastArabic=!0,c.hasUbatB=!0,c.dir),UBAT_S:()=>(c.hasUbatS=!0,u),UBAT_LRE:()=>(c.lastArabic=!1,u),UBAT_RLE:()=>(c.lastArabic=!1,u),UBAT_LRO:()=>(c.lastArabic=!1,u),UBAT_RLO:()=>(c.lastArabic=!1,u),UBAT_PDF:()=>(c.lastArabic=!1,u),UBAT_BN:()=>u}[hu[o]]()}function Su(e){let E,i=0,A=O.length-1;for(;i<=A;)if(E=Math.floor((i+A)/2),e<O[E][0])A=E-1;else{if(!(e>O[E][0]))return O[E][1];i=E+1}return e}function bu(e){for(let E=0;E<W.length;E++)if(W[E]===e)return!0;return!1}function wu(e){for(let E=0;E<j.length;E++)if(e===j[E])return Fu[E];return e}function z(e,E){for(let i=0;i<j.length;i++)if(e===j[i])return E[i];return e}function x(e){return e>="ً"&&e<="ٕ"}function G(e){return e==="L"?"LTR":e==="R"?"RTL":e==="C"?"CLR":e==="D"?"CRL":""}function Nu(e,E,i,A){for(;E*i<A&&x(e[E]);)E+=i;return E*i<A&&(e[E]=" ",!0)}function vu(e,E){for(let i=0;i<N.length;i++)if(e===N[i])return E[i];return e}function Vu(e,E,i){U=[],y=[];for(let A=0;A<i;A++)e[A]=A,E[A]=A,U[A]=A}function xu(e){const E=new Array(e.length);for(let i=0;i<e.length;i++)E[e[i]]=i;return E}function Q(e,E,i,A){for(let c=0;c<e.length;c++)(e[c]>E||!i&&e[c]===E)&&(e[c]+=A)}let U=[],P=[],y=[];const Ou={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},Iu=5,ju=6,w=0,V=1,H=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,ku=/[\u0591-\u06ff\ufb1d-\ufefc]/;export{Pu as d};
