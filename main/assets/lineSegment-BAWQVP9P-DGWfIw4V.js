import{gD as z,du as d,J as B}from"./main-BCJjpBkF.js";import{X as G}from"./sphere-zPMQWhGG-EU2SZKjc.js";import{r as l,y as A,L as P,P as M,v as L,_ as D,p as J}from"./vec32-Cj8pVsU0-DlO4M9Dc.js";import{q as u}from"./vectorStacks-5ZZtmT9E-BbydkEvK.js";function x(t){return t?{origin:z(t.origin),vector:z(t.vector)}:{origin:d(),vector:d()}}function Q(t,r){const n=T.get();return n.origin=t,n.vector=r,n}function _(t,r=x()){return R(t.origin,t.vector,r)}function R(t,r,n=x()){return D(n.origin,t),D(n.vector,r),n}function j(t,r,n=x()){return D(n.origin,t),l(n.vector,r,t),n}function k(t,r){const n=l(u.get(),r,t.origin),g=A(t.vector,n),i=A(t.vector,t.vector),f=B(g/i,0,1),c=l(u.get(),P(u.get(),t.vector,f),n);return A(c,c)}function C(t,r,n){return S(t,r,0,1,n)}function H(t,r,n){return M(n,t.origin,P(n,t.vector,r))}function S(t,r,n,g,i){const{vector:f,origin:c}=t,p=l(u.get(),r,c),s=A(f,p)/L(f);return P(i,f,B(s,n,g)),M(i,i,t.origin)}function I(t,r){if(E(t,Q(r.origin,r.direction),!1,X)){const{tA:n,pB:g,distance2:i}=X;if(n>=0&&n<=1)return i;if(n<0)return J(t.origin,g);if(n>1)return J(M(u.get(),t.origin,t.vector),g)}return null}function K(t,r,n){return!!E(t,r,!0,X)&&(D(n,X.pA),!0)}function E(t,r,n,g){const i=t.origin,f=M(u.get(),i,t.vector),c=r.origin,p=M(u.get(),c,r.vector),s=u.get(),o=u.get();if(s[0]=i[0]-c[0],s[1]=i[1]-c[1],s[2]=i[2]-c[2],o[0]=p[0]-c[0],o[1]=p[1]-c[1],o[2]=p[2]-c[2],Math.abs(o[0])<1e-6&&Math.abs(o[1])<1e-6&&Math.abs(o[2])<1e-6)return!1;const e=u.get();if(e[0]=f[0]-i[0],e[1]=f[1]-i[1],e[2]=f[2]-i[2],Math.abs(e[0])<1e-6&&Math.abs(e[1])<1e-6&&Math.abs(e[2])<1e-6)return!1;const q=s[0]*o[0]+s[1]*o[1]+s[2]*o[2],b=o[0]*e[0]+o[1]*e[1]+o[2]*e[2],F=s[0]*e[0]+s[1]*e[1]+s[2]*e[2],y=o[0]*o[0]+o[1]*o[1]+o[2]*o[2],w=(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])*y-b*b;if(Math.abs(w)<1e-6)return!1;let a=(q*b-F*y)/w,v=(q+b*a)/y;n&&(a=B(a,0,1),v=B(v,0,1));const h=u.get(),m=u.get();return h[0]=i[0]+a*e[0],h[1]=i[1]+a*e[1],h[2]=i[2]+a*e[2],m[0]=c[0]+v*o[0],m[1]=c[1]+v*o[1],m[2]=c[2]+v*o[2],g.tA=a,g.tB=v,g.pA=h,g.pB=m,g.distance2=J(h,m),!0}const X={tA:0,tB:0,pA:d(),pB:d(),distance2:0},T=new G(()=>x());export{R as D,S as E,x as M,_ as Q,j as R,k as S,C as T,H as U,I as V,K as W};
