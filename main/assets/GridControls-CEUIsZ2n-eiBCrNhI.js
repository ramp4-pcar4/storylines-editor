const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CytjfAQD-Ao7uCC1D.js","./index-Cezzb5s0-BxkJT1Ys.js","./jsxFactory-C5LxVioS-x3eAnntn.js","./main-D7vwjMDX.js","./main-CUxMDcRh.css","./intl-DLmy-Li5-l7mSy0H0.js","./uuid-Dj9mdEVg-BaKSCiyT.js","./guid-Cv9vc9qs-CBh637k4.js","./useT9n-ao51JRwP-k-TAz4Rg.js","./index-Buwx-j9b-DYm7HuTf.js","./dom-BYU3NyXf-Yzb49i3L.js","./observers-BKdf62mV-BbXGED_P.js","./keyed-BMAvP6cM-BjRIkNF2.js","./ref-CeH0N1rX-BKjO1LKa.js","./interactive-zE84MPIe-DF-lc3yv.js","./loadable-6U0DTqmj-BVDD0i1D.js","./component-BO03cvB--BD3HYjmJ.js","./index-f5siJR3U-C9vINBmR.js","./index-B-rP10qG-BvBmlHB2.js","./floating-ui-Cb0x-K1J-BRPGrNkW.js","./debounce-B9WUP9Xk-BvexrlwN.js","./openCloseComponent-BMtfhy-V-D-zKhn_M.js","./static-Ca7qybaa-DwVHvnZy.js","./FloatingArrow-CMt5DhCn-BAgd7n8H.js","./key-Dw3QkC1A-9YXD_SWk.js","./index-VtdpGf3k-SXs50Lp_.js","./array-BP5wmg5j-Cp8fhzAV.js","./index-KqP5VmvP-5E5XXMkW.js","./ExpandToggle-5J19yLeu-CpGCAvXn.js","./index-Hni9f9UA-D9JiS-pd.js","./label-BQQZwuu--JvYFNIdr.js","./index-D4Uosrk4-B7nDfgQg.js","./index-BFk4gxdC-ibJ9NVRv.js","./_commonjsHelpers-DtILRGNx-CDCGqrGo.js","./repeat-Dx9W9wDB-DxOUJ6wy.js","./index-O937z6z8-JbLQKWWC.js","./customElement-DYCpmMfo-DXIlgffz.js","./input-CCJ2dDrH-BY1Kn1li.js","./form-CvEjKj31-xxO__wh9.js","./Validation-BvlBtyR--Ca9VHsYu.js","./index-DguA4tdD-aRuwgjaQ.js","./index-BUYNV2Id-iNapyLYj.js"])))=>i.map(i=>d[i]);
import{v as n,I as s,T as E,t as x,bz as ae,a as le,aE as ce,ai as R,aC as $,co as j,E as L,a8 as pe,cX as g,eB as Z,eb as de,b9 as K,c as G,ci as he,cj as ue,Y as me,l0 as Y,c6 as ge,_ as S,ba as ve}from"./main-D7vwjMDX.js";import"./intl-DLmy-Li5-l7mSy0H0.js";import{o as _e}from"./unitFormatUtils-zTNxheG9-wvQ9d3GF.js";import{L as U,T as a,C as ye,m as fe,$ as be}from"./jsxFactory-C5LxVioS-x3eAnntn.js";import{h as W}from"./globalCss-CFN4F315-DRhKtkbs.js";import{r as X,b as we,o as I}from"./index-CVKk0WAC-ztfa-lGG.js";import{U as Se,O as J,k as Ce}from"./projection-m8vi7Cxv-CyI2jDkU.js";import{f as xe}from"./scaleUtils-DtnDbXa5-uHor4eLM.js";import{s as B}from"./projectVectorToVector-D0K_S4MR-QWHMdts3.js";import{_ as Me,d as Pe,p as Ie,u as Te,z as Re,m as Ee,v as Le,h as ke,f as Oe}from"./automaticLengthMeasurementUtils-BcfJmFU0-BS4tbRXD.js";import{k as $e,P as Ge,x as Ae,Q as De}from"./gridUtils-D2du44-d-v-PEiS0b.js";import{DrawGraphicTool2D as Ve}from"./editingTools-KBOXuhog-D3n-Frtv.js";import{L as N,c as je}from"./SketchViewModel-T2dNp9Tt-QF9qwxQk.js";import{z as Ue}from"./TextOverlayItem-pAuO460X-DA8_L8ki.js";import{x as We}from"./number-ZeBaww6r-D_bfrCY-.js";import{b as Be}from"./substitute-TfjvVaWd-BEVJTbkP.js";import"./ByteSizeUnit-DL8UhsB0-B2-AmVRx.js";import"./quantityUtils-RaoZoCNH-1kEzJw6x.js";import"./uuid-Dj9mdEVg-BaKSCiyT.js";import"./Queue-B8H6jIv7-oUuyYSR9.js";import"./signal-DxzURL18-CpTU2B0U.js";import"./Version-BTMwSXf1-pRbtbwqb.js";import"./draw-store-C1_quxsr-B78dyYVI.js";import"./GraphicsLayer-GkJJfSu5-BZxIbWSA.js";import"./GraphicsCollection-rAFZo1AJ-xDpoTuU3.js";import"./Layer-B8q-l4yV-BexM1eQl.js";import"./TimeExtent-gZaEUVeW-B8lK7hOc.js";import"./ScaleRangeLayer-DIxukUBC-C-91RrTO.js";import"./layerContainerType-ChWdCT09-G5sdAsSy.js";import"./jsonUtils-DzmXEA9_-DgFzKCQh.js";import"./parser-hXQyB-Qx-DBEB2hCw.js";import"./mat4f32-CiZjBg9k-CUm34GoR.js";import"./mat4-BFStKTjU-WrlKAspo.js";import"./common-CYWrYyJl-E8-sukrT.js";import"./ElevationInfo-DkWlof50-CKiKbD2K.js";import"./lengthUtils-wU9RRIqK-Dn-cOZRL.js";import"./layerViewUtils-Bk5QNiAa-ulOsFMKn.js";import"./widget-BgluoE6k-Cmg2jAJ2.js";import"./diffUtils-BSe9IE26-SHg3xJhl.js";import"./UpdatingHandles-DBzjq66S-BJQBk2Bl.js";import"./ViewingMode-CyR_b1T8-_s7_Gbsk.js";import"./vec2-BnynUbeJ-CKtGJQAy.js";import"./vec2f64-CEUyUoff-BBc0aQ6D.js";import"./vec32-BuqRmYBM-ClpcRCNx.js";import"./vec42-D8CJyqHG-DnfLTeQH.js";import"./vec4f64-CjUMzAyX-DPYbdAom.js";import"./meshVertexSpaceUtils-BwEbYR8F-3vQSP7Nh.js";import"./MeshLocalVertexSpace-DFCiKNRA-m_RitSj4.js";import"./hydratedFeatures-BDT5zTGB-D1Msl1E0.js";import"./plane-B_adY3_o-CH2S3dla.js";import"./mat3f64-Dh9_zhFu-BIT-k8Dm.js";import"./mat4f64-BaJwL7tQ-k0uMm8LY.js";import"./quatf64-C16JxGFv-BKWK1F8U.js";import"./geodesicUtils-DV-lFWtb-ID_rpKXS.js";import"./Scheduler-Br-2v2ys-9ISnkO6X.js";import"./geometryEngineBase-DueYg7ux-CCeespPx.js";import"./_commonjsHelpers-BITg13Vk-KnjfkSck.js";import"./hydrated-Bae3cp-4-BTtKkc0m.js";import"./mat2d-BQA-1WB--Pnyy0dhf.js";import"./quat-D8L_R4I0-BhK2bIY8.js";import"./drapedUtils-7RfmdK5D-BQR7bVKQ.js";import"./utils-C0LvbFCo-RMQaTNpt.js";import"./Query-CxQYWcUQ-K9TJdLqp.js";import"./Field-Cj6Pz3TI-CQAvI3hR.js";import"./fieldType-VTpxE-EM-B2R_XePP.js";import"./sphere-Cj20syUS-D26RDXx7.js";import"./mat3-DOnW3DjW-C3hbW9XY.js";import"./projectPointToVector-CG1hALQu-DPSkW3cH.js";import"./MeshTransform-CvTryVbE-nHk0oPqj.js";import"./axisAngleDegrees-nTnQhoaG-kPlPAa9I.js";import"./themeUtils-RB4IoNvm-uO-dsvgO.js";import"./a11yUtils-C2ydunC--CssG9qKp.js";import"./spatialReferenceEllipsoidUtils-DlQOpWof-Dfk6ycK5.js";import"./geodesicLengthMeasurementUtils-X1SKKkBz-wYjyxMM-.js";import"./normalizeUtils-b-vZURob-BPlRWf3g.js";import"./utils-DuaeuwP5-C_ijv4zF.js";import"./utils-Jw-4AGsF-CU104lYw.js";import"./SnappingVisualizer2D-DR-yrbjS-RVnQsuD8.js";import"./enums-f9UUstHQ-hLTu4V1l.js";import"./automaticAreaMeasurementUtils-Bz1iefP0-Dzwz5_S8.js";import"./PointSnappingHint-ClwQ1VNw-D03Ymk1S.js";import"./earcut-XDcq3zAf-BcwyrT7l.js";import"./triangle-BePBrXJ8-DtvQmPZI.js";import"./lineSegment-BJNfNZM5-BgDHtF2v.js";import"./editPlaneUtils-CYBM1uSC-C8ushogg.js";import"./boundedPlane-B6TkXVHT-CcczWzL9.js";import"./cimSymbolUtils-BuFg2oLA-Cr-kS5Oj.js";import"./utils-BYqzY6_X-DS1RelRz.js";import"./defaultCIMValues-gWpu7WSC-cjxb95kj.js";import"./GraphicManipulator-DXPP3gDs-CXzTexEm.js";import"./colorUtils-DxUhbS7D-CIyLRpfX.js";import"./drawUtils-BUIg7AUj-Bm8JHmJ6.js";const Ne={readOnly:!0,get(){return Me(this.view)}};function ze(e,t){const i=ee(t);return[e[0].toFixed(i),e[1].toFixed(i)]}function ee(e){return e>=500?6:e<500&&e>=50?7:e<50&&e>=5?8:9}function Fe(e,t){const i=e.includes(",")?",":" ",[r,o,c]=e.split(i).map(d=>{const h=d.trim();return h?Number(h):null});if(!k(r)||!k(o))return null;const p=new L({x:r,y:o,spatialReference:t||E.WGS84});return c&&(p.z=c,p.hasZ=!0),p}function k(e){return typeof e=="number"&&isFinite(e)}function z(e){return!!e&&k(e.x)&&k(e.y)}function F(e,t){if(e.spatialReference.isGeographic&&t){const[i,r]=ze([e.x,e.y],t);return`${i}, ${r}`}return`${e.x.toFixed(3)}, ${e.y.toFixed(3)}`}let u=class extends K{constructor(e){super(e),this.conversionInfo=null,this.coordinateSegments=null,this._currentPattern=void 0,this.defaultPattern=null,this.name=null,this.viewModel=null}get currentPattern(){return(this._currentPattern||this.defaultPattern)??""}set currentPattern(e){this._currentPattern=e}get label(){return this.name??""}set label(e){this._overrideIfSome("label",e)}get hasDisplayProperties(){return!(!this.defaultPattern||!this.coordinateSegments)}get spatialReference(){return this.name==="basemap"?this._viewSpatialReference:this.conversionInfo?.spatialReference??E.WGS84}set spatialReference(e){this._overrideIfSome("spatialReference",e)}get _viewSpatialReference(){return this.viewModel?.view?.spatialReference??E.WGS84}get _additionalCharactersPattern(){const e=this.coordinateSegments;if(!e)return null;const t=e.map(r=>r.alias),i=this.currentPattern.replaceAll(new RegExp(`["nsew${t.join()}]`,"gi"),"").replaceAll(" ","");return new RegExp(`[${i}]`,"g")}get test(){}async convert(e){if(!z(e))throw new G("format:invalid-point","Could not convert invalid point.",{point:e});const t=this.conversionInfo?.convert;if(t)return Promise.resolve().then(()=>t(e));const i=await this._project(e,this.spatialReference);return{location:i,coordinate:await this._getCoordinate(i)}}getConversionStrategy(){const e=this._viewSpatialReference;return this.conversionInfo?.convert||this.viewModel?.formatterAvailable||this.name==="xy"&&(e.isWebMercator||e.isWGS84)||this.name==="basemap"?"client":"server"}getDisplayCoordinate(e){if(!e)return null;if(!this.coordinateSegments||!this.currentPattern)return e;let t=this.currentPattern;const i=this._getSegmentMatches(e,!1);for(let r=this.coordinateSegments.length-1;r>=0;r--){const o=this.coordinateSegments[r];t=t.replace(o.alias,i[r])}return t}_parseUserInput(e){const{defaultPattern:t,_additionalCharactersPattern:i,coordinateSegments:r}=this;if(!t||!i)return"";let o=t.replace(i,"");e=e.replace(i,"");const c=this._getSegmentMatches(e,!0);if(r)for(let p=r.length-1;p>=0;p--){const d=r[p];o=o.replace(d.alias,c[p])}return o}_getSegmentMatches(e,t){const i=new Array,{coordinateSegments:r}=this;if(!r)return i;for(let o=0;o<r.length;o++){const c=r[o],p=e.match(c.searchPattern);if(!p){i.push("");continue}let d=p[0];if(e=e.replace(d,"").trim(),c.substitution){const h=t?c.substitution.input(d):c.substitution.output(d);h&&(d=`${h}`)}i.push(d)}return i}async reverseConvert(e){const t=this._parseUserInput(e),i=this.conversionInfo?.reverseConvert;let r;if(i)r=i(t);else if(this.name==="xy"||this.name==="basemap")r=Fe(t,this.spatialReference);else if(this.viewModel?.formatterAvailable)switch(this.name){case"dd":case"ddm":case"dms":r=Re(t,this.spatialReference);break;case"mgrs":{r=Te(t,this.spatialReference,"automatic");break}case"utm":{r=Ie(t,this.spatialReference,"latitude-band-indicators");break}case"usng":r=Pe(t,this.spatialReference);break;default:r=null}if(!r)throw new G("format:invalid-input","Could not parse input into point.",{userInput:e});return this._project(r,this._viewSpatialReference)}async _getCoordinate(e){const t=this.viewModel?.view?.scale??0;if(!z(e))throw new G("format:invalid-point","Could not transform invalid point into coordinate.",{point:e});if(this.viewModel?.formatterAvailable||this.name==="basemap"||this.name==="xy")switch(this.name){case"dd":case"ddm":case"dms":{const i=ee(t);return Oe(e,this.name,i)}case"mgrs":return ke(e,"automatic",5,!1);case"usng":return Le(e,5,!1);case"utm":return Ee(e,"latitude-band-indicators",!0);default:return F(e,t)}return F(e,t)}async _project(e,t){if(he(e.spatialReference,t)||!t)return e;if(this.viewModel?.formatterAvailable&&Ce())return J(e,t);if(!this.viewModel?.formatterAvailable){const i=ue(e,t);if(i!=null)return i}return null}};n([s()],u.prototype,"conversionInfo",void 0),n([s()],u.prototype,"coordinateSegments",void 0),n([s()],u.prototype,"currentPattern",null),n([s()],u.prototype,"_currentPattern",void 0),n([s()],u.prototype,"label",null),n([s()],u.prototype,"defaultPattern",void 0),n([s({readOnly:!0})],u.prototype,"hasDisplayProperties",null),n([s()],u.prototype,"name",void 0),n([s({type:E})],u.prototype,"spatialReference",null),n([s()],u.prototype,"viewModel",void 0),n([s({readOnly:!0})],u.prototype,"_viewSpatialReference",null),n([s({readOnly:!0})],u.prototype,"_additionalCharactersPattern",null),u=n([x("esri.widgets.CoordinateConversion.support.Format")],u),We().decimal;const He="°‎";let v=class extends me{constructor(e){super(e),this.center=new L,this.dynamicScaling=!0,this.majorLineColor=g.fromArray([115,115,115,1]),this.majorLineInterval=10,this.minorLineColor=g.fromArray([165,165,165,1]),this.rotateWithMap=!1,this.rotation=0,this.spacing=1,this.type="measured",this.units="miles"}};n([s()],v.prototype,"center",void 0),n([s()],v.prototype,"dynamicScaling",void 0),n([s()],v.prototype,"majorLineColor",void 0),n([s()],v.prototype,"majorLineInterval",void 0),n([s()],v.prototype,"minorLineColor",void 0),n([s()],v.prototype,"rotateWithMap",void 0),n([s()],v.prototype,"rotation",void 0),n([s()],v.prototype,"spacing",void 0),n([ae({measured:"measured"})],v.prototype,"type",void 0),n([s()],v.prototype,"units",void 0),v=n([x("esri.grids.MeasuredGrid")],v);let _=class extends K{constructor(e){super(e),this.color=new g([255,127,0,1]),this.isDecoration=!0,this.length=34,this.rotation=0,this.thickness=2,this.visible=!0}get _strokeStyle(){return this.color.toCss(!0)}render(){const{x:e,y:t,length:i,thickness:r,rotation:o}=this,c=i/2,p=`0 0 ${i} ${i}`,d=`M${c} 0 V${i} M0 ${c} H${i}`;return a("div",{classes:{"esri-box-overlay-item":!0},dir:"ltr",styles:{left:`${(e??0)-c}px`,top:`${(t??0)-c}px`,width:`${i}px`,height:`${i}px`,transform:`rotate(${o}deg)`,visibility:this.visible?"visible":"hidden"}},a("svg",{styles:{overflow:"visible"},viewbox:p},a("path",{d,stroke:this._strokeStyle,"stroke-width":r})))}renderCanvas(){}};n([s()],_.prototype,"color",void 0),n([s()],_.prototype,"isDecoration",void 0),n([s()],_.prototype,"length",void 0),n([s()],_.prototype,"rotation",void 0),n([s()],_.prototype,"thickness",void 0),n([s()],_.prototype,"visible",void 0),n([s()],_.prototype,"x",void 0),n([s()],_.prototype,"y",void 0),n([s({readOnly:!0})],_.prototype,"_strokeStyle",null),_=n([x("esri.views.overlay.CrosshairOverlayItem")],_);const qe=_,te=e=>{if(e==null||isNaN(e))return 0;const t=e+180;return Math.trunc(Y(t,360))},Qe=e=>{let t=e;return t==null?0:(typeof t=="string"&&(t=parseInt(t,10)),isNaN(t)?0:Y(Math.trunc(t),360)-180)},H=(e,t)=>{if(!e||t.length<3)return;const[i,r,o,c]=t,[p,d]=c===void 0?[1,.25]:[c,.25*c];e.majorLineColor=g.fromArray([i,r,o,p]),e.minorLineColor=g.fromArray([i,r,o,d])},q=Symbol("grid-interactivity");let l=class extends le.EventedAccessor{constructor(e){super(e),this._drawGraphicTool=null,this._crosshairLabel=null,this._crosshairItem=null,this.snappingManager=null,this.snappingOptions=null,this.view=null,this.placementDisabled=!1,this._mostRecentlyShownGrid=null,this._sketchedVertexCount=0}initialize(){this.addHandles([ce(()=>!this.displayEnabled,()=>{this.interactivePlacementState=null}),R(()=>this.view?.viewpoint,()=>{this._renderOverlays()}),R(()=>this.snappingOptions?.gridEnabled,e=>{e!=null&&this.trySetDisplayEnabled(e)}),R(()=>this.view?.grid,(e,t)=>{this._mostRecentlyShownGrid=!e&&t?t:null})])}destroy(){this._resetGridPlacementState(),this._crosshairItem&&(this.view?.overlay?.removeItem(this._crosshairItem),this._crosshairItem=$(this._crosshairItem)),this._crosshairLabel&&(this.view?.overlay?.removeItem(this._crosshairLabel),this._crosshairLabel=$(this._crosshairLabel))}get displayEnabled(){return!!this.view?.grid}get dynamicScaling(){return this.grid?.dynamicScaling??!1}set dynamicScaling(e){this.grid&&(this.grid.dynamicScaling=e)}get grid(){return this.view?.grid??this._mostRecentlyShownGrid}set gridColor(e){this._set("gridColor",e);const[t,i,r,o]=e.toArray();H(this.grid,[t,i,r,o/255])}get gridControlsEnabled(){return this.displayEnabled&&!this.interactivePlacementState}set interactivePlacementState(e){this._set("interactivePlacementState",e),this._resetGridPlacementState(),e&&this._startGridManipulation(e)}get majorLineInterval(){return this.grid?.majorLineInterval??10}set majorLineInterval(e){this.grid&&(this.grid.majorLineInterval=e<1?1:e>15?15:e)}get rotateWithMap(){return this.grid?.rotateWithMap??!1}set rotateWithMap(e){this.grid&&(this.grid.rotateWithMap=e)}get rotation(){return this.grid?.rotation??-180}set rotation(e){this.grid&&(this.grid.rotation=e)}get snappingEnabled(){return(this.grid&&this.snappingOptions?.gridEnabled)??!1}set snappingEnabled(e){const{snappingOptions:t}=this;t&&(t.gridEnabled=e)}get spacing(){return this.grid?.spacing??1}set spacing(e){this.grid&&e>0&&(this.grid.spacing=e)}get unit(){return this.grid?.units}set unit(e){this.grid&&(this.grid.units=e)}get gridOutOfScale(){return!this.dynamicScaling&&this._pixelsPerStride!=null&&this._pixelsPerStride<$e}get effectiveSpacingAfterDynamicScaling(){return this.majorLineInterval<1||!this.dynamicScaling||!this.view||this._pixelsPerStride==null||!this.grid?.spacing?null:this.grid.spacing*Ge(this.majorLineInterval,this._pixelsPerStride,this.dynamicScaling)}get numericSpacingInputShouldBeVisible(){return!!this.view?.spatialReference&&Ae(this.view.spatialReference)}get _metersPerSRUnit(){if(!(this.view&&this.displayEnabled&&this.grid&&Se(this.grid.center.spatialReference,this.view.spatialReference)))return null;const e=J(this.grid.center,this.view.spatialReference);return De(e)}get _pixelsPerStride(){if(!this.view?.scale||!this.displayEnabled||!this.grid||this._metersPerSRUnit==null)return null;const e=this.grid,{scale:t,spatialReference:i}=this.view;return j(e.spacing,e.units,"meters")/(this._metersPerSRUnit*xe(t,i))}get _isPlacing(){if(!this._drawGraphicTool)return!1;const e=this.interactivePlacementState;return e==="place"||e==="interactive"&&this._sketchedVertexCount===0}get _isRotating(){if(!this._drawGraphicTool)return!1;const e=this.interactivePlacementState;return e==="rotate"||e==="interactive"&&this._sketchedVertexCount===1}get _isScaling(){return this._drawGraphicTool?this.interactivePlacementState==="interactive"&&this._sketchedVertexCount===1:!1}togglePlacementState(e){this.interactivePlacementState=this.interactivePlacementState===e?null:e}trySetDisplayEnabled(e){const{view:t}=this;if(t?.ready)if(!t.grid&&e)if(this._mostRecentlyShownGrid)t.grid=this._mostRecentlyShownGrid;else{const i=this.defaultUnit==="imperial"?"feet":"meters";t.grid=new v({units:i,center:t.center??new L,rotateWithMap:!0}),H(this.grid,[115,115,115])}else e||(t.grid=null);else pe.getLogger(this).warn("Attempting to enable grid display while view is not ready")}startPlacement(e){const{view:t,snappingManager:i}=this;if(!t)return;this._set("interactivePlacementState",e),this._sketchedVertexCount=0;const r=new Ve({view:t,graphicProperties:{attributes:{[N]:N}},sketchOptions:{tooltips:{enabled:!0,visibleElements:{direction:!1,rotation:!1,totalLength:!1,elevation:!1,distance:!1,area:!1}}},geometryType:"polyline",mode:"click",snapToScene:!1,snappingManager:i,forceUniformSize:!0,centered:!1,cursor:this.interactivePlacementState==="interactive"||this.interactivePlacementState==="place"?"none":null,regularVerticesSymbol:void 0,activeVertexSymbol:Ze,activeLineSymbol:Q,graphicSymbol:Q});this._drawGraphicTool=r,t.addAndActivateTool(r),this._renderOverlays(),this.addHandles([r.on("cursor-update",o=>this._onCursorUpdate(o)),r.on("complete",()=>this._onDrawComplete()),r.on("vertex-add",o=>this._onVertexAdd(o,e))],q)}async _startGridManipulation(e){const{view:t}=this;if(!t)return void(this.interactivePlacementState=null);const i=new CustomEvent("before-placement",{cancelable:!0});this.emit("before-placement",i),i.defaultPrevented||this.startPlacement(e)}_onCursorUpdate(e){try{if(this._isPlacing){const t=e.vertices[0].coordinates;return void this._handlePlace(t)}if(this._drawGraphicTool.cursor=null,this._isRotating&&this._handleRotate(e.vertices[0].coordinates),this._isScaling){const t=this._drawGraphicTool?.drawOperation.cursorVertex;this._handleScale(t)}}finally{this._renderOverlays()}}_onDrawComplete(){this._drawGraphicTool.cursor=null,this.interactivePlacementState=null}_onVertexAdd(e,t){const i=e.vertices[0].coordinates;this._isPlacing&&this._handlePlace(i),this._isRotating&&this._sketchedVertexCount>0&&this._handleRotate(i),this._isScaling&&this._sketchedVertexCount>0&&this._handleScale(B(i[0],i[1],void 0,this.view.spatialReference)),this._sketchedVertexCount++,this._drawGraphicTool.cursor=null,this._sketchedVertexCount!==2&&t==="interactive"||(this.interactivePlacementState=null),this._renderOverlays()}_handlePlace(e){const{grid:t,view:i}=this;t&&i&&(t.center=new L({x:e[0],y:e[1],spatialReference:i.spatialReference}))}_handleRotate(e){const{grid:t,view:i}=this;if(!t||!i)return;this._drawGraphicTool?.sketchOptions.tooltips.set("enabled",!1);const{x:r,y:o}=t.center,[c,p]=e,d=i.toScreen(t.center,{pickClosestTarget:!0}),h=d&&i.toMap(d),b=i.toScreen(B(c,p,void 0,i.spatialReference),{pickClosestTarget:!0}),w=b&&i.toMap(b),M=h?h.x:r,O=h?h.y:o,P=M-(w?w.x:c),D=O-(w?w.y:p);if(P===0&&D===0)return;const re=Math.atan2(D,P),V=ve(re),ne=t.rotateWithMap,se=i.viewpoint.rotation??0,oe=ne?V:V-se;t.rotation=Math.fround(oe)%360}_handleScale(e){const{view:t,grid:i,_drawGraphicTool:r,interactivePlacementState:o,_metersPerSRUnit:c}=this;if(!(e&&t&&i&&r&&c))return;r.sketchOptions.tooltips.enabled=!1;const p=o==="interactive"?i.center:r.drawOperation.firstVertex;if(!p||!e)return;const d=t?.toScreen(p),h=d&&t.toMap(d),b=t?.toScreen(e),w=h??p,M=(b&&t.toMap(b))??e,O=Math.sqrt((w.x-M.x)**2+(w.y-M.y)**2),P=j(O*c,"meters",i.units);this.spacing=P}_renderOverlays(){this._renderCrosshairOverlay(),this._renderTextOverlay()}_renderTextOverlay(){const{grid:e,view:t,_drawGraphicTool:i}=this,r=this._getCrosshairLabel();if(!(e&&t?.overlay&&i&&r))return;const o=t.toScreen(e.center,{pickClosestTarget:!0});o&&(r.position=[o.x+12,o.y+12]),this._isRotating?(r.text=`${te(e.rotation)}${He}`,r.visible=!0):r.visible=!1}_renderCrosshairOverlay(){const{grid:e,view:t,_drawGraphicTool:i}=this;if(!e||!t?.overlay||!i)return;const r=this._getCrosshair();if(!r)return;const o=t.toScreen(e.center);o&&(r.x=o.x,r.y=o.y,r.rotation=e.rotateWithMap?t.viewpoint.rotation-e.rotation:-e.rotation,r.visible=!!i)}_getCrosshairLabel(){if(this._crosshairLabel)return this._crosshairLabel;const{grid:e,view:t,_drawGraphicTool:i}=this;if(!e||!t?.overlay||!i)return null;const r=new Ue({anchor:"top-left",fontSize:10,textColor:new g([21,21,21]),backgroundColor:new g([248,248,248]),padding:8,borderRadius:20});return t.overlay.addItem(r),this._crosshairLabel=r,r}_getCrosshair(){const{_crosshairItem:e,view:t}=this;return t?.overlay?e&&t.overlay.items.includes(e)?e:(this._crosshairItem=new qe({color:t.effectiveTheme.accentColor,thickness:4,length:36,visible:!0}),t.overlay?.addItem(this._crosshairItem),this._crosshairItem):null}_resetGridPlacementState(){this.removeHandles(q),this._crosshairItem&&(this._crosshairItem.visible=!1),this._crosshairLabel&&(this._crosshairLabel.visible=!1),this._drawGraphicTool&&(this.view?.activeTool===this._drawGraphicTool&&(this.view.activeTool=null),this.view?.tools.remove(this._drawGraphicTool)),this._drawGraphicTool=$(this._drawGraphicTool)}};n([s(Ne)],l.prototype,"defaultUnit",void 0),n([s({readOnly:!0})],l.prototype,"displayEnabled",null),n([s()],l.prototype,"dynamicScaling",null),n([s()],l.prototype,"grid",null),n([s({type:g})],l.prototype,"gridColor",null),n([s({readOnly:!0})],l.prototype,"gridControlsEnabled",null),n([s()],l.prototype,"interactivePlacementState",null),n([s()],l.prototype,"majorLineInterval",null),n([s()],l.prototype,"rotateWithMap",null),n([s()],l.prototype,"rotation",null),n([s()],l.prototype,"snappingEnabled",null),n([s()],l.prototype,"snappingManager",void 0),n([s({type:je})],l.prototype,"snappingOptions",void 0),n([s()],l.prototype,"spacing",null),n([s()],l.prototype,"unit",null),n([s()],l.prototype,"view",void 0),n([s({readOnly:!0})],l.prototype,"gridOutOfScale",null),n([s({readOnly:!0})],l.prototype,"effectiveSpacingAfterDynamicScaling",null),n([s({readOnly:!0})],l.prototype,"numericSpacingInputShouldBeVisible",null),n([s()],l.prototype,"placementDisabled",void 0),n([s()],l.prototype,"_metersPerSRUnit",null),n([s()],l.prototype,"_pixelsPerStride",null),n([s()],l.prototype,"_isPlacing",null),n([s()],l.prototype,"_isRotating",null),n([s()],l.prototype,"_isScaling",null),n([s()],l.prototype,"_mostRecentlyShownGrid",void 0),n([s()],l.prototype,"_sketchedVertexCount",void 0),l=n([x("esri.widgets.support.GridControls.GridControlsViewModel")],l);const ie=l,Q=new Z({width:0}),Ze=new de({color:g.fromArray([0,0,0,0]),outline:new Z({color:g.fromArray([0,0,0,0])})}),y="esri-grid-controls",f={base:y,borderedSwitch:`${y}__switch--bordered`,container:`${y}__container`,numericInputsContainer:`${y}__numeric-inputs__container`,tilegroup:`${y}__tilegroup`,tile:`${y}__tile`,tileDisabled:`${y}__tile--disabled`,tileContent:`${y}__tile__content`,suffixedInputContainer:`${y}__input-with-suffix__container`,inputSuffix:`${y}__input-with-suffix__suffix-part`,inlineIcon:`${y}__inline-icon`},C={widgetIcon:"grid-unit",gridTheme:{light:"circle",dark:"circle-area",custom:"palette"},placementState:{interactive:"maximum-territory-distance",place:"move",rotate:"rotate"},warning:"exclamation-mark-triangle"},T=g.fromArray([115,115,115]),A=g.fromArray([200,200,200]),Ke=["interactive","place","rotate"];let m=class extends ye{constructor(e,t){super(e,t),this.customColor=null,this.messages=null,this.messagesUnits=null,this.viewModel=new ie,this.visibleElements=new X}initialize(){this.addHandles([R(()=>this.view?.grid?.majorLineColor,e=>{!e||T.equals(e)||A.equals(e)||(this.customColor=e)},ge)])}loadDependencies(){return Promise.all([fe({action:()=>S(()=>import("./index-CytjfAQD-Ao7uCC1D.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url),"action-bar":()=>S(()=>import("./index-f5siJR3U-C9vINBmR.js"),__vite__mapDeps([17,1,2,3,4,5,6,7,8,9,10,11,0,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28]),import.meta.url),label:()=>S(()=>import("./index-Hni9f9UA-D9JiS-pd.js"),__vite__mapDeps([29,2,3,4,5,6,30,10]),import.meta.url),icon:()=>S(()=>import("./index-Buwx-j9b-DYm7HuTf.js"),__vite__mapDeps([9,2,3,4,5,6,10,11]),import.meta.url).then(e=>e.i),popover:()=>S(()=>import("./index-B-rP10qG-BvBmlHB2.js"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,9,10,11,0,12,13,14,15,16,19,20,21,22,23,24]),import.meta.url).then(e=>e.i),tooltip:()=>S(()=>import("./index-D4Uosrk4-B7nDfgQg.js"),__vite__mapDeps([31,2,3,4,5,6,13,19,10,20,7,21,23,12]),import.meta.url),"color-picker":()=>S(()=>import("./index-BFk4gxdC-ibJ9NVRv.js"),__vite__mapDeps([32,2,3,4,5,6,12,13,33,34,10,9,11,35,36,37,24,38,14,30,15,16,39,8,40,1,7,41,22,20]),import.meta.url),"input-number":()=>S(()=>import("./index-DguA4tdD-aRuwgjaQ.js"),__vite__mapDeps([40,9,2,3,4,5,6,10,11,35,36,37,13,24,12,38,14,30,15,16,39,8]),import.meta.url)}),we()])}get icon(){return C.widgetIcon}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages.widgetLabel}set label(e){this._overrideIfSome("label",e)}get snappingManager(){return this.viewModel.snappingManager}set snappingManager(e){this.viewModel.snappingManager=e}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get theme(){const e=this.viewModel.grid?.majorLineColor;return e?T.equals(e)?"dark":A.equals(e)?"light":"custom":null}set theme(e){const{viewModel:t,customColor:i,view:r}=this;switch(e){case"light":t.gridColor=A;break;case"dark":t.gridColor=T;break;case"custom":t.gridColor=i??r?.effectiveTheme.accentColor??T}}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){return a("div",{"aria-label":this.label,class:this.classes(f.base,W.widget,W.panel)},a("div",{class:f.container},this._renderContent()))}_renderContent(){const{visibleElements:e}=this;return[e.gridEnabledToggle?this._renderEnabledToggle():null,e.placementButtons?this._renderGridPlacementButtons():null,e.numericInputs?this._renderNumericInputs():null,e.lineIntervalInput?this._renderIntervalInput():null,e.gridSnapEnabledToggle&&this.viewModel.snappingOptions?this._renderSnappingToggle():null,e.dynamicScaleToggle?this._renderDynamicScaleToggle():null,e.rotateWithMapToggle?this._renderRotateToggle():null,e.colorSelection?this._renderColorSelection():null]}_renderGridPlacementButtons(){const{interactivePlacementState:e,placementDisabled:t,gridControlsEnabled:i}=this.viewModel,r=t||!i;return a("calcite-label",{key:"grid-placement-buttons",scale:"s"},this.messages.placementOptions,a("calcite-action-bar",{expandDisabled:!0,layout:"horizontal"},Ke.map(o=>this._renderPlacementModeButton(o,r,e))))}_renderPlacementModeButton(e,t,i){const r=this.messages.placementState[e],o=`__placement-action-${e}`;return a("div",null,a("calcite-action",{active:i===e,alignment:"center",disabled:t,icon:C.placementState[e],id:o,onclick:()=>this.viewModel.togglePlacementState(e),text:r}),a("calcite-tooltip",{overlayPositioning:"fixed",placement:"top",referenceElement:o},r))}_renderNumericInputs(){const{rotation:e,spacing:t,effectiveSpacingAfterDynamicScaling:i,numericSpacingInputShouldBeVisible:r,unit:o="meters"}=this.viewModel,c=this.messagesUnits.units[o].abbr,p=this.viewModel.gridControlsEnabled,d=i!=null&&i!==this.viewModel.spacing,h=`__spacing_input_scaled-${this.id}`;return a("div",{class:this.classes(f.numericInputsContainer)},[r?a("calcite-label",{key:"spacing-label",scale:"s"},a("span",null,this.messages.inputLabel.spacing,d?a("calcite-icon",{class:this.classes(f.inlineIcon),icon:C.warning,id:h,scale:"s",tabIndex:0}):void 0),a("div",{class:f.suffixedInputContainer},a("calcite-input-number",{disabled:!p,numberButtonType:"none",suffixText:c,value:`${t?.toFixed(2)}`,onCalciteInputNumberChange:({currentTarget:b})=>{const w=parseFloat(b.value);this.viewModel.spacing=w,w!==this.viewModel.spacing&&(b.value=`${this.viewModel.spacing}`)}}),d?a("calcite-tooltip",{overlayPositioning:"fixed",placement:"leading",referenceElement:h},Be(this.messages.warnings.dynamicSpacing,{actualSpacingIncludingUnit:_e(this.messagesUnits,i,o,2,"plural")})):void 0)):void 0,a("calcite-label",{key:"angle-label",scale:"s"},this.messages.inputLabel.angle,a("calcite-input-number",{disabled:!p,integer:!0,numberButtonType:"none",suffixText:this.messagesUnits.units.degrees.abbr,value:`${te(e)}`,onCalciteInputNumberChange:({currentTarget:b})=>this.viewModel.rotation=Qe(b.value)}))])}_renderIntervalInput(){const{majorLineInterval:e,gridControlsEnabled:t}=this.viewModel;return a("div",{class:this.classes(f.numericInputsContainer)},a("calcite-label",{scale:"s"},this.messages.inputLabel.interval,a("calcite-input-number",{disabled:!t,integer:!0,max:15,min:1,numberButtonType:"vertical",value:`${e}`,onCalciteInputNumberChange:({currentTarget:i})=>{const r=Number.parseInt(i.value,10);this.viewModel.majorLineInterval=r,r!==this.viewModel.majorLineInterval&&(i.value=`${this.viewModel.majorLineInterval}`)}})))}_renderSnappingToggle(){const{snappingOptions:e,gridControlsEnabled:t}=this.viewModel;return a(I,{checked:!!(e?.gridEnabled??!1),disabled:!(t&&e),key:"grid-snap-enabled-toggle",label:this.messages.switchLabel.snap,onChange:i=>this.viewModel.snappingOptions?.set("gridEnabled",i)})}_renderDynamicScaleToggle(){const{viewModel:e,messages:t}=this,i=this.visibleElements.outOfScaleWarning&&e.gridOutOfScale;return a(I,{checked:e.dynamicScaling,disabled:!e.gridControlsEnabled,hint:i?t.warnings.outOfScale:void 0,hintIcon:C.warning,hintKind:"warning",key:`grid-dynamic-scale-toggle-${this.id}`,label:t.switchLabel.scaling,onChange:r=>e.dynamicScaling=r})}_renderRotateToggle(){const{gridControlsEnabled:e,rotateWithMap:t}=this.viewModel;return a(I,{checked:t,disabled:!e,key:"grid-rotate-map-toggle",label:this.messages.switchLabel.rotateWithMap,onChange:i=>this.viewModel.rotateWithMap=i})}_renderEnabledToggle(){return a("div",{class:f.borderedSwitch},a(I,{checked:this.viewModel.displayEnabled,disabled:!!this.viewModel.interactivePlacementState,key:"grid-enabled-toggle",label:this.messages.switchLabel.display,onChange:e=>this.viewModel.trySetDisplayEnabled(e)}))}_renderColorSelection(){const{customColor:e}=this,t=`${this.id}--custom-grid-color-button`;return a("calcite-label",{scale:"s"},this.messages.inputLabel.theme,a("div",{class:f.tilegroup},[this._renderThemeTile({value:"dark"}),this._renderThemeTile({value:"light"}),this._renderThemeTile({value:"custom",id:t}),a("calcite-popover",{autoClose:!0,label:this.messages.gridLineColorPopoverLabel,overlayPositioning:"fixed",referenceElement:t},a("calcite-color-picker",{alphaChannel:!0,savedDisabled:!0,value:e?.toHex({digits:8})??"#000000ff",onCalciteColorPickerChange:i=>{const r=g.fromHex(i.currentTarget.value);r&&(this.customColor=r,this.theme="custom")}}))]))}_renderThemeTile(e){const{theme:t}=this,{value:i}=e,r=this.messages.gridTheme[i],o=`${this.id}--theme_tile_${i}`,c=`${o}__label`,p=C.gridTheme[i],d=this.viewModel.gridControlsEnabled;return a("div",{class:be({[f.tile]:!0,[f.tileDisabled]:!d}),id:e.id,role:"button"},a("input",{"aria-labelledby":c,checked:t===i,disabled:!d,id:o,name:`${this.id}--theme`,onchange:h=>{this.theme=i,h.target?.focus()},tabIndex:0,type:"radio"}),a("div",{class:f.tileContent},a("calcite-icon",{icon:p,scale:"l"}),a("calcite-label",{for:o,id:c},r)))}};n([s({type:g})],m.prototype,"customColor",void 0),n([s()],m.prototype,"icon",null),n([s()],m.prototype,"label",null),n([s(),U("esri/widgets/support/GridControls/t9n/GridControls")],m.prototype,"messages",void 0),n([s(),U("esri/core/t9n/Units")],m.prototype,"messagesUnits",void 0),n([s()],m.prototype,"snappingManager",null),n([s()],m.prototype,"snappingOptions",null),n([s()],m.prototype,"theme",null),n([s()],m.prototype,"view",null),n([s({type:ie})],m.prototype,"viewModel",void 0),n([s({type:X,nonNullable:!0})],m.prototype,"visibleElements",void 0),m=n([x("esri.widgets.support.GridControls")],m);const Gi=m;export{Gi as default};
