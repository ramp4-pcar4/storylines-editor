const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Legend-C1YLx_LO-CaAkqvs7.js","./main-DK5A1thH.js","./main-BRDqyNC1.css","./jsxFactory-C5LxVioS-D9YNnBiM.js","./intl-DLmy-Li5-BP8VBpPh.js","./uuid-Dj9mdEVg-BaKSCiyT.js","./featureReductionUtils-CT3zJdMo-COEl9dk_.js","./EffectView-Bw7SZPlx-B2LQXkoN.js","./parser-hXQyB-Qx-BrGynOq8.js","./mat4f32-CiZjBg9k-CUm34GoR.js","./mat4-BFStKTjU-BMLpTkEG.js","./common-CYWrYyJl-E8-sukrT.js","./jsonUtils-DzmXEA9_-xcaB5q4V.js","./displayFilterUtils-CGSKf3_R-D4QSTIWw.js","./ExportImageParameters-BFIpXRBd-KAPTQI-5.js","./scaleUtils-DtnDbXa5-C9ky--DX.js","./floorFilterUtils-4r-vVdzs-C43jLoAE.js","./sublayerUtils-CVtBGavp-DZlN6Bqj.js","./pixelRangeUtils-BteWOAF5-CpV1k138.js","./jsonUtils-DQiDyVGY-B8wzM7Vp.js","./typeUtils-I5iG5ZKA-Bp1Ya_c0.js","./ClassBreaksRenderer-D97YzbWp-C4sjUY3g.js","./commonProperties-BLIn8DYU-B1Yp5erq.js","./colorRamps-KMmVdCPJ-BnSr8GmN.js","./ColorStop-DoHCvOqO-BzNtsbuF.js","./visualVariableUtils-BO-_wo28-DpDT9w5N.js","./lengthUtils-wU9RRIqK-CcSgrDlT.js","./RendererLegendOptions-f5mIImtQ-D05ycPIv.js","./LRUCache-BLmkvs7b-C8UYsL5g.js","./MemCache-BCippCv6-1uKfr3Ab.js","./Version-BTMwSXf1-W7KhXniF.js","./FieldsIndex-Y7EBAYp0-CS8vHjAS.js","./timeZoneUtils-z3WjfjXQ-CBz80Iqi.js","./utils-BYqzY6_X-C0l8qNfz.js","./defaultCIMValues-gWpu7WSC-cjxb95kj.js","./enums-f9UUstHQ-hLTu4V1l.js","./heatmapUtils--OU2Fakh-CU7rUz5B.js","./vec42-D8CJyqHG-DnfLTeQH.js","./vec4f64-CjUMzAyX-DPYbdAom.js","./SimpleRenderer-ADQlYl8U-DdNw8rQ1.js","./UniqueValueRenderer-BmoLL_Ee-DHw-hdzu.js","./diffUtils-BSe9IE26-CWVuAUpT.js","./styleUtils-DxAOZq5S-CiK8jaP7.js","./rendererConversion-D-HBj0jy-NEbd3roX.js","./cimSymbolUtils-BuFg2oLA-D3RNell-.js","./utils-C1HQJ6Ct-B3NGmj_D.js","./globalCss-CFN4F315-BD5UDk6S.js","./Queue-B8H6jIv7-BD0bPSsY.js","./signal-DxzURL18-BUWbVrim.js","./utils-C_9ghOVk-CBxeBNHz.js","./colorUtils-DxUhbS7D-CbcIfQgk.js","./mat2df32-BCnkwMW8-BLRY8i4P.js","./mat2d-BQA-1WB--Pnyy0dhf.js","./webStyleSymbolUtils-BLJ6xjmu-C7AR-t47.js","./devEnvironmentUtils-CxrVv3RG-CX5aoxVE.js","./webStyleAcceptedFormats-DsfCZOwz-CG7ZQ6BV.js","./TimeExtent-gZaEUVeW-DaDBMnur.js","./utils-BG7WTOnW-0dD0ASRJ.js","./themeUtils-RB4IoNvm-uO-dsvgO.js","./substitute-TfjvVaWd-B_KOR7s3.js","./index-Buwx-j9b-DSW1tK6e.js","./dom-BYU3NyXf-DNgN2ZzD.js","./observers-BKdf62mV-CHokQd-s.js","./index-Hni9f9UA-2ETnnoL2.js","./label-BQQZwuu--_9gF-i1t.js","./index-8PAcNuSr-CBKOzR7g.js","./ref-CeH0N1rX-Hks-Szda.js","./form-CvEjKj31-CGU5-W0Z.js","./interactive-zE84MPIe-CBqK13jE.js","./key-Dw3QkC1A-9YXD_SWk.js","./loadable-6U0DTqmj-BGW1Oq0R.js","./index-D4Uosrk4-ByD9vEN5.js","./floating-ui-Cb0x-K1J-7duPQzmT.js","./debounce-B9WUP9Xk-BvexrlwN.js","./guid-Cv9vc9qs-CBh637k4.js","./openCloseComponent-BMtfhy-V-nMlg6X5J.js","./FloatingArrow-CMt5DhCn-CxpXY5O9.js","./keyed-BMAvP6cM-C-s98vKr.js","./index-J94OCPzp-DHmmW0R8.js","./index-Cezzb5s0-B47aWd3U.js","./useT9n-ao51JRwP-DspR1Suu.js","./customElement-B5RyutyI-E6mTlpkb.js","./index-BJZZ1uba-CTglPY3l.js","./dynamicClasses-Dwz_yyhi-08boNpeL.js","./index-CytjfAQD-Ciz-RVgE.js","./component-BO03cvB--BPs5EKAU.js","./index-CZp4PK2p-DDpOfdJI.js","./resources6-Ce6AoWnT-DbbvfBW6.js","./index-DA7O6rVv-oGpG3F1q.js","./customElement-DlEKrn3l-VHZ7D70P.js","./index-B-rP10qG-BvQb5lKk.js","./static-Ca7qybaa-BRrLqgMn.js","./index-VtdpGf3k-CYviBhvg.js","./array-BP5wmg5j-Cp8fhzAV.js","./index-DjLe4PDK-owYIe6QZ.js","./index-GmJqqGd6-QMkEvBUo.js","./index-O937z6z8-MQYCg3Ra.js","./Validation-BvlBtyR--CsEotpSE.js","./index-BUYNV2Id-LfMLnfN8.js","./index-DBbiKKfA-DAV3rS8P.js","./customElement-DYCpmMfo-VQ1OOK1s.js","./input-CCJ2dDrH-Bmrbc5mg.js","./index-CWPudE9o-CcPCdi2s.js","./utils-BV7fKXT2-DTs6dog4.js","./index-CDdEHo-w-DLXd__ol.js","./resources5-CzJkwwvJ-BXQnB_q7.js","./index-CGKRKPuM-BP_QBUri.js","./GridControls-CEUIsZ2n-B7wwA91B.js","./unitFormatUtils-zTNxheG9-C1rTVgUL.js","./ByteSizeUnit-DL8UhsB0-B2-AmVRx.js","./quantityUtils-RaoZoCNH-DBxpP_Oi.js","./projection-m8vi7Cxv-ByA_2Rez.js","./projectVectorToVector-D0K_S4MR-BN7ztR9y.js","./projectPointToVector-CG1hALQu-BoURAVep.js","./automaticLengthMeasurementUtils-BcfJmFU0-BkyAHWFv.js","./vec32-BuqRmYBM-Docn8r6P.js","./MeshTransform-CvTryVbE-CODVsKNr.js","./mat4f64-BaJwL7tQ-k0uMm8LY.js","./quat-D8L_R4I0-CsHvsQG-.js","./mat3f64-Dh9_zhFu-BIT-k8Dm.js","./quatf64-C16JxGFv-BKWK1F8U.js","./axisAngleDegrees-nTnQhoaG-4wogWpSf.js","./meshVertexSpaceUtils-BwEbYR8F-D_1-zksg.js","./MeshLocalVertexSpace-DFCiKNRA-BLWX9O__.js","./SketchViewModel-T2dNp9Tt-LN_5NyI-.js","./UpdatingHandles-DBzjq66S-DFpl8Tb3.js","./GraphicsLayer-GkJJfSu5-BbhDMga4.js","./GraphicsCollection-rAFZo1AJ-sdXgSTo0.js","./Layer-B8q-l4yV-Dsj21cQX.js","./ScaleRangeLayer-DIxukUBC-vVehzNCO.js","./layerContainerType-ChWdCT09-G5sdAsSy.js","./ElevationInfo-DkWlof50-DRCg6lt6.js","./vec2-BnynUbeJ-CKtGJQAy.js","./vec2f64-CEUyUoff-BBc0aQ6D.js","./geodesicUtils-DV-lFWtb-DXiNEbM3.js","./Query-CxQYWcUQ-DdfiJ2tS.js","./Field-Cj6Pz3TI-Ca9WushU.js","./fieldType-VTpxE-EM-CxCafxk5.js","./plane-B_adY3_o-Ns1JnzfT.js","./sphere-Cj20syUS-P9gsXSIi.js","./mat3-DOnW3DjW-C3hbW9XY.js","./a11yUtils-C2ydunC--U3BaqQd2.js","./spatialReferenceEllipsoidUtils-DlQOpWof-8b-0SJHm.js","./geodesicLengthMeasurementUtils-X1SKKkBz-CwYgWama.js","./gridUtils-D2du44-d-B3mxuvuE.js","./normalizeUtils-b-vZURob-A8spekoP.js","./utils-DuaeuwP5-IrMotWQ7.js","./utils-Jw-4AGsF-CezsCFGF.js","./editingTools-KBOXuhog-BisHjdbT.js","./SnappingVisualizer2D-DR-yrbjS-PD1B7NDI.js","./automaticAreaMeasurementUtils-Bz1iefP0-DxDYXAJJ.js","./PointSnappingHint-ClwQ1VNw-D919q5_C.js","./earcut-XDcq3zAf-BcwyrT7l.js","./triangle-BePBrXJ8-BGvt3tv3.js","./lineSegment-BJNfNZM5-RDIZE__8.js","./editPlaneUtils-CYBM1uSC-DxA0f9DH.js","./boundedPlane-B6TkXVHT-y-1QO8ec.js","./ViewingMode-CyR_b1T8-_s7_Gbsk.js","./GraphicManipulator-DXPP3gDs-BScnc98d.js","./drapedUtils-7RfmdK5D-WH2MSmzW.js","./drawUtils-BUIg7AUj-eUYNWEnV.js","./draw-store-C1_quxsr-BJsbni5r.js","./layerViewUtils-Bk5QNiAa-BeVWUaX3.js","./widget-BgluoE6k-KSaIF83b.js","./hydratedFeatures-BDT5zTGB-CvrRwYk-.js","./Scheduler-Br-2v2ys-DaLUn3wq.js","./geometryEngineBase-DueYg7ux-CCeespPx.js","./_commonjsHelpers-BITg13Vk-KnjfkSck.js","./hydrated-Bae3cp-4-BMsgZoRF.js","./utils-C0LvbFCo-RMQaTNpt.js","./TextOverlayItem-pAuO460X-BOmQYLBm.js","./number-ZeBaww6r-ClCKRric.js","./index-KqP5VmvP-CJbxPnIj.js","./index-f5siJR3U-CspUY1f0.js","./ExpandToggle-5J19yLeu-DQOhh0o8.js","./index-DK_RfN06-DIrQYds-.js","./geometryEngineJSON-CGn_tfx8-D3N6SheD.js","./json-BI97KiBB-Ce5cWfI2.js","./index-BxtEfqZ2-DC01DjAE.js","./circle-icon-DrE2wWqh-CCSWTQJL.js","./edit-icon-C_tqZ1EG-pgFx_Q8M.js","./point-icon-BSJft8AI-CVNqAoG-.js","./polygon-icon-BrXtjiJl-Cl48WYuR.js","./polyline-icon-CqjafPK0-CNEbi0ZQ.js","./rectangle-icon-D8mTZj4O-iZbfRzZH.js"])))=>i.map(i=>d[i]);
import{v as r,I as a,cy as S,a as Be,eR as Ks,L as Ce,Q as ee,fY as At,cE as C,ct as ki,cu as Qs,fZ as Js,as as it,f_ as eo,ci as Un,b9 as le,y as to,d6 as ae,T as Gt,ai as R,aC as xe,z as Ri,df as ai,ds as ze,f$ as io,E as Z,a2 as Wn,_ as M,aa as Ee,g0 as no,g1 as so,g2 as oo,b$ as Bt,a1 as jn,r as ro,g3 as Xn,b6 as Yn,cf as qn,g4 as ao,bc as lo,ay as ji,aM as rt,g5 as Kn,g6 as Qn,di as ii,a8 as zt,av as Xi,g7 as co,g8 as po,g9 as Mt,ga as ho,gb as uo,gc as go,gd as mo,fg as yo,co as _o,bf as vo,ge as fo,ce as wo,dr as bo,gf as To,cp as xo,gg as Eo,t as k,af as Mo,gh as fi,gi as So,ca as Co,el as Ht,db as Ii,cc as Po,aG as It,gj as wi,c6 as he,d9 as Jn,D as Vo,fk as Oo,fl as Lo,gk as ko,gl as Ro,fw as cn,fx as Io,fi as es,gm as Do,fo as Ao,fA as Go,fT as zo,cg as $o,gn as Bo,c as Ho,go as Fo,gp as pn,gq as Zo,gr as No,ck as Uo,dn as Wo,dp as jo,dj as Yi,gs as Xo,gt as Yo,gu as qo,ei as Ko,d2 as dn,aE as Qo,gv as Jo,gw as er,fP as tr,gx as ir,eC as Ft,eB as hn,eb as nr,ao as je,gy as sr,gz as bi,gA as Zt,gB as Ti,gC as or}from"./main-DK5A1thH.js";import{y as qi}from"./draw-store-C1_quxsr-BJsbni5r.js";import rr from"./GraphicsLayer-GkJJfSu5-BbhDMga4.js";import"./intl-DLmy-Li5-BP8VBpPh.js";import{I as ar,O as un,S as ni,P as Ki,u as lr,w as ts,K as cr,F as pr,e as is,M as Nt,B as gn,a as bt,W as dr,b as hr,T as ns,c as ss,d as ur,t as os,f as rs,g as gr,v as mr,h as St,s as yr,j as ft,D as vt,_ as as,i as _r,R as vr,r as fr,k as ls,l as wr,m as br}from"./SketchViewModel-T2dNp9Tt-LN_5NyI-.js";import{C as Ve,T as u,m as He,a as Tr,L as $e,c as cs,z as xr}from"./jsxFactory-C5LxVioS-D9YNnBiM.js";import{P as Xe,M as Er,y as mn,S as Mr,h as Qi}from"./globalCss-CFN4F315-BD5UDk6S.js";import{o as qt}from"./layerViewUtils-Bk5QNiAa-BeVWUaX3.js";import{n as Sr,l as yn,a as Cr}from"./widget-BgluoE6k-KSaIF83b.js";import{T as Pr}from"./diffUtils-BSe9IE26-CWVuAUpT.js";import{i as Vr}from"./UpdatingHandles-DBzjq66S-DFpl8Tb3.js";import{l as ps}from"./ViewingMode-CyR_b1T8-_s7_Gbsk.js";import{i as _n,j as Or,P as Lr,z as kr,T as vn,A as Rr,f as ds,d as Ir,O as Dr}from"./vec2-BnynUbeJ-CKtGJQAy.js";import{o as Ye,t as Kt,c as Ar}from"./vec2f64-CEUyUoff-BBc0aQ6D.js";import{k as fn,X as ut,l as gt,N as Di,A as at,y as Qt,Q as wn,P as mt,Y as Ji,W as Ai,_ as yt,g as hs,r as us,B as bn}from"./vec32-BuqRmYBM-Docn8r6P.js";import{A as Gr,p as zr,O as $r}from"./vec42-D8CJyqHG-DnfLTeQH.js";import{o as Br,e as xi,f as Hr}from"./vec4f64-CjUMzAyX-DPYbdAom.js";import{O as si}from"./projection-m8vi7Cxv-ByA_2Rez.js";import{p as Fr}from"./meshVertexSpaceUtils-BwEbYR8F-D_1-zksg.js";import{S as Zr,Q as li}from"./hydratedFeatures-BDT5zTGB-CvrRwYk-.js";import{Q as Tn,r as Nr,B as Ur,O as Ct,C as xn,j as Ei,P as Wr,U as jr,E as Mi,m as Xr}from"./plane-B_adY3_o-Ns1JnzfT.js";import{o as en,i as Yr,t as qr}from"./quantityUtils-RaoZoCNH-DBxpP_Oi.js";import{f as ci,s as tn}from"./projectVectorToVector-D0K_S4MR-BN7ztR9y.js";import{u as Kr,W as Qr}from"./geodesicUtils-DV-lFWtb-DXiNEbM3.js";import{i as gs,S as ms}from"./Scheduler-Br-2v2ys-DaLUn3wq.js";import{G as T}from"./geometryEngineBase-DueYg7ux-CCeespPx.js";import{hydratedAdapter as V}from"./hydrated-Bae3cp-4-BMsgZoRF.js";import{S as Jr}from"./mat2d-BQA-1WB--Pnyy0dhf.js";import{Y as ea,L as ta}from"./quat-D8L_R4I0-CsHvsQG-.js";import{e as En}from"./quatf64-C16JxGFv-BKWK1F8U.js";import{y as ia,x as na}from"./drapedUtils-7RfmdK5D-WH2MSmzW.js";import{n as Mn}from"./utils-C0LvbFCo-RMQaTNpt.js";import{b as Sn}from"./substitute-TfjvVaWd-B_KOR7s3.js";import"./GraphicsCollection-rAFZo1AJ-sdXgSTo0.js";import"./Layer-B8q-l4yV-Dsj21cQX.js";import"./TimeExtent-gZaEUVeW-DaDBMnur.js";import"./ScaleRangeLayer-DIxukUBC-vVehzNCO.js";import"./layerContainerType-ChWdCT09-G5sdAsSy.js";import"./jsonUtils-DzmXEA9_-xcaB5q4V.js";import"./parser-hXQyB-Qx-BrGynOq8.js";import"./mat4f32-CiZjBg9k-CUm34GoR.js";import"./mat4-BFStKTjU-BMLpTkEG.js";import"./common-CYWrYyJl-E8-sukrT.js";import"./ElevationInfo-DkWlof50-DRCg6lt6.js";import"./lengthUtils-wU9RRIqK-CcSgrDlT.js";import"./Query-CxQYWcUQ-DdfiJ2tS.js";import"./Field-Cj6Pz3TI-Ca9WushU.js";import"./fieldType-VTpxE-EM-CxCafxk5.js";import"./sphere-Cj20syUS-P9gsXSIi.js";import"./mat3-DOnW3DjW-C3hbW9XY.js";import"./mat3f64-Dh9_zhFu-BIT-k8Dm.js";import"./uuid-Dj9mdEVg-BaKSCiyT.js";import"./Queue-B8H6jIv7-BD0bPSsY.js";import"./signal-DxzURL18-BUWbVrim.js";import"./Version-BTMwSXf1-W7KhXniF.js";import"./MeshLocalVertexSpace-DFCiKNRA-BLWX9O__.js";import"./mat4f64-BaJwL7tQ-k0uMm8LY.js";import"./projectPointToVector-CG1hALQu-BoURAVep.js";import"./_commonjsHelpers-BITg13Vk-KnjfkSck.js";var Gi;let Re=Gi=class extends ee{constructor(e){super(e),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}initialize(){const e=this.center,t=this.numberOfPoints;if(this.hasZ=e?.hasZ??!1,this.rings.length!==0||!e)return;const i=_o(this.radius,this.radiusUnit,"meters"),n=e.spatialReference;let s,o="geographic";if(n.isWebMercator?o="webMercator":((n.wkid&&vo[n.wkid])!=null||(n.wkt2||n.wkt)&&fo(n.wkt2||n.wkt))&&(o="projected"),this.geodesic){let l;switch(o){case"webMercator":l=wo(e);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":l=e}s=this._createGeodesicCircle(l,i,t),o==="webMercator"&&(s=bo(s))}else{let l;o==="webMercator"||o==="projected"?l=i/To(e.spatialReference):o==="geographic"&&(l=xo(i,"meters",Eo(e.spatialReference).radius)),s=this._createPlanarCircle(e,l,t)}this.spatialReference=s.spatialReference,this.addRing(s.rings[0])}clone(){const{center:e,numberOfPoints:t,radius:i,radiusUnit:n,geodesic:s}=this;return new Gi({center:e?.clone(),numberOfPoints:t,radius:i,radiusUnit:n,geodesic:s})}_createGeodesicCircle(e,t,i){const n=[],s=[e.x,e.y];for(let o=0;o<360;o+=360/i){const l=this.hasZ?[0,0,e.z??0]:[0,0];Qr(l,s,o,t,Gt.WGS84),n.push(l)}return n.push(n[0]),new ee({rings:[n]})}_createPlanarCircle(e,t,i){const n=[],s=2*Math.PI/i;for(let o=0;o<i;++o){const l=s*o,c=[e.x+Math.cos(-l)*t,e.y+Math.sin(-l)*t];this.hasZ&&c.push(e.z??0),n.push(c)}return n.push(n[0]),new ee({spatialReference:e.spatialReference,rings:[n]})}};r([a({type:Z})],Re.prototype,"center",void 0),r([a()],Re.prototype,"geodesic",void 0),r([a()],Re.prototype,"numberOfPoints",void 0),r([a()],Re.prototype,"radius",void 0),r([a()],Re.prototype,"radiusUnit",void 0),Re=Gi=r([k("esri.geometry.Circle")],Re);const sa=Re;function O(e){const t=Array.isArray(e)?e[0].spatialReference:e.spatialReference;return t?Mo(Gt,t):Gt.WGS84}function oa(e){return T.extendedSpatialReferenceInfo(e)}function ra(e,t){return S(e),T.clip(V,O(e),e,t)}function aa(e,t){return S(e),T.cut(V,O(e),e,t)}function la(e,t){return S(e),S(t),T.contains(V,O(e),e,t)}function ca(e,t){return S(e),S(t),T.crosses(V,O(e),e,t)}function ys(e,t,i){return S(e),S(t),T.distance(V,O(e),e,t,i)}function pa(e,t){return S(e),S(t),T.equals(V,O(e),e,t)}function da(e,t){return S(e),S(t),T.intersects(V,O(e),e,t)}function ha(e,t){return S(e),S(t),T.touches(V,O(e),e,t)}function ua(e,t){return S(e),S(t),T.within(V,O(e),e,t)}function ga(e,t){return S(e),S(t),T.disjoint(V,O(e),e,t)}function ma(e,t){return S(e),S(t),T.overlaps(V,O(e),e,t)}function ya(e,t,i){return S(e),S(t),T.relate(V,O(e),e,t,i)}function _a(e){return S(e),T.isSimple(V,O(e),e)}function _s(e){return S(e),T.simplify(V,O(e),e)}function va(e,t=!1){return T.convexHull(V,O(e),e,t)}function fa(e,t){return S(t),T.difference(V,O(e),e,t)}function wa(e,t){return S(t),T.symmetricDifference(V,O(e),e,t)}function ba(e,t){return S(t),T.intersect(V,O(e),e,t)}function Ta(e){return T.union(V,O(e),e)}function xa(e,t,i,n,s,o){return T.offset(V,O(e),e,t,i,n,s,o)}function Ea(e,t,i,n=!1){return T.buffer(V,O(e),e,t,i,n)}function Ma(e,t,i,n,s,o){return T.geodesicBuffer(V,O(e),e,t,i,n,s,o)}function Sa(e,t,i=!0){return S(e),T.nearestCoordinate(V,O(e),e,t,i)}function Ca(e,t){return S(e),T.nearestVertex(V,O(e),e,t)}function Pa(e,t,i,n){return S(e),T.nearestVertices(V,O(e),e,t,i,n)}function nn(e){return"xmin"in e?"center"in e?e.center:null:"x"in e?e:"extent"in e?e.extent?.center??null:null}function Va(e,t,i){if(e==null)throw new wt;const n=e.spatialReference;if((i=i??nn(e))==null)throw new wt;const s=e.constructor.fromJSON(T.rotate(e,t,i));return s.spatialReference=n,s}function Oa(e,t){if(e==null)throw new wt;const i=e.spatialReference;if((t=t??nn(e))==null)throw new wt;const n=e.constructor.fromJSON(T.flipHorizontal(e,t));return n.spatialReference=i,n}function La(e,t){if(e==null)throw new wt;const i=e.spatialReference;if((t=t??nn(e))==null)throw new wt;const n=e.constructor.fromJSON(T.flipVertical(e,t));return n.spatialReference=i,n}function ka(e,t,i,n){return S(e),T.generalize(V,O(e),e,t,i,n)}function Ra(e,t,i){return S(e),T.densify(V,O(e),e,t,i)}function Ia(e,t,i,n=0){return S(e),T.geodesicDensify(V,O(e),e,t,i,n)}function Da(e,t){return S(e),T.planarArea(V,O(e),e,t)}function Aa(e,t){return S(e),T.planarLength(V,O(e),e,t)}function Ga(e,t,i){return S(e),T.geodesicArea(V,O(e),e,t,i)}function za(e,t,i){return S(e),T.geodesicLength(V,O(e),e,t,i)}function $a(e,t){return T.intersectLinesToPoints(V,O(e),e,t)}function Ba(e,t){T.changeDefaultSpatialReferenceTolerance(e,t)}function Ha(e){T.clearDefaultSpatialReferenceTolerance(e)}let wt=class extends Error{constructor(){super("Illegal Argument Exception")}};const Fp=Object.freeze(Object.defineProperty({__proto__:null,buffer:Ea,changeDefaultSpatialReferenceTolerance:Ba,clearDefaultSpatialReferenceTolerance:Ha,clip:ra,contains:la,convexHull:va,crosses:ca,cut:aa,densify:Ra,difference:fa,disjoint:ga,distance:ys,equals:pa,extendedSpatialReferenceInfo:oa,flipHorizontal:Oa,flipVertical:La,generalize:ka,geodesicArea:Ga,geodesicBuffer:Ma,geodesicDensify:Ia,geodesicLength:za,intersect:ba,intersectLinesToPoints:$a,intersects:da,isSimple:_a,nearestCoordinate:Sa,nearestVertex:Ca,nearestVertices:Pa,offset:xa,overlaps:ma,planarArea:Da,planarLength:Aa,relate:ya,rotate:Va,simplify:_s,symmetricDifference:wa,touches:ha,union:Ta,within:ua},Symbol.toStringTag,{value:"Module"}));var z;(function(e){e[e.Z=0]="Z",e[e.M=1]="M"})(z||(z={}));let Fa=class{constructor(e){this.spatialReference=e}createVector(){return this._tag(Ye())}pointToVector(e){return this._tag(Kt(e.x,e.y))}arrayToVector(e){return this._tag(Kt(e[0],e[1]))}vectorToArray(e){return[e[0],e[1]]}pointToArray(e){return[e.x,e.y]}vectorToPoint(e,t=new Z){return t.x=e[0],t.y=e[1],t.z=void 0,t.m=void 0,t.spatialReference=this.spatialReference,t}arrayToPoint(e,t=new Z){return t.x=e[0],t.y=e[1],t.z=void 0,t.m=void 0,t.spatialReference=this.spatialReference,t}vectorToDehydratedPoint(e,t){if(e)return t??={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"},t.x=e[0],t.y=e[1],t.z=void 0,t.m=void 0,t.hasZ=!1,t.hasM=!1,t.spatialReference=this.spatialReference,t}lerp(e,t,i,n){return Rr(n,e,t,i)}addDelta(e,t,i){e[0]+=t,e[1]+=i}distance(e,t){return ds(e,t)}getZ(e,t=void 0){return t}hasZ(){return!1}getM(e,t=void 0){return t}hasM(){return!1}clone(e){return this._tag(Ar(e))}copy(e,t){return Ir(t,e)}fromXYZ(e){return this._tag(Kt(e[0],e[1]))}toXYZ(e,t=C()){return at(t,e[0],e[1],0)}pointToXYZ(e,t=C()){return at(t,e.x,e.y,0)}equals(e,t){return Dr(e,t)}_tag(e){return e}},Cn=class{constructor(e,t){this._valueType=e,this.spatialReference=t}createVector(){return this._tag(C())}pointToVector(e){return this._tag(fi(e.x,e.y,this._valueType===z.Z?e.z:e.m))}arrayToVector(e){return this._tag(fi(e[0],e[1],e[2]||0))}vectorToArray(e){return[e[0],e[1],e[2]]}pointToArray(e){return this._valueType===z.Z?[e.x,e.y,e.z]:[e.x,e.y,e.m]}vectorToPoint(e,t=new Z){return t.x=e[0],t.y=e[1],t.z=this._valueType===z.Z?e[2]:void 0,t.m=this._valueType===z.M?e[2]:void 0,t.spatialReference=this.spatialReference,t}arrayToPoint(e,t=new Z){return t.x=e[0],t.y=e[1],t.z=this._valueType===z.Z?e[2]:void 0,t.m=this._valueType===z.M?e[2]:void 0,t.spatialReference=this.spatialReference,t}vectorToDehydratedPoint(e,t){if(!e)return;t??={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"};const i=this._valueType===z.Z,n=this._valueType===z.M;return t.x=e[0],t.y=e[1],t.z=i?e[2]:void 0,t.m=n?e[2]:void 0,t.hasZ=i,t.hasM=n,t.spatialReference=this.spatialReference,t}lerp(e,t,i,n){return Ji(n,e,t,i)}addDelta(e,t,i,n){e[0]+=t,e[1]+=i,this._valueType===z.Z&&(e[2]+=n)}distance(e,t){return this._valueType===z.Z?hs(e,t):ds(e,t)}getZ(e,t=void 0){return this._valueType===z.Z?e[2]:t}hasZ(){return this._valueType===z.Z}getM(e,t=void 0){return this._valueType===z.M?e[2]:t}hasM(){return this._valueType===z.M}clone(e){return this._tag(So(e))}copy(e,t){return yt(t,e)}fromXYZ(e,t=0,i=0){return this._tag(fi(e[0],e[1],this._valueType===z.Z?e.length>2?e[2]:t:i))}toXYZ(e,t=C()){return at(t,e[0],e[1],this._valueType===z.Z?e[2]:0)}pointToXYZ(e,t=C()){return at(t,e.x,e.y,this._valueType===z.Z?e.z??0:0)}equals(e,t){return Ai(e,t)}_tag(e){return e}},Za=class{constructor(e){this.spatialReference=e}createVector(){return this._tag(Br())}pointToVector(e){return this._tag(xi(e.x,e.y,e.z,e.m))}arrayToVector(e){return this._tag(xi(e[0],e[1],e[2]||0,e[3]||0))}vectorToArray(e){return[e[0],e[1],e[2],e[3]]}pointToArray(e){return[e.x,e.y,e.z,e.m]}vectorToPoint(e,t=new Z){return t.x=e[0],t.y=e[1],t.z=e[2],t.m=e[3],t.spatialReference=this.spatialReference,t}arrayToPoint(e,t=new Z){return t.x=e[0],t.y=e[1],t.z=e[2],t.m=e[3],t.spatialReference=this.spatialReference,t}vectorToDehydratedPoint(e,t){if(e)return t??={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"},t.x=e[0],t.y=e[1],t.z=e[2],t.m=e[3],t.hasZ=!0,t.hasM=!0,t.spatialReference=this.spatialReference,t}lerp(e,t,i,n){return Gr(n,e,t,i)}addDelta(e,t,i,n){e[0]+=t,e[1]+=i,e[2]+=n}distance(e,t){return hs(e,t)}getZ(e){return e[2]}hasZ(){return!0}getM(e){return e[3]}hasM(){return!0}clone(e){return this._tag(Hr(e))}copy(e,t){return zr(t,e)}fromXYZ(e,t=0,i=0){return this._tag(xi(e[0],e[1],e.length>2?e[2]:t,i))}toXYZ(e,t=C()){return at(t,e[0],e[1],e[2])}pointToXYZ(e,t=C()){return at(t,e.x,e.y,e.z??0)}equals(e,t){return $r(e,t)}_tag(e){return e}};function vs(e,t,i){return e&&t?new Za(i):t?new Cn(z.M,i):e?new Cn(z.Z,i):new Fa(i)}function Na(e,t){if(!t.supported)return;let i=1/0,n=-1/0;const s=t.upperBoundX-t.lowerBoundX;e.forEach(l=>{let c=l.pos[0];for(;c<t.lowerBoundX;)c+=s;for(;c>t.upperBoundX;)c-=s;i=Math.min(i,c),n=Math.max(n,c),l.pos[0]=c});const o=n-i;s-o<o&&e.forEach(l=>{l.pos[0]<0&&(l.pos[0]+=s)})}function Ua(e,t){const i=$o(e);return t===ps.Global&&i?{supported:!0,lowerBoundX:i.valid[0],upperBoundX:i.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}}let $t=class{constructor(e){this.component=e,this.leftEdge=null,this.rightEdge=null,this.type="vertex",this.index=null}get pos(){return this._pos}set pos(e){this._pos=e,this.component.unnormalizeVertexPositions()}},Pe=class{constructor(e,t,i){this.component=e,this.leftVertex=t,this.rightVertex=i,this.type="edge",t.rightEdge=this,i.leftEdge=this}},pi=class{constructor(e,t){this._spatialReference=e,this._viewingMode=t,this.vertices=[],this.edges=[],this.index=null}unnormalizeVertexPositions(){this.vertices.length<=1||Na(this.vertices,Ua(this._spatialReference,this._viewingMode))}updateVertexIndex(e,t){if(this.vertices.length===0)return;const i=this.vertices[0];let n=null,s=e,o=t;do n=s,n.index=o++,s=n.rightEdge?n.rightEdge.rightVertex:null;while(s!=null&&s!==i);n.leftEdge&&n!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(n),this.vertices.length-1)}getFirstVertex(){return this.vertices.at(0)}getLastVertex(){return this.vertices.at(-1)}isClosed(){return this.vertices.length>2&&this.vertices[0].leftEdge!==null}swapVertices(e,t){const i=this.vertices[e];this.vertices[e]=this.vertices[t],this.vertices[t]=i}iterateVertices(e){if(this.vertices.length===0)return;const t=this.vertices[0];let i=t;do e(i,i.index),i=i.rightEdge!=null?i.rightEdge.rightVertex:null;while(i!==t&&i!=null)}},zi=class fs extends Be{constructor(t,i){super(),this.type=t,this.coordinateHelper=i,this._geometry=null,this._dirty=!0,this.components=[]}get geometry(){if(this._dirty){switch(this.type){case"point":this._geometry=this._toPoint();break;case"polyline":this._geometry=this._toPolyline();break;case"polygon":this._geometry=this._toPolygon();break;case"mesh":break;default:Ks(this.type)}this._dirty=!1}return this._geometry}get spatialReference(){return this.coordinateHelper.spatialReference}get allVertices(){return Array.from(this.iterateVertices())}*iterateVertices(){for(const t of this.components)for(const i of t.vertices)yield i}notifyChanges(t){this._dirty=!0,this.emit("change",t)}_toPoint(){return this.components.length===0||this.components[0].vertices.length===0?null:this.coordinateHelper.vectorToPoint(this.components[0].vertices[0].pos)}_toPolyline(){const t=[],i=this.coordinateHelper.vectorToArray;for(const n of this.components){if(n.vertices.length<1)continue;const s=[];let o=n.vertices.find(c=>c.leftEdge==null);const l=o;do s.push(i(o.pos)),o=o.rightEdge?o.rightEdge.rightVertex:null;while(o&&o!==l);t.push(s)}return new Ce({paths:t,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}_toPolygon(){const t=[],i=this.coordinateHelper.vectorToArray;for(const n of this.components){if(n.vertices.length<1)continue;const s=[],o=n.vertices[0];let l=o;const c=l;do s.push(i(l.pos)),l=l.rightEdge!=null?l.rightEdge.rightVertex:null;while(l&&l!==c);n.isClosed()&&s.push(i(o.pos)),t.push(s)}return new ee({rings:t,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}static fromGeometry(t,i){const n=t.spatialReference,s=vs(t.hasZ,t.hasM,n),o=new fs(t.type,s);switch(t.type){case"polygon":Wa(o,t,i);break;case"polyline":ja(o,t,i);break;case"point":Pn(o,t,i);break;case"mesh":Pn(o,t.origin,i),o._geometry=t,o._dirty=!1}return o}};function Wa(e,t,i){const n=t.spatialReference,s=e.coordinateHelper,o=t.rings;for(let l=0;l<o.length;++l){const c=o[l],p=new pi(n,i);p.index=l;const d=c.length>2&&At(c[0],c[c.length-1]),h=d?c.length-1:c.length;for(let y=0;y<h;++y){const _=s.arrayToVector(c[y]),P=new $t(p);p.vertices.push(P),P.pos=_,P.index=y}const g=p.vertices.length-1;for(let y=0;y<g;++y){const _=p.vertices[y],P=p.vertices[y+1],f=new Pe(p,_,P);p.edges.push(f)}if(d){const y=new Pe(p,p.vertices[p.vertices.length-1],p.vertices[0]);p.edges.push(y)}e.components.push(p)}}function ja(e,t,i){const n=t.spatialReference,s=e.coordinateHelper,o=t.paths;for(let l=0;l<o.length;++l){const c=o[l],p=new pi(n,i);p.index=l;const d=c.length;for(let g=0;g<d;++g){const y=s.arrayToVector(c[g]),_=new $t(p);p.vertices.push(_),_.pos=y,_.index=g}const h=p.vertices.length-1;for(let g=0;g<h;++g){const y=p.vertices[g],_=p.vertices[g+1],P=new Pe(p,y,_);p.edges.push(P)}e.components.push(p)}}function Pn(e,t,i){const n=t.spatialReference,s=e.coordinateHelper,o=new pi(n,i);o.index=0;const l=new $t(o);l.index=0,l.pos=s.pointToVector(t),o.vertices.push(l),e.components.push(o)}function Pt(e){return e.type==="mesh"}var J;(function(e){e[e.NEW_STEP=0]="NEW_STEP",e[e.ACCUMULATE_STEPS=1]="ACCUMULATE_STEPS"})(J||(J={}));let Xa=class{constructor(e,t,i){this._editGeometry=e,this._component=t,this._pos=i,this._addedVertex=null,this._originalEdge=null,this._left=null,this._right=null}apply(){let e="redo";this._addedVertex==null&&(e="apply",this._addedVertex=new $t(this._component));const t=this._component.getLastVertex();if(t==null)this._component.vertices.push(this._addedVertex),this._addedVertex.pos=this._pos,this._addedVertex.index=0;else{let i=null;t.rightEdge&&(this._originalEdge=t.rightEdge,i=this._originalEdge.rightVertex,this._component.edges.splice(this._component.edges.indexOf(this._originalEdge),1)),this._component.vertices.push(this._addedVertex),this._addedVertex.pos=this._pos,this._left==null&&(this._left=new Pe(this._component,t,this._addedVertex)),this._component.edges.push(this._left),t.rightEdge=this._left,this._originalEdge!=null&&i!=null&&(this._right==null&&(this._right=new Pe(this._component,this._addedVertex,i)),this._component.edges.push(this._right),i.leftEdge=this._right),this._component.updateVertexIndex(this._addedVertex,t.index+1)}this._editGeometry.notifyChanges({operation:e,addedVertices:[this._addedVertex]})}undo(){this._addedVertex!=null&&(this._component.vertices.splice(this._component.vertices.indexOf(this._addedVertex),1),this._left!=null&&(this._component.edges.splice(this._component.edges.indexOf(this._left),1),this._left.leftVertex.rightEdge=null),this._right!=null&&(this._component.edges.splice(this._component.edges.indexOf(this._right),1),this._right.rightVertex.leftEdge=null),this._originalEdge!=null&&(this._component.edges.push(this._originalEdge),this._originalEdge.leftVertex.rightEdge=this._originalEdge,this._originalEdge.rightVertex.leftEdge=this._originalEdge),this._left!=null?this._component.updateVertexIndex(this._left.leftVertex,this._left.leftVertex.index):this._component.updateVertexIndex(this._addedVertex,0),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this._addedVertex]}))}accumulate(){return!1}},Ya=class ws{constructor(t,i,n){this._editGeometry=t,this._vertices=i,this.operation=n,this._undone=!1}_notifyChanges(t){this._editGeometry.components.forEach(i=>i.unnormalizeVertexPositions()),this._editGeometry.notifyChanges({operation:t,updatedVertices:this._vertices})}apply(){this._vertices.forEach(t=>this.operation.apply(t)),this._notifyChanges(this._undone?"redo":"apply")}undo(){this._vertices.forEach(t=>this.operation.undo(t)),this._undone=!0,this._notifyChanges("undo")}canAccumulate(t){if(this._undone||t._vertices.length!==this._vertices.length)return!1;for(let i=0;i<t._vertices.length;++i)if(t._vertices[i]!==this._vertices[i])return!1;return this.operation.canAccumulate(t.operation)}accumulate(t){return!!(t instanceof ws&&this.canAccumulate(t))&&(this._vertices.forEach(i=>this.operation.accumulate(i,t.operation)),this.operation.accumulateParams(t.operation),this._notifyChanges("apply"),!0)}};var ue;(function(e){e[e.CUMULATIVE=0]="CUMULATIVE",e[e.REPLACE=1]="REPLACE"})(ue||(ue={}));let qa=class{constructor(e,t,i=0){this._editGeometry=e,this._vertices=t,this._minNumberOfVertices=i,this.removedVertices=null}apply(){let e="redo";if(this.removedVertices==null){const t=this.removedVertices=[];this._vertices.forEach(i=>{const n=this._removeVertex(i);n!=null&&t.push(n)}),e="apply"}else this.removedVertices.forEach(t=>{this._removeVertex(t.removedVertex)});this._editGeometry.notifyChanges({operation:e,removedVertices:this._vertices})}undo(){this.removedVertices?.forEach(e=>{this._undoRemoveVertex(e)}),this._editGeometry.notifyChanges({operation:"undo",addedVertices:this._vertices})}accumulate(){return!1}_removeVertex(e){const t=e.component;if(t.vertices.length<=this._minNumberOfVertices)return null;const i={removedVertex:e,createdEdge:null},n=e.leftEdge,s=e.rightEdge;return t.vertices.splice(t.vertices.indexOf(e),1),n&&(t.edges.splice(t.edges.indexOf(n),1),n.leftVertex.rightEdge=null),s&&(t.edges.splice(t.edges.indexOf(s),1),s.rightVertex.leftEdge=null),e.index===0&&s&&this._vertices.length>0&&t.swapVertices(t.vertices.indexOf(s.rightVertex),0),n&&s&&(i.createdEdge=new Pe(t,n.leftVertex,s.rightVertex),t.edges.push(i.createdEdge)),s&&t.updateVertexIndex(s.rightVertex,s.rightVertex.index-1),i}_undoRemoveVertex(e){const t=e.removedVertex,i=e.removedVertex.component,n=t.leftEdge,s=t.rightEdge;e.createdEdge&&i.edges.splice(i.edges.indexOf(e.createdEdge),1),i.vertices.push(t),n&&(i.edges.push(n),n.leftVertex.rightEdge=n),s&&(i.edges.push(s),s.rightVertex.leftEdge=s),i.updateVertexIndex(t,t.index)}},Ka=class{constructor(e,t,i){this._editGeometry=e,this._edge=t,this._t=i,this.createdVertex=null,this._left=null,this._right=null}apply(){let e="redo";const t=this._edge,i=t.component,n=t.leftVertex,s=t.rightVertex;i.edges.splice(i.edges.indexOf(t),1),this.createdVertex==null&&(e="apply",this.createdVertex=new $t(t.component)),i.vertices.push(this.createdVertex),this.createdVertex.pos=this._editGeometry.coordinateHelper.lerp(t.leftVertex.pos,t.rightVertex.pos,this._t,this._editGeometry.coordinateHelper.createVector()),this._left==null&&(this._left=new Pe(i,n,this.createdVertex)),this._left.leftVertex.leftEdge?i.edges.push(this._left):i.edges.unshift(this._left),n.rightEdge=this._left,this._right==null&&(this._right=new Pe(i,this.createdVertex,s)),i.edges.push(this._right),s.leftEdge=this._right,i.updateVertexIndex(this.createdVertex,n.index+1),this._editGeometry.notifyChanges({operation:e,addedVertices:[this.createdVertex]})}undo(){if(this.createdVertex==null||this._left==null||this._right==null)return null;const e=this._edge,t=e.component,i=this.createdVertex.leftEdge,n=this.createdVertex.rightEdge,s=i?.leftVertex,o=n?.rightVertex;t.vertices.splice(t.vertices.indexOf(this.createdVertex),1),t.edges.splice(t.edges.indexOf(this._left),1),t.edges.splice(t.edges.indexOf(this._right),1),this._edge.leftVertex.leftEdge?t.edges.push(this._edge):t.edges.unshift(this._edge),s&&(s.rightEdge=e),o&&(o.leftEdge=e),s&&t.updateVertexIndex(s,s.index),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this.createdVertex]})}accumulate(){return!1}},Qa=class bs{constructor(t,i,n){this._editGeometry=t,this._vertex=i,this._pos=n}apply(){const t=this._originalPosition==null;t&&(this._originalPosition=this._vertex.pos),this._apply(t?"apply":"redo")}undo(){this._vertex.pos=this._originalPosition,this._editGeometry.notifyChanges({operation:"undo",updatedVertices:[this._vertex]})}accumulate(t){return t instanceof bs&&t._vertex===this._vertex&&(this._pos=t._pos,this._apply("apply"),!0)}_apply(t){this._vertex.pos=this._pos,this._editGeometry.components.forEach(i=>i.unnormalizeVertexPositions()),this._editGeometry.notifyChanges({operation:t,updatedVertices:[this._vertex]})}},Ja=class{constructor(e,t){this._editGeometry=e,this._component=t,this._createdEdge=null}apply(){let e="redo";if(this._createdEdge==null){e="apply";const t=this._component.getFirstVertex(),i=this._component.getLastVertex();if(this._component.isClosed()||this._component.vertices.length<3||t==null||i==null)return;this._createdEdge=new Pe(this._component,i,t)}this._createdEdge.leftVertex.rightEdge=this._createdEdge,this._createdEdge.rightVertex.leftEdge=this._createdEdge,this._component.edges.push(this._createdEdge),this._editGeometry.notifyChanges({operation:e})}undo(){this._createdEdge!=null&&(Co(this._component.edges,this._createdEdge),this._createdEdge.leftVertex.rightEdge=null,this._createdEdge.rightVertex.leftEdge=null,this._editGeometry.notifyChanges({operation:"undo"}))}accumulate(){return!1}},Vn=class Ts{constructor(t,i,n,s){this._editGeometry=t,this.dx=i,this.dy=n,this.dz=s,this._firstTime=!0}apply(){const t=this._firstTime?"apply":"redo";this._firstTime=!1,this._apply(t,this.dx,this.dy,this.dz)}undo(){this._apply("undo",-this.dx,-this.dy,-this.dz)}accumulate(t){const i=this._editGeometry.geometry;return t instanceof Ts&&t._editGeometry.geometry===i&&(this._apply("apply",t.dx,t.dy,t.dz),this.dx+=t.dx,this.dy+=t.dy,this.dz+=t.dz,!0)}_apply(t,i,n,s){const o=this._editGeometry.geometry;o.offset(i,n,s);const l=this._editGeometry.components[0].getFirstVertex();if(!l)return;const c=this._editGeometry.coordinateHelper;l.pos=c.pointToVector(o.origin),this._editGeometry.notifyChanges({operation:t,updatedVertices:[l]})}},el=class xs{constructor(t,i,n,s){this._helper=t,this.dx=i,this.dy=n,this.dz=s}_move(t,i,n,s){this._helper.addDelta(t.pos,i,n,s)}apply(t){this._move(t,this.dx,this.dy,this.dz)}undo(t){this._move(t,-this.dx,-this.dy,-this.dz)}canAccumulate(t){return t instanceof xs}accumulate(t,i){this._move(t,i.dx,i.dy,i.dz)}accumulateParams(t){this.dx+=t.dx,this.dy+=t.dy,this.dz+=t.dz}},tl=class $i{get plane(){return this._plane}get requiresSplitEdgeLeft(){return!this._left.isOriginalDirection}get requiresSplitEdgeRight(){return!this._right.isOriginalDirection}get edgeDirection(){return this._edgeDirection}constructor(t,i,n,s=0,o=Dt.IMMEDIATE){this._helper=t,this._planeType=i,this._edge=n,this.distance=s,this._plane=Tn(),this._offsetPlane=Tn(),this._minDistance=-1/0,this._maxDistance=1/0,this._selectedArrow=1,o===Dt.IMMEDIATE&&this._initialize()}_initialize(){this._initializeNeighbors(),this._initializePlane(),this._initializeDistanceConstraints()}_initializeNeighbors(){const t=this._toXYZ(this._edge.leftVertex.pos),i=this._toXYZ(this._edge.leftVertex.leftEdge?.leftVertex?.pos),n=this._toXYZ(this._edge.rightVertex.pos),s=this._toXYZ(this._edge.rightVertex.rightEdge?.rightVertex?.pos);this._edgeDirection=fn(C(),t,n),i?(this._left=this._computeNeighbor(t,i,this._edgeDirection),this._right=this._computeNeighbor(n,s,this._edgeDirection,this._left)):(this._right=this._computeNeighbor(n,s,this._edgeDirection),this._left=this._computeNeighbor(t,i,this._edgeDirection,this._right))}_toXYZ(t){return t!=null?this._helper.toXYZ(t):null}_pointToXYZ(t){return this._toXYZ(this._helper.pointToVector(t))}_computeNeighbor(t,i,n,s){const o=C();if(i){fn(o,t,i);const l=!this._passesBisectingAngleThreshold(o,n);return{start:t,end:i,direction:l?this._bisectVectorsPerpendicular(n,o):o,isOriginalDirection:!l}}return this._helper.hasZ()?s&&(ut(o,n,s.direction),ut(o,o,n),gt(o,o),Math.sign(o[1])!==Math.sign(n[0])&&Di(o,o,-1)):at(o,-n[1],n[0],0),{start:t,end:i,direction:o,isOriginalDirection:!0}}_passesBisectingAngleThreshold(t,i){const n=Math.abs(Nr(i,t));return n>=On&&n<=Math.PI-On}_bisectVectorsPerpendicular(t,i){const n=Qt(t,i)<0?t:wn(C(),t),s=Math.abs(Qt(n,i));if(!(s<Ln||s>1-Ln))return this._bisectDirection(n,i);const o=ut(C(),n,[0,0,1]);return gt(o,o)}_bisectDirection(t,i){const n=mt(C(),t,i);return gt(n,n)}_initializePlane(){const t=this._computeNormalDirection(this._left),i=this._computeNormalDirection(this._right);Qt(t,i)<0&&wn(i,i),Ur(this._left.start,this._bisectDirection(t,i),this._plane)}_computeNormalDirection(t){const i=ut(C(),t.direction,this._edgeDirection);gt(i,i);const n=ut(C(),this._edgeDirection,i);return this._planeType===Bi.XY&&(n[2]=0),gt(n,n)}_initializeDistanceConstraints(){this._left.end==null||this.requiresSplitEdgeLeft||this._updateDistanceConstraint(Ct(this._plane,this._left.end)),this._right.end==null||this.requiresSplitEdgeRight||this._updateDistanceConstraint(Ct(this._plane,this._right.end)),this._updateIntersectDistanceConstraint(this._plane)}_updateDistanceConstraint(t){t<=0&&(this._minDistance=Math.max(this._minDistance,t)),t>=0&&(this._maxDistance=Math.min(this._maxDistance,t))}_updateIntersectDistanceConstraint(t){const i=Mi(t),n=this._edgeDirection,s=mt(C(),this._left.start,this._left.direction),o=mt(C(),this._right.start,this._right.direction),l=this._pointInBasis2D(Ye(),i,n,this._left.start),c=this._pointInBasis2D(Ye(),i,n,s),p=this._pointInBasis2D(Ye(),i,n,this._right.start),d=this._pointInBasis2D(Ye(),i,n,o),[h]=ar({start:c,end:l,type:un.LINE},{start:d,end:p,type:un.LINE});if(!h)return;const g=_n(Ye(),l,c);Or(g,g);const y=_n(Ye(),h,c),_=Lr(g,y),P=mt(C(),s,Di(C(),this._left.direction,-_)),f=Ct(t,P);this._updateDistanceConstraint(f)}_pointInBasis2D(t,i,n,s){return t[0]=xn(i,s),t[1]=xn(n,s),t}_offset(t,i){Number.isFinite(this._minDistance)&&(i=Math.max(this._minDistance,i)),Number.isFinite(this._maxDistance)&&(i=Math.min(this._maxDistance,i)),Ei(this._offsetPlane,this._plane),this._offsetPlane[3]-=i;const n=(o,l,c)=>l!=null&&Xr(this._offsetPlane,o,mt(C(),o,l),c),s=C();(t===this._edge.leftVertex?n(this._left.start,this._left.direction,s):n(this._right.start,this._right.direction,s))&&this._helper.copy(this._helper.fromXYZ(s,void 0,this._helper.getM(t.pos)),t.pos)}selectArrowFromStartPoint(t){this._selectedArrow=Wr(this.plane,this._pointToXYZ(t))?1:-1}get selectedArrow(){return this._selectedArrow}signedDistanceToPoint(t){return Ct(this.plane,this._pointToXYZ(t))}clampedStartAndEnd(t){const i=this._helper.toXYZ(this._helper.pointToVector(t)),n=jr(this._plane,i,C()),s=Ct(this._plane,i),o=ki(s,this._minDistance,this._maxDistance);return Ji(i,n,i,o/s),{start:n,end:i}}apply(t){this._offset(t,this.distance)}undo(t){this._offset(t,0)}canAccumulate(t){return t instanceof $i&&this._edge.leftVertex.index===t._edge.leftVertex.index&&this._edge.rightVertex.index===t._edge.rightVertex.index&&this._edge.component===t._edge.component&&this._maybeEqualsVec3(this._left.direction,t._left.direction)&&this._maybeEqualsVec3(this._right.direction,t._right.direction)&&Ai(Mi(this._plane),Mi(t._plane))}accumulate(t,i){const n=this._plane[3]-i._plane[3]+i.distance;this._offset(t,n)}accumulateParams(t){const i=t.distance-t._plane[3];this.distance=i+this._plane[3]}clone(){const t=new $i(this._helper,this._planeType,this._edge,this.distance,Dt.DEFERRED);return Ei(t._plane,this._plane),Ei(t._offsetPlane,this._offsetPlane),t._maxDistance=this._maxDistance,t._minDistance=this._minDistance,t._left=this._cloneNeighbor(this._left),t._right=this._cloneNeighbor(this._right),t._edgeDirection=yt(C(),this._edgeDirection),t}_maybeEqualsVec3(t,i){return t==null&&i==null||t!=null&&i!=null&&Ai(t,i)}_cloneNeighbor({start:t,end:i,direction:n,isOriginalDirection:s}){return{start:yt(C(),t),end:i!=null?yt(C(),i):null,direction:yt(C(),n),isOriginalDirection:s}}};const On=Qs(15),Ln=.001;var Bi,Dt;(function(e){e[e.XYZ=0]="XYZ",e[e.XY=1]="XY"})(Bi||(Bi={})),function(e){e[e.IMMEDIATE=0]="IMMEDIATE",e[e.DEFERRED=1]="DEFERRED"}(Dt||(Dt={}));let il=class Es{constructor(t,i,n=ue.CUMULATIVE){this.origin=t,this.angle=i,this._accumulationType=n}_rotate(t,i){kr(t.pos,t.pos,this.origin,i)}apply(t){this._rotate(t,this.angle)}undo(t){this._rotate(t,-this.angle)}canAccumulate(t){return t instanceof Es&&At(this.origin,t.origin)}accumulate(t,i){const n=i._accumulationType===ue.REPLACE;this._rotate(t,n?i.angle-this.angle:i.angle)}accumulateParams(t){const i=t._accumulationType===ue.REPLACE;this.angle=i?t.angle:this.angle+t.angle}},nl=class Ms{constructor(t,i,n,s,o=ue.CUMULATIVE){this.origin=t,this.axis1=i,this.factor1=n,this.factor2=s,this._accumulationType=o,this.axis2=Kt(i[1],-i[0])}_scale(t,i,n){vn(t.pos,t.pos,this.origin,this.axis1,i),vn(t.pos,t.pos,this.origin,this.axis2,n)}apply(t){this._scale(t,this.factor1,this.factor2)}undo(t){this._scale(t,1/this.factor1,1/this.factor2)}canAccumulate(t){return t instanceof Ms&&At(this.origin,t.origin)&&At(this.axis1,t.axis1)}accumulate(t,i){i._accumulationType===ue.REPLACE?this._scale(t,i.factor1/this.factor1,i.factor2/this.factor2):this._scale(t,i.factor1,i.factor2)}accumulateParams(t){const i=t._accumulationType===ue.REPLACE;this.factor1=i?t.factor1:this.factor1*t.factor1,this.factor2=i?t.factor2:this.factor2*t.factor2}},sl=class Ss{constructor(t,i){this._editGeometry=t,this._newPositions=i}apply(){const t=this._originalPositions==null?"apply":"redo";if(!this._originalPositions){const i=this._editGeometry.coordinateHelper;this._originalPositions=this._editGeometry.allVertices.map(n=>i.clone(n.pos))}this._apply(t,this._newPositions)}undo(){this._originalPositions&&this._apply("undo",this._originalPositions)}accumulate(t){return t instanceof Ss&&(this._newPositions=t._newPositions,this._apply("apply",this._newPositions),!0)}_apply(t,i){const n=this._editGeometry.coordinateHelper,s=this._editGeometry.allVertices;for(let o=0;o<s.length;o++)n.copy(i[o],s[o].pos);this._editGeometry.components.forEach(o=>o.unnormalizeVertexPositions()),this._editGeometry.notifyChanges({operation:t,updatedVertices:s})}};var Cs;const ol=Symbol();let rl=class{constructor(e){this._operations=[],this._closed=!1,this[Cs]=!0,e&&(this._operations=e,this._closed=!0)}close(){this._closed=!0}apply(){for(const e of this._operations)e.apply()}undo(){for(let e=this._operations.length-1;e>=0;e--)this._operations[e].undo()}accumulate(e){if(this._closed)return!1;const t=this._operations.length?this._operations[this._operations.length-1]:null;return t&&t.accumulate(e)||(this._operations.push(e),e.apply()),!0}};Cs=ol;let Hi=class Ps extends Be{constructor(t,i){super(),this.data=t,this.viewingMode=i,this._undoStack=[],this._redoStack=[],this._listener=this.data.on("change",n=>{n.addedVertices&&this.emit("vertex-add",{type:"vertex-add",vertices:n.addedVertices,operation:n.operation}),n.removedVertices&&this.emit("vertex-remove",{type:"vertex-remove",vertices:n.removedVertices,operation:n.operation}),n.updatedVertices&&this.emit("vertex-update",{type:"vertex-update",vertices:n.updatedVertices,operation:n.operation})})}destroy(){this._listener.remove()}splitEdge(t,i){return this._apply(new Ka(this.data,t,i))}updateVertices(t,i,n=J.ACCUMULATE_STEPS){return this._apply(new Ya(this.data,t,i),n)}move(t,i,n,s=J.ACCUMULATE_STEPS){return Pt(this.data)?this._apply(new Vn(this.data,t,i,n),s):this.moveVertices(this.data.allVertices,t,i,n,s)}moveVertices(t,i,n,s,o=J.ACCUMULATE_STEPS){return Pt(this.data)?this._apply(new Vn(this.data,i,n,s),o):this.updateVertices(t,new el(this.data.coordinateHelper,i,n,s),o)}scale(t,i,n,s,o=J.ACCUMULATE_STEPS,l=ue.CUMULATIVE){return this.scaleVertices(this.data.allVertices,t,i,n,s,o,l)}scaleVertices(t,i,n,s,o,l=J.ACCUMULATE_STEPS,c=ue.CUMULATIVE){return this.updateVertices(t,new nl(i,n,s,o,c),l)}rotate(t,i,n=J.ACCUMULATE_STEPS,s=ue.CUMULATIVE){return this.rotateVertices(this.data.allVertices,t,i,n,s)}rotateVertices(t,i,n,s=J.ACCUMULATE_STEPS,o=ue.CUMULATIVE){return this.updateVertices(t,new il(i,n,o),s)}removeVertices(t){return this._apply(new qa(this.data,t,this._minNumVerticesPerType))}appendVertex(t){return this.data.components.length===0?null:this._apply(new Xa(this.data,this.data.components[0],t))}setVertexPosition(t,i){return this._apply(new Qa(this.data,t,i))}offsetEdge(t,i,n,s=J.ACCUMULATE_STEPS){return this.updateVertices([i.leftVertex,i.rightVertex],new tl(this.data.coordinateHelper,t,i,n),s)}trySetGeometry(t,i=J.ACCUMULATE_STEPS){const{data:n}=this,{coordinateHelper:s}=n;if(n.type!==t.type||!n.spatialReference.equals(t.spatialReference)||s.hasZ()!==t.hasZ||s.hasM()!==t.hasM||!Js(n.geometry,t)||Pt(n))return;const o=Array.from(zi.fromGeometry(t,this.viewingMode).iterateVertices(),l=>l.pos);return this.setVertexPositions(o,i)}setVertexPositions(t,i=J.ACCUMULATE_STEPS){return this._apply(new sl(this.data,t),i)}createResetState(){if(Pt(this.data))return this._createResetStateMesh();const t=this.data.geometry.clone();return it(()=>this.trySetGeometry(t))}closeComponent(t){return this.data.components.includes(t)?this._apply(new Ja(this.data,t)):null}canRemoveVertex(t){return t.vertices.length>this._minNumVerticesPerType}createUndoGroup(){const t=new rl;return this._apply(t),it(()=>t.close())}undo(){if(this._undoStack.length>0){const t=this._undoStack.pop();return t.undo(),this._redoStack.push(t),t}return null}redo(){if(this._redoStack.length>0){const t=this._redoStack.pop();return t.apply(),this._undoStack.push(t),t}return null}get canUndo(){return this._undoStack.length>0}get canRedo(){return this._redoStack.length>0}get lastOperation(){return this._undoStack.length>0?this._undoStack[this._undoStack.length-1]:null}get _minNumVerticesPerType(){switch(this.data.type){case"point":return 1;case"polyline":return 2;case"polygon":return 3;default:return 0}}_apply(t,i=J.ACCUMULATE_STEPS){return i!==J.NEW_STEP&&this.lastOperation!=null&&this.lastOperation.accumulate(t)||(t.apply(),this._undoStack.push(t),this._redoStack=[]),t}_createResetStateMesh(){if(!Pt(this.data))return it();const t=this.data.geometry,{vertexSpace:i}=t;if(i.origin){const s=eo(i.origin);return it(()=>{t.vertexSpace.origin=s})}const n=t.vertexAttributes.clonePositional();return it(()=>{t.vertexAttributes=n,t.vertexAttributesChanged()})}static fromGeometry(t,i){return new Ps(zi.fromGeometry(t,i),i)}};function Jt(e,t){return e===t||e!=null&&t!=null&&Un(e.spatialReference,t.spatialReference)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.m===t.m}function Si(e,t,i){return e===t||e!=null&&t!=null&&Un(e.spatialReference,t.spatialReference)&&Ht(e.x,t.x,i)&&Ht(e.y,t.y,i)&&Ht(e.z??0,t.z??0,i)&&Ht(e.m??0,t.m??0,i)}var nt;(function(e){e[e.WhenToolEditable=0]="WhenToolEditable",e[e.WhenToolNotEditable=1]="WhenToolNotEditable",e[e.Always=2]="Always"})(nt||(nt={}));let al=class{constructor(){this._isToolEditable=!0,this._manipulators=new Ee,this._resourceContexts={manipulator3D:{}},this._attached=!1}set isToolEditable(e){this._isToolEditable=e}get length(){return this._manipulators.length}add(e,t=nt.WhenToolEditable){this.addMany([e],t)}addMany(e,t=nt.WhenToolEditable){for(const i of e){const n={manipulator:i,visibilityPredicate:t,attached:!1};this._manipulators.add(n),this._attached&&this._updateManipulatorAttachment(n)}}remove(e){for(let t=0;t<this._manipulators.length;t++)if(this._manipulators.at(t).manipulator===e){const i=this._manipulators.splice(t,1)[0];this._detachManipulator(i);break}}removeAll(){this._manipulators.forEach(e=>{this._detachManipulator(e)}),this._manipulators.removeAll()}attach(){this._manipulators.forEach(e=>{this._updateManipulatorAttachment(e)}),this._attached=!0}detach(){this._manipulators.forEach(e=>{this._detachManipulator(e)}),this._attached=!1}destroy(){this.detach(),this._manipulators.forEach(({manipulator:e})=>e.destroy()),this._manipulators.destroy(),this._resourceContexts=null}on(e,t){return this._manipulators.on(e,i=>{t(i)})}forEach(e){for(const t of this._manipulators.items)e(t)}some(e){return this._manipulators.items.some(e)}toArray(){const e=[];return this.forEach(t=>e.push(t.manipulator)),e}intersect(e,t){let i=null,n=Number.MAX_VALUE;return this._manipulators.forEach(({manipulator:s,attached:o})=>{if(!o||!s.interactive)return;const l=s.intersectionDistance(e,t);l!=null&&l<n&&(n=l,i=s)}),i}_updateManipulatorAttachment(e){this._isManipulatorItemVisible(e)?this._attachManipulator(e):this._detachManipulator(e)}_attachManipulator(e){e.attached||(e.manipulator.attach&&e.manipulator.attach(this._resourceContexts),e.attached=!0)}_detachManipulator(e){if(!e.attached)return;const t=e.manipulator;t.grabbing=!1,t.dragging=!1,t.hovering=!1,t.selected=!1,t.detach&&t.detach(this._resourceContexts),e.attached=!1}_isManipulatorItemVisible(e){return e.visibilityPredicate===nt.Always||(this._isToolEditable?e.visibilityPredicate===nt.WhenToolEditable:e.visibilityPredicate===nt.WhenToolNotEditable)}},j=class extends le{constructor(e){super(e),this.manipulators=new al,this.automaticManipulatorSelection=!0,this.hasGrabbedManipulators=!1,this.hasHoveredManipulators=!1,this.firstGrabbedManipulator=null,this.created=!1,this.removeIncompleteOnCancel=!0,this._editableFlags=new Map([[Xe.MANAGER,!0],[Xe.USER,!0]]),this._creationFinishedResolver=to()}get active(){return this.view!=null&&this.view.activeTool===this}set visible(e){this._get("visible")!==e&&(this._set("visible",e),this._syncVisible())}get editable(){return this.getEditableFlag(Xe.USER)}set editable(e){this.setEditableFlag(Xe.USER,e)}get updating(){return!1}get cursor(){return null}get hasFocusedManipulators(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}destroy(){this.manipulators.destroy(),this._set("view",null)}onAdd(){this._syncVisible()}activate(){this.view!=null&&(this.view.focus(),this.onActivate())}deactivate(){this.onDeactivate()}handleInputEvent(e){this.onInputEvent(e)}handleInputEventAfter(e){this.onInputEventAfter(e)}setEditableFlag(e,t){this._editableFlags.set(e,t),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),e===Xe.USER&&this.notifyChange("editable"),this.onEditableChange(),this.onManipulatorSelectionChanged()}getEditableFlag(e){return this._editableFlags.get(e)??!1}endDrag(){const e=this.view.inputManager.latestPointerLocation;if(!e)return;let t=!1;this.manipulators.forEach(({manipulator:i})=>{i.dragging&&(t=!0,i.events.emit("drag",{action:"end",start:e,screenPoint:e}))}),t&&(this.view.toolViewManager.activeTool=null)}whenCreated(){return this._creationFinishedResolver.promise}onManipulatorSelectionChanged(){}onActivate(){}onDeactivate(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(e){}onInputEventAfter(e){}get internallyEditable(){return this.getEditableFlag(Xe.USER)&&this.getEditableFlag(Xe.MANAGER)}finishToolCreation(){this.created||this._creationFinishedResolver.resolve(this),this._set("created",!0)}_syncVisible(){if(this.initialized){if(this.visible)this._show();else if(this._hide(),this.active)return void(this.view.activeTool=null)}}_show(){this._updateManipulatorAttachment(),this.onShow()}_hide(){this._updateManipulatorAttachment(),this.onHide()}_updateManipulatorAttachment(){this.visible?this.manipulators.attach():this.manipulators.detach()}};r([a({constructOnly:!0})],j.prototype,"view",void 0),r([a({readOnly:!0})],j.prototype,"active",null),r([a({value:!0})],j.prototype,"visible",null),r([a({value:!0})],j.prototype,"editable",null),r([a({readOnly:!0})],j.prototype,"manipulators",void 0),r([a({readOnly:!0})],j.prototype,"updating",null),r([a()],j.prototype,"cursor",null),r([a({readOnly:!0})],j.prototype,"automaticManipulatorSelection",void 0),r([a()],j.prototype,"hasFocusedManipulators",null),r([a()],j.prototype,"hasGrabbedManipulators",void 0),r([a()],j.prototype,"hasHoveredManipulators",void 0),r([a()],j.prototype,"firstGrabbedManipulator",void 0),r([a({readOnly:!0})],j.prototype,"created",void 0),r([a({readOnly:!0})],j.prototype,"removeIncompleteOnCancel",void 0),j=r([k("esri.views.interactive.InteractiveToolBase")],j);function ll(e,t){let i=null,n=null;return s=>{if(s.action==="cancel")return void(n!=null&&(n.execute({action:"cancel"}),i=null,n=null));const o={action:s.action,screenStart:s.start,screenEnd:s.screenPoint};s.action==="start"&&i==null&&(i=new Fi,n=new Fi,t(e,i,n,s.pointerType,o)),i?.execute(o),s.action==="end"&&i!=null&&(i=null,n=null)}}function Ci(e,t){return e.events.on("drag",ll(e,t))}function Zp(e,t){const i=[e.x,e.y,e.z??0],n=t,s=[Math.cos(n),Math.sin(n)],o=Math.sqrt(s[0]*s[0]+s[1]*s[1]);if(o===0)return null;s[0]/=o,s[1]/=o;const l=c=>{const p=(c.x-i[0])*s[0]+(c.y-i[1])*s[1];c.x=i[0]+p*s[0],c.y=i[1]+p*s[1]};return c=>(l(c.mapStart),l(c.mapEnd),{...c,axis:s})}function cl(e){let t=null;return i=>{if(i.action==="start"&&(t=pl(e,i.mapStart.spatialReference)),t==null)return null;const n=i.mapEnd.x-i.mapStart.x,s=i.mapEnd.y-i.mapStart.y,o=(i.mapEnd.z??0)-(i.mapStart.z??0);return t.move(n,s,o,i.action),{...i,translationX:n,translationY:s,translationZ:o}}}function kn(e,t){return e==null?null:e.spatialReference.equals(t)?e.clone():si(e,t)}function pl(e,t){const i=e.operations;if(!i)return null;const n=i.data.geometry,s=Zr(t);if(n.spatialReference.equals(s))return Pi(e,i,()=>{});if(n.type!=="mesh"){const o=kn(n,s);if(o==null)return null;const l=n.spatialReference;return Pi(e,Hi.fromGeometry(o,i.viewingMode),()=>{const c=si(n,l);i.trySetGeometry(c)})}if(Fr(n)){const o=kn(n.origin,s);if(!o)return null;const l=n.spatialReference,c=Hi.fromGeometry(o,i.viewingMode);return Pi(e,i,()=>{const p=si(c.data.geometry,l),d=p.x-n.origin.x,h=p.y-n.origin.y,g=(p.z??0)-(n.origin.z??0);i.move(d,h,g)})}return null}function Pi(e,t,i){let n=0,s=0,o=0;return{move:(l,c,p,d)=>{d==="start"&&(n=0,s=0,o=0);const h=l-n,g=c-s,y=p-o;t.move(h,g,y),n+=h,s+=g,o+=y,i(),d==="end"&&e.endInteraction?.()}}}function Np(e,t=null,i){let n=null;const s=t==null||e.spatialReference?.equals(t)?l=>l:l=>l!=null?si(l,t):l,o={exclude:[],...i};return l=>{if(l.action==="start"&&(n=s(e.toMap(l.screenStart,o))),n==null)return null;const c=s(e.toMap(l.screenEnd,o));return c!=null?{...l,mapStart:n,mapEnd:c}:null}}function Up(e){const t=e.map(i=>cl(i)).filter(ae);return i=>{const n=i.mapEnd.x-i.mapStart.x,s=i.mapEnd.y-i.mapStart.y,o=i.mapEnd.z-i.mapStart.z;return t.forEach(l=>l(i)),{...i,translationX:n,translationY:s,translationZ:o}}}function dl(e){const t=e.operations?.createResetState();return i=>(t?.remove(),i)}function Wp(e){const t=e.map(i=>dl(i)).filter(i=>i!=null);return i=>(t.forEach(n=>n(i)),i)}function jp(){let e=0,t=0,i=0;return n=>{n.action==="start"&&(e=n.mapStart.x,t=n.mapStart.y,i=n.mapStart.z);const s=n.mapEnd.x-e,o=n.mapEnd.y-t,l=n.mapEnd.z-i;return e=n.mapEnd.x,t=n.mapEnd.y,i=n.mapEnd.z,{...n,mapDeltaX:s,mapDeltaY:o,mapDeltaZ:l,mapDeltaSpatialReference:n.mapStart.spatialReference}}}function Xp(){let e=0,t=0;return i=>{i.action==="start"&&(e=i.screenStart.x,t=i.screenStart.y);const n=i.screenEnd.x-e,s=i.screenEnd.y-t;return e=i.screenEnd.x,t=i.screenEnd.y,{...i,screenDeltaX:n,screenDeltaY:s}}}function Yp(e,t){let i=null,n=0,s=0;return o=>{if(o.action==="start"&&(i=e.toScreen?.(t),i!=null&&(i.x<0||i.x>e.width||i.y<0||i.y>e.height?i=null:(n=o.screenStart.x-i.x,s=o.screenStart.y-i.y))),i==null)return null;const l=ki(o.screenEnd.x-n,0,e.width),c=ki(o.screenEnd.y-s,0,e.height),p=ai(l,c);return o.screenStart=i,o.screenEnd=p,o}}const hl=()=>{};let Fi=class Vs{constructor(){this.execute=hl}next(t,i=new Vs){return t!=null&&(this.execute=n=>{const s=t(n);s!=null&&i.execute(s)}),i}};function ul(e,t,i=[]){if(e.type==="2d")return s=>s;let n=null;return s=>{s.action==="start"&&(n=e.toMap(s.screenStart,{exclude:i}),n!=null&&(n.z=ni(n,e,t)));const o=e.toMap(s.screenEnd,{exclude:i});o!=null&&(o.z=ni(o,e,t));const l=n!=null&&o!=null?{sceneStart:n,sceneEnd:o}:null;return{...s,scenePoints:l}}}function Rn(e,t,i){const n=t.elevationProvider.getElevation(e.x,e.y,e.z??0,e.spatialReference,"scene")??0,s=li(e);return s.z=n,s.hasZ=!0,s.z=ni(s,t,i),s}function qp(e,t){if(e.type==="2d")return n=>n;let i=null;return n=>{n.action==="start"&&(i=Rn(n.mapStart,e,t));const s=Rn(n.mapEnd,e,t),o=i!=null&&s!=null?{sceneStart:i,sceneEnd:s}:null;return{...n,scenePoints:o}}}let Zi=class{constructor(e){this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.selfSnappingZ=null,this.drawConstraints=null,this.editGeometryOperations=e.editGeometryOperations,this.elevationInfo=e.elevationInfo,this.pointer=e.pointer,this.vertexHandle=e.vertexHandle,this.excludeFeature=e.excludeFeature,this.feature=e.feature,this.visualizer=e.visualizer,this.selfSnappingZ=e.selfSnappingZ,this.drawConstraints=e.drawConstraints}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}get spatialReference(){return this.coordinateHelper.spatialReference}},qe=class extends le{constructor(e){super(e),this.constrainResult=t=>t,this._snapPoints=null,this._frameTask=null,this._abortController=null,this._stagedPoint=null,this._snap=ji(async(t,i,n,s)=>{const o=this._frameTask;if(o==null)return;const l=await o.schedule(()=>i.snap({...t,context:n,signal:s}),s);l.valid&&await o.schedule(()=>{this.stagedPoint=l.apply(),t!==this._snapPoints&&this._snapPoints!=null&&(this.stagedPoint=i.update({...this._snapPoints,context:n}))},s)})}get stagedPoint(){return this._stagedPoint}set stagedPoint(e){this._stagedPoint=this.constrainResult(e)}initialize(){const e=this.view.type==="3d"?this.view?.resourceController?.scheduler:null;this._frameTask=e!=null?e.registerTask(gs.SNAPPING):ms}destroy(){this._abortController=Ii(this._abortController),this._frameTask=rt(this._frameTask)}update(e,t,i){this._snapPoints=e;const{point:n,scenePoint:s}=e,o=t.update({point:n,scenePoint:s,context:i});return this.stagedPoint=o,o}async snap(e,t,i){const{point:n,scenePoint:s}=e;return this.stagedPoint=t.update({point:n,scenePoint:s,context:i}),this._snapPoints=e,this._abortController==null&&(this._abortController=new AbortController),this._snap(e,t,i,this._abortController.signal)}async snapAgainNearPreviousMapPoint(e,t){this._snapPoints!=null&&await this.snap(this._snapPoints,e,t)}abort(){this._abortController=Ii(this._abortController),this._snapPoints=null}};r([a({constructOnly:!0})],qe.prototype,"view",void 0),r([a()],qe.prototype,"stagedPoint",null),r([a()],qe.prototype,"constrainResult",void 0),r([a()],qe.prototype,"_stagedPoint",void 0),qe=r([k("esri.views.interactive.snapping.SnappingOperation")],qe);function In(e){let t,i,n=[],s=!1;function o(...l){return s&&t===this&&gl(l,n)||(i=e.apply(this,l),t=this,n=l,s=!0),i}return o}function gl(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}const Os="click";let ml=class{constructor({consumesClicks:e,grabbableForEvent:t}){this.events=new Be,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.consumesClicks=e,this.grabbableForEvent=t}destroy(){}intersectionDistance(e,t){return 0}attach(){}detach(){}onElevationChange(){}onViewChange(){}};function Kp(e,t,i,n,s,o){let l="geodesic",c=Kr(i);const p=bt();return Ki(e,t,n,p),p[2]=0,c&&ci(p,i,p,c)||(l="euclidean",c=i),{mode:l,view:t,elevationInfo:n,hasZ:s,directionMode:o,spatialReference:e.spatialReference,measurementSR:c,origin:p}}function yl(e,t,i){if(t==null||e==null)return;const n=ir(i.measurementSR);if(n==null)return;const s=di(e,i);if(s==null)return;const o=en(t,n);return new yr(s,o)}function _l(e,t,i,n){if(i==null||e==null)return;const s=di(e,n);if(s==null)return;const o=ft(i),l=10,c=d=>{if(d==null)return;const h=bt(),g=qr(d,"degrees","geographic");return vr(h,s,n.measurementSR,l,g,n.mode)?new fr(s,h):void 0},p=()=>{if(t!=null&&e!=null)return ft(ls(t,e))};switch(n.directionMode){case vt.Absolute:return c(o);case vt.Relative:{const d=p();return d==null?void 0:c(d+o)}case vt.RelativeBilateral:{const d=p();return d==null?void 0:as([c(d+o),c(d-o)])}}}function Ls(e,t){const i=hi(e,t);return i!=null?new _r(i):void 0}function ks(e,t,i){const{context:n,longitude:s,latitude:o,direction:l,distance:c,elevation:p}=i;if(s!=null||o!=null||c!=null||p!=null||l!=null){if(s!=null||o!=null){const d=ft(s),h=ft(o),g=hi(p,n);return new rs(d,h,g)}return vl(e,t,i)}}function vl(e,t,{context:i,direction:n,distance:s,elevation:o}){if(t==null)return Ls(o,i);const{view:l,elevationInfo:c,measurementSR:p}=i,d=Ki(t,l,c);if(!p||!ci(d,t.spatialReference,Dn,p))return;const[h,g]=Dn,y=s!=null?en(s,"meters"):void 0,_=ft(n),P=hi(o,i),f=G=>{const H=new wr([h,g],p,y,P,G);return y==null||G==null||P==null&&i.hasZ?H:new br(H.closestTo(d))};if(_==null)return f(void 0);const K=()=>{if(e!=null&&t!=null)return ft(ls(e,t))};switch(i.directionMode){case vt.Absolute:return f(_);case vt.Relative:{const G=K();return G==null?void 0:f(G+_)}case vt.RelativeBilateral:{const G=K();return G==null?void 0:as([f(G+_),f(G-_)])}}}function fl(e){return e.context.mode==="geodesic"?ks(null,null,e):Rs(e)}function wl(e,t,i){const{context:n,x:s,y:o,distance:l,direction:c,elevation:p}=i;return n.mode==="geodesic"?ks(t,e,i):s!=null||o!=null?Rs(i):bl([yl(e,l,n),_l(e,t,c,n),Ls(p,n)])}function Rs({x:e,y:t,elevation:i,context:n}){Ut.x=e?.value??0,Ut.y=t?.value??0,Ut.spatialReference=n.spatialReference;const s=di(Ut,n,El);return new rs(e!=null&&s!=null?s[0]:void 0,t!=null&&s!=null?s[1]:void 0,hi(i,n))}function bl(e){let t;for(const i of e)i&&(t=t?.intersect(i)??i);return t}function di(e,t,i=bt()){const{view:n,elevationInfo:s,measurementSR:o,origin:l,mode:c}=t;if(Ki(e,n,s,i),ci(i,e.spatialReference,i,o))return c!=="geodesic"&&us(i,i,l),i}function Tl(e,t,i,n){const{view:s,measurementSR:o,spatialReference:l,origin:c,mode:p}=i;if(p==="geodesic"?yt(Vt,e):mt(Vt,e,c),ci(Vt,o,Vt,l))return dr(Vt,s,t,i,n)}function hi(e,t){return xl(e,t)?.value??void 0}function xl(e,{view:t,origin:i,elevationInfo:n,hasZ:s,measurementSR:o}){if(e==null||!s)return;const l=Bo(o);if(l==null)return;const[c,p]=i,d=en(e,l),h=t?.type==="3d"?gr(t,c,p,d,o,n):d;return h!=null?Yr(h,l):void 0}const Dn=bt(),El=bt(),Vt=bt(),Ut=tn(0,0,0,Gt.WGS84);function Ml({predicate:e=()=>!0,snappingManager:t,snappingContext:i,updatingHandles:n,useZ:s=!0}){const o=new Fi;if(t==null)return{snappingStep:[An,o],cancelSnapping:An};let l,c=null,p=null,d=null;const h=()=>{c=Ii(c),t.doneSnapping(),p?.frameTask.remove(),p=null,l=rt(l),d=null},g=Sl(t,s,o);let y=null,_=null,P=null;return{snappingStep:[f=>{if(!e(f))return f;const{action:K}=f;if(K==="start"){const{info:G}=f,H=Cl(t.view);if(p=Pl(i,f,H),p.context.selfSnappingZ=null,!s&&G!=null){const ge=Ol(i.coordinateHelper,G.handle.component);ge!=null&&(p.context.selfSnappingZ={value:ge,elevationInfo:i.elevationInfo??lr})}}if(p!=null){const{context:G,originalScenePos:H,originalPos:ge}=p,{mapEnd:Fe,mapStart:Ze,scenePoints:te}=f,Oe=Is(ge,Ni(Fe,Ze)),lt=Ni(Ze,ge),m={...f,action:"update"},x=p.context,v=Vl(H,te),I=t.update({point:Oe,scenePoint:v,context:G});if(P=I,Ds(Fe,I,lt,s),y=Oe,_=v,K!=="end"){const{frameTask:N}=p;c==null&&(c=new AbortController),d=ce=>{n.addPromise(ze(g({frameTask:N,event:m,context:x,point:Oe,scenePoint:v,delta:lt,getLastState:()=>({point:y,scenePoint:_,updatePoint:ce.forceUpdate?null:P})},c.signal)))},d({forceUpdate:!1}),l==null&&(l=R(()=>t.options.effectiveEnabled,()=>d?.({forceUpdate:!0})))}}return K==="end"&&h(),f},o],cancelSnapping:f=>(h(),f)}}function Sl(e,t,i){return ji(async({frameTask:n,point:s,scenePoint:o,context:l,event:c,delta:p,getLastState:d},h)=>{const g=await n.schedule(()=>e.snap({point:s,scenePoint:o,context:l,signal:h}),h);if(g.valid){let y=await n.schedule(()=>g.apply(),h);const _=d();_.point!=null&&s!==_.point&&(y=e.update({point:_.point,scenePoint:_.scenePoint,context:l})),_.updatePoint!=null&&Jt(y,_.updatePoint)||(Ds(c.mapEnd,y,p,t),i.execute(c))}})}function Cl(e){return e.type==="3d"?e.resourceController.scheduler.registerTask(gs.SNAPPING):ms}function Pl(e,t,i){return{context:new Zi({editGeometryOperations:e.editGeometryOperations,elevationInfo:e.elevationInfo,pointer:e.pointer,vertexHandle:t.info!=null?t.info.handle:null,excludeFeature:e.excludeFeature,feature:e.feature,visualizer:e.visualizer}),originalPos:t.snapOrigin!=null?e.coordinateHelper.vectorToDehydratedPoint(t.snapOrigin):t.mapStart,originalScenePos:t.scenePoints!=null?t.scenePoints.sceneStart:null,frameTask:i}}function Is(e,[t,i,n]){const s=li(e);return s.x+=t,s.y+=i,s.hasZ&&(s.z+=n),s}function Vl(e,t){return e==null||t==null?null:Is(e,Ni(t.sceneEnd,t.sceneStart))}function Ni(e,t){const i=e.hasZ&&t.hasZ?e.z-t.z:0;return[e.x-t.x,e.y-t.y,i]}function Ds(e,t,[i,n,s],o){e.x=t.x+i,e.y=t.y+n,o&&e.hasZ&&t.hasZ&&(e.z=t.z+s)}function Ol(e,t){if(!e.hasZ())return null;const i=t.vertices;let n=null;for(const s of i){const o=e.getZ(s.pos);if(n!=null&&o!=null&&Math.abs(o-n)>1e-6)return null;n==null&&(n=o)}return n}function An(e){return e}const Ll="crosshair",kl="progress",Gn=Symbol(),zn=Symbol();let b=class extends Be.EventedMixin(le){constructor(e){super(e),this._createOperationCompleted=!1,this._hideDefaultCursor=!1,this._pointerDownStates=new Sr,this._stagedScreenPoint=null,this._stagedPointerType=null,this._updatingHandles=new Vr,this._stagedPointerId=null,this.constraintsEnabled=!1,this.constraints=void 0,this._getPointConstraint=In(fl),this._getPolylineOrPolygonConstraint=In(wl),this.constraintZ=null,this.defaultZ=null,this.isDraped=!0,this.labelOptions=new ts,this.cursor=null,this.loading=!1,this.snapToSceneEnabled=null,this.firstVertex=null,this.lastVertex=null,this.secondToLastVertex=null,e.elevationInfo==null&&(this.elevationInfo=cr(!!e.hasZ))}initialize(){const{geometryType:e,view:t}=this,i=t.spatialReference,n="viewingMode"in t.state?t.state.viewingMode:ps.Local,s=e==="segment"||e==="multipoint"?"polyline":e;this.coordinateHelper=vs(this.hasZ,this.hasM,i),this._editGeometryOperations=new Hi(new zi(s,this.coordinateHelper),n),this._snappingOperation=new qe({view:t}),this.addHandles([R(()=>({stagedPoint:this._snappingOperation.stagedPoint,constraint:this._constraint}),({stagedPoint:c,constraint:p},d)=>{const{snappingOptions:h}=this;if(h&&(h.forceDisabled=p!=null&&hr(p)),d!=null&&c===d.stagedPoint&&p!==d.constraint)return this._onKeyboardBasedChange();this._processCursor(c??this._screenToMap(this._stagedScreenPoint))},{equals:(c,p)=>c.stagedPoint===p.stagedPoint&&Po(c.constraint,p.constraint)}),R(()=>this.view.viewpoint,(c,p)=>{c&&p&&Pr(c,p)&&this._onKeyboardBasedChange()})]),this._activeComponent=new pi(i,n),this._editGeometryOperations.data.components.push(this._activeComponent);const o=this.segmentLabels;o!=null&&(o.context={view:t,editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,labelOptions:this.labelOptions},this.addHandles(R(()=>this.labelOptions.enabled,c=>{o.visible=c},It))),this.addHandles(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],c=>{const p=c.vertices.map(_=>({componentIndex:0,vertexIndex:_.index,coordinates:this.coordinateHelper.vectorToArray(_.pos)})),d=p.map(_=>_.coordinates),h=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.getFirstVertex()?.pos)??null;Jt(h,this.firstVertex)||(this.firstVertex=h);const g=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.getLastVertex()?.pos)??null;Jt(g,this.lastVertex)||(this.lastVertex=g);const y=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.edges.at(-1)?.leftVertex?.pos)??null;switch(Jt(y,this.secondToLastVertex)||(this.secondToLastVertex=y),this._processCursor(this.cursorVertex),c.type){case"vertex-add":this.emit(c.type,{...c,added:d,vertices:p});break;case"vertex-update":this.emit(c.type,{...c,updated:d,vertices:p});break;case"vertex-remove":this.emit(c.type,{...c,removed:d,vertices:p})}}));const l=this._manipulator=new ml({consumesClicks:!1,grabbableForEvent:c=>this.drawingMode!=="click"||c.pointerType==="touch"&&this._snappingEnabled&&this._pointerDownStates.size===1});this.manipulators.add(l),l.grabbable=e!=="point"&&e!=="multipoint",this.addHandles([l.events.on("immediate-click",c=>this._onImmediateClick(c)),l.events.on("immediate-double-click",c=>this._onImmediateDoubleClick(c)),R(()=>this.drawingMode,()=>{this.removeHandles(Gn),this.addHandles(this._createManipulatorDragPipeline(l),Gn)},It),R(()=>({effectiveCursor:this.effectiveCursor}),({effectiveCursor:c})=>{l.cursor=c},It)]),pr(this,()=>{const c=this.view.inputManager.latestPointerType??"mouse",p=this._getSnappingContext(c);if(this.snappingManager!=null){const d=this._snappingOperation.snapAgainNearPreviousMapPoint(this.snappingManager,p);this._updatingHandles.addPromise(ze(d))}})}destroy(){xe(this.segmentLabels),xe(this._snappingOperation),this._editGeometryOperations=xe(this._editGeometryOperations),this._updatingHandles.destroy()}get _isDragging(){const{_stagedPointerId:e,_manipulator:t}=this;return e!=null&&this._pointerDownStates.has(e)||t.grabbing||!t.interactive}get _snappingEnabled(){return this.snappingManager!=null&&this.snappingManager.options.effectiveEnabled}get _requiresScenePoint(){const e=this._updateAndGetEffectiveDrawSurface();return this.view.type==="3d"&&this.drawSurface!==e}get canRedo(){return this._editGeometryOperations.canRedo}get canUndo(){return this._editGeometryOperations.canUndo}get committedVertices(){return this._activeComponent.vertices.map(e=>this.coordinateHelper.vectorToArray(e.pos))}get _constraint(){const{constraints:e,constraintsEnabled:t}=this;if(e&&t)switch(this.geometryType){case"point":case"multipoint":return this._getPointConstraint(e);case"polygon":case"polyline":return this._getPolylineOrPolygonConstraint(this.lastVertex,this.secondToLastVertex,e)}}set drawingMode(e){this._set("drawingMode",e??Os)}get effectiveCursor(){return this.loading?kl:this._hideDefaultCursor?null:this.cursor||Ll}get interactive(){return this._manipulator.interactive}set interactive(e){this._manipulator.interactive=e}get isCompleted(){return this._createOperationCompleted}get numCommittedVertices(){return this._activeComponent.vertices.length}get snappingOptions(){return this.snappingManager!=null?this.snappingManager.options:null}get cursorVertex(){return this._get("cursorVertex")}get visualizationCursorVertex(){return this._stagedPointerType==="mouse"?this.cursorVertex:null}get committableVertex(){const{cursorVertex:e,lastVertex:t,firstVertex:i,geometryType:n}=this;return n==="polygon"&&Si(e,i)||Si(e,t)?null:e}get updating(){return this._updatingHandles.updating}get geometryIncludingUncommittedVertices(){const{committedVertices:e,committableVertex:t,coordinateHelper:i}=this,n=e.slice();return t!=null&&n.push(i.pointToArray(t)),n}cancel(){this.complete({aborted:!0})}commitStagedVertex(){this._snappingOperation.abort();const{committableVertex:e}=this;e!=null&&this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(e))}complete(e){const t=e?.aborted||!1;this._snappingOperation.abort(),this.snappingManager?.doneSnapping();const{geometryType:i,numCommittedVertices:n}=this,s=i==="multipoint"&&n===0||i==="polyline"&&n<2||i==="polygon"&&n<3;i!=="segment"&&i!=="point"||this.commitStagedVertex(),this._createOperationCompleted=!s,(this.isCompleted||t)&&(this._stagedScreenPoint=null,this._stagedPointerId=null,this._stagedPointerType=null,this._processCursor(null),this.emit("complete",{vertices:this.committedVertices.map((o,l)=>({componentIndex:0,vertexIndex:l,coordinates:o})),aborted:t,type:"complete"}))}onInputEvent(e){switch(e.type){case"pointer-down":this._pointerDownStates.add(e.pointerId);break;case"pointer-up":this._pointerDownStates.delete(e.pointerId)}switch(e.type){case"pointer-move":return this._onPointerMove(e);case"hold":return this._onHold(e)}}redo(){this._editGeometryOperations.redo()}undo(){this.snappingManager!=null&&this.snappingManager.doneSnapping(),this._editGeometryOperations.undo()}_processCursor(e){const t=Ri(this.cursorVertex),i=Ri(e),n=i&&(this._updateAndGetEffectiveDrawSurface()?.constrainZ(i)??i),s=this._snapToClosingVertex(n),o=this._applyConstraints(s);Si(t,o)||(this._set("cursorVertex",o),this.segmentLabels?.set("stagedVertex",o!=null?this.coordinateHelper.pointToVector(o):null),o==null||this._stagedPointerType!=="mouse"?this.emit("cursor-remove"):this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(o)}],operation:"apply",type:"vertex-update"}))}_snapToClosingVertex(e){if(e==null||this._isDragging||this.geometryType!=="polygon"||this.numCommittedVertices<=2)return e;const t=this._mapToScreen(e);if(!t)return e;const i=this._activeComponent;return this._vertexWithinPointerDistance(i.vertices[0].pos,t)?this.firstVertex:this._vertexWithinPointerDistance(i.vertices.at(-1).pos,t)?this.lastVertex:e}_createManipulatorDragPipeline(e){switch(this.drawingMode){case"click":return this._createManipulatorDragPipelineClick(e);case"freehand":return this._createManipulatorDragPipelineFreehand(e);case"hybrid":return this._createManipulatorDragPipelineHybrid(e)}}_createManipulatorDragPipelineClick(e){return Ci(e,(t,i,n,s)=>{const o=s==="touch"&&this._snappingEnabled;if(this.isCompleted||!o)return;const{snappingStep:l,cancelSnapping:c}=Ml({predicate:()=>o,snappingManager:this.snappingManager,snappingContext:new Zi({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,feature:this.graphic,pointer:s,visualizer:this.snappingVisualizer,drawConstraints:this.constraints}),updatingHandles:this._updatingHandles,useZ:!this._requiresScenePoint});n=n.next(p=>(o&&this.snappingManager!=null&&this.snappingManager.doneSnapping(),p)).next(c),i.next(this._screenToMapDragEventStep()).next(p=>(p.action==="start"&&(this._processCursor(p.mapStart),(this.geometryType==="segment"||o&&!this.numCommittedVertices)&&this.commitStagedVertex()),p)).next(ul(this.view,this.elevationInfo)).next(...l).next(p=>(o&&(this._processCursor(p.mapEnd),p.action==="end"&&this.commitStagedVertex()),p)).next(p=>(p.action==="end"&&(this._stagedPointerType!=="mouse"&&this._snappingOperation.abort(),this.geometryType!=="segment"&&this.geometryType!=="point"||this.complete()),p))})}_createManipulatorDragPipelineFreehand(e){return Ci(e,(t,i)=>{this.isCompleted||i.next(this._screenToMapDragEventStep()).next(n=>(n.action==="start"&&(this._snappingOperation.abort(),this.committableVertex==null&&this._processCursor(n.mapStart),this.geometryType==="segment"&&this.commitStagedVertex()),n)).next(n=>{switch(n.action){case"start":case"update":this._processCursor(n.mapEnd),this.geometryType!=="polygon"&&this.geometryType!=="polyline"||this.commitStagedVertex();break;case"end":this.complete()}return n})})}_createManipulatorDragPipelineHybrid(e){return Ci(e,(t,i)=>{this.isCompleted||i.next(this._screenToMapDragEventStep()).next(n=>(n.action==="start"&&(this._snappingOperation.abort(),this.addHandles(this._editGeometryOperations.createUndoGroup(),zn),this._processCursor(n.mapStart),this.commitStagedVertex()),n)).next(n=>{switch(n.action){case"start":case"update":this._processCursor(n.mapEnd),this.geometryType!=="polygon"&&this.geometryType!=="polyline"||this.commitStagedVertex();break;case"end":this._stagedPointerType!=="mouse"&&this._snappingOperation.abort(),this.removeHandles(zn),this.geometryType!=="segment"&&this.geometryType!=="point"||this.complete()}return n})})}get _drawAtFixedElevation(){const{constraintsEnabled:e,constraintZ:t,geometryType:i,numCommittedVertices:n}=this;return e?t!=null||i==="segment"&&n>0:(i==="segment"||i==="polygon")&&n>0}_updateAndGetEffectiveDrawSurface(){const{constraintsEnabled:e,coordinateHelper:t,drawSurface:i,elevationDrawSurface:n,snapToSceneEnabled:s}=this;if(n==null)return i;if(!this.hasZ)return n.defaultZ=null,n;const o=this.elevationInfo?.mode;let l=this.defaultZ,c=e||o==="absolute-height";return s!=null&&(c=s),o==="on-the-ground"&&(c=!1),this._drawAtFixedElevation&&(l=(e?this.constraintZ:null)??t.getZ(this._activeComponent.vertices[0].pos),c=!1),c?i:(n.defaultZ=l,n)}_mapToScreen(e){return this._updateAndGetEffectiveDrawSurface()?.mapToScreen(e)}_onHold(e){this._snappingOperation.abort(),this.drawingMode==="click"&&e.pointerType==="touch"&&this._snappingEnabled&&this._processCursor(e.mapPoint),e.stopPropagation()}_onImmediateClick(e){if(!(e.pointerType==="mouse"&&e.button===2||this._manipulator.dragging))try{const{drawingMode:t,geometryType:i}=this;this._stagedPointerType=e.pointerType,this._stagedScreenPoint=e.screenPoint;const n=this._screenToMap(e.screenPoint);if(n==null||n==null||t==="freehand"&&i!=="point"&&i!=="multipoint")return;if(this._snappingEnabled&&this.cursorVertex!=null||this._processCursor(n),this.committableVertex==null)return void this.complete();this.commitStagedVertex(),e.pointerType!=="mouse"&&this._processCursor(null),(t==="freehand"&&this.geometryType!=="multipoint"||i==="point"||i==="segment"&&this.numCommittedVertices===2||i==="segment"&&t==="hybrid"&&this.numCommittedVertices===1)&&this.complete()}finally{e.stopPropagation()}}_onImmediateDoubleClick(e){this._manipulator.dragging||this.geometryType==="point"||(this.complete(),e.stopPropagation())}_onPointerMove(e){const t=ai(e.x,e.y);this._stagedScreenPoint=t,this._stagedPointerType=e.pointerType,this._stagedPointerId=e.pointerId,this._isDragging?this._snappingOperation.abort():(e.stopPropagation(),this._processCursorMovementRelativeToSurface(t,e.pointerType))}_onKeyboardBasedChange(){this._stagedPointerType==="mouse"&&this._stagedScreenPoint&&this._stagedPointerId!=null&&!this._isDragging?this._processCursorMovementRelativeToSurface(this._stagedScreenPoint,this._stagedPointerType):this._snappingOperation.abort()}_processCursorMovementRelativeToSurface(e,t){const i=this._snappingOperation,n=this._screenToMap(e),s=this._requiresScenePoint?this.drawSurface?.screenToMap(e):null;if(n==null)return this._hideDefaultCursor=!0,this._processCursor(null),void i.abort();this._hideDefaultCursor=!1;const o=this.snappingManager;if(o==null)return this._processCursor(n),void i.abort();const l=this._getSnappingContext(t);this._updatingHandles.addPromise(ze(i.snap({point:n,scenePoint:s},o,l)))}_applyConstraints(e){const{_constraint:t,constraints:i}=this;if(!e||!i||!t)return e;const{context:n}=i,s=di(e,n),o=s?t.closestTo(s):void 0;if(!o)return e;const l=Tl(o,e,n),c=this.view.type==="2d"||n.elevationInfo.mode!=="absolute-height";return l!=null&&c&&this.constraintZ!=null&&this.hasZ&&(l.z=this.constraintZ),l}_screenToMap(e){return e?this._updateAndGetEffectiveDrawSurface()?.screenToMap(e):null}_screenToMapDragEventStep(){let e=null;return t=>{if(t.action==="start"&&(e=this._screenToMap(t.screenStart)),e==null)return null;const i=this._screenToMap(t.screenEnd);return i!=null?{...t,mapStart:e,mapEnd:i}:null}}_vertexWithinPointerDistance(e,t){const i=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(e));return i!=null&&Rl(i,t,25)}_getSnappingContext(e){const t=this._drawAtFixedElevation?this.elevationDrawSurface?.defaultZ:null;return new Zi({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:e,feature:this.graphic,visualizer:this.snappingVisualizer,selfSnappingZ:t!=null?{value:t,elevationInfo:this.elevationInfo}:null,drawConstraints:this.constraints})}};function Rl(e,t,i){const n=e.x-t.x,s=e.y-t.y;return n*n+s*s<=i}r([a()],b.prototype,"_hideDefaultCursor",void 0),r([a()],b.prototype,"_stagedPointerId",void 0),r([a()],b.prototype,"_isDragging",null),r([a()],b.prototype,"_snappingOperation",void 0),r([a()],b.prototype,"_snappingEnabled",null),r([a({constructOnly:!0})],b.prototype,"graphic",void 0),r([a()],b.prototype,"constraintsEnabled",void 0),r([a()],b.prototype,"constraints",void 0),r([a()],b.prototype,"_constraint",null),r([a()],b.prototype,"constraintZ",void 0),r([a()],b.prototype,"defaultZ",void 0),r([a()],b.prototype,"isDraped",void 0),r([a({value:Os})],b.prototype,"drawingMode",null),r([a({constructOnly:!0})],b.prototype,"elevationDrawSurface",void 0),r([a({constructOnly:!0})],b.prototype,"elevationInfo",void 0),r([a({constructOnly:!0,type:ts})],b.prototype,"labelOptions",void 0),r([a({constructOnly:!0})],b.prototype,"geometryType",void 0),r([a({constructOnly:!0})],b.prototype,"hasM",void 0),r([a({constructOnly:!0})],b.prototype,"hasZ",void 0),r([a()],b.prototype,"cursor",void 0),r([a()],b.prototype,"effectiveCursor",null),r([a()],b.prototype,"loading",void 0),r([a({constructOnly:!0})],b.prototype,"manipulators",void 0),r([a({constructOnly:!0})],b.prototype,"drawSurface",void 0),r([a({constructOnly:!0})],b.prototype,"segmentLabels",void 0),r([a({constructOnly:!0})],b.prototype,"snappingManager",void 0),r([a({constructOnly:!0})],b.prototype,"snappingVisualizer",void 0),r([a()],b.prototype,"snapToSceneEnabled",void 0),r([a({readOnly:!0})],b.prototype,"cursorVertex",null),r([a({readOnly:!0})],b.prototype,"visualizationCursorVertex",null),r([a()],b.prototype,"committableVertex",null),r([a()],b.prototype,"firstVertex",void 0),r([a()],b.prototype,"lastVertex",void 0),r([a()],b.prototype,"secondToLastVertex",void 0),r([a()],b.prototype,"updating",null),r([a({constructOnly:!0})],b.prototype,"view",void 0),b=r([k("esri.views.draw.DrawOperation")],b);let Qp=class{constructor(e,t,i,n=null){this._elevationInfo=e,this.defaultZ=t,this._view=i,this._excludeGraphics=n}screenToMap(e){const{defaultZ:t,_view:i}=this,n=i.sceneIntersectionHelper.intersectElevationFromScreen(io(e.x,e.y),this._elevationInfo,t??0,this._excludeGraphics);return t==null&&n!=null&&(n.z=void 0),n}mapToScreen(e){const t=tn(e.x,e.y,is(this._view,e,this._elevationInfo),e.spatialReference);return this._view.toScreen(t)}constrainZ(e){const{defaultZ:t}=this;return t!=null&&e.z!==t&&((e=li(e)).z=t),e}},Jp=class{constructor(e,t,i=[]){this.view=e,this.elevationInfo=t,this.exclude=i}screenToMap(e){const t=this.view.toMap(e,{exclude:this.exclude,excludeLabels:!0});return t!=null&&(t.z=ni(t,this.view,this.elevationInfo)),t}mapToScreen(e){let t=e;return this.elevationInfo!=null&&(t=tn(e.x,e.y,is(this.view,e,this.elevationInfo),e.spatialReference)),this.view.toScreen(t)}constrainZ(e){return e}},ed=class{constructor(e,t=!1,i=0){this.view=e,this.hasZ=t,this.defaultZ=i,this.mapToScreen=n=>e.toScreen(n),this.screenToMap=t?n=>{const s=e.toMap(n);return s.z=i,s}:n=>e.toMap(n)}constrainZ(e){const{defaultZ:t}=this;return this.hasZ&&e.z!==t&&((e=li(e)).z=t),e}},Ui=class As{screenToMap(t){const{x:i,y:n}=t;return new Z({x:i,y:n,spatialReference:As.spatialReference})}mapToScreen(t){return ai(t.x,t.y)}constrainZ(t){return t}};Ui.spatialReference=new Gt;function oi(e,t,i=null){return i!=null?[e,t,i]:[e,t]}function D(e,t,i=null){return i!=null?{x:e,y:t,z:i}:{x:e,y:t}}let Gs=class{constructor(e){this.spatialReference=e}mapToLocalMultiple(e){return e.map(t=>this.mapToLocal(t)).filter(ae)}get doUnnormalization(){return!1}};class zs extends Gs{constructor(t,i,n=null){super(i),this._defaultZ=n,this.transform=mn(),this.transformInv=mn(),this.transform=Mr(t),Jr(this.transformInv,this.transform)}makeMapPoint(t,i){return oi(t,i,this._defaultZ)}mapToLocal(t){return D(this.transform[0]*t[0]+this.transform[2]*t[1]+this.transform[4],this.transform[1]*t[0]+this.transform[3]*t[1]+this.transform[5])}localToMap(t){return oi(this.transformInv[0]*t.x+this.transformInv[2]*t.y+this.transformInv[4],this.transformInv[1]*t.x+this.transformInv[3]*t.y+this.transformInv[5],this._defaultZ)}}let Il=class extends Gs{constructor(e,t){super(e.spatialReference),this.view=e,this.defaultZ=null,this.pWS=C(),this.tangentFrameUpWS=C(),this.tangentFrameRightWS=C(),this.tangentFrameForwardWS=C(),this.localFrameRightWS=C(),this.localFrameUpWS=C(),this.worldToLocalTransform=En(),this.localToWorldTransform=En(),this.scale=1,this.scale=e.resolution,this.referenceMapPoint=t,this.defaultZ=t.hasZ?t.z:null;const i=e.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,wi.X,this.tangentFrameRightWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,wi.Y,this.tangentFrameUpWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,wi.Z,this.tangentFrameForwardWS);const n=C();Di(n,this.tangentFrameForwardWS,Qt(i,this.tangentFrameForwardWS)),us(this.localFrameRightWS,i,n),gt(this.localFrameRightWS,this.localFrameRightWS),ut(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS),ea(this.worldToLocalTransform,this.localFrameRightWS,this.tangentFrameRightWS),ta(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return this.view.viewingMode==="global"}makeMapPoint(e,t){return oi(e,t,this.defaultZ)}mapToLocal(e){const t=C();this.view.renderCoordsHelper.toRenderCoords(new Z({x:e[0],y:e[1],spatialReference:this.spatialReference}),t),bn(t,t,this.worldToLocalTransform);const i=this.view.renderCoordsHelper.fromRenderCoords(t,new Z({spatialReference:this.view.spatialReference}));return i!=null?D(i.x/this.scale,i.y/this.scale):null}localToMap(e){const t=C();this.view.renderCoordsHelper.toRenderCoords(new Z({x:e.x*this.scale,y:e.y*this.scale,spatialReference:this.spatialReference}),t),bn(t,t,this.localToWorldTransform);const i=this.view.renderCoordsHelper.fromRenderCoords(t,new Z({spatialReference:this.view.spatialReference}));return i!=null?oi(i.x,i.y,this.defaultZ):null}};function td(e,t){if(e.type==="2d")return new zs(e.state.transform,e.spatialReference,t.length>2?t[2]:null);if(e.type==="3d"){const i=t.length>2?new Z({x:t[0],y:t[1],z:t[2],spatialReference:e.spatialReference}):new Z({x:t[0],y:t[1],spatialReference:e.spatialReference});return new Il(e,i)}return null}const Dl={absolute:"absolute-direction",relative:"relative-direction"},Al={hide:"hide",hideChildren:"hide-children"};function ri(e){return e?.listMode??void 0}function Gl(e){return e!=null&&"minScale"in e&&e.minScale!=null?e.minScale:void 0}function zl(e){return e!=null&&"maxScale"in e&&e.maxScale!=null?e.maxScale:void 0}function $l(e){if(!e)return"inherited";const t=Hl(Bs(e)?e.layer:e);return t!=null?t?"independent":"inherited":"visibilityMode"in e&&e.visibilityMode!=null?e.visibilityMode:"independent"}function $s(e){if(e&&(!("type"in e)||e.type!=="wmts"))return"sublayers"in e?"sublayers":"layers"in e?"layers":void 0}function sn(e){return ri(e)!==Al.hide}function Bl(e,t){if(!e||t==null||isNaN(t))return!1;const i=Gl(e),n=zl(e),s=i!=null&&!isNaN(i)&&i>0&&t>i,o=n!=null&&!isNaN(n)&&n>0&&t<n;return s||o}function $n(e){const t=e?.layer;return t&&"layers"in t?t.layers:null}function Bs(e){return e!=null&&"layer"in e&&e.layer!=null}function Hl(e){const t=Fl(e);return t!=null&&"supportsSublayerVisibility"in t?t.supportsSublayerVisibility:void 0}function Fl(e){return e&&"capabilities"in e&&e.capabilities!=null&&"exportMap"in e.capabilities?e.capabilities.exportMap:void 0}let X=class extends Wn.IdentifiableMixin(Ve){constructor(e,t){super(e,t),this._legend=null,this.className=null,this.content=null,this.flowEnabled=!1,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles([R(()=>this._canCreateLegend,()=>this._createLegend(),he),R(()=>[this._legend,this._legendOptions],()=>this._updateLegend(),he)])}destroy(){this._legend=xe(this._legend)}get _canCreateLegend(){const{content:e,listItem:t}=this;if(!t)return!1;const i="legend";return e===i||e!=null&&!!Array.isArray(e)&&e.includes(i)}get _legendOptions(){const{listItem:e,_legendLayerInfo:t}=this,i=e?.view;return t&&i?{view:i,layerInfos:[t]}:{}}get _legendLayerInfo(){const e=this.listItem?.layer;if(!e||e.type==="subtype-sublayer")return null;const t=Bs(e)?e:null,i=e?.parent,n=i!=null&&"type"in i&&i.type==="map-image"?t?.source:null,s="";return n&&i?{layer:i,title:s,sublayerIds:[n.mapLayerId]}:{layer:e,title:s}}get disabled(){const{listItem:e,_legend:t,content:i}=this;return!e||!(Array.isArray(i)&&i.length>1)&&!!t&&(!t.activeLayerInfos?.length||!e.visibleAtCurrentScale||!e.visible)}set disabled(e){this._overrideIfSome("disabled",e)}get icon(){const{image:e}=this,t=this._getFirstWidget();return this._get("icon")??(!e&&t?t.icon:null)}set icon(e){this._overrideIfSome("icon",e)}get title(){return this._get("title")||(this._getFirstWidget()?.label??"")}set title(e){this._override("title",e)}render(){return u("div",{class:"esri-list-item-panel"},this._renderContents())}_renderContent(e){const{_legend:t,disabled:i,open:n}=this;return e&&!i&&n?e==="legend"&&t?u("div",{key:"legend-widget"},t.render()):typeof e=="string"?u("div",{innerHTML:e,key:e}):yn(e)?u("div",{key:"content-widget"},e.render()):e instanceof HTMLElement?u("div",{afterCreate:this._attachToNode,bind:e,key:"content-element"}):null:null}_renderContents(){const{content:e,open:t}=this;return t?Array.isArray(e)?e.map(i=>this._renderContent(i)):this._renderContent(e):null}async _createLegend(){if(xe(this._legend),this._legend=null,!this._canCreateLegend)return;const{default:e}=await M(()=>import("./Legend-C1YLx_LO-CaAkqvs7.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59]),import.meta.url),t=new e(this._legendOptions);this._legend=t}_attachToNode(e){e.appendChild(this)}_updateLegend(){const e=this._legend;e&&e.set(this._legendOptions)}_getWidget(e){return e==="legend"?this._legend:yn(e)?e:null}_getFirstWidget(){const{content:e}=this;return Array.isArray(e)?e.map(t=>this._getWidget(t)).find(t=>t):this._getWidget(e)}};r([a()],X.prototype,"_legend",void 0),r([a()],X.prototype,"_canCreateLegend",null),r([a()],X.prototype,"_legendOptions",null),r([a()],X.prototype,"_legendLayerInfo",null),r([a()],X.prototype,"className",void 0),r([a()],X.prototype,"content",void 0),r([a()],X.prototype,"disabled",null),r([a()],X.prototype,"flowEnabled",void 0),r([a()],X.prototype,"icon",null),r([a()],X.prototype,"image",void 0),r([a()],X.prototype,"listItem",void 0),r([a()],X.prototype,"open",void 0),r([a()],X.prototype,"title",null),r([a()],X.prototype,"visible",void 0),X=r([k("esri.widgets.LayerList.ListItemPanel")],X);const Hs=X;var Rt;const Zl=Ee.ofType({key:"type",defaultKeyValue:"button",base:no,typeMap:{button:so,toggle:oo}}),Fs=Ee.ofType(Zl),Vi="layer",Wt="child-list-mode",Nl="hide";let L=Rt=class extends Wn.IdentifiableMixin(le){constructor(e){super(e),this.actionsSections=new Fs,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(Ee.ofType(Rt)),this.childrenSortable=!0,this.hidden=!1,this.layer=null,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.open=!1,this.panel=null,this.parent=null,this.view=null}initialize(){if(this.addHandles([R(()=>[this.layer,this.layer?.listMode,this.listModeDisabled],()=>this._watchLayerProperties(this.layer),he),R(()=>this.checkPublishStatusEnabled,e=>this._updateChildrenPublishing(e),he),R(()=>this.view,e=>this._updateChildrenView(e),he),R(()=>this.panel,e=>this._setListItemOnPanel(e),he)]),typeof this.listItemCreatedFunction=="function"){const e={item:this};this.listItemCreatedFunction.call(null,e)}}destroy(){this.panel?.destroy(),this.children.destroyAll(),this.view=null}get connectionStatus(){const{layerView:e,publishing:t}=this;if(!t&&e&&"connectionStatus"in e)return e.connectionStatus}get error(){return this.layer?.loadError}get incompatible(){const{layerView:e}=this;return!(!e||!("spatialReferenceSupported"in e))&&!e.spatialReferenceSupported}get layerView(){const{layer:e,view:t}=this;if(!e||!t||e.type==="sublayer")return null;const i=e.type==="subtype-sublayer"?e.parent:e;return t.allLayerViews.find(n=>n.layer===i)??null}castPanel(e){return this.panel?.open&&!e.hasOwnProperty("open")&&(e.open=!0),e?new Hs(e):null}get sortable(){return this.layer?.type!=="knowledge-graph-sublayer"&&this._get("sortable")}set sortable(e){this._set("sortable",e)}get title(){const e=Bt(this,"layer.layer");return(!e||e&&Bt(this,"layer.layer.loaded"))&&Bt(this,"layer.title")||Bt(this,"layer.attributes.title")||""}set title(e){this._override("title",e)}get publishing(){const{layer:e,checkPublishStatusEnabled:t}=this;return!!(t&&e&&"publishingInfo"in e&&e.publishingInfo?.status==="publishing")}get updating(){const{layerView:e,connectionStatus:t,layer:i,publishing:n}=this;return!n&&!t&&(e?e.updating:i?.loadStatus==="loading"||!1)}get visible(){return!!this.layer?.visible}set visible(e){const t=this.layer;t&&(t.visible=e)}get visibleAtCurrentScale(){return this.layerView?.visibleAtCurrentScale??!Bl(this.layer,this.view?.scale)}get visibleAtCurrentTimeExtent(){return this.layerView?.visibleAtCurrentTimeExtent??!0}get visibilityMode(){return $l(this.layer)}clone(){return new Rt({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),childrenSortable:this.childrenSortable,hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,open:this.open,panel:this.panel,parent:this.parent,sortable:this.sortable,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(e){e&&(e.listItem=this)}_updateChildrenPublishing(e){this.children?.forEach(t=>t.checkPublishStatusEnabled=e)}_updateChildrenView(e){const t=this.children;t&&t.forEach(i=>i.view=e)}_createChildren(e){const{listModeDisabled:t,children:i}=this,n=e.filter(s=>!i.some(o=>o.layer===s));i.addMany(this._createChildItems(n,t))}_destroyChildren(e){const{children:t}=this,i=t.filter(n=>!!n.layer&&!e.includes(n.layer));t.destroyMany(i)}_sortChildren(e){this.children.sort((t,i)=>e.indexOf(i.layer)-e.indexOf(t.layer))}_destroyAllChildren(){this.removeHandles(Wt),this.children.destroyAll()}_watchChildLayerListMode(e){this.removeHandles(Wt),this.listModeDisabled||this.addHandles(e.toArray().map(t=>R(()=>t.listMode,()=>this._compileChildren(e))),Wt)}_compileChildren(e){const t=this.listModeDisabled?e:e?.filter(i=>ri(i)!==Nl);e?.length?(this._createChildren(t),this._destroyChildren(t),this._sortChildren(t),this._watchChildLayerListMode(e)):this._destroyAllChildren()}_watchSublayerChanges(e){e&&this.addHandles(e.on("change",()=>this._compileChildren(e)),Vi)}_initializeChildLayers(e){this._compileChildren(e),this._watchSublayerChanges(e)}_createChildItems(e,t){return e.reverse().map(i=>t||sn(i)?new Rt({layer:i,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,parent:this,view:this.view}):null).filter(ae)}_watchLayerProperties(e){if(this.removeHandles(Vi),this.removeHandles(Wt),!e)return;if((!this.listModeDisabled&&ri(e))==="hide-children")return void this.children.destroyAll();const t=$s(e);t&&this.addHandles(R(()=>e[t],i=>{e.hasOwnProperty(t)&&this._initializeChildLayers(i)},he),Vi)}};r([a({type:Fs})],L.prototype,"actionsSections",void 0),r([a()],L.prototype,"actionsOpen",void 0),r([a()],L.prototype,"checkPublishStatusEnabled",void 0),r([a({type:Ee.ofType(L)})],L.prototype,"children",void 0),r([a()],L.prototype,"childrenSortable",void 0),r([a({readOnly:!0})],L.prototype,"connectionStatus",null),r([a({readOnly:!0})],L.prototype,"error",null),r([a()],L.prototype,"hidden",void 0),r([a({readOnly:!0})],L.prototype,"incompatible",null),r([a()],L.prototype,"layer",void 0),r([a({readOnly:!0})],L.prototype,"layerView",null),r([a()],L.prototype,"listItemCreatedFunction",void 0),r([a({nonNullable:!0})],L.prototype,"listModeDisabled",void 0),r([a()],L.prototype,"open",void 0),r([a({type:Hs})],L.prototype,"panel",void 0),r([jn("panel")],L.prototype,"castPanel",null),r([a()],L.prototype,"parent",void 0),r([a({value:!0})],L.prototype,"sortable",null),r([a()],L.prototype,"title",null),r([a({readOnly:!0})],L.prototype,"publishing",null),r([a({readOnly:!0})],L.prototype,"updating",null),r([a()],L.prototype,"view",void 0),r([a()],L.prototype,"visible",null),r([a({readOnly:!0})],L.prototype,"visibleAtCurrentScale",null),r([a({readOnly:!0})],L.prototype,"visibleAtCurrentTimeExtent",null),r([a({readOnly:!0})],L.prototype,"visibilityMode",null),L=Rt=r([k("esri.widgets.LayerList.ListItem")],L);const on=L;let pe=class extends le{constructor(e){super(e),this.colorSelection=!0,this.dynamicScaleToggle=!0,this.gridEnabledToggle=!0,this.numericInputs=!0,this.gridSnapEnabledToggle=!0,this.lineIntervalInput=!0,this.outOfScaleWarning=!0,this.placementButtons=!0,this.rotateWithMapToggle=!0}};r([a({type:Boolean,nonNullable:!0})],pe.prototype,"colorSelection",void 0),r([a({type:Boolean,nonNullable:!0})],pe.prototype,"dynamicScaleToggle",void 0),r([a({type:Boolean,nonNullable:!0})],pe.prototype,"gridEnabledToggle",void 0),r([a({type:Boolean,nonNullable:!0})],pe.prototype,"numericInputs",void 0),r([a({type:Boolean,nonNullable:!0})],pe.prototype,"gridSnapEnabledToggle",void 0),r([a({type:Boolean,nonNullable:!0})],pe.prototype,"lineIntervalInput",void 0),r([a({type:Boolean,nonNullable:!0})],pe.prototype,"outOfScaleWarning",void 0),r([a({type:Boolean,nonNullable:!0})],pe.prototype,"placementButtons",void 0),r([a({type:Boolean,nonNullable:!0})],pe.prototype,"rotateWithMapToggle",void 0),pe=r([k("esri.widgets.support.GridControls.VisibleElements")],pe);const Zs=pe;let de=class extends le{constructor(e){super(e),this.enabledToggle=!0,this.featureEnabledToggle=!0,this.gridEnabledToggle=!0,this.header=!1,this.layerList=!0,this.gridControls=!0,this.gridControlsElements=new Zs({gridSnapEnabledToggle:!1,gridEnabledToggle:!1}),this.layerListToggleLayersButton=!0,this.selfEnabledToggle=!0}};r([a({type:Boolean,nonNullable:!0})],de.prototype,"enabledToggle",void 0),r([a({type:Boolean,nonNullable:!0})],de.prototype,"featureEnabledToggle",void 0),r([a({type:Boolean,nonNullable:!0})],de.prototype,"gridEnabledToggle",void 0),r([a({type:Boolean,nonNullable:!0})],de.prototype,"header",void 0),r([a({type:Boolean,nonNullable:!0})],de.prototype,"layerList",void 0),r([a({type:Boolean,nonNullable:!0})],de.prototype,"gridControls",void 0),r([a({type:Zs,nonNullable:!0})],de.prototype,"gridControlsElements",void 0),r([a({type:Boolean,nonNullable:!0})],de.prototype,"layerListToggleLayersButton",void 0),r([a({type:Boolean,nonNullable:!0})],de.prototype,"selfEnabledToggle",void 0),de=r([k("esri.widgets.support.SnappingControls.VisibleElements")],de);const ui=de,Ns=()=>He({icon:()=>M(()=>import("./index-Buwx-j9b-DSW1tK6e.js"),__vite__mapDeps([60,3,1,2,4,5,61,62]),import.meta.url).then(e=>e.i),label:()=>M(()=>import("./index-Hni9f9UA-2ETnnoL2.js"),__vite__mapDeps([63,3,1,2,4,5,64,61]),import.meta.url),switch:()=>M(()=>import("./index-8PAcNuSr-CBKOzR7g.js"),__vite__mapDeps([65,3,1,2,4,5,66,61,67,68,69,64,70]),import.meta.url),tooltip:()=>M(()=>import("./index-D4Uosrk4-ByD9vEN5.js"),__vite__mapDeps([71,3,1,2,4,5,66,72,61,73,74,75,76,77]),import.meta.url)}),Ot="esri-labeled-switch",Lt={label:`${Ot}__label`,labelContent:`${Ot}__label-content`,iconInfo:`${Ot}__icon_info`,iconWarning:`${Ot}__icon_warning`,tooltip:`${Ot}__tooltip`};function _t({checked:e,disabled:t,hint:i,key:n,label:s,onChange:o,hintIcon:l,hintKind:c}){return u("calcite-label",{class:Lt.label,disabled:t,key:n,layout:"inline-space-between",scale:"s"},i?u("div",{class:Lt.labelContent,key:"label-content"},u("div",null,s),u("calcite-icon",{class:c!=="warning"?Lt.iconInfo:Lt.iconWarning,icon:l??"information",id:n,scale:"s",tabIndex:0}),u("calcite-tooltip",{class:Lt.tooltip,overlayPositioning:"fixed",referenceElement:n},i)):s,u("calcite-switch",{checked:e,disabled:t,scale:"s",onCalciteSwitchChange:p=>o(p.currentTarget.checked)}))}let Ke=class extends le{constructor(e){super(e),this.directionModePicker=!1,this.header=!1,this.labelsToggle=!0,this.tooltipsToggle=!0}};r([a({type:Boolean,nonNullable:!0})],Ke.prototype,"directionModePicker",void 0),r([a({type:Boolean,nonNullable:!0})],Ke.prototype,"header",void 0),r([a({type:Boolean,nonNullable:!0})],Ke.prototype,"labelsToggle",void 0),r([a({type:Boolean,nonNullable:!0})],Ke.prototype,"tooltipsToggle",void 0),Ke=r([k("esri.widgets.support.SketchTooltipControls.VisibleElements")],Ke);const rn=Ke,kt="esri-sketch-tooltip-controls",jt={base:kt,block:`${kt}__block`,blockContent:`${kt}__block-content`,hintIcon:`${kt}__hint-icon`,radioButtonLabelWrapper:`${kt}__radio-button-label-wrapper`};let Ie=class extends Ve{constructor(e,t){super(e,t),this.viewModel=null,this.visibleElements=new rn,this.sketchOptions=new ns,this.viewType=void 0,this._onTooltipsEnabledChange=i=>{this.sketchOptions.tooltips.enabled=i},this._onLabelsEnabledChange=i=>{this.sketchOptions.labels.enabled=i},this._onDirectionModeChange=i=>{this.sketchOptions.values.directionMode=i.currentTarget.selectedItem.value}}loadDependencies(){return Promise.all([He({block:()=>M(()=>import("./index-J94OCPzp-DHmmW0R8.js"),__vite__mapDeps([78,79,3,1,2,4,5,74,80,81,66,62,61,60,82,72,73,68,69,70,75,83,84,77,85,86,87,88,89,90,91,76,92,93]),import.meta.url),label:()=>M(()=>import("./index-Hni9f9UA-2ETnnoL2.js"),__vite__mapDeps([63,3,1,2,4,5,64,61]),import.meta.url),icon:()=>M(()=>import("./index-Buwx-j9b-DSW1tK6e.js"),__vite__mapDeps([60,3,1,2,4,5,61,62]),import.meta.url).then(e=>e.i),"radio-button":()=>M(()=>import("./index-DjLe4PDK-owYIe6QZ.js"),__vite__mapDeps([94,3,1,2,4,5,66,93,61,67,68,64,70]),import.meta.url),"radio-button-group":()=>M(()=>import("./index-GmJqqGd6-QMkEvBUo.js"),__vite__mapDeps([95,60,3,1,2,4,5,61,62,96,70,97]),import.meta.url)}),Ns()])}render(){const{label:e,visibleElements:t}=this,i=this._renderContent();return u("div",{"aria-label":e,class:this.classes(jt.base,Qi.widget)},i?u("calcite-block",{class:jt.block,heading:t.header?this.label:"",key:"content-block",label:this.label,open:!0},u("div",{class:jt.blockContent,key:"content"},i)):void 0)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}_renderContent(){const{visibleElements:e,viewType:t}=this,i=[e.tooltipsToggle?this._renderTooltipsToggle():null,e.labelsToggle&&t!=="2d"?this._renderLabelsToggle():null,e.directionModePicker?this._renderDirectionModePicker():null].filter(ae);return i.length===0?null:i}_renderTooltipsToggle(){const{messages:e,sketchOptions:t}=this;return u(_t,{checked:t.tooltips.effectiveEnabled,hint:e.tooltipsToggleHint,key:`${this.id}__tooltips`,label:e.tooltipsToggle,onChange:this._onTooltipsEnabledChange})}_renderLabelsToggle(){const{messages:e,sketchOptions:t}=this;return u(_t,{checked:t.labels.enabled,hint:e.labelsToggleHint,key:`${this.id}__labels`,label:e.labelsToggle,onChange:this._onLabelsEnabledChange})}_renderDirectionModePicker(){const{messages:e,sketchOptions:t}=this,{directionMode:i}=t.values;return u("calcite-label",{key:"direction-mode",layout:"default",scale:"s"},e.directionModePicker,u("calcite-radio-button-group",{key:"radio-button-group",layout:"horizontal",name:this.id,scale:"s",value:i,onCalciteRadioButtonGroupChange:this._onDirectionModeChange},this._renderDirectionModeOption("relative",i,e.directionModeRelative),this._renderDirectionModeOption("absolute",i,e.directionModeAbsolute)))}_renderDirectionModeOption(e,t,i){return u("calcite-label",{key:e,layout:"inline",scale:"s"},u("calcite-radio-button",{checked:e===t,scale:"s",value:e}),u("div",{class:jt.radioButtonLabelWrapper,key:"label-wrapper"},u("calcite-icon",{icon:Dl[e],scale:"s"}),i))}};r([a()],Ie.prototype,"label",null),r([a({type:rn,nonNullable:!0})],Ie.prototype,"visibleElements",void 0),r([a(),$e("esri/widgets/support/SketchTooltipControls/t9n/SketchTooltipControls")],Ie.prototype,"messages",void 0),r([a({nonNullable:!0,type:ns})],Ie.prototype,"sketchOptions",void 0),r([a({type:String})],Ie.prototype,"viewType",void 0),Ie=r([k("esri.widgets.support.SketchTooltipControls")],Ie);const Ul=Ie,me={view:"view",viewLayers:"view-layers",mapLayers:"map-layers",layerViews:"layer-views",layerListMode:"layer-list-mode"},Wl="hide",Us=Ee.ofType(on);let we=class extends Be.EventedAccessor{constructor(e){super(e),this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.operationalItems=new Us,this.view=null}initialize(){this.addHandles([R(()=>this.view?.ready===!0,()=>this._viewHandles(),he),R(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._recompileList()),R(()=>Mn(this.view)?this.view.inGeographicLayout:null,()=>this._compileList())],me.view)}destroy(){this._removeAllItems(),this.view=null}get state(){const{view:e}=this;return e?.ready?"ready":e?"loading":"disabled"}get totalItems(){return this.operationalItems.flatten(e=>e.children).length}triggerAction(e,t){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:t})}moveListItem(e,t,i,n){const s=e?.layer;if(!s||s.type==="subtype-sublayer"||s.type==="sublayer")return;const o=this.view?.map?.layers,l=t?$n(t):o,c=i?$n(i):o;if(!l||!c)return;const{operationalItems:p}=this,d=t?.children||p,h=i?.children||p,g=c.length-n;e.parent=i||null,d.remove(e),l.remove(s),h.includes(e)||h.add(e,g),c.includes(s)||c.add(s,g),this._compileList()}_createLayerViewHandles(e){this.removeHandles(me.layerViews),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),me.layerViews)}_createMapLayerHandles(e){this.removeHandles(me.mapLayers),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),me.mapLayers)}_createListItem(e){const{view:t,listItemCreatedFunction:i,checkPublishStatusEnabled:n,listModeDisabled:s}=this;return new on({checkPublishStatusEnabled:n,listModeDisabled:s,layer:e,listItemCreatedFunction:i,view:t})}_removeAllItems(){this.operationalItems.destroyAll()}_getViewableLayers(e){return e?this.listModeDisabled?e:e.filter(t=>ri(t)!==Wl):void 0}_watchLayersListMode(e){this.removeHandles(me.layerListMode),e&&!this.listModeDisabled&&this.addHandles(R(()=>e.filter(t=>"listMode"in t).map(t=>t.listMode).toArray(),()=>this._compileList()),me.layerListMode)}_compileList(){const e=this.view?.map?.layers,t=Mn(this.view)&&!this.view.inGeographicLayout?e?.filter(({type:n})=>n==="link-chart"):e;this._watchLayersListMode(t);const i=this._getViewableLayers(t);i?.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createNewItems(e){const{operationalItems:t}=this;e.forEach(i=>{t.some(n=>n.layer===i)||t.add(this._createListItem(i))})}_removeItems(e){const{operationalItems:t}=this,i=[];t.forEach(n=>{n&&e&&e.includes(n.layer)||i.push(n)}),t.destroyMany(i)}_sortItems(e){const{operationalItems:t}=this;t.sort((i,n)=>{const s=e.indexOf(i.layer),o=e.indexOf(n.layer);return s>o?-1:s<o?1:0})}_recompileList(){this._removeAllItems(),this._compileList()}_viewHandles(){const{view:e}=this;this.removeHandles([me.mapLayers,me.layerViews,me.viewLayers]),e?.ready?this.addHandles([R(()=>this.view?.map?.allLayers,t=>this._createMapLayerHandles(t),he),R(()=>this.view?.allLayerViews,t=>this._createLayerViewHandles(t),he)],me.viewLayers):this._removeAllItems()}};r([a()],we.prototype,"checkPublishStatusEnabled",void 0),r([a()],we.prototype,"listItemCreatedFunction",void 0),r([a({nonNullable:!0})],we.prototype,"listModeDisabled",void 0),r([a({type:Us})],we.prototype,"operationalItems",void 0),r([a({readOnly:!0})],we.prototype,"state",null),r([a()],we.prototype,"totalItems",null),r([a()],we.prototype,"view",void 0),we=r([k("esri.widgets.LayerList.LayerListViewModel")],we);const jl=we,an=e=>Xl(e)||Yl(e),Xl=e=>{if(!("type"in e))return!1;switch(e.type){case"feature":case"geojson":case"csv":case"graphics":case"wfs":case"map-notes":case"oriented-imagery":case"scene":case"building-scene":case"subtype-sublayer":return!0;default:return!1}},Yl=e=>{const t=$s(e);if(t!=null&&e.hasOwnProperty(t)&&e[t]!=null){for(const i of e[t])if(an(i))return!0}return!1},ei=(e,t)=>t!=null&&e!=null&&(t.test(e.title)?"self":!!e.children.some(i=>ei(i,t)!==!1)&&"children");var Wi;let Se=Wi=class extends on{constructor(e){super(e),this.children=new Ee,this.parent=null}get enabled(){const{children:e}=this;if(e.length===0)return this.featureSource!=null&&this.featureSource.enabled?"enabled":"disabled";let t=!1,i=!1;for(const n of e){if(n.enabled==="indeterminate")return n.enabled;if(n.enabled==="enabled"?t=!0:n.enabled==="disabled"&&(i=!0),i&&t)return"indeterminate"}return i?"disabled":"enabled"}get childLayerIds(){return this.children.toArray().flatMap(e=>[e.layer?.id,...e.childLayerIds])}get featureSource(){const{layer:e,getFeatureSnappingSources:t}=this;return t().find(i=>i.layer===e)}_initializeChildLayers(e){if(!e)return;const t=e.filter(an);super._initializeChildLayers(t)}_createChildItems(e){return e.map(t=>sn(t)?new Wi({layer:t,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null).filter(ae).reverse()}};r([a()],Se.prototype,"enabled",null),r([a()],Se.prototype,"children",void 0),r([a()],Se.prototype,"childLayerIds",null),r([a()],Se.prototype,"featureSource",null),r([a({constructOnly:!0})],Se.prototype,"getFeatureSnappingSources",void 0),r([a()],Se.prototype,"parent",void 0),Se=Wi=r([k("esri.widgets.support.SnappingControls.SnappingListItem")],Se);let Qe=class extends jl{constructor(){super(...arguments),this.featureSnappingSources=new Ee}get operationalItemsFlat(){return this.operationalItems.flatten(e=>e.children)}get selectableItems(){return this.operationalItemsFlat.filter(e=>!e.children?.length)}_compileList(){const e=this.view?.map?.layers;if(!e)return;const t=e.filter(an);this._watchLayersListMode(t);const i=this._getViewableLayers(t);i?.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createListItem(e){return new Se({layer:e,view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})}};r([a()],Qe.prototype,"featureSnappingSources",void 0),r([a()],Qe.prototype,"operationalItems",void 0),r([a()],Qe.prototype,"operationalItemsFlat",null),r([a()],Qe.prototype,"selectableItems",null),Qe=r([k("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],Qe);let be=class extends le{constructor(e){super(e),this.layerListViewModel=new Qe,this.snappingOptions=new ss,this.view=null}initialize(){this.addHandles([R(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:e,view:t})=>{e.view=t},he),R(()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources}),({viewModel:e,sources:t})=>{e.featureSnappingSources=t},he)])}get allLayersEnabled(){return(this.layerListViewModel?.selectableItems??[]).every(e=>e.enabled==="enabled")}get allLayersDisabled(){return(this.layerListViewModel?.selectableItems??[]).every(e=>!e.enabled)}get layersEnabledCount(){return this.layerListViewModel?.selectableItems?.filter(e=>e.enabled==="enabled").length??0}get state(){return this.snappingOptions?"ready":"disabled"}toggleSnappingForLayers(e,t){e?.forEach(i=>t?this.enableSnappingForLayer(i):this.disableSnappingForLayer(i))}toggleSnappingForAllLayers(e){this.layerListViewModel.selectableItems.forEach(({layer:t})=>{const i=t?.id;e?this.enableSnappingForLayer(i):this.disableSnappingForLayer(i)})}enableSnappingForLayer(e){const t=this._findSnappingSourceForLayer(e)??this._makeSnappingSourceForLayer(e);t&&(t.enabled=!0)}disableSnappingForLayer(e){const t=this._findSnappingSourceForLayer(e);t&&(t.enabled=!1)}updateEnabledFeatureSources(e){for(const t of this.snappingOptions.featureSources)sn(t.layer)&&(t.enabled=e.includes(t.layer.id))}_findSnappingSourceForLayer(e){return this.snappingOptions.featureSources.find(t=>t.layer.id===e)}_makeSnappingSourceForLayer(e){const t=this.layerListViewModel.operationalItemsFlat.find(n=>n.layer?.id===e)?.layer;if(!t)throw new Ho("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${e} because no such layer was found in the view`);if(t.type==="group")return;const i=new mr({layer:t});return this.snappingOptions.featureSources.add(i),i}};r([a()],be.prototype,"allLayersEnabled",null),r([a()],be.prototype,"allLayersDisabled",null),r([a({constructOnly:!0})],be.prototype,"layerListViewModel",void 0),r([a()],be.prototype,"layersEnabledCount",null),r([a({type:ss,nonNullable:!0})],be.prototype,"snappingOptions",void 0),r([a()],be.prototype,"state",null),r([a()],be.prototype,"view",void 0),be=r([k("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],be);const ql=be,ye="esri-snapping-controls",_e={base:ye,container:`${ye}__container`,item:`${ye}__item`,toggleBlock:`${ye}__toggle-block`,layerListBlock:`${ye}__layer-list-block`,layerList:`${ye}__layer-list`,layerListFilter:`${ye}__layer-list__filter`,layerListButton:`${ye}__layer-list__button`,layerListItem:`${ye}__layer-list__item`,layerListGroup:`${ye}__layer-list__group`,nestedContainer:`${ye}__nested-container`};let F=class extends Ve{constructor(e,t){super(e,t),this._defaultViewModel=null,this._layerListFilter=null,this._gridLoadTask=null,this.layerListOpen=!0,this.gridOptionsOpen=!1,this.messages=null,this.messagesCommon=null,this.snappingManager=null,this.visibleElements=new ui,this._enableSnappingSwitchChange=o=>{this.snappingOptions.enabled=o},this._featureEnabledSwitchChange=o=>{this.snappingOptions.featureEnabled=o},this._gridEnabledSwitchChange=o=>{this.snappingOptions.gridEnabled=o,o&&this._startLoadGrid()},this._selfEnabledSwitchChange=o=>{this.snappingOptions.selfEnabled=o},this._onToggleLayersButtonClick=o=>{this.viewModel.toggleSnappingForAllLayers(!this.viewModel.allLayersEnabled),xr(o.target)};const{snappingOptions:i,view:n,viewModel:s}=e;this.viewModel=s??(this._defaultViewModel=new ql({snappingOptions:i,view:n}))}normalizeCtorArgs(e){const{snappingOptions:t,view:i,viewModel:n,...s}=e;return s}destroy(){this.viewModel!==this._defaultViewModel&&(this._defaultViewModel=xe(this._defaultViewModel))}loadDependencies(){return Promise.all([He({block:()=>M(()=>import("./index-J94OCPzp-DHmmW0R8.js"),__vite__mapDeps([78,79,3,1,2,4,5,74,80,81,66,62,61,60,82,72,73,68,69,70,75,83,84,77,85,86,87,88,89,90,91,76,92,93]),import.meta.url),button:()=>M(()=>import("./index-BUYNV2Id-LfMLnfN8.js"),__vite__mapDeps([98,79,3,1,2,4,5,74,80,60,61,62,66,91,67,68,64,70,85]),import.meta.url),input:()=>M(()=>import("./index-DBbiKKfA-DAV3rS8P.js"),__vite__mapDeps([99,60,3,1,2,4,5,61,62,96,100,101,66,69,77,91,67,68,64,70,85,97,80]),import.meta.url),list:()=>M(()=>import("./index-CWPudE9o-CcPCdi2s.js"),__vite__mapDeps([102,79,3,1,2,4,5,74,80,81,66,62,61,77,60,96,100,99,101,69,91,67,68,64,70,85,97,73,103]),import.meta.url),"list-item":()=>M(()=>import("./index-CDdEHo-w-DLXd__ol.js"),__vite__mapDeps([104,60,3,1,2,4,5,61,62,82,66,72,73,74,68,69,70,75,83,79,80,84,77,85,86,87,88,89,103,105]),import.meta.url),checkbox:()=>M(()=>import("./index-CGKRKPuM-BP_QBUri.js"),__vite__mapDeps([106,3,1,2,4,5,66,61,67,68,69,64,70]),import.meta.url),loader:()=>M(()=>import("./index-Cezzb5s0-B47aWd3U.js"),__vite__mapDeps([79,3,1,2,4,5,74,80]),import.meta.url)}),Ns()])}initialize(){this.addHandles(R(()=>this.view?.type==="2d"&&!!this.view.grid,e=>{this.visibleElements.gridControls&&(this.snappingOptions.gridEnabled=e)}))}get _openAndReady(){return this.gridOptionsOpen&&this.snappingOptions.gridEnabled&&this.snappingOptions.enabled}get icon(){return"snap-to-point"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){e!==this._get("viewModel")&&(this._defaultViewModel!=null&&this._defaultViewModel===e||(this._defaultViewModel=xe(this._defaultViewModel)),this._set("viewModel",e))}render(){const{label:e}=this;return u("div",{"aria-label":e,class:this.classes(_e.base,Qi.widget)},u("div",{class:_e.container},this._renderContent()))}_renderContent(){return[this._renderToggles(),this._renderLayerList(),this.view?.type==="2d"&&this.visibleElements.gridControls?this._renderGridOptions():null]}_renderToggles(){const{visibleElements:e,view:t}=this,i=[e.selfEnabledToggle?this._renderSelfEnabledToggle():null,e.featureEnabledToggle?this._renderFeatureEnabledToggle():null,e.gridEnabledToggle&&t?.type==="2d"?this._renderGridEnabledToggle():null].filter(ae),n=[e.enabledToggle?this._renderEnabledToggle():null,i.length>0?u("div",{class:_e.nestedContainer},i):null].filter(ae);return n.length===0?null:u("calcite-block",{class:_e.toggleBlock,heading:e.header?this.label:"",key:"toggle-block",label:this.label,open:!0},n)}_renderEnabledToggle(){return u(_t,{checked:this.viewModel.snappingOptions.enabled,disabled:this._enabledToggleDisabled,key:`${this.id}__enabled-toggle`,label:this.messages.enableSnapping,onChange:this._enableSnappingSwitchChange})}_renderSelfEnabledToggle(){return u(_t,{checked:this.viewModel.snappingOptions.selfEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__self-enabled-toggle`,label:this.messages.geometryGuides,onChange:this._selfEnabledSwitchChange})}_renderFeatureEnabledToggle(){return u(_t,{checked:this.viewModel.snappingOptions.featureEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__feature-enabled-toggle`,label:this.messages.featureToFeature,onChange:this._featureEnabledSwitchChange})}_renderGridEnabledToggle(){return u(_t,{checked:this.viewModel.snappingOptions.gridEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__grid-enabled-toggle`,label:this.messages.grid,onChange:this._gridEnabledSwitchChange})}_renderLayerList(){if(!this.visibleElements.layerList)return null;const{messages:e,viewModel:t}=this,i=t.layerListViewModel.operationalItems.length>9?u("calcite-input",{class:_e.layerListFilter,clearable:!0,placeholder:e?.searchLayers,onCalciteInputInput:({currentTarget:{value:l}})=>{this._layerListFilter=l===""?null:new RegExp(l,"i")}}):null,n=this._secondaryElementsDisabled,s=this.layerListOpen&&!n,o=t.layerListViewModel.operationalItems?.find(l=>!!l.children.length);return u("calcite-block",{class:_e.layerListBlock,collapsible:!0,disabled:this._secondaryElementsDisabled,heading:e.snappingLayers,key:"list-block",open:s,onCalciteBlockToggle:l=>this.layerListOpen=l.currentTarget.open},i,this._renderToggleLayersButton(),u("calcite-list",{class:_e.layerList,displayMode:o?"nested":"flat",label:e?.snappingLayers,selectionMode:"none"},this._renderLayerListItemCollection(t.layerListViewModel.operationalItems)))}_renderGridOptions(){const{view:e,visibleElements:t,snappingManager:i,snappingOptions:n,_openAndReady:s}=this,{gridEnabled:o,enabled:l}=n;(s||e?.type==="2d"&&e.grid)&&this._startLoadGrid();const c=this._gridLoadTask?.value,p=c&&e?.type==="2d"&&u(c,{snappingManager:i,snappingOptions:n,view:e,visibleElements:t.gridControlsElements});return u("calcite-block",{class:_e.layerListBlock,collapsible:!0,disabled:!o||!l,heading:this.messages.gridOptionsHeading,key:"grid-block",open:s,onCalciteBlockClose:()=>this.gridOptionsOpen=!1,onCalciteBlockOpen:()=>this.gridOptionsOpen=!0},p??u("calcite-loader",{label:this.messagesCommon.loading,scale:"s",text:this.messagesCommon.loading}))}async _startLoadGrid(){!this._gridLoadTask&&this.visibleElements.gridControls&&this.view?.type==="2d"&&(this._gridLoadTask=Jn(async()=>(await M(async()=>{const{default:e}=await import("./GridControls-CEUIsZ2n-B7wwA91B.js");return{default:e}},__vite__mapDeps([107,1,2,4,108,109,46,47,48,30,110,3,5,111,15,112,113,114,115,11,116,10,117,118,119,120,37,121,122,123,124,125,126,127,128,56,129,130,12,8,9,131,26,132,133,134,135,136,137,38,138,139,140,58,141,142,143,144,145,146,147,148,149,35,150,151,152,153,154,155,156,44,33,34,157,158,159,50,160,161,162,163,41,164,165,166,167,168,52,169,59,170,171]),import.meta.url)).default))}_renderLayerListItemCollection(e){const t=this._layerListFilter;return e.map(i=>{switch(t?ei(i,t):null){case"children":{const n=i.children.filter(s=>ei(s,t)!==!1);return this._renderLayerListItemGroup(i,n)}case"self":case null:return this._renderLayerListItemOrGroup(i);case!1:return ei(i.parent,t)==="self"?this._renderLayerListItemOrGroup(i):null}}).toArray().filter(ae)}_renderToggleLayersButton(){if(!this.visibleElements.layerListToggleLayersButton)return null;const{viewModel:{allLayersEnabled:e},messages:t}=this,i=e?t.disableAllLayers:t.enableAllLayers;return u("calcite-button",{appearance:"transparent",class:_e.layerListButton,label:i,name:"layer-toggle",onclick:this._onToggleLayersButtonClick},i)}_renderLayerListItemOrGroup(e){if(e.children.length)return this._renderLayerListItemGroup(e);const{messages:{untitledLayer:t}}=this,i=e.title||t,n=()=>{this.viewModel.toggleSnappingForLayers([e.layer?.id],e.enabled!=="enabled")};return u("calcite-list-item",{class:_e.layerListItem,key:`${this.id}-list-item-${e.uid}`,label:i,onCalciteListItemSelect:s=>{s.stopPropagation(),n()}},u("calcite-checkbox",{checked:e.enabled==="enabled",slot:"actions-start",onCalciteCheckboxChange:n}))}_renderLayerListItemGroup(e,t){const{messages:i}=this,{children:n,title:s}=e,o=s||i.untitledLayer,l=s&&s!==""?s:Fo(),c=!!t?.length,p=t??n,d=()=>{this.viewModel.toggleSnappingForLayers(e.childLayerIds,e.enabled!=="enabled")},h=p?.find(g=>!!g.children.length);return u("calcite-list-item",{class:_e.layerListGroup,key:l,label:o,open:c,onCalciteListItemSelect:g=>{g.stopPropagation(),d()}},u("calcite-checkbox",{checked:e.enabled==="enabled",indeterminate:e.enabled==="indeterminate",slot:"actions-start",onCalciteCheckboxChange:d}),u("calcite-list",{displayMode:h?"nested":"flat",label:i?.snappingLayers,selectionMode:"none"},this._renderLayerListItemCollection(p)))}get _enabledToggleDisabled(){const e=this.snappingOptions;return e.enabledToggled||e.forceDisabled}get _secondaryElementsDisabled(){return this._enabledToggleDisabled||!this.snappingOptions.enabled}};r([a()],F.prototype,"_defaultViewModel",void 0),r([a()],F.prototype,"_layerListFilter",void 0),r([a()],F.prototype,"_gridLoadTask",void 0),r([a()],F.prototype,"_openAndReady",null),r([a()],F.prototype,"label",null),r([a({type:Boolean,nonNullable:!0})],F.prototype,"layerListOpen",void 0),r([a({type:Boolean,nonNullable:!0})],F.prototype,"gridOptionsOpen",void 0),r([a(),$e("esri/widgets/support/SnappingControls/t9n/SnappingControls")],F.prototype,"messages",void 0),r([a(),$e("esri/t9n/common")],F.prototype,"messagesCommon",void 0),r([a()],F.prototype,"snappingOptions",null),r([a()],F.prototype,"snappingManager",void 0),r([a()],F.prototype,"view",null),r([a()],F.prototype,"viewModel",null),r([a({type:ui,nonNullable:!0})],F.prototype,"visibleElements",void 0),r([a()],F.prototype,"_enabledToggleDisabled",null),r([a()],F.prototype,"_secondaryElementsDisabled",null),F=r([k("esri.widgets.support.SnappingControls")],F);const Kl=F;let re=class extends le{constructor(e){super(e),this.point=!0,this.polyline=!0,this.polygon=!0,this.rectangle=!0,this.circle=!0,this.multipoint=!0,this.mesh=!0,this.freehandPolyline=!1,this.freehandPolygon=!1}};r([a({type:Boolean,nonNullable:!0})],re.prototype,"point",void 0),r([a({type:Boolean,nonNullable:!0})],re.prototype,"polyline",void 0),r([a({type:Boolean,nonNullable:!0})],re.prototype,"polygon",void 0),r([a({type:Boolean,nonNullable:!0})],re.prototype,"rectangle",void 0),r([a({type:Boolean,nonNullable:!0})],re.prototype,"circle",void 0),r([a({type:Boolean,nonNullable:!0})],re.prototype,"multipoint",void 0),r([a({type:Boolean,nonNullable:!0})],re.prototype,"mesh",void 0),r([a({type:Boolean,nonNullable:!0})],re.prototype,"freehandPolyline",void 0),r([a({type:Boolean,nonNullable:!0})],re.prototype,"freehandPolygon",void 0),re=r([k("esri.widgets.Sketch.VisibleElements.CreateToolVisibilityMap")],re);let st=class extends le{constructor(e){super(e),this["rectangle-selection"]=!0,this["lasso-selection"]=!0,this["custom-selection"]=!0}};r([a({nonNullable:!0})],st.prototype,"rectangle-selection",void 0),r([a({nonNullable:!0})],st.prototype,"lasso-selection",void 0),r([a({nonNullable:!0})],st.prototype,"custom-selection",void 0),st=r([k("esri.widgets.Sketch.VisibleElements.SelectionToolVisibilityMap")],st);let Y=class extends le{constructor(e){super(e),this.createTools=new re,this.directionModePicker=!1,this.duplicateButton=!0,this.deleteButton=!0,this.selectionCountLabel=!0,this.labelsToggle=!0,this.selectionTools=new st,this.settingsMenu=!0,this.snappingControls=!0,this.snappingControlsElements=new ui,this.tooltipsToggle=!0,this.undoRedoMenu=!0}};r([a({type:re,nonNullable:!0})],Y.prototype,"createTools",void 0),r([a({type:Boolean,nonNullable:!0})],Y.prototype,"directionModePicker",void 0),r([a({type:Boolean,nonNullable:!0})],Y.prototype,"duplicateButton",void 0),r([a({type:Boolean,nonNullable:!0})],Y.prototype,"deleteButton",void 0),r([a({type:Boolean,nonNullable:!0})],Y.prototype,"selectionCountLabel",void 0),r([a({type:Boolean,nonNullable:!0})],Y.prototype,"labelsToggle",void 0),r([a({type:st,nonNullable:!0})],Y.prototype,"selectionTools",void 0),r([a({type:Boolean,nonNullable:!0})],Y.prototype,"settingsMenu",void 0),r([a({type:Boolean,nonNullable:!0})],Y.prototype,"snappingControls",void 0),r([a({type:ui,nonNullable:!0})],Y.prototype,"snappingControlsElements",void 0),r([a({type:Boolean,nonNullable:!0})],Y.prototype,"tooltipsToggle",void 0),r([a({type:Boolean,nonNullable:!0})],Y.prototype,"undoRedoMenu",void 0),Y=r([k("esri.widgets.Sketch.VisibleElements")],Y);const q={groupSeparator:1,action:{s:32,m:48,l:64},splitButtonPart:{horizontal:{s:16,m:16,l:24},vertical:{s:16,m:24,l:40}}},Ws={splitButton:{horizontal:"chevron-down",vertical:"ellipsis"},overflow:"ellipsis"};function js(e,t){return e.vnodeSelector===t?[e]:e.children?.flatMap(i=>js(i,t))??[]}const ln=e=>{let t=class extends e{constructor(){super(...arguments),this.priority=0,this.scale="m",this.slot=void 0,this.lastActiveKey=null,this.layout="horizontal"}destroy(){this.measurementManager?.managedElements.remove(this),this.measurementManager=null}set measurementManager(i){const n=this._get("measurementManager");i!==n&&(n&&n.managedElements.remove(this),this._set("measurementManager",i),i?.managedElements.add(this))}set budgetedLength(i){this.budgetedLength!==i&&(this._set("budgetedLength",i),this.scheduleRender())}get actionChildren(){return this.children?.flatMap(i=>js(i,"calcite-action"))??[]}get activeChildElement(){const i=this.actionChildren.find(n=>n.properties?.active===!0);return i?(this._set("lastActiveKey",i.properties?.key),i):this.lastActiveKey?this.actionChildren.find(n=>n.properties?.key===this.lastActiveKey):void 0}_handleClick(i){i?.dataset&&"dataset"in i&&i.dataset.actionKey&&(this.lastActiveKey=i.dataset.actionKey)}};return r([a()],t.prototype,"priority",void 0),r([a()],t.prototype,"measurementManager",null),r([a()],t.prototype,"budgetedLength",null),r([a()],t.prototype,"actionChildren",null),r([a()],t.prototype,"activeChildElement",null),r([a()],t.prototype,"scale",void 0),r([a()],t.prototype,"slot",void 0),r([a()],t.prototype,"lastActiveKey",void 0),r([a()],t.prototype,"layout",void 0),t=r([k("esri.widgets.Sketch.support.ResponsiveToolbar.ToolbarGroupBase")],t),t},Bn=Symbol("on-resize-handle-key");let Je=class extends ln(Ve){constructor(e){super(e),this._measuredWidth=0,this._measuredHeight=0,this._measuredElement=null}destroy(){this._measuredElement=null}get lengthOptions(){return[this.layout==="horizontal"?this._measuredWidth:this._measuredHeight]}render(){return u("div",{afterCreate:e=>{this._measuredElement=e.firstElementChild,this.addHandles(Tr(this._measuredElement,()=>{this._measuredWidth=this._measuredElement?.clientWidth??0,this._measuredHeight=this._measuredElement?.clientHeight??0}),Bn)},afterRemoved:()=>this.removeHandles(Bn)},this.children)}};r([a()],Je.prototype,"_measuredWidth",void 0),r([a()],Je.prototype,"_measuredHeight",void 0),r([a()],Je.prototype,"lengthOptions",null),r([a()],Je.prototype,"_measuredElement",void 0),Je=r([k("esri.widgets.Sketch.support.ResponsiveToolbar.MeasuredContentGroup")],Je);const Ql=Je;let De=class extends ln(Ve){constructor(e){super(e),this.allowCollapse=!0,this.messagesCommon=null}loadDependencies(){return He({action:()=>M(()=>import("./index-CytjfAQD-Ciz-RVgE.js"),__vite__mapDeps([84,79,3,1,2,4,5,74,80,60,61,62,77,66,68,70,85]),import.meta.url),"action-group":()=>M(()=>import("./index-KqP5VmvP-CJbxPnIj.js"),__vite__mapDeps([172,79,3,1,2,4,5,74,80,60,61,62,84,77,66,68,70,85,90,72,73,75,91,76,69,92,93]),import.meta.url).then(e=>e.i),"action-menu":()=>M(()=>import("./index-VtdpGf3k-CYviBhvg.js"),__vite__mapDeps([92,79,3,1,2,4,5,74,80,60,61,62,84,77,66,68,70,85,90,72,73,75,91,76,69,93]),import.meta.url).then(e=>e.i)})}get minimumLength(){const{actionChildren:e,scale:t}=this;return e.length?this.allowCollapse?q.groupSeparator+q.action[t]*Math.min(e.length,2):q.groupSeparator+q.action[t]*e.length:0}get lengthOptions(){const{actionChildren:e,scale:t,minimumLength:i,allowCollapse:n,priority:s}=this,o=[i];if(e.length<=2||!n||s<1)return o;for(let l=1;l<e.length-1;l++)o.push(i+q.action[t]*l);return o}render(){if(!this.actionChildren.length)return u(cs,null,void 0);const{budgetedLength:e,actionChildren:t,activeChildElement:i,layout:n,slot:s,scale:o}=this,l=Math.floor(e/q.action[o]),c=[],p=[];if(l>=t.length)c.push(...t);else{const d=i??c.at(0);if(c.push(...t.slice(0,l-1)),p.push(...t.slice(l-1)),d&&p.includes(d)){const[h]=p.splice(p.indexOf(d),1),g=c.pop();c.push(h),g&&p.unshift(g)}}return u("calcite-action-group",{key:"overflow-button-group",layout:n,onclick:d=>this._handleClick(d.target),slot:s},c.map(d=>this._renderManagedAction(d)),p.length>0?u("calcite-action-menu",{key:"split-button-dropdown",label:this.messagesCommon.more,overlayPositioning:"fixed"},u("calcite-action",{icon:Ws.overflow,key:"split-button-dropdown-trigger",scale:o,slot:"trigger",text:this.messagesCommon.more}),p.map(d=>this._renderManagedAction(d))):void 0)}_renderManagedAction(e){return u("calcite-action",{...e?.properties,"data-action-key":e?.properties?.key,text:e?.properties?.text??""})}};De.vnodeSelector="calcite-action-group",r([a()],De.prototype,"allowCollapse",void 0),r([a()],De.prototype,"minimumLength",null),r([a(),$e("esri/t9n/common")],De.prototype,"messagesCommon",void 0),r([a()],De.prototype,"lengthOptions",null),De=r([k("esri.widgets.Sketch.support.ResponsiveToolbar.OverflowGroup")],De);const Jl=De;let Ae=class extends le{constructor(){super(...arguments),this.measuredElement=null,this.managedElements=new Ee,this.availableLength=0,this.layout="horizontal",this._resizeObserver=new ResizeObserver(()=>{this._measure()})}get _sortedElements(){return[...this.managedElements].sort((e,t)=>t.priority-e.priority)}connect(e){this._resizeObserver.disconnect(),this.measuredElement=e,this._resizeObserver.observe(e),this._measure()}allocate(){const e=new Map,{availableLength:t,_sortedElements:i}=this;let n=0;for(const s of i){const o=s.lengthOptions[0];e.set(s,o),n+=o}for(const s of i)for(;n<t;){const o=e.get(s);if(!o)break;const l=s.lengthOptions.find(p=>p>o);if(!l)break;const c=n-o+l;if(c>t)break;e.set(s,l),n=c}for(const[s,o]of e)s.budgetedLength=o}_measure(){const e=this.measuredElement;this.availableLength=e?this.layout==="horizontal"?e.clientWidth??0:e.clientHeight??0:0,this.allocate()}destroy(){this._resizeObserver.disconnect()}};r([a()],Ae.prototype,"measuredElement",void 0),r([a()],Ae.prototype,"managedElements",void 0),r([a()],Ae.prototype,"_sortedElements",null),r([a()],Ae.prototype,"availableLength",void 0),r([a()],Ae.prototype,"layout",void 0),Ae=r([k("esri.widgets.Sketch.support.ResponsiveToolbar.ResponsiveToolbarManager")],Ae);const ec=Ae,tc={base:"esri-split-button",splitButtonBase:"esri-split-button--split-part"};let et=class extends ln(Ve){constructor(e){super(e),this.messagesCommon=null}loadDependencies(){return He({action:()=>M(()=>import("./index-CytjfAQD-Ciz-RVgE.js"),__vite__mapDeps([84,79,3,1,2,4,5,74,80,60,61,62,77,66,68,70,85]),import.meta.url),"action-group":()=>M(()=>import("./index-KqP5VmvP-CJbxPnIj.js"),__vite__mapDeps([172,79,3,1,2,4,5,74,80,60,61,62,84,77,66,68,70,85,90,72,73,75,91,76,69,92,93]),import.meta.url).then(e=>e.i),"action-menu":()=>M(()=>import("./index-VtdpGf3k-CYviBhvg.js"),__vite__mapDeps([92,79,3,1,2,4,5,74,80,60,61,62,84,77,66,68,70,85,90,72,73,75,91,76,69,93]),import.meta.url).then(e=>e.i)})}get minimumLength(){const e=this.actionChildren;return e.length?e.length===1?q.action[this.scale]+q.groupSeparator:q.action[this.scale]+q.splitButtonPart[this.layout][this.scale]+q.groupSeparator:0}get lengthOptions(){const{actionChildren:e,minimumLength:t,layout:i,scale:n,priority:s}=this;if(e.length<2||s<0)return[t];const o=q.groupSeparator+q.action[n]*e.length;return[q.groupSeparator+q.action[n]+q.splitButtonPart[i][n],o]}render(){if(!this.actionChildren.length)return u(cs,null,void 0);const{actionChildren:e,minimumLength:t,budgetedLength:i,layout:n,slot:s}=this,o=e.length<2||i>t;return u("calcite-action-group",{key:"split-button-group",layout:n,onclick:l=>this._handleClick(l.target),slot:s},o?this._renderUnSplit():this._renderSplit())}_renderSplit(){const{activeChildElement:e,layout:t,actionChildren:i,scale:n,messagesCommon:s}=this,o=e??i.at(0);if(!o)return;const l=i.filter(c=>c!==o);return[this._renderManagedAction(o),u("calcite-action-menu",{key:"split-button-dropdown",label:s.more,overlayPositioning:"fixed",placement:t==="horizontal"?"bottom-end":"right-end"},u("calcite-action",{class:`${tc.splitButtonBase}--${t}--${this.scale}`,compact:t==="horizontal",icon:Ws.splitButton[t],key:"split-button-dropdown-trigger",scale:n,slot:"trigger",text:s.more}),l?.map(c=>this._renderManagedAction(c)))]}_renderUnSplit(){return this.actionChildren.map(e=>this._renderManagedAction(e))}_renderManagedAction(e){return u("calcite-action",{...e?.properties,"data-action-key":e?.properties?.key,text:e?.properties?.text??""})}};et.vnodeSelector="calcite-action-group",r([a()],et.prototype,"minimumLength",null),r([a()],et.prototype,"lengthOptions",null),r([a(),$e("esri/t9n/common")],et.prototype,"messagesCommon",void 0),et=r([k("esri.widgets.Sketch.support.ResponsiveToolbar.SplitButton")],et);const ve="esri-responsive-toolbar",fe={rulerBase:`${ve}__ruler`,rulerBarHorizontal:`${ve}__ruler--bar`,rulerBarVertical:`${ve}__ruler--bar--vertical`,rulerPadVertical:`${ve}__ruler--pad--vertical`,rulerPadHorizontal:`${ve}__ruler--pad--horizontal`,bar:`${ve}__bar`,barHorizontal:`${ve}__bar--horizontal`,barVertical:`${ve}__bar--vertical`,pad:`${ve}__pad`,padVertical:`${ve}__pad--vertical`,padHorizontal:`${ve}__pad--horizontal`};let Ge=class extends Ve{constructor(e){super(e),this.scale="m",this.barStyle="floating",this._measurementManager=new ec,this._managedWidgets=new Map}loadDependencies(){return He({"action-bar":()=>M(()=>import("./index-f5siJR3U-CspUY1f0.js"),__vite__mapDeps([173,79,3,1,2,4,5,74,80,60,61,62,84,77,66,68,70,85,90,72,73,75,91,76,69,92,93,172,174]),import.meta.url),"action-pad":()=>M(()=>import("./index-DK_RfN06-DIrQYds-.js"),__vite__mapDeps([175,79,3,1,2,4,5,74,80,60,61,62,84,77,66,68,70,85,90,72,73,75,91,76,69,92,93,172,174]),import.meta.url)})}destroy(){this._measurementManager=xe(this._measurementManager),this._managedWidgets.forEach(e=>e.destroy()),this._managedWidgets.clear()}set layout(e){const t=this._get("layout");this._set("layout",e),this._measurementManager&&(this._measurementManager.layout=e),t!==e&&this.scheduleRender()}render(){const{layout:e,scale:t,barStyle:i}=this,n={layout:e,scale:t,expandDisabled:!0,key:"measured-toolbar"},s=i==="docked"?e==="vertical"?fe.rulerBarVertical:fe.rulerBarHorizontal:e==="horizontal"?fe.rulerPadHorizontal:fe.rulerPadVertical;return u("div",null,u("div",{afterCreate:o=>{this._measurementManager?.connect(o)},class:this.classes(fe.rulerBase,s)}),i==="docked"?u("calcite-action-bar",{...n,classes:{[fe.barHorizontal]:this.layout==="horizontal",[fe.barVertical]:this.layout==="vertical",[fe.bar]:!0},overflowActionsDisabled:!0},this._renderChildren()):u("calcite-action-pad",{...n,class:this.classes(fe.pad,e==="horizontal"?fe.padHorizontal:fe.padVertical)},this._renderChildren()))}_renderChildren(){if(!this.children)return;const e=this.children.filter(n=>n.properties?.key!==void 0&&"group-kind"in n.properties),t=new Set,i=e.map(n=>{const s=n.properties,o=s.key;t.add(o);const l=this.barStyle==="docked"?s.slot??void 0:void 0,c=s.priority??0,p=s["group-kind"]??"overflow-group",d=s["allow-collapse"]??!0,h=this._managedWidgets.get(o);if(h)return h.children=n.children,h.priority=c,"allowCollapse"in h&&(h.allowCollapse=d),h.slot=l,h.layout=this.layout,h.scale=this.scale,h.measurementManager=this._measurementManager,h;const g={scale:this.scale,priority:c,measurementManager:this._measurementManager,children:n.children,slot:l,layout:this.layout};switch(p){case"split-button":{const y=new et({...g});return this._managedWidgets.set(o,y),y}case"overflow-group":{const y=new Jl({...g,allowCollapse:d});return this._managedWidgets.set(o,y),y}case"measured-content":{const y=new Ql({...g});return this._managedWidgets.set(o,y),y}}}).filter(ae);return Array.from(this._managedWidgets.keys()).filter(n=>!t.has(n)).forEach(n=>{this._managedWidgets.get(n)?.destroy(),this._managedWidgets.delete(n)}),this._measurementManager?.allocate(),i.map(n=>n.render())}};r([a()],Ge.prototype,"scale",void 0),r([a({value:"horizontal"})],Ge.prototype,"layout",null),r([a()],Ge.prototype,"barStyle",void 0),r([a()],Ge.prototype,"_measurementManager",void 0),r([a()],Ge.prototype,"_managedWidgets",void 0),Ge=r([k("esri.widgets.Sketch.support.ResponsiveToolbar.ResponsiveToolbar")],Ge);const Hn=Ge;function ot(e,t){const i=new Z({x:e[0],y:e[1],spatialReference:t});return e.length>2&&(i.z=e[2]),i}function id(e,t){return new ro({points:e,spatialReference:t})}function nd(e,t,i){const n=new Ce({paths:e,spatialReference:t});return i&&Xn(n),n}function gi(e,t,i,n=!0){const s=Ri(e);s.forEach(l=>{const c=l[0],p=l[l.length-1];At(c,p)&&l.length!==1||l.push(l[0])});let o=new ee({rings:s,spatialReference:t});return o.rings.forEach(l=>{Yn(l)||l.reverse()}),i&&Xn(o),n&&o.isSelfIntersecting&&qn(t)&&(o=_s(o)),o}function ic(e,t,i){const n=t.mapToLocalMultiple(e),s=[],o={x:n[0].x,y:n[0].y},l={x:n[1].x,y:n[1].y},c=Math.round(l.x-o.x),p=Math.round(l.y-o.y),d=Math.max(Math.abs(c),Math.abs(p));if(i){const h={x:o.x+d,y:o.y+d},g={x:o.x-d,y:o.y-d};s.push(D(h.x,g.y),D(g.x,g.y),D(g.x,h.y),D(h.x,h.y))}else{const h={x:c>0?o.x+d:o.x-d,y:p>0?o.y+d:o.y-d};s.push(D(o.x,o.y),D(h.x,o.y),D(h.x,h.y),D(o.x,h.y))}return Xs(gi([s.map(h=>t.localToMap(h)).filter(ae)],t.spatialReference,t.doUnnormalization,!0),s,t)}function nc(e,t,i){let n=t.mapToLocalMultiple(e);if(n.length===1){const c=n[0];n=[D(c.x-48,c.y+48),D(c.x+48,c.y-48),D(c.x+48,c.y-48),D(c.x-48,c.y+48)]}const s=[],o={x:n[0].x,y:n[0].y},l={x:n[1].x,y:n[1].y};if(i){const c=Math.round(l.x-o.x),p=Math.round(l.y-o.y);s.push(D(o.x-c,o.y-p),D(l.x,o.y-p),D(l.x,l.y),D(o.x-c,l.y))}else s.push(D(o.x,o.y),D(l.x,o.y),D(l.x,l.y),D(o.x,l.y));return Xs(gi([s.map(c=>t.localToMap(c)).filter(ae)],t.spatialReference,t.doUnnormalization,!0),s,t)}function Xs(e,t,i){const n=Xt(t[3],t[2],i),s=Xt(t[1],t[2],i),o=Xt(t[0],t[1],i),l=Xt(t[0],t[3],i);return{geometry:e,midpoints:n!=null&&s!=null&&o!=null&&l!=null?{top:n,right:s,bottom:o,left:l}:null}}function Xt(e,t,i){dt[0]=e.x,dt[1]=e.y,dt[2]=0,ht[0]=t.x,ht[1]=t.y,ht[2]=0,Ji(dt,dt,ht,.5),Yt.x=dt[0],Yt.y=ht[1],Yt.z=ht[2];const n=i.localToMap(Yt);return n!=null?ot(n,i.spatialReference):null}const Yt=D(0,0,0),dt=C(),ht=C();function sc(e,t,i,n){const s=t.mapToLocalMultiple(e);let o=null,l=null;if(i)o=s[0],l=s[1];else{const P=s[0],f=s[1],K=Math.round(f.x-P.x),G=Math.round(f.y-P.y),H=Math.max(Math.abs(K),Math.abs(G));o=D(K>0?P.x+H/2:P.x-H/2,G>0?P.y+H/2:P.y-H/2),l=D(Math.abs(K)>Math.abs(G)?o.x-H/2:o.x,Math.abs(K)>Math.abs(G)?o.y:o.y-H/2)}const c=t.localToMap(o),p=t.localToMap(l);if(c==null||p==null)return null;t.doUnnormalization&&ao([[c,p]],t.spatialReference);const d=ot(c,t.spatialReference),h=ot(p,t.spatialReference),g=lo(t.spatialReference);let y=0;if(qn(t.spatialReference))y=g*ys(d,h,null);else{const P=o.x-l.x,f=o.y-l.y;y=g*Math.sqrt(P*P+f*f)*(n||1)}const _=new sa({center:d,radius:y,radiusUnit:"meters",spatialReference:t.spatialReference});return{geometry:gi(_.rings,_.spatialReference,!1),center:d,edge:h}}function oc(e,t,i){const n=t.mapToLocalMultiple(e),s=n[0],o=n[1],l=Math.round(o.x-s.x),c=Math.round(o.y-s.y),p=D(i?s.x:s.x+l/2,i?s.y:s.y+c/2),d=i?l:l/2,h=i?c:c/2,g=60,y=[],_=2*Math.PI/g;function P(te){const Oe=Math.cos(te),lt=Math.sin(te);return D(d*Oe+p.x,h*lt+p.y)}for(let te=0;te<g;te++)y.push(P(te*_));y.push(y[0]);const{spatialReference:f,doUnnormalization:K}=t,G=gi([y.map(te=>t.localToMap(te)).filter(ae)],f,K,!1),H=t.localToMap(P(Math.PI/2)),ge=t.localToMap(P(0)),Fe=t.localToMap(P(-Math.PI/2)),Ze=t.localToMap(P(Math.PI));return{geometry:G,midpoints:H!=null&&ge!=null&&Fe!=null&&Ze!=null?{top:ot(H,f),right:ot(ge,f),bottom:ot(Fe,f),left:ot(Ze,f)}:null}}let Q=class extends le{constructor(e){super(e),this.coordinates=void 0,this.strokeDash=[],this.strokeWidth=1,this.strokeColor=[0,0,0,1],this.strokeDashColor=[255,255,255,1],this.fillColor=[0,0,0,0],this.visible=!0,this.isDecoration=!0}get _strokeStyle(){const e=this.strokeColor;return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}get _strokeBackgroundStyle(){const e=this.strokeDashColor;return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}get _fillStyle(){const e=this.fillColor;return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}get _renderCoordinates(){const e=[];if(!this.coordinates)return{coordinates:e,rect:pn};const t=Zo(No(Uo(pn),this.coordinates),2*this.strokeWidth);t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]+.5),t[3]=Math.ceil(t[3]+.5);for(const i of this.coordinates)e.push([Math.floor(i[0]-t[0])+.5,Math.floor(i[1]-t[1])+.5]);return e.reverse(),{coordinates:e,rect:t}}render(){const{coordinates:e,rect:t}=this._renderCoordinates,i=Wo(t),n=jo(t);return u("div",{classes:{"esri-outline-overlay-item":!0},styles:{left:t[0]+"px",top:t[1]+"px",width:i+"px",height:n+"px",visibility:this.visible?"visible":"hidden"}},u("svg",{height:n,styles:{display:"block"},width:i},u("polygon",{fill:this._fillStyle,points:e.map(([s,o])=>`${s},${o}`).join(" "),stroke:this._strokeBackgroundStyle,"stroke-width":this.strokeWidth}),u("polygon",{fill:"transparent",points:e.map(([s,o])=>`${s},${o}`).join(" "),stroke:this._strokeStyle,"stroke-dasharray":this.strokeDash.length?this.strokeDash.join(" "):void 0,"stroke-width":this.strokeWidth})))}renderCanvas(){}};r([a()],Q.prototype,"coordinates",void 0),r([a()],Q.prototype,"strokeDash",void 0),r([a()],Q.prototype,"strokeWidth",void 0),r([a()],Q.prototype,"strokeColor",void 0),r([a()],Q.prototype,"strokeDashColor",void 0),r([a()],Q.prototype,"fillColor",void 0),r([a()],Q.prototype,"visible",void 0),r([a()],Q.prototype,"isDecoration",void 0),r([a({readOnly:!0})],Q.prototype,"_strokeStyle",null),r([a({readOnly:!0})],Q.prototype,"_strokeBackgroundStyle",null),r([a({readOnly:!0})],Q.prototype,"_fillStyle",null),r([a({readOnly:!0})],Q.prototype,"_renderCoordinates",null),Q=r([k("esri.views.overlay.OutlineOverlayItem")],Q);const rc=Q;let oe=class extends Be.EventedMixin(j){constructor(e){super(e),this._overlayItem=void 0,this.geometryType=null,this.mode=null,this.type="draw-screen"}initialize(){this.drawOperation=this._makeDrawOperation();const e=t=>this.drawOperation.on(t,i=>{this._updateVisuals(),this.emit(t,i)});this.addHandles([e("vertex-add"),e("vertex-remove"),e("vertex-update"),e("cursor-update"),e("complete")]),this.finishToolCreation()}destroy(){this.drawOperation=xe(this.drawOperation),this._set("view",null)}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centeredToggled(e){this._set("centeredToggled",e),this._updateVisuals()}set enabled(e){this.drawOperation.interactive=e,this._set("enabled",e)}set uniformSizeToggled(e){this._set("uniformSizeToggled",e),this._updateVisuals()}get updating(){return this.drawOperation?.updating??!1}get cursor(){return this.geometryType==="point"?"default":"crosshair"}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(e){this.destroyed||this.drawOperation.onInputEvent(e)}redo(){this.drawOperation.redo()}undo(){this.drawOperation.undo()}reset(){}_makeDrawOperation(){const{view:e}=this;return new b({view:e,manipulators:this.manipulators,geometryType:ac(this.geometryType),drawingMode:this.mode,hasZ:!1,defaultZ:0,snapToSceneEnabled:!1,drawSurface:new Ui,hasM:!1,snappingManager:null,snappingVisualizer:null,graphic:null,cursor:this.cursor})}get coordinates(){const{drawOperation:e}=this;if(!e?.geometryIncludingUncommittedVertices.length)return[];const{coordinateHelper:t}=e,i=e.committableVertex,n=e.committedVertices.slice();i!=null&&n.push(t.pointToArray(i));const s=n.length;switch(this.geometryType){case"circle":case"rectangle":{const o=new zs(Er,Ui.spatialReference),l=this.geometryType==="circle"?sc:ic,c=this.geometryType==="circle"?oc:nc;if(s===1&&e.isCompleted){const p=n[0],d=o.makeMapPoint(p[0]+lc,p[1]);return l([p,d],o,!0)?.geometry.rings[0]??[]}if(s===2){const p=this.geometryType!=="rectangle",d=this.centeredToggled!==p,h=this.geometryType!=="rectangle";return(this.uniformSizeToggled!==h?l(n,o,d)?.geometry.rings[0]:c(n,o,d)?.geometry.rings[0])??[]}return[]}}return n}_updateVisuals(){if(!this._overlayItem){const e=new rc({strokeDash:[5],strokeDashColor:[255,255,255,255]});this.view.overlay?.addItem(e),this.addHandles(it(()=>{this.view.overlay?.removeItem(e),e?.destroy(),this._overlayItem=void 0})),this._overlayItem=e}this._overlayItem.coordinates=this.coordinates}onDeactivate(){this.drawOperation.isCompleted||this.drawOperation.cancel()}};function ac(e){switch(e){case"polygon":case"point":return e;case"circle":case"rectangle":return"segment"}}r([a({value:!1})],oe.prototype,"centeredToggled",null),r([a()],oe.prototype,"drawOperation",void 0),r([a({value:!0})],oe.prototype,"enabled",null),r([a({value:!1})],oe.prototype,"uniformSizeToggled",null),r([a({constructOnly:!0})],oe.prototype,"geometryType",void 0),r([a({constructOnly:!0})],oe.prototype,"mode",void 0),r([a({readOnly:!0})],oe.prototype,"type",void 0),r([a({readOnly:!0})],oe.prototype,"updating",null),r([a({constructOnly:!0,nonNullable:!0})],oe.prototype,"view",void 0),r([a()],oe.prototype,"cursor",null),oe=r([k("esri.views.draw.DrawScreenTool")],oe);const lc=48;async function cc(){return M(()=>import("./geometryEngineJSON-CGn_tfx8-D3N6SheD.js"),__vite__mapDeps([176,166,167,177]),import.meta.url).then(e=>e.g)}async function pc(){return cc().then(({contains:e,intersects:t,overlaps:i,simplify:n})=>({contains:e,intersects:t,overlaps:i,simplify:n}))}async function dc(e){const{currentSelection:t,selector:i,signal:n,sources:s,view:o}=e;if(!s?.length)return{added:[],removed:[]};const{layers:l,layerViews:c,graphicsLayers:p}=mc(s),d=(await Yi(Promise.all([uc(i,l,o,n),gc(i,c,o,n),hc(i,p,o)]),n)).flat();if(!t)return{added:d,removed:[]};const h=t.toArray(),g=d.filter(_=>!Fn(h,_)),y=h.filter(_=>!Fn(d,_));return t.removeMany(y),t.addMany(g),{added:g,removed:y}}const hc=async(e,t,i)=>fc({candidates:t.flatMap(n=>n.graphics.toArray())??[],selector:e,view:i}),uc=async(e,t,i,n)=>{const s=await ze(_c({selector:e,signal:n,layers:t,view:i}));return s?Ys(s):[]},gc=async(e,t,i,n)=>{const s=await ze(yc({selector:e,signal:n,layerViews:t,view:i}));return s?Ys(s):[]};function Ys(e){const t=[];for(let i=0;i<e.length;i++){const n=e[i];n.status==="fulfilled"&&t.push(...n.value)}return t}function mc(e){const t=[],i=[],n=[];return e.forEach(s=>{Xo(s)?t.push(s):(Kn(s)||Qn(s))&&s.layers?.length?t.push(...s.layers.toArray()):Yo(s)&&s.sublayers?.length?n.push(...s.sublayers.toArray()):qo(s)?n.push(s):qt(s)&&i.push(s)}),{layers:t,layerViews:i,graphicsLayers:n}}function Fn(e,t){if(e.includes(t))return!0;const i=t.getObjectId(),n=i!=null,{layer:s,uid:o}=t;return n?e.some(l=>{if(s===l.layer)return i===l.getObjectId()}):e.some(l=>{if(s===l.layer)return o===l.uid})}async function yc(e){const{layerViews:t,selector:i,signal:n,view:s}=e;return Yi(Promise.allSettled(t.map(async o=>{const l=o.createQuery(),{geometry:c}=qs(i,o.layer,s);return l.outFields=["*"],l.geometry=c,l.returnGeometry=!0,l.outSpatialReference=s.spatialReference,o.queryFeatures(l,{signal:n}).then(({features:p})=>p)})),n)}async function _c(e){const{layers:t,selector:i,signal:n,view:s}=e;return Yi(Promise.allSettled(t.map(async o=>o.queryFeatures(vc(o.createQuery(),i,o,s),{signal:n}).then(({features:l})=>l))),n)}function qs(e,t,i){const n="renderer"in t?ia({renderer:t.renderer}):0,s=e.type==="point"?na(e,n,i):e,o="displayField"in t?t.displayField:null,l=Ko({displayField:o,fields:t.fields}),c=[t.objectIdField];if(l!=null&&t.fieldsIndex.has(l)&&c.push(l),"globalIdField"in t&&t.globalIdField!=null&&t.fieldsIndex.has(t.globalIdField)&&c.push(t.fieldsIndex.get(t.globalIdField).name),dn(t)&&t.subtypeField!=null&&t.fieldsIndex.has(t.subtypeField)&&c.push(t.fieldsIndex.get(t.subtypeField).name),"utilityNetworks"in i.map&&i.map.utilityNetworks?.length&&(dn(t)||t.type==="feature")){const p=t.fieldsIndex.get("assetgroup"),d=t.fieldsIndex.get("assettype");p?.name&&c.push(p.name),d?.name&&c.push(d.name)}return{geometry:s,outFields:c}}function vc(e,t,i,n){const{outFields:s,geometry:o}=qs(t,i,n);return e.outFields=s,e.geometry=o,e.returnGeometry=!0,e.outSpatialReference=n.spatialReference,e}async function fc(e){const{selector:t,candidates:i,view:n}=e;if(!i?.length||!t)return[];const{spatialReference:s}=n,o=t,l=await pc();return i.filter(c=>c.geometry&&c.geometry.type!=="mesh"&&l.intersects(s,o,c.geometry))}const wc=100;let tt=class extends Be.EventedAccessor{constructor(e){super(e),this._processTask=null,this.options=null,this.selection=new Ee,this.sources=null,this._process=ji(async(t,i)=>{const{callback:n,selector:s,completed:o}=t,l=Jn(async c=>{const{options:p,sources:d,selection:h,view:g}=this;if(!(!d?.length&&!g?.selectionManager.sources.length)&&g){if(s&&d!=null){const y=await dc({currentSelection:h,selector:s,signal:c,sources:d,view:g});o&&p?.persistSelection!==!1&&g.selectionManager?.updateSelection({current:h.toArray(),...y})}n&&n()}else h.removeAll()});return Vo(i,()=>l.abort()),this._processTask=l,l.promise},wc)}initialize(){this._setup()}cancel(){this.removeAllHandles(),this._processTask?.abort()}async _setup(){const{view:e}=this;if(await e.whenReady(),this.destroyed)return;const t=this.options,i=t?.createTool??"rectangle",n=t?.mode??(i==="polygon"?"click":"hybrid"),s=Symbol();this._tool=new oe({view:e,mode:n,geometryType:i}),t?.selectOnComplete||this.addHandles(this._tool.on(["cursor-update","vertex-add","vertex-remove"],()=>ze(this._process({selector:this._selectionArea}))),s),this.addHandles([e.on("key-down",o=>{if(!o.repeat)switch(o.key){case Nt.constraint:this._tool.uniformSizeToggled=!0,o.stopPropagation();break;case Nt.center:this._tool.centeredToggled=!0,o.stopPropagation()}}),e.on("key-up",o=>{switch(o.key){case Nt.constraint:this._tool.uniformSizeToggled=!1,o.stopPropagation();break;case Nt.center:this._tool.centeredToggled=!1,o.stopPropagation()}}),this._tool.on("complete",async o=>{this.removeHandles(s);const l=()=>{this.removeAllHandles(),this.emit("complete",{aborted:o.aborted,selection:this.selection.toArray()})};o.aborted?(this.cancel(),this.selection.removeAll(),l()):await this._process({selector:this._selectionArea,callback:l,completed:!0})})],s),this.addHandles(it(()=>e.tools.remove(this._tool))),e.addAndActivateTool(this._tool)}get _selectionArea(){const e=ai(),t=this._tool.coordinates,i=this.view.spatialReference,n=o=>{e.x=o[0],e.y=o[1];const{x:l,y:c}=this.view.toMap(e);return[l,c]};if(t.length===0)return;if(t.length===1||t.every(([o,l])=>o===t[0][0]&&l===t[0][1])){const[o,l]=n(t[0]);return new Z({x:o,y:l,spatialReference:i})}const s=t.map(n);if(s.length!==0)return Yn(s)||s.reverse(),new ee({spatialReference:i,rings:[s]})}};r([a()],tt.prototype,"options",void 0),r([a({readOnly:!0})],tt.prototype,"selection",void 0),r([a()],tt.prototype,"sources",void 0),r([a({constructOnly:!0})],tt.prototype,"view",void 0),tt=r([k("esri.widgets.support.Selector2D.SelectionOperation")],tt);const bc=tt;let Te=class extends Be.EventedAccessor{constructor(e){super(e),this._operationHandlesGroup=null,this.activeOperation=null,this.layerViewPreferenceEnabled=!0,this.sources=null}initialize(){this.addHandles([R(()=>this._sources,e=>{this.activeOperation&&(this.activeOperation.sources=e)})])}destroy(){this._operationHandlesGroup=rt(this._operationHandlesGroup)}get _sources(){const{layerViewPreferenceEnabled:e,sources:t,view:i}=this;return i&&t?.length?t.flatMap(n=>{if(qt(n))return n;if(Kn(n)||Qn(n)){const o=n.layers||[],l=o.map(c=>{const p=gn(i,c)||void 0;return e&&qt(p)?p:c});return l.length?l.toArray():o.length?o.toArray():n}if(!e)return n;const s=gn(i,n)||void 0;return qt(s)?s:n}):[]}get layers(){return ii(zt.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.sources}set layers(e){ii(zt.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.sources=e}get state(){const{_sources:e,view:t}=this,i=!e?.length&&!t?.selectionManager.sources.length;return this.activeOperation?"active":t?.ready&&!i?"ready":"disabled"}cancel(){this.state==="active"&&(this.activeOperation?.cancel(),this._set("activeOperation",null))}activate(e){const{_sources:t,state:i,view:n}=this,s=!t?.length&&!n?.selectionManager.sources.length;if(i==="disabled"||s||!this.view)return;i==="active"&&this.cancel();const o=new bc({view:this.view,sources:t,options:e});return this._operationHandlesGroup=Xi([o.selection.on("change",l=>this.emit("selection-change",l)),o.once("complete",l=>this._onOperationComplete(l))]),this._set("activeOperation",o),o}_onOperationComplete(e){this._operationHandlesGroup=rt(this._operationHandlesGroup),this._set("activeOperation",null),this.emit("complete",e)}};r([a()],Te.prototype,"_sources",null),r([a({readOnly:!0})],Te.prototype,"activeOperation",void 0),r([a()],Te.prototype,"layers",null),r([a()],Te.prototype,"layerViewPreferenceEnabled",void 0),r([a()],Te.prototype,"sources",void 0),r([a({readOnly:!0})],Te.prototype,"state",null),r([a()],Te.prototype,"view",void 0),Te=r([k("esri.widgets.support.SelectionToolbar.SelectionToolbarViewModel")],Te);const Tc=Te,Zn={lassoTool:!0,rectangleTool:!0},Oi="esri-selection-toolbar",Li={base:Oi,container:`${Oi}__container`,toolButton:`${Oi}__tool-button`};let B=class extends Ve{constructor(e,t){super(e,t),this._viewModelHandlesGroup=null,this.activeToolInfo=null,this.defaultLassoToolOptions={createTool:"polygon",mode:"freehand"},this.defaultRectangleToolOptions={createTool:"rectangle"},this.messages=null,this.toolConfigs=[],this.viewModel=new Tc,this.visibleElements={...Zn},this.scale="s",this.layout="horizontal",this._viewModelHandlesGroup=Xi([this.viewModel.on("complete",i=>{this._set("activeToolInfo",null),this.emit("complete",i)})])}destroy(){this._viewModelHandlesGroup=rt(this._viewModelHandlesGroup)}loadDependencies(){return He({action:()=>M(()=>import("./index-CytjfAQD-Ciz-RVgE.js"),__vite__mapDeps([84,79,3,1,2,4,5,74,80,60,61,62,77,66,68,70,85]),import.meta.url)})}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get layers(){return ii(zt.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.viewModel.sources}set layers(e){ii(zt.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."}),this.viewModel.sources=e}get layerViewPreferenceEnabled(){return this.viewModel.layerViewPreferenceEnabled}set layerViewPreferenceEnabled(e){this.viewModel.layerViewPreferenceEnabled=e}get sources(){return this.viewModel.sources}set sources(e){this.viewModel.sources=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...Zn,...e}}get state(){return this.viewModel.state}get visibleToolCount(){const{view:e,toolConfigs:t,visibleElements:i}=this;return(t?.length??0)+(e?.type==="2d"?(i.lassoTool?1:0)+(i.rectangleTool?1:0):0)}activate(e){if(this.cancel(),this.state!=="disabled")switch(e){case"lasso":this._activateTool("lasso");break;case"rectangle":this._activateTool("rectangle");break;default:this._activateTool(e)}}cancel(){this.viewModel.cancel(),this._set("activeToolInfo",null)}render(){return u("div",{"aria-label":this.label,class:this.classes(Li.base,Qi.widget)},u("div",{class:Li.container},this._renderDefaultTools(),this._renderCustomTools()))}_renderDefaultTools(){if(this.view?.type==="2d")return[this._renderRectangleTool(),this._renderLassoTool()]}_renderCustomTools(){if(this.toolConfigs?.length)return this.toolConfigs.map(({toolName:e,icon:t,toolKey:i})=>this._renderToolWithTooltip(e,i,t))}_renderLassoTool(){const{messages:e,visibleElements:t}=this;if(!t.lassoTool)return;const i=e.selectByLasso;return this._renderToolWithTooltip("lasso","lasso","lasso-select",i)}_renderRectangleTool(){const{messages:e,visibleElements:t}=this;if(!t.rectangleTool)return;const i=e.selectByRectangle;return this._renderToolWithTooltip("rectangle","rectangle","cursor-marquee",i)}_renderToolWithTooltip(e,t,i,n=e){const s=`${this.id}-tool-${t}`;return u("calcite-action",{active:this.activeToolInfo?.toolName===e,bind:this,class:Li.toolButton,disabled:this.state==="disabled",icon:i||"selection",id:s,key:s,onclick:()=>this._toggleTool(e),scale:this.scale,text:n,title:n})}_activateTool(e){const t=this._getToolOptions(e);if(!t)return;const i=this.viewModel.activate(t);i&&this._set("activeToolInfo",{toolName:e,operation:i})}_toggleTool(e){if(this.activeToolInfo){const t=this.activeToolInfo.toolName;if(this.cancel(),t===e)return}this._activateTool(e)}_getToolOptions(e){return e==="lasso"?this.defaultLassoToolOptions:e==="rectangle"?this.defaultRectangleToolOptions:this.toolConfigs.find(t=>t.toolName===e)}};r([a({readOnly:!0})],B.prototype,"activeToolInfo",void 0),r([a()],B.prototype,"defaultLassoToolOptions",void 0),r([a()],B.prototype,"defaultRectangleToolOptions",void 0),r([a()],B.prototype,"label",null),r([a()],B.prototype,"layers",null),r([a()],B.prototype,"layerViewPreferenceEnabled",null),r([a(),$e("esri/widgets/support/SelectionToolbar/t9n/SelectionToolbar")],B.prototype,"messages",void 0),r([a()],B.prototype,"sources",null),r([a()],B.prototype,"toolConfigs",void 0),r([a()],B.prototype,"view",null),r([a()],B.prototype,"viewModel",void 0),r([a()],B.prototype,"visibleElements",void 0),r([jn("visibleElements")],B.prototype,"castVisibleElements",null),r([a()],B.prototype,"scale",void 0),r([a()],B.prototype,"state",null),r([a()],B.prototype,"layout",void 0),r([a()],B.prototype,"visibleToolCount",null),B=r([k("esri.widgets.support.SelectionToolbar")],B);const xc=B,ke="esri-sketch",Me={base:ke,vertical:`${ke}--vertical`,docked:`${ke}-bar`,floating:`${ke}-pad`,chipHorizontal:`${ke}__selection-count-chip--horizontal`,chipVertical:`${ke}__selection-count-chip--vertical`,chipVerticalSmall:`${ke}__selection-count-chip--vertical--s`,popoverWrapper:`${ke}__popover-wrapper`},Ec={point:"pin",polyline:"line",polygon:"polygon",rectangle:"rectangle",circle:"circle",multipoint:"pins",mesh:"i3-d-building",freehandPolygon:"freehand-area",freehandPolyline:"freehand"};let E=class extends Ve{constructor(e,t){super(e,t),this._activeCustomToolOptions=null,this._selectionToolbar=null,this._viewModelHandlesGroup=null,this.availableCreateTools=["point","polyline","polygon","rectangle","circle"],this.customToolOptions=null,this.customActions=null,this.toolbarKind="floating",this.contextualToolLocation="separate",this.groupCollapsePriorities=null,this.messages=null,this.messagesCommon=null,this.visibleElements=new Y,this._defaultViewModel=null,this._calcitePopoverReferenceElement=null,this._relativeLocation="top",this._popoverOpen=!1,this._activateCreateTool=this._activateCreateTool.bind(this),this.viewModel=e?.viewModel||(this._defaultViewModel=new os({creationMode:e?.creationMode??"continuous"}))}initialize(){const{layer:e,view:t}=this,i=new xc({view:t?.type==="2d"?t:null,sources:e?[e]:null,scale:this.scale});this.addHandles([R(()=>this.viewModel,n=>{this._viewModelHandlesGroup=rt(this._viewModelHandlesGroup),n&&(this._viewModelHandlesGroup=Xi([n.on("create",()=>this.scheduleRender()),n.on("update",()=>this.scheduleRender()),n.on("delete",s=>this.emit("delete",s)),n.on("undo",()=>this.scheduleRender()),n.on("redo",()=>this.scheduleRender()),R(()=>n.layer,s=>{this._selectionToolbar&&(this._selectionToolbar.sources=s?[s]:null)}),R(()=>n.view,s=>{this._selectionToolbar&&(this._selectionToolbar.view=s?.type==="2d"?s:null)}),R(()=>n.state,()=>this.notifyChange("state"))]))},It),Qo(()=>i.activeToolInfo,()=>this.viewModel.cancel()),i.on("complete",n=>this._onSelectionOperationComplete(n)),R(()=>{const{selectionTools:n}=this.visibleElements;return{lassoTool:!!n?.["lasso-selection"],rectangleTool:!!n?.["rectangle-selection"]}},n=>{Object.assign(i.visibleElements,n)},It)]),this._selectionToolbar=i}loadDependencies(){return He({action:()=>M(()=>import("./index-CytjfAQD-Ciz-RVgE.js"),__vite__mapDeps([84,79,3,1,2,4,5,74,80,60,61,62,77,66,68,70,85]),import.meta.url),chip:()=>M(()=>import("./index-BxtEfqZ2-DC01DjAE.js"),__vite__mapDeps([178,60,3,1,2,4,5,61,62,66,70,68,69,85,80]),import.meta.url),popover:()=>M(()=>import("./index-B-rP10qG-BvQb5lKk.js"),__vite__mapDeps([90,79,3,1,2,4,5,74,80,60,61,62,84,77,66,68,70,85,72,73,75,91,76,69]),import.meta.url).then(e=>e.i)})}destroy(){this._selectionToolbar?.destroy(),this._viewModelHandlesGroup=rt(this._viewModelHandlesGroup)}get activeTool(){const e=this._selectionToolbar?.activeToolInfo;if(e)switch(e.toolName){case"lasso":return"lasso-selection";case"rectangle":return"rectangle-selection";case"default":return"custom-selection"}const t=this._effectiveAvailableCreateTools,{activeTool:i,activeCreateToolDrawMode:n}=this.viewModel;return i==="polygon"&&n==="freehand"&&t?.includes("freehandPolygon")?"freehandPolygon":i==="polyline"&&n==="freehand"&&t?.includes("freehandPolyline")?"freehandPolyline":this.viewModel.activeTool}get activeTooltip(){return this.viewModel.activeTooltip}get createGraphic(){return this.viewModel.createGraphic}get creationMode(){return this.viewModel.creationMode}set creationMode(e){this.viewModel.creationMode=e}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(e){this.viewModel.defaultCreateOptions=e}get defaultUpdateOptions(){return this.viewModel.defaultUpdateOptions}set defaultUpdateOptions(e){this.viewModel.defaultUpdateOptions=e}get icon(){return"pencil"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(e){this.viewModel.labelOptions=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}set layout(e){this._set("layout",e),this._selectionToolbar&&(this._selectionToolbar.layout=e)}set scale(e){this._set("scale",e),this._selectionToolbar&&(this._selectionToolbar.scale=e)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get state(){return this._selectionToolbar?.activeToolInfo?"active":this.viewModel.state}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(e){this.viewModel.tooltipOptions=e}get updateGraphics(){return this.viewModel.updateGraphics}get valueOptions(){return this.viewModel.valueOptions}set valueOptions(e){this.viewModel.valueOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){const t=this._get("viewModel");e!==t&&(t&&t===this._defaultViewModel&&xe(t),this._set("viewModel",e))}get _effectiveAvailableCreateTools(){const{availableCreateTools:e,view:t,visibleElements:i}=this,n=e?.filter(s=>!!i.createTools?.[s]);return t?.type==="3d"?n?.filter(s=>s!=="multipoint"):n}create(e,t,i){const n=i?.createOptions??t;return this._activeCustomToolOptions=i,ze(this.viewModel.create(e,n))}update(e,t){return ze(this.viewModel.update(e,t))}complete(){this.viewModel.complete()}cancel(){this._selectionToolbar?.cancel(),this.viewModel.cancel(),this._activeCustomToolOptions=null}undo(){this.viewModel.undo(),this.view?.focus()}redo(){this.viewModel.redo(),this.view?.focus()}delete(){this.viewModel.delete()}duplicate(){return this.viewModel.duplicate()}dismissFloatingElements(){this._popoverOpen=!1}render(){const{toolbarKind:e,layout:t,scale:i}=this,n=this.customActions?.filter(s=>s.position==="selection-toolbar");return u("div",null,u("div",{classes:{[Me.base]:!0,[Me.floating]:e==="floating",[Me.docked]:e==="docked",[Me.vertical]:t==="vertical"}},u(Hn,{barStyle:e,layout:t,scale:i},this._renderSelectionSetItemGroupInline(),u("div",{"group-kind":"split-button",key:"selection-split-button",priority:this.groupCollapsePriorities?.get("selectionTools")??St.Low},this._renderDefaultSelectionButton(),this._selectionToolbar?.render(),n?.map(s=>this._renderToolbarItem(s))),this._renderCreateToolActionGroup(),this._renderUndoRedoMenuItemGroup(),this._renderSettingsMenuItemGroup()),this._renderSelectionSetToolbar(),this._renderSettingsMenuPopover()))}_renderSettingsMenuPopover(){const{messagesCommon:e,snappingOptions:t,view:i,viewModel:n,visibleElements:s}=this;if(!this._calcitePopoverReferenceElement)return;const o={directionModePicker:s.directionModePicker,labelsToggle:s.labelsToggle,tooltipsToggle:s.tooltipsToggle},l=this.layout==="horizontal"?this._relativeLocation==="top"?"bottom-end":"top-end":"right-end";return u("calcite-popover",{closable:!0,focusTrapDisabled:!0,heading:e.settings,label:e.settings,open:this._popoverOpen,overlayPositioning:"fixed",placement:l,referenceElement:this._calcitePopoverReferenceElement,scale:this.scale,onCalcitePopoverBeforeClose:()=>this._popoverOpen=!1,onCalcitePopoverBeforeOpen:c=>this._remeasurePopoverSizes(c.currentTarget),onCalcitePopoverClose:()=>this._refocusOnView()},u("div",{class:Me.popoverWrapper},Object.values(o).includes(!0)?u(Ul,{sketchOptions:n.sketchOptions,viewType:i?.type,visibleElements:new rn(o)}):void 0,s.snappingControls&&i&&t?u(Kl,{snappingManager:this.viewModel.snappingManager,snappingOptions:t,view:i,visibleElements:s.snappingControlsElements}):void 0))}_renderSelectionSetToolbar(){if(this.contextualToolLocation!=="separate")return;const e=this._renderSelectionSetItemGroup();return e?.length?u(Hn,{barStyle:this.toolbarKind,layout:this.layout,scale:this.scale},e):void 0}_renderSelectionSetItemGroupInline(){return this.contextualToolLocation==="separate"?[]:this._renderSelectionSetItemGroup()}_renderUndoRedoMenuItemGroup(){return u("div",{"group-kind":"split-button",key:"undo-redo-menu",priority:this.groupCollapsePriorities?.get("undoRedo")??St.Medium,slot:"actions-end"},this._renderUndoButton(),this._renderRedoButton())}_renderSettingsMenuItemGroup(){const e=[],t=[];this.customActions?.forEach(n=>{n.position==="settings-before"?t.push(n):n.position==="settings-after"&&e.push(n)});const i=[...t.map(n=>this._renderToolbarItem(n)),this._renderSettingsMenuButton(),...e.map(n=>this._renderToolbarItem(n))].filter(ae);if(i.length)return u("div",{"allow-collapse":!1,"group-kind":"overflow-group",key:"settings-menu",priority:this.groupCollapsePriorities?.get("settings")??St.Max,slot:"actions-end"},i)}_renderSelectionSetItemGroup(){if(!this.updateGraphics.length)return[];const e=this.contextualToolLocation==="inline-end"?"actions-end":void 0,t=this.customActions?.filter(s=>s.position==="before-selection-set"),i=this.customActions?.filter(s=>s.position==="after-selection-set"),n=this.groupCollapsePriorities?.get("selectionSet")??St.High;return[u("div",{"group-kind":"measured-content",key:"selection-count-chip-group",priority:n,slot:e},this._renderFeatureCountChip()),u("div",{"allow-collapse":!1,"group-kind":"overflow-group",key:"selection-set-tool-group",priority:n,slot:e},t?.map(s=>this._renderToolbarItem(s)),this._renderDuplicateButton(),this._renderDeleteButton(),i?.map(s=>this._renderToolbarItem(s)))]}_renderDefaultSelectionButton(){if(!this.viewModel.updateOnGraphicClick)return[];const{messages:e,state:t}=this;return this._renderToolbarItem({id:"pointer-select",text:e.selectFeature,icon:"cursor",onclick:this._activateDefaultSelectTool,active:t==="ready"})}_renderCreateToolActionGroup(){const e=this._effectiveAvailableCreateTools?.flatMap(i=>this._renderBuiltInCreateToolItem(i))??[],t=this.customToolOptions?.flatMap(i=>this._renderCustomToolItem(i))??[];return u("div",{"group-kind":"overflow-group",key:"create-tools-group",priority:this.groupCollapsePriorities?.get("createTools")??St.High},e,t)}_renderBuiltInCreateToolItem(e){return this._renderToolbarItem({id:`${e}-button`,text:this.messages.draw[e],icon:Ec[e],onclick:()=>this._activateCreateTool(e),active:this.activeTool===e&&!this._activeCustomToolOptions})}_renderCustomToolItem(e){const{toolKey:t}=e;return this._renderToolbarItem({id:`custom-${e.toolKey}`,text:e.label,icon:e.icon,onclick:()=>this._activateCreateTool(e.toolName,null,e),active:this._activeCustomToolOptions?.toolKey===t})}_renderUndoButton(){return this.visibleElements.undoRedoMenu?this._renderToolbarItem({id:"undo-button",text:this.messages.undo,icon:"undo",disabled:!this.viewModel.canUndo(),onclick:this.undo,flipRTL:!0}):[]}_renderRedoButton(){return this.visibleElements.undoRedoMenu?this._renderToolbarItem({id:"redo-button",text:this.messages.redo,icon:"redo",disabled:!this.viewModel.canRedo(),onclick:this.redo,flipRTL:!0}):[]}_renderSettingsMenuButton(){return this.visibleElements.settingsMenu?this._renderToolbarItem({id:"settings-menu-action",text:this.messagesCommon.settings,icon:"gear",active:this._popoverOpen,onclick:()=>this._popoverOpen=!this._popoverOpen,afterCreate:e=>this._calcitePopoverReferenceElement=e,afterUpdate:e=>this._calcitePopoverReferenceElement=e,afterRemoved:()=>this._calcitePopoverReferenceElement=null}):[]}_renderFeatureCountChip(){if(!this.visibleElements.selectionCountLabel)return[];const{layout:e,messages:t,scale:i,id:n,updateGraphics:{length:s}}=this,o=Sn(t.selectedCount,{count:s}),l=i==="s"?99:999,c=s>l?Sn(t.selectedCountTruncated,{truncated:l}):s,p=i==="s"&&e==="vertical",d=p?`${n}-selection-chip-small`:`${n}-selection-chip`;return[p?u("span",{classes:{[Me.chipVertical]:!0,[Me.chipVerticalSmall]:this.scale==="s"},id:d,tabIndex:0,title:o},c):u("calcite-chip",{appearance:"outline",class:e==="horizontal"?Me.chipHorizontal:Me.chipVertical,id:d,kind:"brand",label:o,scale:i==="l"?"m":"s",tabIndex:0,title:e==="vertical"?o:void 0},e==="vertical"?c:o)]}_renderDuplicateButton(){if(!this.visibleElements.duplicateButton)return[];const{messages:e}=this;return this._renderToolbarItem({id:"duplicate",text:this.updateGraphics.length>1?e.duplicateFeatures:e.duplicateFeature,icon:"copy",onclick:this._onDuplicateSelect})}_renderDeleteButton(){if(!this.visibleElements.deleteButton)return[];const{messages:e}=this,t=this.updateGraphics.length>1?e.deleteFeatures:e.deleteFeature;return this._renderToolbarItem({id:"delete",text:t,icon:"trash",onclick:this.delete})}_renderToolbarItem({id:e,text:t,icon:i,disabled:n,onclick:s,active:o,flipRTL:l,afterCreate:c,afterUpdate:p,afterRemoved:d}){const h=`${this.id}-${e}`;return[u("calcite-action",{active:o,afterCreate:c,afterRemoved:d,afterUpdate:p,bind:this,"data-testid":e,disabled:n||this.state==="disabled",icon:i,iconFlipRtl:l??!1,id:h,key:e,onclick:s,scale:this.scale,text:t,title:t})]}_remeasurePopoverSizes(e){try{const t=e.parentElement,i=this?.view?.container?.getBoundingClientRect(),n=t?.style;if(!(t&&i&&n&&this.view?.container?.contains(t)))return;const s=this._calcitePopoverReferenceElement;if(!s)return;const{bottom:o,top:l}=s.getBoundingClientRect();if(this.layout==="horizontal"){const p=o<i.height/2;p!==(this._relativeLocation==="top")&&(this._relativeLocation=p?"top":"bottom"),p?(n?.setProperty("--sketch-view-height-offset",o-i.top+"px"),n?.setProperty("--sketch-view-margin-offset","30px")):(n?.setProperty("--sketch-view-height-offset",i.bottom-l+"px"),n?.setProperty("--sketch-view-margin-offset","15px"))}else this.layout==="vertical"&&(n.setProperty("--sketch-view-height-offset","15px"),n.setProperty("--sketch-view-margin-offset","15px"));const c=e.shadowRoot?.querySelector("div.header")?.getBoundingClientRect().height;n.setProperty("--sketch-popover-header-offset",`${c}px`)}catch(t){zt.getLogger(this.declaredClass).warnOnce("Sketch failed to lay out settings menu.",t)}}_activateCreateTool(e,t,i){const n=this._activeCustomToolOptions;if(i||n){if(i?.toolKey===n?.toolKey)return void this.cancel()}else if(this.activeTool===e)return void this.cancel();this._selectionToolbar?.cancel(),this.create(e,t,i)}_onDuplicateSelect(){const e=this.duplicate(),t=this.viewModel.activeTool;t!=="transform"&&t!=="reshape"||this.update(e,{tool:t})}_onSelectionOperationComplete(e){const{viewModel:{defaultUpdateOptions:t}}=this,{selection:i}=e;if(!e.aborted&&i.length){const n=t.tool,s=i.length>1&&n==="reshape"?"transform":n;this.update(i,{...t,tool:s})}this.notifyChange("state")}_activateDefaultSelectTool(){this.cancel(),this.view?.focus()}_refocusOnView(){this.activeTool&&this.view?.focus()}};r([a()],E.prototype,"_activeCustomToolOptions",void 0),r([a()],E.prototype,"activeTool",null),r([a({readOnly:!0})],E.prototype,"activeTooltip",null),r([a({cast:e=>{if(!e?.length)return null;const t=new Set(["point","polyline","polygon","rectangle","circle","multipoint","freehandPolyline","freehandPolygon","mesh"]);return e.filter(i=>t.has(i))}})],E.prototype,"availableCreateTools",void 0),r([a({readOnly:!0})],E.prototype,"createGraphic",null),r([a()],E.prototype,"creationMode",null),r([a()],E.prototype,"customToolOptions",void 0),r([a()],E.prototype,"customActions",void 0),r([a()],E.prototype,"defaultCreateOptions",null),r([a()],E.prototype,"defaultUpdateOptions",null),r([a()],E.prototype,"icon",null),r([a()],E.prototype,"label",null),r([a()],E.prototype,"labelOptions",null),r([a()],E.prototype,"layer",null),r([a({type:["horizontal","vertical"],value:"horizontal"})],E.prototype,"layout",null),r([a({value:"m"})],E.prototype,"scale",null),r([a()],E.prototype,"toolbarKind",void 0),r([a()],E.prototype,"contextualToolLocation",void 0),r([a()],E.prototype,"groupCollapsePriorities",void 0),r([a(),$e("esri/widgets/Sketch/t9n/Sketch")],E.prototype,"messages",void 0),r([a(),$e("esri/t9n/common")],E.prototype,"messagesCommon",void 0),r([a()],E.prototype,"snappingOptions",null),r([a()],E.prototype,"state",null),r([a()],E.prototype,"tooltipOptions",null),r([a({readOnly:!0})],E.prototype,"updateGraphics",null),r([a({type:ur,nonNullable:!0})],E.prototype,"valueOptions",null),r([a()],E.prototype,"view",null),r([a({type:os}),Cr(["create","update","undo","redo"])],E.prototype,"viewModel",null),r([a({type:Y,nonNullable:!0})],E.prototype,"visibleElements",void 0),r([a()],E.prototype,"_effectiveAvailableCreateTools",null),r([a()],E.prototype,"_defaultViewModel",void 0),r([a()],E.prototype,"_calcitePopoverReferenceElement",void 0),r([a()],E.prototype,"_relativeLocation",void 0),r([a()],E.prototype,"_popoverOpen",void 0),E=r([k("esri.widgets.Sketch")],E);const Mc=E,Sc=(e,t,i)=>{const n=e[t];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((s,o)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(o.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==i?". Note that variables only represent file names one level deep.":""))))})},Cc=(e,t)=>(i,n)=>Vc(i,e,n);class Pc extends sr{constructor(t,i,n){super(t,i,n),this._watchedViewModelProperties=new Map,this._watchedVisibleElementsProperties={},this._isBindingViewModel={value:!0},Object.defineProperty(this.exports,"viewModel",{value:bi.makeGetterProxy(t,this._watchedViewModelProperties,this._isBindingViewModel)}),Object.defineProperty(this.exports,"visibleElements",{value:this._makeVisibleElementsBinder()})}hostConnected(){super.hostConnected(),this._isBindingViewModel.value=!1,this.component.manager.loadedCalled&&Zt(this.component)}async hostLoad(){if(this._watchedProperties.delete("viewModel"),await super.hostLoad(),this.component.manager.destroyed)return;this._watchMetaProperties(),this.onLifecycle(()=>this.reactiveUtils.watch(()=>this._instance.viewModel,n=>{this.component.viewModel=n},{initial:!0}));const t=this._instance.viewModel;typeof t=="object"&&(bi.watchComponentUpdates(this,t,this._watchedViewModelProperties),bi.watchAccessorUpdates(this,t,this._watchedViewModelProperties));const i=Object.entries(this._watchedVisibleElementsProperties);i.length>0&&this.onLifecycle(()=>i.map(([n,s])=>{let o=this._instance.visibleElements??{},l;for(const d of s.slice(0,-1))if(typeof o[d]=="object"&&o[d]!==null)o=o[d];else{l=!!o[d];break}l===void 0&&(l=!!(o[s.slice(-1)[0]]??!0)),n.startsWith("hide");const c=n.startsWith("hide")||n.startsWith("show")?n.startsWith("hide"):l,p=this.component;return typeof p[n]=="boolean"?this._updateWidgetVisibleElement(s,p[n],c):p[n]=!1,Ti(this.component,n,d=>this._updateWidgetVisibleElement(s,d,c))}))}_updateWidgetVisibleElement(t,i,n){let s=this._instance.visibleElements??{};for(const l of t.slice(0,-1))(typeof s[l]!="object"||s[l]===null)&&(s[l]={}),s=s[l];const o=!!(n?!i:i);s[t.at(-1)]=o}hostLoaded(){const{el:t}=this.component;t.childElem??=document.createElement("div"),this._instance.container=t.childElem;let i=!1;const n=this.component.el.view;Object.defineProperty(this.component.el,"view",{get:()=>this._instance.view??this._instance.viewModel?.view,set:s=>{!("view"in this._instance)&&typeof this._instance.viewModel=="object"?this._instance.viewModel.view=s:this._instance.view=s,!("map"in this._instance)&&typeof this._instance.viewModel=="object"?this._instance.viewModel.map=s.map:this._instance.map=s.map,this._watchViewDestroy(),s&&!i&&(i=!0,this.component.arcgisReady.emit())},configurable:!0,enumerable:!0}),n&&(this._instance.view=n),this.component.el.isConnected&&(Zt(this.component),this._watchViewDestroy())}hostDisconnected(){typeof this.component.el.childElem=="object"&&this.component.el.view?.ui?.remove(this.component.el.childElem)}hostDestroy(){super.hostDestroy(),this._watchViewDestroyHandle?.remove()}_watchMetaProperties(){Ti(this.component,"position",t=>{this.component.el.childElem!=null&&typeof t=="string"&&Zt(this.component)}),Ti(this.component,"referenceElement",()=>Zt(this.component))}_makeVisibleElementsBinder(){return new Proxy({},{has:(t,i)=>typeof i=="string"||Reflect.has(t,i),get:(t,i)=>{if(typeof i=="symbol"||i in Promise.prototype)return Reflect.get(t,i);const n=[i],s=this._makeRecursiveProxy(n);return or(this.component,o=>{const l=o;this.component[l]=!1,this._watchedVisibleElementsProperties[l]=n},s)}})}_makeRecursiveProxy(t){const i=new Proxy({},{get:(n,s)=>{const o=Reflect.get(n,s);return typeof s=="symbol"||s in Promise.prototype?o:(t.push(s),i)}});return i}_watchViewDestroy(){this._watchViewDestroyHandle?.remove(),this._watchViewDestroyHandle=this.reactiveUtils.when(()=>this.component.el.view?.destroyed===!0,()=>void this.component.destroy().catch(console.error),{sync:!0})}}const Vc=Jo(Pc),Oc=co`@layer{arcgis-sketch{display:block}}`,Lc=Cc(Mc);class kc extends po{constructor(){super(),this.widget=Lc(this,{editConstructorProperties:this._editConstructorProperties}),this.viewModel=this.widget.viewModel,this.activeTool=this.widget.activeTool,this.autoDestroyDisabled=!1,this.availableCreateTools=this.widget.availableCreateTools,this.createGraphic=this.widget.createGraphic,this.creationMode=this.widget.creationMode,this.defaultCreateOptions=this.widget.defaultCreateOptions,this.defaultGraphicsLayerDisabled=!1,this.defaultUpdateOptions=this.widget.defaultUpdateOptions,this.hideCreateToolsCircle=this.widget.visibleElements.createTools.circle,this.hideCreateToolsPoint=this.widget.visibleElements.createTools.point,this.hideCreateToolsPolygon=this.widget.visibleElements.createTools.polygon,this.hideCreateToolsPolyline=this.widget.visibleElements.createTools.polyline,this.hideCreateToolsRectangle=this.widget.visibleElements.createTools.rectangle,this.hideDuplicateButton=this.widget.visibleElements.duplicateButton,this.hideDeleteButton=this.widget.visibleElements.deleteButton,this.hideSelectionCountLabel=this.widget.visibleElements.selectionCountLabel,this.hideLabelsToggle=this.widget.visibleElements.labelsToggle,this.hideSelectionToolsLassoSelection=this.widget.visibleElements.selectionTools["lasso-selection"],this.hideSelectionToolsRectangleSelection=this.widget.visibleElements.selectionTools["rectangle-selection"],this.hideSettingsMenu=this.widget.visibleElements.settingsMenu,this.hideSnappingControls=this.widget.visibleElements.snappingControls,this.hideSnappingControlsElementsEnabledToggle=this.widget.visibleElements.snappingControlsElements.enabledToggle,this.hideSnappingControlsElementsFeatureEnabledToggle=this.widget.visibleElements.snappingControlsElements.featureEnabledToggle,this.hideSnappingControlsElementsLayerList=this.widget.visibleElements.snappingControlsElements.layerList,this.hideSnappingControlsElementsSelfEnabledToggle=this.widget.visibleElements.snappingControlsElements.selfEnabledToggle,this.hideTooltipsToggle=this.widget.visibleElements.tooltipsToggle,this.hideUndoRedoMenu=this.widget.visibleElements.undoRedoMenu,this.icon=this.widget.icon,this.label=this.widget.label,this.labelOptions=this.widget.labelOptions,this.layer=this.widget.layer,this.layout=this.widget.layout,this.pointSymbol=this.viewModel.pointSymbol,this.polygonSymbol=this.viewModel.polygonSymbol,this.polylineSymbol=this.viewModel.polylineSymbol,this.position="bottom-left",this.scale=this.widget.scale,this.toolbarKind=this.widget.toolbarKind,this.showSnappingControlsElementsHeader=this.widget.visibleElements.snappingControlsElements.header,this.snappingOptions=this.widget.snappingOptions,this.state=this.widget.state,this.tooltipOptions=this.widget.tooltipOptions,this.updateGraphics=this.widget.updateGraphics,this.arcgisCreate=Mt(()=>this.widget,"create"),this.arcgisDelete=Mt(()=>this.widget,"delete"),this.arcgisPropertyChange=ho()("state"),this.arcgisReady=uo(),this.arcgisRedo=Mt(()=>this.widget,"redo"),this.arcgisUndo=Mt(()=>this.widget,"undo"),this.arcgisUpdate=Mt(()=>this.widget,"update"),this.listen("arcgisReady",this._arcgisReadyHandler)}static{this.properties={activeTool:3,autoDestroyDisabled:5,availableCreateTools:0,createGraphic:0,creationMode:1,defaultCreateOptions:0,defaultGraphicsLayerDisabled:5,defaultUpdateOptions:0,hideCreateToolsCircle:5,hideCreateToolsPoint:5,hideCreateToolsPolygon:5,hideCreateToolsPolyline:5,hideCreateToolsRectangle:5,hideDuplicateButton:5,hideDeleteButton:5,hideSelectionCountLabel:5,hideLabelsToggle:5,hideSelectionToolsLassoSelection:5,hideSelectionToolsRectangleSelection:5,hideSettingsMenu:5,hideSnappingControls:5,hideSnappingControlsElementsEnabledToggle:5,hideSnappingControlsElementsFeatureEnabledToggle:5,hideSnappingControlsElementsLayerList:5,hideSnappingControlsElementsSelfEnabledToggle:5,hideTooltipsToggle:5,hideUndoRedoMenu:5,icon:1,label:1,labelOptions:0,layer:0,layout:1,pointSymbol:0,polygonSymbol:0,polylineSymbol:0,position:1,referenceElement:1,scale:1,toolbarKind:1,showSnappingControlsElementsHeader:5,snappingOptions:0,state:3,tooltipOptions:0,updateGraphics:0}}static{this.shadowRootOptions=go}static{this.styles=Oc}async cancel(){this.widget?.cancel()}async complete(){this.widget?.complete()}async create(t,i){await this.widget?.create(t,i)}async delete(){this.widget?.delete()}async destroy(){await this.manager.destroy()}async duplicate(){this.widget?.duplicate()}async redo(){this.widget?.redo()}async triggerUpdate(t,i){this.widget?.update(t,i)}async undo(){this.widget?.undo()}_arcgisReadyHandler(){this.defaultGraphicsLayerDisabled||this.el.view?.map.add(this.widget.layer)}async _editConstructorProperties(t){return this.defaultGraphicsLayerDisabled||(t.layer??=new rr({title:"Sketch Layer"})),t}}mo("arcgis-sketch",kc);const ti="RampDrawGraphicsLayer",Rc=yo({__name:"draw",setup(e){const{t}=Oo(),i=m=>t(m?`draw.${m}`:"draw.unknown"),n=Lo("iApi"),s=qi();let o=null;const l=ko("sketchEl");let c=null,p=null,d=null,h=null,g=!1,y=null,_=[];const P=Ro([]),f=m=>{if(h&&(p?.remove(h),h=null),!m)return;let x;switch(m.geometry?.type){case"point":case"multipoint":x=new nr({color:[255,255,0,.8],size:16,outline:{color:[255,165,0,1],width:3}});break;case"polyline":x=new hn({color:[255,255,0,.8],width:6});break;default:x=new Ft({color:[255,255,0,.3],outline:{color:[255,165,0,1],width:3}})}h=new je({geometry:m.geometry,symbol:x}),p?.add(h)};cn(()=>s.selectedGraphicId,(m,x)=>{if(!(!o||!p)){if(!m)o.cancel(),f();else if(m!==x){const v=p.graphics.toArray().find(I=>I.attributes&&I.attributes.id===m);v&&(o.triggerUpdate([v]),f(v))}}});const K=async()=>{if(!p||!o||s.activeTool!=="edit")return;await n.geo.map.viewPromise;const m=n.geo.map.esriView,x={x:m.width/2,y:m.height/2},v={x:x.x,y:x.y,width:20,height:20},I=(await m.hitTest(v)).results.filter(N=>!("graphic"in N)||N.graphic.layer!==p?!1:!!N.graphic.attributes?.id);I.length>0?(d=I[0].graphic,o.triggerUpdate([d]),d.attributes?.id&&s.selectGraphic(d.attributes.id),n.updateAlert(t("draw.graphic.selected",{type:i(d.attributes?.type)}))):(o.cancel(),d=null,s.clearSelection())},G=async()=>{if(!o||!s.activeTool)return;await n.geo.map.viewPromise;const m=n.geo.map.esriView,x={x:Math.floor(m.width/2),y:Math.floor(m.height/2)},v=m.toMap(x),I=m.extent,N=I.width,ce=I.height,Le=Math.min(N,ce)/10;let ie;switch(s.activeTool){case"point":ie=new je({geometry:new Z({x:v.x,y:v.y,spatialReference:m.spatialReference}),symbol:o.pointSymbol});break;case"polyline":ie=new je({geometry:new Ce({paths:[[[v.x-Le/2,v.y],[v.x+Le/2,v.y]]],spatialReference:m.spatialReference}),symbol:o.polylineSymbol});break;case"polygon":case"rectangle":const w=Le/2;ie=new je({geometry:new ee({rings:[[[v.x-w,v.y-w],[v.x+w,v.y-w],[v.x+w,v.y+w],[v.x-w,v.y+w],[v.x-w,v.y-w]]],spatialReference:m.spatialReference}),symbol:o.polygonSymbol||new Ft({color:[0,255,0,.3],outline:{color:[0,255,0,1],width:1}})});break;case"circle":const A=Le/2,ct=36,Tt=[];for(let Ne=0;Ne<=ct;Ne++){const pt=Ne/ct*2*Math.PI,U=v.x+A*Math.cos(pt),$=v.y+A*Math.sin(pt);Tt.push([U,$])}ie=new je({geometry:new ee({rings:[Tt],spatialReference:m.spatialReference}),symbol:o.polygonSymbol||new Ft({color:[255,0,255,.3],outline:{color:[255,0,255,1],width:1}})});break;default:console.warn("Unknown tool type:",s.activeTool);return}if(ie){const w=`graphic-${Date.now()}`;ie.attributes={id:w,type:s.activeTool},p?.add(ie),s.addGraphic({id:w,type:s.activeTool,geometry:ie.geometry,attributes:ie.attributes}),s.activeTool!=="point"&&(s.clearSelection(),s.setActiveTool(null),o.cancel()),n.updateAlert(t("draw.graphic.created",{type:i(s.activeTool)}))}},H=m=>{const x=n.geo.map.esriView?.container;if(!(!document.activeElement||!x?.contains(document.activeElement)))switch(m.key){case"Enter":if(m.preventDefault(),s.activeTool&&s.activeTool!=="edit")if((s.activeTool==="polyline"||s.activeTool==="polygon")&&(g||_.length===0)){const I=n.geo.map.esriView,N={x:Math.floor(I.width/2),y:Math.floor(I.height/2)},ce=I.toMap(N);g?(_.push([ce.x,ce.y]),s.activeTool==="polyline"?y.geometry=new Ce({paths:[_],spatialReference:I.spatialReference}):y.geometry=new ee({rings:[_],spatialReference:I.spatialReference}),n.updateAlert(t("draw.multiPoint.pointAdded",{type:i(s.activeTool),count:_.length}))):(g=!0,_=[[ce.x,ce.y]],s.activeTool==="polyline"?y=new je({geometry:new Ce({paths:[_],spatialReference:I.spatialReference}),symbol:o?.polylineSymbol||new hn({color:[0,0,255,1],width:2})}):y=new je({geometry:new ee({rings:[_],spatialReference:I.spatialReference}),symbol:o?.polygonSymbol||new Ft({color:[0,255,0,.3],outline:{color:[0,255,0,1],width:1}})}),y.attributes={id:`temp-graphic-${Date.now()}`,type:s.activeTool},p?.add(y),n.updateAlert(t("draw.multiPoint.started",{type:i(s.activeTool),count:1})))}else G();else K();break;case"Delete":case"Backspace":const v=n.geo.map.esriView;g&&_.length>1?(m.preventDefault(),_.pop(),s.activeTool==="polyline"?y.geometry=new Ce({paths:[_],spatialReference:v.spatialReference}):y.geometry=new ee({rings:[_],spatialReference:v.spatialReference}),y.set("geometry",y?.geometry),n.updateAlert(t("draw.multiPoint.pointRemoved",{type:i(s.activeTool??void 0),count:_.length}))):g&&_.length===1?(m.preventDefault(),y&&p?.remove(y),y=null,_=[],g=!1,n.updateAlert(t("draw.multiPoint.canceled"))):d&&(m.preventDefault(),o?.delete(),p?.remove(d),typeof s.removeGraphic=="function"&&s.removeGraphic(d.attributes.id),d=null,f(void 0),n.updateAlert(t("draw.graphic.deleted")));break;case"Escape":s.setActiveTool(null),o?.cancel(),d=null,f(void 0),s.clearSelection(),n.updateAlert(t("draw.tool.canceled"));break}},ge=m=>{const x=n.geo.map.esriView.container;if(!document.activeElement||!x?.contains(document.activeElement)||!d||!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(m.key))return;m.preventDefault(),m.stopPropagation();const v=10,I=m.shiftKey,N=m.altKey,ce=n.geo.map.esriView;let Le=0,ie=0;m.key==="ArrowLeft"&&(Le=-v),m.key==="ArrowRight"&&(Le=v),m.key==="ArrowUp"&&(ie=-v),m.key==="ArrowDown"&&(ie=v);const w=d.geometry;let A;if(w.type==="point")A={x:w.x,y:w.y};else{const $=w.extent;A={x:($.xmin+$.xmax)/2,y:($.ymin+$.ymax)/2}}const ct=ce.toScreen(new Z({x:A.x,y:A.y,spatialReference:ce.spatialReference}));ct.x+=Le,ct.y+=ie;const Tt=ce.toMap(ct),Ne=Tt.x-A.x,pt=Tt.y-A.y;let U;if(w.type==="point")!I&&!N?U=new Z({x:w.x+Ne,y:w.y+pt,spatialReference:w.spatialReference}):I?(U=w.clone(),n.updateAlert(t("draw.point.resize.unsupported"))):N&&(U=w.clone(),n.updateAlert(t("draw.point.rotate.unsupported")));else if(w.type==="polyline"){if(!I&&!N){const $=w.paths.map(W=>W.map(([ne,se])=>[ne+Ne,se+pt]));U=new Ce({paths:$,spatialReference:w.spatialReference})}else if(I){const $=w,W=m.key==="ArrowUp"||m.key==="ArrowRight"?1.05:.95,ne=$.paths.map(se=>se.map(([Ue,We])=>[A.x+(Ue-A.x)*W,A.y+(We-A.y)*W]));U=new Ce({paths:ne,spatialReference:w.spatialReference})}else if(N){const $=w,W=m.key==="ArrowLeft"?-.05:m.key==="ArrowRight"?.05:0;if(W!==0){const ne=Math.cos(W),se=Math.sin(W),Ue=$.paths.map(We=>We.map(([mi,yi])=>{const xt=mi-A.x,Et=yi-A.y,_i=xt*ne-Et*se,vi=xt*se+Et*ne;return[A.x+_i,A.y+vi]}));U=new Ce({paths:Ue,spatialReference:w.spatialReference})}else U=w.clone()}}else if(w.type==="polygon"){if(!I&&!N){const $=w.rings.map(W=>W.map(([ne,se])=>[ne+Ne,se+pt]));U=new ee({rings:$,spatialReference:w.spatialReference})}else if(I){const $=w,W=m.key==="ArrowUp"||m.key==="ArrowRight"?1.05:.95,ne=$.rings.map(se=>se.map(([Ue,We])=>[A.x+(Ue-A.x)*W,A.y+(We-A.y)*W]));U=new ee({rings:ne,spatialReference:w.spatialReference})}else if(N){const $=w,W=m.key==="ArrowLeft"?-.05:m.key==="ArrowRight"?.05:0;if(W!==0){const ne=Math.cos(W),se=Math.sin(W),Ue=$.rings.map(We=>We.map(([mi,yi])=>{const xt=mi-A.x,Et=yi-A.y,_i=xt*ne-Et*se,vi=xt*se+Et*ne;return[A.x+_i,A.y+vi]}));U=new ee({rings:Ue,spatialReference:w.spatialReference})}else U=w.clone()}}if(U){d.geometry=U,d.set("geometry",U),f(d),d.attributes?.id&&s.updateGraphicGeometry(d.attributes.id,U);const $=I?"resized":N?"rotated":"moved";n.updateAlert(t(`draw.graphic.${$}`))}},Fe=async m=>{const x=(await n.geo.map.esriView.hitTest(m)).results.find(v=>"graphic"in v&&v.graphic.layer===p&&!!v.graphic.attributes?.id);x&&s.activeTool==="edit"?o?.triggerUpdate([x.graphic]):(o?.cancel(),d=null,s.clearSelection(),f())},Ze=async()=>{await n.geo.map.viewPromise,n.geo.layer.getLayer(ti)?p=n.geo.layer.getLayer(ti).esriLayer:(p=n.geo.layer.createLayer({id:ti,layerType:er.GRAPHIC,cosmetic:!0,system:!0,url:""}),await n.geo.map.addLayer(p)),p?.esriLayer&&(p=p.esriLayer),Object.assign(l.value,{view:n.geo.map.esriView,layer:p,availableCreateTools:["point","multipoint","polyline","polygon","rectangle","circle"],updateOnGraphicClick:!0,visibleElements:{createTools:{point:!0,polyline:!0,polygon:!0,rectangle:!0,circle:!0},selectionTools:{enable:!0},settingsMenu:!1},defaultUpdateOptions:{highlightOptions:{enabled:!1}}}),n.geo.map.esriView.ui.add(l.value,"bottom-right"),l.value?.addEventListener("arcgisCreate",m=>Oe(m.detail)),l.value?.addEventListener("arcgisUpdate",m=>lt(m.detail)),c={remove:()=>l.value?.removeEventListener("arcgisCreate",m=>Oe(m.detail))},o=l.value,n.geo.map.esriView.on("click",Fe),document.addEventListener("keydown",H),document.addEventListener("keydown",ge,{capture:!0})},te=()=>{o&&(n.geo.map.esriView&&n.geo.map.esriView.ui.remove(o),c&&c.remove(),o.destroy()),document.removeEventListener("keydown",H),document.removeEventListener("keydown",ge,{capture:!0}),g=!1,y=null,_=[],o=null,p=null},Oe=m=>{if(m.state==="complete"){const x=m.graphic,v=`graphic-${Date.now()}`;x.attributes=x.attributes||{},x.attributes.id=v,s.addGraphic({id:v,type:m.tool,geometry:x.geometry,attributes:x.attributes}),m.tool!=="point"&&s.setActiveTool(null)}},lt=m=>{const x=m.graphics[0];if(x)if(m.state==="start"){if(s.activeTool!=="edit"){o.cancel();return}d=x,x.attributes?.id&&(s.selectGraphic(x.attributes.id),n.updateAlert(t("draw.graphic.selected",{type:i(x.attributes?.type)})))}else m.state==="active"?f(x):m.state==="complete"&&x.attributes?.id&&(s.updateGraphicGeometry(x.attributes.id,x.geometry),n.updateAlert(t("draw.graphic.updated")))};return Io(()=>{Ze(),P.push(n.event.on(es.MAP_DESTROYED,()=>{te()}))}),cn(()=>s.activeTool,m=>{o.cancel(),f(),y=null,_=[],g=!1,m&&m!="edit"&&o.create(m)}),Do(()=>{te(),P.forEach(m=>n.event.off(m))}),(m,x)=>(Ao(),Go("arcgis-sketch",{ref_key:"sketchEl",ref:l,style:{display:"none"}},null,512))}}),Nn=[{type:"point"},{type:"polyline"},{type:"polygon"},{type:"circle"},{type:"rectangle"}];class Ic extends tr{store;constructor(t,i){super(t,i),this.store=qi(this.$vApp.$pinia)}_parseConfig(t){if(!t){this.store.setSupportedTypes(Nn);return}if(t.types!==void 0){const i=(t.types===null?[]:t.types).filter(n=>n.enabled!==!1);this.store.setSupportedTypes(i)}else this.store.setSupportedTypes(Nn);t.defaultTool&&this.store.setActiveTool(t.defaultTool)}get graphicsLayerId(){return ti}}const Dc={en:{"draw.multiPoint.started":"{type} drawing started with 1 point","draw.multiPoint.pointAdded":"Point added {count} points total","draw.multiPoint.pointRemoved":"Point removed {count} points remaining","draw.multiPoint.canceled":"Drawing canceled","draw.multiPoint.completed":"{type} completed with {count} points","draw.multiPoint.notEnoughPoints":"Not enough points for {type} minimum {min} required","draw.graphic.created":"{type} created","draw.graphic.selected":"{type} selected","draw.graphic.deselected":"Graphic deselected","draw.graphic.deleted":"Graphic deleted","draw.graphic.updated":"Graphic updated","draw.graphic.none":"No graphic found","draw.tool.canceled":"Drawing tool canceled","draw.point.resize.unsupported":"Resizing not supported for point graphics","draw.point.rotate.unsupported":"Rotation not supported for point graphics","draw.move.up":"Moved up","draw.move.down":"Moved down","draw.move.left":"Moved left","draw.move.right":"Moved right","draw.resize.increase":"Increased size","draw.resize.decrease":"Decreased size","draw.rotate.clockwise":"Rotated clockwise","draw.rotate.counterclockwise":"Rotated counter-clockwise","draw.button.point":"Draw point","draw.button.polyline":"Draw line","draw.button.polygon":"Draw polygon","draw.button.rectangle":"Draw rectangle","draw.button.circle":"Draw circle","draw.point.tooltip":"Draw point","draw.polyline.tooltip":"Draw polyline","draw.polygon.tooltip":"Draw polygon","draw.circle.tooltip":"Draw circle","draw.rectangle.tooltip":"Draw rectangle","draw.edit.tooltip":"Edit Mode","draw.graphic.moved":"Graphic moved","draw.shape":"shape","draw.point":"point","draw.multipoint":"multipoint","draw.polyline":"polyline","draw.polygon":"polygon","draw.rectangle":"rectangle","draw.circle":"circle","draw.unknown":"unknown"},fr:{"draw.multiPoint.started":"Dessin de {type} commenc avec 1 point","draw.multiPoint.pointAdded":"Point ajout","draw.multiPoint.pointRemoved":"Point supprim","draw.multiPoint.canceled":"Dessin annul","draw.multiPoint.completed":"{type} termin avec {count} points","draw.multiPoint.notEnoughPoints":"Pas assez de points pour {type}","draw.graphic.created":"{type} cr","draw.graphic.selected":"{type} slectionn","draw.graphic.deselected":"Graphique dslectionn","draw.graphic.deleted":"Graphique supprim","draw.graphic.updated":"Graphique mis  jour","draw.graphic.none":"Aucun graphique trouv","draw.tool.canceled":"Outil de dessin annul","draw.point.resize.unsupported":"Le redimensionnement n'est pas pris en charge pour les points","draw.point.rotate.unsupported":"La rotation n'est pas prise en charge pour les points","draw.move.up":"Dplac vers le haut","draw.move.down":"Dplac vers le bas","draw.move.left":"Dplac vers la gauche","draw.move.right":"Dplac vers la droite","draw.resize.increase":"Taille augmente","draw.resize.decrease":"Taille rduite","draw.rotate.clockwise":"Rotation dans le sens horaire","draw.rotate.counterclockwise":"Rotation dans le sens antihoraire","draw.button.point":"Dessiner un point","draw.button.polyline":"Dessiner une ligne","draw.button.polygon":"Dessiner un polygone","draw.button.rectangle":"Dessiner un rectangle","draw.button.circle":"Dessiner un cercle","draw.point.tooltip":"Dessiner un point","draw.polyline.tooltip":"Dessiner une polyligne","draw.polygon.tooltip":"Dessiner un polygone","draw.circle.tooltip":"Dessiner un cercle","draw.rectangle.tooltip":"Dessiner un rectangle","draw.edit.tooltip":"Mode dition","draw.graphic.moved":"Graphique dplac","draw.shape":"forme","draw.point":"indiquer","draw.multipoint":"multipoint","draw.polyline":"polyligne","draw.polygon":"polygone","draw.rectangle":"rectangle","draw.circle":"cercle","draw.unknown":"inconnue"}};class Ac extends Ic{async init(){const{el:t}=this.mount(Rc,{app:this.$element});this.$vApp.$el.getElementsByClassName("inner-shell")[0].appendChild(t.childNodes[0]),Object.entries(Dc).forEach(i=>this.$iApi.$i18n.mergeLocaleMessage(...i)),this._parseConfig(this.config),qi(this.$vApp.$pinia).supportedTypes.forEach(i=>{const n=`${i.type}-icon`;this.$iApi.component(n,zo(Sc(Object.assign({"./icons/circle-icon.vue":()=>M(()=>import("./circle-icon-DrE2wWqh-CCSWTQJL.js"),__vite__mapDeps([179,1,2]),import.meta.url),"./icons/edit-icon.vue":()=>M(()=>import("./edit-icon-C_tqZ1EG-pgFx_Q8M.js"),__vite__mapDeps([180,1,2]),import.meta.url),"./icons/point-icon.vue":()=>M(()=>import("./point-icon-BSJft8AI-CVNqAoG-.js"),__vite__mapDeps([181,1,2]),import.meta.url),"./icons/polygon-icon.vue":()=>M(()=>import("./polygon-icon-BrXtjiJl-Cl48WYuR.js"),__vite__mapDeps([182,1,2]),import.meta.url),"./icons/polyline-icon.vue":()=>M(()=>import("./polyline-icon-CqjafPK0-CNEbi0ZQ.js"),__vite__mapDeps([183,1,2]),import.meta.url),"./icons/rectangle-icon.vue":()=>M(()=>import("./rectangle-icon-D8mTZj4O-iZbfRzZH.js"),__vite__mapDeps([184,1,2]),import.meta.url)}),`./icons/${i.type}-icon.vue`,3)))})}async added(){this.$iApi.event.on(es.MAP_CREATED,()=>{this.init()})}}const sd=Object.freeze(Object.defineProperty({__proto__:null,default:Ac},Symbol.toStringTag,{value:"Module"}));export{dl as A,Zp as B,Ga as C,Xp as D,Hi as E,td as F,Jp as G,Qp as H,jp as I,Wp as J,Ml as K,sc as L,Yp as M,Bi as N,tl as O,za as P,ul as Q,nd as R,Up as S,ic as T,qp as U,Fp as V,sd as W,Kp as Z,vs as a,Ns as b,nc as c,Jt as d,Zi as e,id as f,Ya as g,el as h,il as i,gi as j,nl as k,Dl as l,b as m,j as n,_t as o,ed as p,Ci as q,Zs as r,Np as s,In as t,J as u,oc as v,Fi as w,ue as x,zi as y,cl as z};
