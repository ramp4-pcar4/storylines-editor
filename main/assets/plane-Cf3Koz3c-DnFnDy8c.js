import{J as z,du as D}from"./main-DXQSfJ4c.js";import{r as f,L as v,P as y,y as T,A as h,S as d,l as A,R as p}from"./vec32-Cj8pVsU0--XyG9wAo.js";import"./vec42-D8CJyqHG-DnfLTeQH.js";import{q as s,v as j,b as P}from"./vectorStacks-5ZZtmT9E-C3-CqvmY.js";function rr(r){const t=r[0]*r[0]+r[4]*r[4]+r[8]*r[8],I=r[1]*r[1]+r[5]*r[5]+r[9]*r[9],u=r[2]*r[2]+r[6]*r[6]+r[10]*r[10];return Math.sqrt(Math.max(t,I,u))}function tr(r,t){const I=Math.sqrt(t[0]*t[0]+t[4]*t[4]+t[8]*t[8]),u=Math.sqrt(t[1]*t[1]+t[5]*t[5]+t[9]*t[9]),c=Math.sqrt(t[2]*t[2]+t[6]*t[6]+t[10]*t[10]);return h(r,I,u,c),r}function w(r,t,I){Math.abs(r[0])>Math.abs(r[1])?h(t,0,1,0):h(t,1,0,0),d(I,r,t),d(t,I,r),A(I,I),A(t,t)}function L(r=_){return[r[0],r[1],r[2],r[3]]}function Ir(r=_[0],t=_[1],I=_[2],u=_[3]){return X(r,t,I,u,j.get())}function B(r,t){return X(t[0],t[1],t[2],t[3],r)}function ur(r){return r}function X(r,t,I,u,c=L()){return c[0]=r,c[1]=t,c[2]=I,c[3]=u,c}function G(r,t,I){const u=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],c=Math.abs(u-1)>1e-5&&u>1e-12?1/Math.sqrt(u):1;return I[0]=t[0]*c,I[1]=t[1]*c,I[2]=t[2]*c,I[3]=-(I[0]*r[0]+I[1]*r[1]+I[2]*r[2]),I}function H(r,t,I,u=L()){const c=I[0]-t[0],i=I[1]-t[1],n=I[2]-t[2],e=r[0]-t[0],g=r[1]-t[1],O=r[2]-t[2],S=i*O-n*g,m=n*e-c*O,b=c*g-i*e,q=S*S+m*m+b*b,$=Math.abs(q-1)>1e-5&&q>1e-12?1/Math.sqrt(q):1;return u[0]=S*$,u[1]=m*$,u[2]=b*$,u[3]=-(u[0]*r[0]+u[1]*r[1]+u[2]*r[2]),u}function x(r,t,I,u=0,c=Math.floor(I*(1/3)),i=Math.floor(I*(2/3))){if(I<3)return!1;t(M,u);let n=c,e=!1;for(;n<I-1&&!e;)t(E,n),n++,e=!p(M,E);if(!e)return!1;for(n=Math.max(n,i),e=!1;n<I&&!e;)t(a,n),n++,f(C,M,E),A(C,C),f(U,E,a),A(U,U),e=!p(M,a)&&!p(E,a)&&Math.abs(T(C,U))<J;return e?(H(M,E,a,r),!0):(u!==0||c!==1||i!==2)&&x(r,t,I,0,1,2)}function cr(r,t,I=!0){const u=t.length/3;return x(r,(c,i)=>h(c,t[3*i+0],t[3*i+1],t[3*i+2]),I?u-1:u)}const J=.99619469809,M=D(),E=D(),a=D(),C=D(),U=D();function er(r,t,I){return t!==r&&B(r,t),r[3]=-T(r,I),r}function nr(r,t){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=-r[3],t}function ir(r,t,I,u){return d(a,t,r),G(I,a,u)}function or(r,t,I,u){return l(F(r,t,f(s.get(),I,t),V,u))}function Nr(r,t,I){return t!=null&&l(F(r,t.origin,t.direction,W,I))}function sr(r,t,I){return l(F(r,t.origin,t.vector,N.NONE,I))}function ar(r,t,I){return l(F(r,t.origin,t.vector,N.CLAMP,I))}function Er(r,t){return R(r,t)>=0}function fr(r,t){const I=T(r,t.ray.direction),u=-R(r,t.ray.origin);if(I>-1e-6&&I<1e-6)return u>0;const c=u/I;return I>0?c<t.c1&&(t.c1=c):c>t.c0&&(t.c0=c),t.c0<=t.c1}function Tr(r,t,I){const u=v(s.get(),r,-r[3]),c=K(r,f(s.get(),t,u),s.get());return y(I,c,u),I}function Sr(r,t,I,u){const c=r,i=s.get(),n=s.get();w(c,i,n);const e=f(s.get(),I,t),g=P(i,e),O=P(n,e),S=P(c,e);return h(u,g,O,S)}function K(r,t,I){const u=v(s.get(),r,T(r,t));return f(I,t,u),I}function Mr(r,t){return Math.abs(R(r,t))}function R(r,t){return T(r,t)+r[3]}var o;function l(r){return r===o.INTERSECTS_INSIDE_OUT||r===o.INTERSECTS_OUTSIDE_IN}function F(r,t,I,u,c){const i=T(r,I),n=R(r,t);if(i===0)return n>=0?o.INSIDE:o.OUTSIDE;let e=-n/i;return u&N.CLAMP&&(e=z(e,0,1)),!(u&N.INFINITE_MIN)&&e<0||!(u&N.INFINITE_MAX)&&e>1?n>=0?o.INSIDE:o.OUTSIDE:(y(c,t,v(c,I,e)),n>=0?o.INTERSECTS_INSIDE_OUT:o.INTERSECTS_OUTSIDE_IN)}(function(r){r[r.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",r[r.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",r[r.INSIDE=2]="INSIDE",r[r.OUTSIDE=3]="OUTSIDE"})(o||(o={}));const _=[0,0,1,0];var N;(function(r){r[r.NONE=0]="NONE",r[r.CLAMP=1]="CLAMP",r[r.INFINITE_MIN=4]="INFINITE_MIN",r[r.INFINITE_MAX=8]="INFINITE_MAX"})(N||(N={}));const V=N.INFINITE_MIN|N.INFINITE_MAX,W=N.INFINITE_MAX;export{ur as $,cr as B,H as G,x as H,Ir as K,Mr as N,R as O,rr as V,er as Y,nr as Z,sr as a,fr as c,X as d,Er as e,Tr as i,tr as j,or as n,Nr as o,Sr as r,ar as s,ir as t,w as u,B as w,L as y,G as z};
