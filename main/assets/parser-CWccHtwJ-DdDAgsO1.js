import{h as v,f9 as Te,fa as De,fb as Le,fc as Ue,f7 as Ke,fd as Qe}from"./main-vBMuZyvK.js";import{o as Ft}from"./mat4f32-BdRMyjXW-CWt6U0BP.js";import{E as j,G as q}from"./mat4-OOmHNWi7-C-PfZJuw.js";const Be=(r,n)=>{const t=j(r,n,0,0,0,0,n,0,0,0,0,n,0,0,0,0,1);return q(t,t)},He=(r,n)=>{const t=j(r,n,0,0,.5-.5*n,0,n,0,.5-.5*n,0,0,n,.5-.5*n,0,0,0,1);return q(t,t)},Ve=(r,n)=>{const t=1-n,a=j(r,.2126+.7874*t,.7152-.7152*t,.0722-.0722*t,0,.2126-.2126*t,.7152+.2848*t,.0722-.0722*t,0,.2126-.2126*t,.7152-.7152*t,.0722+.9278*t,0,0,0,0,1);return q(a,a)},Ze=(r,n)=>{const t=Math.sin(n*Math.PI/180),a=Math.cos(n*Math.PI/180),g=j(r,.213+.787*a-.213*t,.715-.715*a-.715*t,.072-.072*a+.928*t,0,.213-.213*a+.143*t,.715+.285*a+.14*t,.072-.072*a-.283*t,0,.213-.213*a-.787*t,.715-.715*a+.715*t,.072+.928*a+.072*t,0,0,0,0,1);return q(g,g)},We=(r,n)=>{const t=1-2*n,a=j(r,t,0,0,n,0,t,0,n,0,0,t,n,0,0,0,1);return q(a,a)},tr=(r,n)=>{const t=j(r,.213+.787*n,.715-.715*n,.072-.072*n,0,.213-.213*n,.715+.285*n,.072-.072*n,0,.213-.213*n,.715-.715*n,.072+.928*n,0,0,0,0,1);return q(t,t)},er=(r,n)=>{const t=1-n,a=j(r,.393+.607*t,.769-.769*t,.189-.189*t,0,.349-.349*t,.686+.314*t,.168-.168*t,0,.272-.272*t,.534-.534*t,.131+.869*t,0,0,0,0,1);return q(a,a)};class B{constructor(n,t,a){this.strength=n,this.radius=t,this.threshold=a,this.type="bloom"}interpolate(n,t,a){this.strength=A(n.strength,t.strength,a),this.radius=A(n.radius,t.radius,a),this.threshold=A(n.threshold,t.threshold,a)}clone(){return new B(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:D(this.radius),strength:this.strength,threshold:this.threshold}}}let Et=class Ct{constructor(n){this.radius=n,this.type="blur"}interpolate(n,t,a){this.radius=Math.round(A(n.radius,t.radius,a))}clone(){return new Ct(this.radius)}toJSON(){return{type:"blur",radius:D(this.radius)}}};class L{constructor(n,t){this.type=n,this.amount=t,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(n,t,a){this.amount=A(n.amount,t.amount,a),this._updateMatrix()}clone(){return new L(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const n=this._colorMatrix||Ft();switch(this.type){case"brightness":this._colorMatrix=Be(n,this.amount);break;case"contrast":this._colorMatrix=He(n,this.amount);break;case"grayscale":this._colorMatrix=Ve(n,this.amount);break;case"invert":this._colorMatrix=We(n,this.amount);break;case"saturate":this._colorMatrix=tr(n,this.amount);break;case"sepia":this._colorMatrix=er(n,this.amount)}}}let Rt=class _t{constructor(n,t,a,g){this.offsetX=n,this.offsetY=t,this.blurRadius=a,this.color=g,this.type="drop-shadow"}interpolate(n,t,a){this.offsetX=A(n.offsetX,t.offsetX,a),this.offsetY=A(n.offsetY,t.offsetY,a),this.blurRadius=A(n.blurRadius,t.blurRadius,a),this.color[0]=Math.round(A(n.color[0],t.color[0],a)),this.color[1]=Math.round(A(n.color[1],t.color[1],a)),this.color[2]=Math.round(A(n.color[2],t.color[2],a)),this.color[3]=A(n.color[3],t.color[3],a)}clone(){return new _t(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const n=[...this.color];return n[3]*=255,{type:"drop-shadow",xoffset:D(this.offsetX),yoffset:D(this.offsetY),blurRadius:D(this.blurRadius),color:n}}},St=class Ot{constructor(n){this.angle=n,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(n,t,a){this.angle=A(n.angle,t.angle,a),this._updateMatrix()}clone(){return new Ot(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const n=this._colorMatrix||Ft();this._colorMatrix=Ze(n,this.angle)}};class H{constructor(n){this.amount=n,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(n,t,a){this.amount=A(n.amount,t.amount,a)}clone(){return new H(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}function A(r,n,t){return r+(n-r)*t}function D(r){return Math.round(1e3*Ke(r))/1e3}function rr(r){switch(r.type){case"grayscale":case"sepia":case"invert":return new L(r.type,0);case"saturate":case"brightness":case"contrast":return new L(r.type,1);case"opacity":return new H(1);case"hue-rotate":return new St(0);case"blur":return new Et(0);case"drop-shadow":return new Rt(0,0,0,[...Qe("transparent")]);case"bloom":return new B(0,0,1)}}function nr(r,n){const t=r.length>n.length?r:n;return(r.length>n.length?n:r).every((a,g)=>a.type===t[g].type)}function or(r,n){const t=r.length>n.length?r:n,a=r.length>n.length?n:r;for(let g=a.length;g<t.length;g++)a.push(rr(t[g]))}function Er(r){const n=r[0];return!!n&&"type"in n}class Mt extends SyntaxError{constructor(n,t,a,g){super(n),this.expected=t,this.found=a,this.location=g,this.name="SyntaxError"}format(n){let t="Error: "+this.message;if(this.location){let a=null;const g=n.find(_=>_.source===this.location.source);g&&(a=g.text.split(/\r\n|\n|\r/g));const M=this.location.start,R=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(M):M,S=this.location.source+":"+R.line+":"+R.column;if(a){const _=this.location.end,N="".padEnd(R.line.toString().length," "),J=a[M.line-1],Y=(M.line===_.line?_.column:J.length+1)-M.column||1;t+=`
 --> `+S+`
`+N+` |
`+R.line+" | "+J+`
`+N+" | "+"".padEnd(M.column-1," ")+"".padEnd(Y,"^")}else t+=`
 at `+S}return t}static buildMessage(n,t){function a(p){return p.codePointAt(0).toString(16).toUpperCase()}const g=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function M(p){return g?p.replace(g,f=>"\\u{"+a(f)+"}"):p}function R(p){return M(p.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,f=>"\\x0"+a(f)).replace(/[\x10-\x1F\x7F-\x9F]/g,f=>"\\x"+a(f)))}function S(p){return M(p.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,f=>"\\x0"+a(f)).replace(/[\x10-\x1F\x7F-\x9F]/g,f=>"\\x"+a(f)))}const _={literal:p=>'"'+R(p.text)+'"',class(p){const f=p.parts.map(F=>Array.isArray(F)?S(F[0])+"-"+S(F[1]):S(F));return"["+(p.inverted?"^":"")+f.join("")+"]"+(p.unicode?"u":"")},any:()=>"any character",end:()=>"end of input",other:p=>p.description};function N(p){return _[p.type](p)}function J(p){const f=p.map(N);if(f.sort(),f.length>0){let F=1;for(let O=1;O<f.length;O++)f[O-1]!==f[O]&&(f[F]=f[O],F++);f.length=F}switch(f.length){case 1:return f[0];case 2:return f[0]+" or "+f[1];default:return f.slice(0,-1).join(", ")+", or "+f[f.length-1]}}function Y(p){return p?'"'+R(p)+'"':"end of input"}return"Expected "+J(n)+" but "+Y(t)+" found."}}function ur(r,n){const t={},a=(n=n!==void 0?n:{}).grammarSource,g={start:bt};let M=bt;const R="none",S=")",_=",",N="(",J="%",Y="px",p="cm",f="mm",F="in",O="pt",ot="pc",ut="deg",st="rad",at="grad",it="turn",kt="#",It=".",jt="e",ct=/^[ \t\n\r]/,lt=/^[a-z\-]/,ft=/^[0-9a-fA-F]/,ht=/^[+\-]/,P=/^[0-9]/,qt=I("none"),Nt=w("none",!1),Jt=w(")",!1),pt=w(",",!1),gt=T([" ","	",`
`,"\r"],!1,!1,!1),Yt=I("function"),Xt=w("(",!1),zt=I("identifier"),mt=T([["a","z"],"-"],!1,!1,!1),Gt=I("percentage"),Tt=w("%",!1),Dt=I("length"),Lt=w("px",!1),Ut=w("cm",!1),Kt=w("mm",!1),Qt=w("in",!1),Bt=w("pt",!1),Ht=w("pc",!1),Vt=I("angle"),Zt=w("deg",!1),Wt=w("rad",!1),te=w("grad",!1),ee=w("turn",!1),re=I("number"),ne=I("color"),oe=w("#",!1),dt=T([["0","9"],["a","f"],["A","F"]],!1,!1,!1),yt=T(["+","-"],!1,!1,!1),k=T([["0","9"]],!1,!1,!1),ue=w(".",!1),se=w("e",!1);function ae(){return[]}function ie(e,o){return{type:"function",name:e,parameters:o||[]}}function ce(e,o){return o.length>0?Ge(e,o,3):[e]}function le(e){return{type:"quantity",value:e.value,unit:e.unit}}function fe(e){return{type:"color",colorType:e.type,value:e.value}}function he(){return Q()}function pe(e){return{value:e,unit:"%"}}function ge(e){return{value:e,unit:"px"}}function me(e){return{value:e,unit:"cm"}}function de(e){return{value:e,unit:"mm"}}function ye(e){return{value:e,unit:"in"}}function we(e){return{value:e,unit:"pt"}}function xe(e){return{value:e,unit:"pc"}}function be(e){return{value:e,unit:"deg"}}function ve(e){return{value:e,unit:"rad"}}function Ae(e){return{value:e,unit:"grad"}}function Me(e){return{value:e,unit:"turn"}}function $e(e){return{value:e,unit:null}}function Fe(){return{type:"hex",value:Q()}}function Ee(e){return{type:"function",value:e}}function Ce(){return{type:"named",value:Q()}}function Re(){return parseFloat(Q())}let u=0|n.peg$currPos,m=u;const X=[{line:1,column:1}];let G,E=u,K=n.peg$maxFailExpected||[],i=0|n.peg$silentFails;if(n.startRule){if(!(n.startRule in g))throw new Error(`Can't start parsing from rule "`+n.startRule+'".');M=g[n.startRule]}function Q(){return r.substring(m,u)}function _e(e=u){const o=r.codePointAt(e);return o===void 0?"":String.fromCodePoint(o)}function w(e,o){return{type:"literal",text:e,ignoreCase:o}}function T(e,o,s,c){return{type:"class",parts:e,inverted:o,ignoreCase:s,unicode:c}}function Se(){return{type:"end"}}function I(e){return{type:"other",description:e}}function wt(e){let o,s=X[e];if(s)return s;if(e>=X.length)o=X.length-1;else for(o=e;!X[--o];);for(s=X[o],s={line:s.line,column:s.column};o<e;)r.charCodeAt(o)===10?(s.line++,s.column=1):s.column++,o++;return X[e]=s,s}function xt(e,o,s){const c=wt(e),h=wt(o);return{source:a,start:{offset:e,line:c.line,column:c.column},end:{offset:o,line:h.line,column:h.column}}}function l(e){u<E||(u>E&&(E=u,K=[]),K.push(e))}function Oe(e,o,s){return new Mt(Mt.buildMessage(e,o),e,o,s)}function bt(){let e;return e=Pe(),e===t&&(e=ke()),e}function Pe(){let e,o;return i++,e=u,x(),r.substr(u,4)===R?(o=R,u+=4):(o=t,i===0&&l(Nt)),o!==t?(x(),m=e,e=ae()):(u=e,e=t),i--,e===t&&i===0&&l(qt),e}function ke(){let e,o;if(e=[],o=Z(),o!==t)for(;o!==t;)e.push(o),o=Z();else e=t;return e}function Z(){let e,o,s,c;return e=u,x(),o=je(),o!==t?(x(),s=Ie(),s===t&&(s=null),x(),r.charCodeAt(u)===41?(c=S,u++):(c=t,i===0&&l(Jt)),c!==t?(x(),m=e,e=ie(o,s)):(u=e,e=t)):(u=e,e=t),e}function Ie(){let e,o,s,c,h,d,y,b;if(e=u,o=W(),o!==t){for(s=[],c=u,h=x(),r.charCodeAt(u)===44?(d=_,u++):(d=t,i===0&&l(pt)),d===t&&(d=null),y=x(),b=W(),b!==t?(h=[h,d,y,b],c=h):(u=c,c=t);c!==t;)s.push(c),c=u,h=x(),r.charCodeAt(u)===44?(d=_,u++):(d=t,i===0&&l(pt)),d===t&&(d=null),y=x(),b=W(),b!==t?(h=[h,d,y,b],c=h):(u=c,c=t);m=e,e=ce(o,s)}else u=e,e=t;return e}function W(){let e,o;return e=u,o=qe(),o===t&&(o=Ne(),o===t&&(o=Je(),o===t&&(o=Ye()))),o!==t&&(m=e,o=le(o)),e=o,e===t&&(e=u,o=Xe(),o!==t&&(m=e,o=fe(o)),e=o),e}function x(){let e,o;for(i++,e=[],o=r.charAt(u),ct.test(o)?u++:(o=t,i===0&&l(gt));o!==t;)e.push(o),o=r.charAt(u),ct.test(o)?u++:(o=t,i===0&&l(gt));return i--,e}function je(){let e,o,s;return i++,e=u,o=vt(),o!==t?(r.charCodeAt(u)===40?(s=N,u++):(s=t,i===0&&l(Xt)),s!==t?(m=e,e=o):(u=e,e=t)):(u=e,e=t),i--,e===t&&(o=t,i===0&&l(Yt)),e}function vt(){let e,o,s;if(i++,e=u,o=[],s=r.charAt(u),lt.test(s)?u++:(s=t,i===0&&l(mt)),s!==t)for(;s!==t;)o.push(s),s=r.charAt(u),lt.test(s)?u++:(s=t,i===0&&l(mt));else o=t;return o!==t&&(m=e,o=he()),e=o,i--,e===t&&(o=t,i===0&&l(zt)),e}function qe(){let e,o,s;return i++,e=u,x(),o=$(),o!==t?(r.charCodeAt(u)===37?(s=J,u++):(s=t,i===0&&l(Tt)),s!==t?(m=e,e=pe(o)):(u=e,e=t)):(u=e,e=t),i--,e===t&&i===0&&l(Gt),e}function Ne(){let e,o,s;return i++,e=u,x(),o=$(),o!==t?(r.substr(u,2)===Y?(s=Y,u+=2):(s=t,i===0&&l(Lt)),s!==t?(m=e,e=ge(o)):(u=e,e=t)):(u=e,e=t),e===t&&(e=u,x(),o=$(),o!==t?(r.substr(u,2)===p?(s=p,u+=2):(s=t,i===0&&l(Ut)),s!==t?(m=e,e=me(o)):(u=e,e=t)):(u=e,e=t),e===t&&(e=u,x(),o=$(),o!==t?(r.substr(u,2)===f?(s=f,u+=2):(s=t,i===0&&l(Kt)),s!==t?(m=e,e=de(o)):(u=e,e=t)):(u=e,e=t),e===t&&(e=u,x(),o=$(),o!==t?(r.substr(u,2)===F?(s=F,u+=2):(s=t,i===0&&l(Qt)),s!==t?(m=e,e=ye(o)):(u=e,e=t)):(u=e,e=t),e===t&&(e=u,x(),o=$(),o!==t?(r.substr(u,2)===O?(s=O,u+=2):(s=t,i===0&&l(Bt)),s!==t?(m=e,e=we(o)):(u=e,e=t)):(u=e,e=t),e===t&&(e=u,x(),o=$(),o!==t?(r.substr(u,2)===ot?(s=ot,u+=2):(s=t,i===0&&l(Ht)),s!==t?(m=e,e=xe(o)):(u=e,e=t)):(u=e,e=t)))))),i--,e===t&&i===0&&l(Dt),e}function Je(){let e,o,s;return i++,e=u,o=$(),o!==t?(r.substr(u,3)===ut?(s=ut,u+=3):(s=t,i===0&&l(Zt)),s!==t?(m=e,e=be(o)):(u=e,e=t)):(u=e,e=t),e===t&&(e=u,o=$(),o!==t?(r.substr(u,3)===st?(s=st,u+=3):(s=t,i===0&&l(Wt)),s!==t?(m=e,e=ve(o)):(u=e,e=t)):(u=e,e=t),e===t&&(e=u,o=$(),o!==t?(r.substr(u,4)===at?(s=at,u+=4):(s=t,i===0&&l(te)),s!==t?(m=e,e=Ae(o)):(u=e,e=t)):(u=e,e=t),e===t&&(e=u,o=$(),o!==t?(r.substr(u,4)===it?(s=it,u+=4):(s=t,i===0&&l(ee)),s!==t?(m=e,e=Me(o)):(u=e,e=t)):(u=e,e=t)))),i--,e===t&&(o=t,i===0&&l(Vt)),e}function Ye(){let e,o;return i++,e=u,x(),o=$(),o!==t?(m=e,e=$e(o)):(u=e,e=t),i--,e===t&&i===0&&l(re),e}function Xe(){let e,o,s,c;if(i++,e=u,r.charCodeAt(u)===35?(o=kt,u++):(o=t,i===0&&l(oe)),o!==t){if(s=[],c=r.charAt(u),ft.test(c)?u++:(c=t,i===0&&l(dt)),c!==t)for(;c!==t;)s.push(c),c=r.charAt(u),ft.test(c)?u++:(c=t,i===0&&l(dt));else s=t;s!==t?(m=e,e=Fe()):(u=e,e=t)}else u=e,e=t;return e===t&&(e=u,o=Z(),o!==t&&(m=e,o=Ee(o)),e=o,e===t&&(e=u,o=vt(),o!==t&&(m=e,o=Ce()),e=o)),i--,e===t&&(o=t,i===0&&l(ne)),e}function $(){let e,o,s,c,h,d,y,b;for(e=u,o=r.charAt(u),ht.test(o)?u++:(o=t,i===0&&l(yt)),o===t&&(o=null),s=u,c=[],h=r.charAt(u),P.test(h)?u++:(h=t,i===0&&l(k));h!==t;)c.push(h),h=r.charAt(u),P.test(h)?u++:(h=t,i===0&&l(k));if(r.charCodeAt(u)===46?(h=It,u++):(h=t,i===0&&l(ue)),h!==t){if(d=[],y=r.charAt(u),P.test(y)?u++:(y=t,i===0&&l(k)),y!==t)for(;y!==t;)d.push(y),y=r.charAt(u),P.test(y)?u++:(y=t,i===0&&l(k));else d=t;d!==t?(c=[c,h,d],s=c):(u=s,s=t)}else u=s,s=t;if(s===t)if(s=[],c=r.charAt(u),P.test(c)?u++:(c=t,i===0&&l(k)),c!==t)for(;c!==t;)s.push(c),c=r.charAt(u),P.test(c)?u++:(c=t,i===0&&l(k));else s=t;if(s!==t){if(c=u,r.charCodeAt(u)===101?(h=jt,u++):(h=t,i===0&&l(se)),h!==t){if(d=r.charAt(u),ht.test(d)?u++:(d=t,i===0&&l(yt)),d===t&&(d=null),y=[],b=r.charAt(u),P.test(b)?u++:(b=t,i===0&&l(k)),b!==t)for(;b!==t;)y.push(b),b=r.charAt(u),P.test(b)?u++:(b=t,i===0&&l(k));else y=t;y!==t?(h=[h,d,y],c=h):(u=c,c=t)}else u=c,c=t;c===t&&(c=null),m=e,e=Re()}else u=e,e=t;return e}function ze(e,o){return e.map(function(s){return s[o]})}function Ge(e,o,s){return[e].concat(ze(o,s))}G=M();const tt=G!==t&&u===r.length;function At(){throw G!==t&&u<r.length&&l(Se()),Oe(K,E<r.length?_e(E):null,E<r.length?xt(E,E+1):xt(E,E))}return n.peg$library?{peg$result:G,peg$currPos:u,peg$FAILED:t,peg$maxFailExpected:K,peg$maxFailPos:E,peg$success:tt,peg$throw:tt?void 0:At}:tt?G:void At()}function Cr(r){if(!r||r.length===0)return null;if(typeof r=="string"){const t=$t(r);return t&&t.length!==0?t:null}const n=r.map(t=>{if(!Number.isFinite(t.scale)||t.scale<=0)throw new v("effect:invalid-scale","scale must be finite and greater than 0",{stop:t});return{scale:t.scale,effects:$t(t.value)}});n.sort((t,a)=>a.effects.length-t.effects.length);for(let t=0;t<n.length-1;t++){if(!nr(n[t].effects,n[t+1].effects))throw new v("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:n[t].effects,b:n[t+1].effects});or(n[t].effects,n[t+1].effects)}return n.sort((t,a)=>a.scale-t.scale),n}function $t(r){let n;if(!r)return[];try{n=ur(r)}catch(t){throw new v("effect:invalid-syntax","Invalid effect syntax",{value:r,error:t})}return n.map(t=>sr(t))}function sr(r){try{switch(r.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return ar(r);case"opacity":return ir(r);case"hue-rotate":return cr(r);case"blur":return lr(r);case"drop-shadow":return fr(r);case"bloom":return hr(r)}}catch(n){throw n.details.filter=r,n}throw new v("effect:unknown-effect",`Effect '${r.name}' is not supported`,{effect:r})}function ar(r){let n=1;return z(r.parameters,1),r.parameters.length===1&&(n=C(r.parameters[0])),new L(r.name,n)}function ir(r){let n=1;return z(r.parameters,1),r.parameters.length===1&&(n=C(r.parameters[0])),new H(n)}function cr(r){let n=0;return z(r.parameters,1),r.parameters.length===1&&(n=wr(r.parameters[0])),new St(n)}function lr(r){let n=0;return z(r.parameters,1),r.parameters.length===1&&(n=nt(r.parameters[0]),U(n,r.parameters[0])),new Et(n)}function fr(r){const n=[];let t=null;for(const a of r.parameters)if(a.type==="color"){if(n.length&&Object.freeze(n),t)throw new v("effect:type-error","Accepts only one color",{});t=xr(a)}else{const g=nt(a);if(Object.isFrozen(n))throw new v("effect:type-error","<length> parameters not consecutive",{lengths:n});n.push(g),n.length===3&&U(g,a)}if(n.length<2||n.length>3)throw new v("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${n.length}}`,{lengths:n});return new Rt(n[0],n[1],n[2]||0,t||Pt("black"))}function hr(r){let n=1,t=0,a=0;return z(r.parameters,3),r.parameters[0]&&(n=C(r.parameters[0])),r.parameters[1]&&(t=nt(r.parameters[1]),U(t,r.parameters[1])),r.parameters[2]&&(a=C(r.parameters[2])),new B(n,t,a)}function z(r,n){if(r.length>n)throw new v("effect:type-error",`Function supports up to ${n} parameters, Actual: ${r.length}`,{parameters:r})}function V(r){if(r.type==="color")return"<color>";if(r.unit){if(r.unit in rt)return"<length>";if(r.unit in et)return"<angle>";if(r.unit==="%")return"<percentage>"}return"<double>"}function U(r,n){if(r<0)throw new v("effect:type-error",`Negative values are not allowed, Actual: ${r}`,{term:n})}function pr(r){if(r.type!=="quantity"||r.unit!==null)throw new v("effect:type-error",`Expected <double>, Actual: ${V(r)}`,{term:r})}function gr(r){if(r.type!=="quantity"||r.unit!==null&&r.unit!=="%")throw new v("effect:type-error",`Expected <double> or <percentage>, Actual: ${V(r)}`,{term:r})}const et={deg:1,grad:.9,rad:180/Math.PI,turn:360};function mr(r){if(r.type!=="quantity"||!(r.value===0&&r.unit===null||r.unit&&et[r.unit]!=null))throw new v("effect:type-error",`Expected <angle>, Actual: ${V(r)}`,{term:r})}const rt={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function dr(r){if(r.type!=="quantity"||!(r.value===0&&r.unit===null||r.unit&&rt[r.unit]!=null))throw new v("effect:type-error",`Expected <length>, Actual: ${V(r)}`,{term:r})}function C(r){gr(r);const n=r.value;return U(n,r),r.unit==="%"?.01*n:n}function yr(r){return pr(r),U(r.value,r),r.value}function wr(r){return mr(r),r.value*et[r.unit]||0}function nt(r){return dr(r),r.value*rt[r.unit]||0}function xr(r){switch(r.colorType){case"hex":return Te(r.value);case"named":return Pt(r.value);case"function":return Ar(r.value)}}function Pt(r){if(!De(r))throw new v("effect:unknown-color",`color '${r}' isn't valid`,{namedColor:r});return Le(r)}const br=/^rgba?/i,vr=/^hsla?/i;function Ar(r){if(z(r.parameters,4),br.test(r.name))return[C(r.parameters[0]),C(r.parameters[1]),C(r.parameters[2]),r.parameters[3]?C(r.parameters[3]):1];if(vr.test(r.name))return Ue(yr(r.parameters[0]),C(r.parameters[1]),C(r.parameters[2]),r.parameters[3]?C(r.parameters[3]):1);throw new v("effect:syntax-error",`Invalid color function '${r.name}'`,{colorFunction:r})}export{nr as F,or as R,Cr as a,Er as s};
