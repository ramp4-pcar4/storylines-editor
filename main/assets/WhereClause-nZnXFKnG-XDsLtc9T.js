import{aK as Qo,aU as V,C as q,a5 as or,aV as Bo,aW as Go,aX as He,aY as qe,q as J,P as $,aZ as de,a_ as Wo,a$ as Xo}from"./main-D7vwjMDX.js";import{g as Y,m as z}from"./TimeOnly-C3SOkmg2-DHa7dw_N.js";var d;(function(a){a.InvalidFunctionParameters="InvalidFunctionParameters",a.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction",a.UnsupportedSqlFunction="UnsupportedSqlFunction",a.UnsupportedOperator="UnsupportedOperator",a.UnsupportedSyntax="UnsupportedSyntax",a.UnsupportedIsRhs="UnsupportedIsRhs",a.UnsupportedIsLhs="UnsupportedIsLhs",a.InvalidDataType="InvalidDataType",a.CannotCastValue="CannotCastValue",a.FunctionNotRecognized="FunctionNotRecognized",a.InvalidTime="InvalidTime",a.InvalidParameterCount="InvalidParameterCount",a.InvalidTimeStamp="InvalidTimeStamp",a.InvalidDate="InvalidDate",a.InvalidOperator="InvalidOperator",a.IllegalInterval="IllegalInterval",a.YearMonthIntervals="YearMonthIntervals",a.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers",a.MissingStatisticParameters="MissingStatisticParameters"})(d||(d={}));const Ko={[d.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[d.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[d.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[d.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[d.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[d.UnsupportedOperator]:"Unsupported operator - {operator}",[d.UnsupportedSyntax]:"Unsupported syntax - {node}",[d.UnsupportedSqlFunction]:"Sql function not found = {function}",[d.InvalidDataType]:"Invalid sql data type",[d.InvalidDate]:"Invalid date encountered",[d.InvalidOperator]:"Invalid operator encountered",[d.InvalidTime]:"Invalid time encountered",[d.IllegalInterval]:"Illegal interval",[d.FunctionNotRecognized]:"Function not recognized",[d.InvalidTimeStamp]:"Invalid timestamp encountered",[d.InvalidParameterCount]:"Invalid parameter count for call to {name}",[d.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[d.YearMonthIntervals]:"Year-Month Intervals not supported",[d.CannotCastValue]:"Cannot cast value to the required data type"};let m=class hr extends Error{constructor(i,u){super(Qo(Ko[i],u)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,hr)}};function lr(a){return Number.isNaN(a)||a===0?a:Math.trunc(a)}const cr="esri.core.sql.SqlTimeStampOffset";let B=class oe{constructor(i){this._timeStampOffset=i,this.declaredRootClass=cr,this._date=null}static isTimestampOffset(i){return typeof i=="object"&&i!=null&&"declaredRootClass"in i&&i.declaredRootClass===cr}toDateTime(){return this._date??=V.fromISO(this._timeStampOffset,{setZone:!0}),this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return lr(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return lr(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return oe.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(i){return new oe(V.fromJSDate(i).toISO({includeOffset:!0}))}static fromDateTime(i){return new oe(i.toISO({includeOffset:!0}))}static fromParts(i,u,t=0,l=0,v=0,g=0,T=0,S=!1,N=0,x=0){const D=`${i.toString().padStart(4,"0")}-${u.toString().padStart(2,"0")}-${t.toString().padStart(2,"0")}`;let E="";g<10&&(E="0");let K=`${l.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}:${E+g.toString()}`;T!==0&&(K+="."+T.toString().padStart(3,"0"));const ee=`${S?"-":"+"}${N.toString().padStart(2,"0")}:${x.toString().padStart(2,"0")}`;return new oe(D+"T"+K+ee)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let i=this.toDateTime().toSQL({includeOffset:!0,includeOffsetSpace:!0});return i&&(i=i.replace(".000","")),i}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(i){const u=this.toDateTime().plus(i);return oe.fromDateTime(u)}};function el(a,i){const u=wr[a.toLowerCase()];if(u==null)throw new m(d.FunctionNotRecognized);if(i.length<u.minParams||i.length>u.maxParams)throw new m(d.InvalidParameterCount,{name:a.toUpperCase()});return u.evaluate(i)}function fr(a,i){const u=wr[a.toLowerCase()];return u!=null&&i>=u.minParams&&i<=u.maxParams}const wr={min:{minParams:1,maxParams:1,evaluate:a=>dr(a[0],"min")},max:{minParams:1,maxParams:1,evaluate:a=>dr(a[0],"max")},avg:{minParams:1,maxParams:1,evaluate:a=>Ir(a[0])},sum:{minParams:1,maxParams:1,evaluate:a=>tl(a[0])},stddev:{minParams:1,maxParams:1,evaluate:a=>rl(a[0])},count:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:a[0].length},var:{minParams:1,maxParams:1,evaluate:a=>gr(a[0])}};function Ir(a){if(a===null)return null;let i=0,u=0;for(let t=0;t<a.length;t++){const l=a[t];if(l!==null){if(!tt(l))throw new m(d.InvalidValueForAggregateFunction);u++,i+=l}}return u===0?null:i/a.length}function tt(a){return typeof a=="number"}function dr(a,i){if(a===null)return null;let u=null,t=null;for(const l of a){let v=l;v=Y.isDateOnly(l)||z.isTimeOnly(l)?l.toNumber():V.isDateTime(l)?l.toMillis():B.isTimestampOffset(l)?l.toMilliseconds():l,(u===null||i==="max"&&t!==null&&v!==null&&t<=v||i==="min"&&t!==null&&v!==null&&t>=v)&&(u=l,t=v)}return u}function tl(a){if(a===null)return null;let i=0;for(let u=0;u<a.length;u++){const t=a[u];if(t!==null){if(!tt(t))throw new m(d.InvalidValueForAggregateFunction);i+=t}}return i}function rl(a){if(a===null)return null;const i=gr(a);return i===null?null:Math.sqrt(i)}function gr(a){if(a===null||(a=a.filter(t=>t!==null)).length===0)return null;const i=Ir(a);if(i===null)return null;let u=0;for(const t of a){if(!tt(t))throw new m(d.InvalidValueForAggregateFunction);u+=(i-t)**2}return u/(a.length-1)}function Ye(a){if(a.precision!==null||a.secondary!==null)throw new m(d.PrimarySecondaryQualifiers)}function Fe(a,i){if(i.includes(".")){const u=i.split(".");a.second=parseFloat(u[0]),a.millis=parseInt(u[1],10)}else a.second=parseFloat(i)}const pr="esri.core.sql.SqlInterval";class L{constructor(){this.declaredRootClass=pr,this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0,this.millis=0}static isInterval(i){return typeof i=="object"&&i!=null&&"declaredRootClass"in i&&i.declaredRootClass===pr}static createFromMilliseconds(i){const u=new L;return u.second=i/1e3,u}static createFromValueAndQualifier(i,u,t){let l=null;const v=new L;if(v.op=t==="-"?"-":"+",u.type==="interval-period"){Ye(u);const g=new RegExp("^[0-9]{1,}$");if(u.period==="year"||u.period==="month")throw new m(d.YearMonthIntervals);if(u.period==="second"){if(!/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(i))throw new m(d.IllegalInterval);Fe(v,i)}else{if(!g.test(i))throw new m(d.IllegalInterval);v[u.period]=parseFloat(i)}}else{if(Ye(u.start),Ye(u.end),u.start.period==="year"||u.start.period==="month"||u.end.period==="year"||u.end.period==="month")throw new m(d.YearMonthIntervals);switch(u.start.period){case"day":switch(u.end.period){case"hour":if(l=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!l.test(i))throw new m(d.IllegalInterval);v[u.start.period]=parseFloat(i.split(" ")[0]),v[u.end.period]=parseFloat(i.split(" ")[1]);break;case"minute":if(l=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!l.test(i))throw new m(d.IllegalInterval);{v[u.start.period]=parseFloat(i.split(" ")[0]);const g=i.split(" ")[1].split(":");v.hour=parseFloat(g[0]),v.minute=parseFloat(g[1])}break;case"second":if(l=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(i))throw new m(d.IllegalInterval);{v[u.start.period]=parseFloat(i.split(" ")[0]);const g=i.split(" ")[1].split(":");v.hour=parseFloat(g[0]),v.minute=parseFloat(g[1]),Fe(v,g[2])}break;default:throw new m(d.IllegalInterval)}break;case"hour":switch(u.end.period){case"minute":if(l=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!l.test(i))throw new m(d.IllegalInterval);v.hour=parseFloat(i.split(":")[0]),v.minute=parseFloat(i.split(":")[1]);break;case"second":if(l=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(i))throw new m(d.IllegalInterval);{const g=i.split(":");v.hour=parseFloat(g[0]),v.minute=parseFloat(g[1]),Fe(v,g[2])}break;default:throw new m(d.IllegalInterval)}break;case"minute":if(u.end.period!=="second")throw new m(d.IllegalInterval);if(l=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(i))throw new m(d.IllegalInterval);{const g=i.split(":");v.minute=parseFloat(g[0]),Fe(v,g[1])}break;default:throw new m(d.IllegalInterval)}}return v}valueInMilliseconds(){return(this.op==="-"?-1:1)*(this.millis+1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}const nl=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,il=/^(\d{1,2}):(\d{1,2})$/,al=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,yr=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,sl=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,ul=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,ol=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,ll=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function Pe(a,i){if(i instanceof Go)return i===He.instance?V.fromMillis(a.getTime(),{zone:He.instance}):V.fromJSDate(a,{zone:i});switch(i){case"system":case"local":case null:return V.fromJSDate(a);default:return i?.toLowerCase()==="unknown"?V.fromMillis(a.getTime(),{zone:He.instance}):V.fromJSDate(a,{zone:i})}}function X(a){return L.isInterval(a)}function F(a){return V.isDateTime(a)}function b(a){return Y.isDateOnly(a)}function P(a){return z.isTimeOnly(a)}function A(a){return B.isTimestampOffset(a)}function rt(a){let i=nl.exec(a);if(i!==null){const[,u,t,l]=i,v=z.fromParts(parseInt(u,10),parseInt(t,10),parseInt(l,10),0);if(v!==null)return v;throw new m(d.InvalidTime)}if(i=il.exec(a),i!==null){const[,u,t]=i,l=z.fromParts(parseInt(u,10),parseInt(t,10),0,0);if(l!==null)return l;throw new m(d.InvalidTime)}if(i=al.exec(a),i!==null){const[,u,t,l,v]=i,g=z.fromParts(parseInt(u,10),parseInt(t,10),parseInt(l,10),parseInt(v,10));if(g!==null)return g;throw new m(d.InvalidTime)}throw new m(d.InvalidTime)}function Le(a,i,u=!1){let t=sl.exec(a);if(t!==null){const[,l,v,g,T,S,N,x]=t,D=V.fromObject({year:parseInt(l,10),month:parseInt(v,10),day:parseInt(g,10),hour:parseInt(T,10),minute:parseInt(S,10),second:parseInt(N,10),millisecond:x?parseInt(x.replace(".",""),10):0},{zone:qe(i)});if(D.isValid===!1)throw new m(d.InvalidTimeStamp);return D}if(t=ul.exec(a),t!==null){const[,l,v,g,T,S,N,x,D,E,K]=t,ee=B.fromParts(parseInt(l,10),parseInt(v,10),parseInt(g,10),parseInt(T,10),parseInt(S,10),parseInt(N,10),x?parseInt(x.replace(".",""),10):0,D==="-",parseInt(E,10),parseInt(K,10));if(ee.isValid===!1)throw new m(d.InvalidTimeStamp);return ee}if(t=ol.exec(a),t!==null){const[,l,v,g,T,S,N,x,D]=t,E=B.fromParts(parseInt(l,10),parseInt(v,10),parseInt(g,10),parseInt(T,10),parseInt(S,10),0,0,N==="-",parseInt(x,10),parseInt(D,10));if(E.isValid===!1)throw new m(d.InvalidTimeStamp);return E}if(t=ll.exec(a),t!==null){const[,l,v,g,T,S]=t,N=V.fromObject({year:parseInt(l,10),month:parseInt(v,10),day:parseInt(g,10),hour:parseInt(T,10),minute:parseInt(S,10),second:0},{zone:qe(i)});if(N.isValid===!1)throw new m(d.InvalidTimeStamp);return N}if(t=yr.exec(a),t!==null){const[,l,v,g]=t,T=V.fromObject({year:parseInt(l,10),month:parseInt(v,10),day:parseInt(g,10),hour:0,minute:0,second:0},{zone:qe(i)});if(T.isValid===!1)throw new m(d.InvalidTimeStamp);return T}throw new m(d.InvalidTimeStamp)}function Tr(a,i){const u=yr.exec(a);if(u===null)try{return Le(a,i)}catch{throw new m(d.InvalidDate)}const[,t,l,v]=u,g=Y.fromParts(parseInt(t,10),parseInt(l,10),parseInt(v,10));if(g===null)throw new m(d.InvalidDate);return g}const cl=321408e5,fl=26784e5,dl=864e5,pl=36e5,ml=6e4;function je(a){return!!F(a)||!!A(a)}function We(a){return!!F(a)||!!b(a)||!!A(a)||!!P(a)}function be(a){if(F(a))return a.toMillis();if(b(a))return a.toNumber();if(A(a))return a.toMilliseconds();throw new m(d.InvalidDataType)}function Z(a,i,u,t){if(a==null||i==null)return null;if(J(a)){if(J(i))return Q(a,i,u);if($(i))return vl(a,i,u);if(We(i))throw new m(d.InvalidOperator);if(b(i))throw new m(d.InvalidOperator)}else if($(a)){if(J(i))return hl(a,i,u);if($(i))return wl(a,i,u);if(F(i))throw new m(d.InvalidOperator);if(b(i))throw new m(d.InvalidOperator);if(P(i))throw new m(d.InvalidOperator);if(A(i))throw new m(d.InvalidOperator)}else if(F(a)){if(je(i)){if(de(a.zone)){if(V.isDateTime(i)&&!de(i.zone)||B.isTimestampOffset(i))return Qe(a,i,u)}else if(V.isDateTime(i)&&de(i.zone)&&(!de(a.zone)||B.isTimestampOffset(a)))return Qe(a,i,u);return Q(be(a),be(i),u)}if($(i))throw new m(d.InvalidOperator);if(b(i))return Il(a,i,u);if(P(i))throw new m(d.InvalidOperator);if(J(i))throw new m(d.InvalidOperator)}else if(b(a)){if(A(i))return Tl(a,i,u);if(F(i))return yl(a,i,u);if($(i))throw new m(d.InvalidOperator);if(b(i))return Q(a.toNumber(),i.toNumber(),u);if(P(i))throw new m(d.InvalidOperator);if(J(i))throw new m(d.InvalidOperator)}else if(P(a)){if(P(i))return Q(a.toNumber(),i.toNumber(),u);if($(i))throw new m(d.InvalidOperator);if(J(i))throw new m(d.InvalidOperator);if(b(i))throw new m(d.InvalidOperator);if(je(i))throw new m(d.InvalidOperator)}else if(A(a)){if(je(i))return V.isDateTime(i)&&de(i.zone)?Qe(a,i,u):Q(be(a),be(i),u);if($(i))throw new m(d.InvalidOperator);if(b(i))return gl(a,i,u);if(P(i))throw new m(d.InvalidOperator);if(J(i))throw new m(d.InvalidOperator)}switch(u){case"<>":return a!==i;case"=":return a===i;case">":return a>i;case"<":return a<i;case">=":return a>=i;case"<=":return a<=i}}function Q(a,i,u){switch(u){case"<>":return a!==i;case"=":return a===i;case">":return a>i;case"<":return a<i;case">=":return a>=i;case"<=":return a<=i}}function vl(a,i,u){const t=parseFloat(i);if(!isNaN(t))return Q(a,t,u);const l=a.toString();switch(u){case"<>":return l!==i;case"=":return l===i;case">":return l>i;case"<":return l<i;case">=":return l>=i;case"<=":return l<=i}}function hl(a,i,u){const t=parseFloat(a);if(!isNaN(t))return Q(t,i,u);const l=i.toString();switch(u){case"<>":return a!==l;case"=":return a===l;case">":return a>l;case"<":return a<l;case">=":return a>=l;case"<=":return a<=l}}function wl(a,i,u){switch(u){case"<>":return a!==i;case"=":return a===i;case">":return a>i;case"<":return a<i;case">=":return a>=i;case"<=":return a<=i}}function Il(a,i,u){const t=i.toDateTimeLuxon(a.zone);return Q((a=a.startOf("day")).toMillis(),t.toMillis(),u)}function gl(a,i,u){const t=i.toDateTimeLuxon(a.toDateTime().zone);return Q((a=a.startOfDay()).toMilliseconds(),t.toMillis(),u)}function yl(a,i,u){const t=a.toDateTimeLuxon(i.zone);return i=i.startOf("day"),Q(t.toMillis(),i.toMillis(),u)}function Tl(a,i,u){const t=a.toDateTimeLuxon(i.toDateTime().zone);return i=i.startOfDay(),Q(t.toMillis(),i.toMilliseconds(),u)}function Qe(a,i,u){B.isTimestampOffset(a)&&(a=a.toDateTime()),B.isTimestampOffset(i)&&(i=i.toDateTime());const t=mr(a),l=mr(i);switch(u){case"<>":return t!==l;case"=":return t===l;case">":return t>l;case"<":return t<l;case">=":return t>=l;case"<=":return t<=l}}function mr(a){return a.year*cl+a.month*fl+a.day*dl+a.hour*pl+a.minute*ml+1e3*a.second+a.millisecond}function nt(a,i,u){const t=Nr[a.toLowerCase()];if(t==null)throw new m(d.FunctionNotRecognized);if(i.length<t.minParams||i.length>t.maxParams)throw new m(d.InvalidParameterCount,{name:a.toUpperCase()});return t.evaluate(i,u)}function Ol(a,i){const u=Nr[a.toLowerCase()];return u!=null&&i>=u.minParams&&i<=u.maxParams}function Be(a){return!q(a)&&!b(a)&&!F(a)&&!P(a)&&!A(a)}function Or(a){return b(a)||P(a)?a.toString():A(a)?a.toSQLValue():F(a)?a.millisecond===0?a.toFormat("yyyy-LL-dd HH:mm:ss"):a.toSQL({includeOffset:!1}):q(a)?Or(V.fromJSDate(a)):a.toString()}function Nl(a){if(q(a))return Y.fromDateJS(a);if(F(a))return Y.fromParts(a.year,a.month,a.day);if(b(a))return a;if(P(a))throw new m(d.CannotCastValue);if(A(a)&&Y.fromParts(a.year,a.month,a.day)===null)throw new m(d.CannotCastValue);if($(a)){const i=Y.fromReader(a);if(i!==null&&i.isValid)return i}throw new m(d.CannotCastValue)}function Sl(a,i,u){if(q(a))return Pe(a,i);if(F(a))return a;if(b(a))return a.toDateTimeLuxon("unknown");if(P(a))throw new m(d.CannotCastValue);if(A(a))return a;if($(a))return Le(a,"unknown",u);throw new m(d.CannotCastValue)}function xl(a){if(q(a))return z.fromDateJS(a);if(F(a))return z.fromDateTime(a);if(b(a))throw new m(d.CannotCastValue);if(P(a))return a;if(A(a))return z.fromSqlTimeStampOffset(a);if($(a))return rt(a);throw new m(d.CannotCastValue)}const Nr={extract:{minParams:2,maxParams:2,evaluate:([a,i])=>{if(i==null)return null;if(q(i))switch(a.toUpperCase()){case"SECOND":return i.getSeconds();case"MINUTE":return i.getMinutes();case"HOUR":return i.getHours();case"DAY":return i.getDate();case"MONTH":return i.getMonth()+1;case"YEAR":return i.getFullYear();case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":return 0}else if(F(i))switch(a.toUpperCase()){case"SECOND":return i.second;case"MINUTE":return i.minute;case"HOUR":return i.hour;case"DAY":return i.day;case"MONTH":return i.month;case"YEAR":return i.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new m(d.InvalidFunctionParameters,{function:"EXTRACT"})}else if(b(i))switch(a.toUpperCase()){case"DAY":return i.day;case"MONTH":return i.month;case"YEAR":return i.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new m(d.InvalidFunctionParameters,{function:"EXTRACT"})}else if(P(i))switch(a.toUpperCase()){case"SECOND":return i.second;case"MINUTE":return i.minute;case"HOUR":return i.hour}else if(A(i))switch(a.toUpperCase()){case"SECOND":return i.second;case"MINUTE":return i.minute;case"HOUR":return i.hour;case"DAY":return i.day;case"MONTH":return i.month;case"YEAR":return i.year;case"TIMEZONE_HOUR":return i.timezoneOffsetHour;case"TIMEZONE_MINUTE":return i.timezoneOffsetMinutes}throw new m(d.InvalidFunctionParameters,{function:"EXTRACT"})}},substring:{minParams:2,maxParams:3,evaluate:a=>{if(a.length===2){const[i,u]=a;return i==null||u==null?null:i.toString().substring(u-1)}if(a.length===3){const[i,u,t]=a;return i==null||u==null||t==null?null:t<=0?"":i.toString().substring(u-1,u+t-1)}}},position:{minParams:2,maxParams:2,evaluate:([a,i])=>a==null||i==null?null:i.indexOf(a)+1},trim:{minParams:2,maxParams:3,evaluate:a=>{const i=a.length===3,u=i?a[1]:" ",t=i?a[2]:a[1];if(u==null||t==null)return null;const l=`(${Wo(u)})`;switch(a[0]){case"BOTH":return t.replaceAll(new RegExp(`^${l}*|${l}*$`,"g"),"");case"LEADING":return t.replaceAll(new RegExp(`^${l}*`,"g"),"");case"TRAILING":return t.replaceAll(new RegExp(`${l}*$`,"g"),"")}throw new m(d.InvalidFunctionParameters,{function:"TRIM"})}},abs:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.abs(a[0])},ceiling:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.ceil(a[0])},floor:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.floor(a[0])},log:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.log(a[0])},log10:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.log(a[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.sin(a[0])},cos:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.cos(a[0])},tan:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.tan(a[0])},asin:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.asin(a[0])},acos:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.acos(a[0])},atan:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.atan(a[0])},sign:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:a[0]>0?1:a[0]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:a=>a[0]==null||a[1]==null?null:a[0]**a[1]},mod:{minParams:2,maxParams:2,evaluate:a=>a[0]==null||a[1]==null?null:a[0]%a[1]},round:{minParams:1,maxParams:2,evaluate:a=>{const i=a[0],u=a.length===2?10**a[1]:1;return i==null?null:Math.round(i*u)/u}},truncate:{minParams:1,maxParams:2,evaluate:a=>a[0]==null?null:a.length===1||a[1]===0?Math.trunc(a[0]):Xo("trunc",a[0],-Number(a[1]))},char_length:{minParams:1,maxParams:1,evaluate:a=>$(a[0])?a[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:a=>{let i="";for(let u=0;u<a.length;u++){if(a[u]==null)return null;i+=a[u].toString()}return i}},lower:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:a[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:a[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:1/0,evaluate:a=>{for(const i of a)if(i!==null)return i;return null}},cosh:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.cosh(a[0])},sinh:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.sinh(a[0])},tanh:{minParams:1,maxParams:1,evaluate:a=>a[0]==null?null:Math.tanh(a[0])},nullif:{minParams:2,maxParams:2,evaluate:(a,i)=>Z(a[0],a[1],"=")?null:a[0]},cast:{minParams:2,maxParams:2,evaluate:(a,i)=>{const u=a[0],t=a[1];if(u===null)return null;switch(t.type){case"integer":{if(!Be(u))throw new m(d.CannotCastValue);const l=parseInt(u,10);if(isNaN(l))throw new m(d.CannotCastValue);return l}case"smallint":{if(!Be(u))throw new m(d.CannotCastValue);const l=parseInt(u,10);if(isNaN(l))throw new m(d.CannotCastValue);if(l>32767||l<-32767)throw new m(d.CannotCastValue);return l}case"float":case"real":{if(!Be(u))throw new m(d.CannotCastValue);const l=parseFloat(u);if(isNaN(l))throw new m(d.CannotCastValue);return l}case"time":return xl(u);case"date":return Nl(u);case"timestamp":return Sl(u,i,t.withtimezone===!0);case"varchar":{const l=Or(u);if(l.length>t.size)throw new m(d.CannotCastValue);return l}default:throw new m(d.InvalidDataType)}}}};function Sr(a,i,u,t){if(a==="||")return nt("concat",[i,u],t);if(i===null||u===null)return null;if(J(i)){if(J(u))return it(i,u,a);if(X(u))return Pl(i,u,a);if(P(u))return kl();if(b(u))return Hl();if(A(u))return zl();if(F(u))return Jl();if($(u))return ql(i,u,a);throw new m(d.InvalidOperator)}if(b(i)){if(J(u))return $l(i,u,a);if(X(u))return Ll(i,u,a);if(P(u))return Kl();if(b(u))return Xl(i,u,a);if(A(u))return Wl(i,u,a);if(F(u))return Gl(i,u,a);if($(u))return dc();throw new m(d.InvalidOperator)}if(P(i)){if(J(u))return Vl(i,u,a);if(X(u))return Fl(i,u,a);if(P(u))return uc();if(b(u))return ac();if(A(u))return sc();if(F(u))return ic();if($(u))return pc();throw new m(d.InvalidOperator)}if(X(i)){if(J(u))return Dl(i,u,a);if(X(u))return Al(i,u,a);if(P(u))return Ml(i,u,a);if(b(u))return El(i,u,a);if(A(u))return bl(i,u,a);if(F(u))return Cl(i,u,a);if($(u))return Ql();throw new m(d.InvalidOperator)}if(F(i)){if(J(u))return Ul(i,u,a);if(X(u))return Rl(i,u,a);if(P(u))return fc();if(b(u))return lc(i,u,a);if(A(u))return cc(i,u,a);if(F(u))return oc(i,u,a);if($(u))return mc();throw new m(d.InvalidOperator)}if(A(i)){if(J(u))return Zl(i,u,a);if(X(u))return _l(i,u,a);if(P(u))return ec();if(b(u))return tc(i,u,a);if(A(u))return nc(i,u,a);if(F(u))return rc(i,u,a);if($(u))return vc();throw new m(d.InvalidOperator)}if($(i)){if(J(u))return Yl(i,u,a);if(X(u))return Bl();if(P(u))return hc();if(b(u))return wc();if(A(u))return gc();if(F(u))return Ic();if($(u))return jl(i,u,a);throw new m(d.InvalidOperator)}throw new m(d.InvalidOperator)}function it(a,i,u){switch(u){case"+":return a+i;case"-":return a-i;case"*":return a*i;case"/":return a/i}throw new m(d.InvalidOperator)}function Cl(a,i,u){switch(u){case"+":return i.plus({milliseconds:a.valueInMilliseconds()});case"-":return a.valueInMilliseconds()-i.toMillis()}throw new m(d.InvalidOperator)}function Ml(a,i,u){if(u==="+")return i.plus("milliseconds",a.valueInMilliseconds());throw new m(d.InvalidOperator)}function El(a,i,u){if(u==="+")return i.plus("milliseconds",a.valueInMilliseconds());throw new m(d.InvalidOperator)}function Fl(a,i,u){switch(u){case"+":return a.plus("milliseconds",i.valueInMilliseconds());case"-":return a.plus("milliseconds",-1*i.valueInMilliseconds())}throw new m(d.InvalidOperator)}function bl(a,i,u){if(u==="+")return i.addMilliseconds(a.valueInMilliseconds());throw new m(d.InvalidOperator)}function Al(a,i,u){switch(u){case"+":return L.createFromMilliseconds(a.valueInMilliseconds()+i.valueInMilliseconds());case"-":return L.createFromMilliseconds(a.valueInMilliseconds()-i.valueInMilliseconds());case"*":return L.createFromMilliseconds(a.valueInMilliseconds()*i.valueInMilliseconds());case"/":return L.createFromMilliseconds(a.valueInMilliseconds()/i.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Dl(a,i,u){switch(u){case"+":return L.createFromMilliseconds(a.valueInMilliseconds()+i);case"-":return L.createFromMilliseconds(a.valueInMilliseconds()-i);case"*":return L.createFromMilliseconds(a.valueInMilliseconds()*i);case"/":return L.createFromMilliseconds(a.valueInMilliseconds()/i)}throw new m(d.InvalidOperator)}function Pl(a,i,u){switch(u){case"+":return L.createFromMilliseconds(a+i.valueInMilliseconds());case"-":return L.createFromMilliseconds(a-i.valueInMilliseconds());case"*":return L.createFromMilliseconds(a*i.valueInMilliseconds());case"/":return L.createFromMilliseconds(a/i.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Ll(a,i,u){switch(u){case"+":return a.plus("milliseconds",i.valueInMilliseconds());case"-":return a.plus("milliseconds",-1*i.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Rl(a,i,u){switch(u){case"+":return a.plus({milliseconds:i.valueInMilliseconds()});case"-":return a.minus({milliseconds:i.valueInMilliseconds()})}throw new m(d.InvalidOperator)}function _l(a,i,u){switch(u){case"+":return a.addMilliseconds(i.valueInMilliseconds());case"-":return a.addMilliseconds(-1*i.valueInMilliseconds())}throw new m(d.InvalidOperator)}function Ul(a,i,u){const t=1e3*i*24*60*60;switch(u){case"+":return a.plus({milliseconds:t});case"-":return a.minus({milliseconds:t})}throw new m(d.InvalidOperator)}function $l(a,i,u){const t=1e3*i*24*60*60;switch(u){case"+":return a.plus("milliseconds",t);case"-":return a.plus("milliseconds",-1*t)}throw new m(d.InvalidOperator)}function Vl(a,i,u){const t=1e3*i*24*60*60;switch(u){case"+":return a.plus("milliseconds",t);case"-":return a.plus("milliseconds",-1*t)}throw new m(d.InvalidOperator)}function Jl(a,i,u){throw new m(d.InvalidOperator)}function Zl(a,i,u){const t=1e3*i*24*60*60;switch(u){case"+":return a.addMilliseconds(t);case"-":return a.addMilliseconds(-1*t)}throw new m(d.InvalidOperator)}function zl(a,i,u){throw new m(d.InvalidOperator)}function kl(a,i,u){throw new m(d.InvalidOperator)}function Hl(a,i,u){throw new m(d.InvalidOperator)}function ql(a,i,u){const t=parseFloat(i);if(isNaN(t))throw new m(d.InvalidOperator);return it(a,t,u)}function Yl(a,i,u){const t=parseFloat(a);if(isNaN(t))throw new m(d.InvalidOperator);return it(t,i,u)}function jl(a,i,u){if(u==="+")return a+i;throw new m(d.InvalidOperator)}function Ql(a,i,u){throw new m(d.InvalidOperator)}function Bl(a,i,u){throw new m(d.InvalidOperator)}function Gl(a,i,u){if(u==="-")return a.toDateTimeLuxon(i.zone).diff(i).as("days");throw new m(d.InvalidOperator)}function Wl(a,i,u){if(u==="-")return a.toDateTimeLuxon(i.toDateTime().zone).diff(i.toDateTime()).as("days");throw new m(d.InvalidOperator)}function Xl(a,i,u){if(u==="-")return a.toDateTimeLuxon("UTC").diff(i.toDateTimeLuxon("UTC")).as("days");throw new m(d.InvalidOperator)}function Kl(a,i,u){throw new m(d.InvalidOperator)}function ec(a,i,u){throw new m(d.InvalidOperator)}function tc(a,i,u){if(u==="-")return a.toDateTime().diff(i.toDateTimeLuxon(a.toDateTime().zone)).as("days");throw new m(d.InvalidOperator)}function rc(a,i,u){if(u==="-")return a.toDateTime().diff(i).as("days");throw new m(d.InvalidOperator)}function nc(a,i,u){if(u==="-")return a.toDateTime().diff(i.toDateTime()).as("days");throw new m(d.InvalidOperator)}function ic(a,i,u){throw new m(d.InvalidOperator)}function ac(a,i,u){throw new m(d.InvalidOperator)}function sc(a,i,u){throw new m(d.InvalidOperator)}function uc(a,i,u){throw new m(d.InvalidOperator)}function oc(a,i,u){if(u==="-")return a.diff(i).as("days");throw new m(d.InvalidOperator)}function lc(a,i,u){if(u==="-")return a.diff(i.toDateTimeLuxon(a.zone)).as("days");throw new m(d.InvalidOperator)}function cc(a,i,u){if(u==="-")return a.diff(i.toDateTime()).as("days");throw new m(d.InvalidOperator)}function fc(a,i,u){throw new m(d.InvalidOperator)}function dc(a,i,u){throw new m(d.InvalidOperator)}function pc(a,i,u){throw new m(d.InvalidOperator)}function mc(a,i,u){throw new m(d.InvalidOperator)}function vc(a,i,u){throw new m(d.InvalidOperator)}function hc(a,i,u){throw new m(d.InvalidOperator)}function wc(a,i,u){throw new m(d.InvalidOperator)}function Ic(a,i,u){throw new m(d.InvalidOperator)}function gc(a,i,u){throw new m(d.InvalidOperator)}function yc(a,i){function u(){this.constructor=a}u.prototype=i.prototype,a.prototype=new u}function se(a,i,u,t){var l=Error.call(this,a);return Object.setPrototypeOf&&Object.setPrototypeOf(l,se.prototype),l.expected=i,l.found=u,l.location=t,l.name="SyntaxError",l}function Ge(a,i,u){return u=u||" ",a.length>i?a:(i-=a.length,a+(u+=u.repeat(i)).slice(0,i))}function Tc(a,i){var u,t={},l=(i=i!==void 0?i:{}).grammarSource,v={start:xt},g=xt,T="!",S="=",N=">=",x=">",D="<=",E="<>",K="!=",ee="||",Fr="@",st="'",ut="N'",me="''",br=".",Ar="null",Dr="true",Pr="false",Lr="in",Rr="is",_r="like",Ur="escape",$r="not",Vr="and",Jr="or",Zr="between",zr="from",kr="for",Hr="substring",qr="extract",Yr="trim",jr="position",Qr="timestamp",Br="date",Gr="time",Wr="leading",Xr="trailing",Kr="both",en="cast",tn="as",rn="integer",nn="int",an="smallint",sn="float",un="real",on="varchar",ln="to",cn="interval",fn="year",dn="timezone_hour",pn="timezone_minute",mn="month",vn="day",hn="hour",wn="minute",In="second",gn="case",yn="end",Tn="when",On="then",Nn="else",Sn=",",xn="(",Cn=")",ot="`",Mn=/^[<-=]/,ve=/^[+\-]/,En=/^[*\/]/,Fn=/^[A-Za-z_\x80-\uFFFF]/,bn=/^[A-Za-z0-9_]/,lt=/^[A-Za-z0-9_.\x80-\uFFFF]/,An=/^["]/,ct=/^[^']/,Dn=/^[0-9]/,Pn=/^[eE]/,Ln=/^[ \t\n\r]/,ft=/^[^`]/,Rn=y("!",!1),_n=y("=",!1),Un=y(">=",!1),$n=y(">",!1),Vn=y("<=",!1),Jn=y("<>",!1),Zn=k([["<","="]],!1,!1),zn=y("!=",!1),he=k(["+","-"],!1,!1),kn=y("||",!1),Hn=k(["*","/"],!1,!1),qn=k([["A","Z"],["a","z"],"_",["","￿"]],!1,!1),Yn=k([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),dt=k([["A","Z"],["a","z"],["0","9"],"_",".",["","￿"]],!1,!1),jn=k(['"'],!1,!1),Qn=y("@",!1),pt=y("'",!1),Bn=y("N'",!1),mt=y("''",!1),vt=k(["'"],!0,!1),Gn=y(".",!1),Wn=k([["0","9"]],!1,!1),Xn=k(["e","E"],!1,!1),Kn=y("NULL",!0),ei=y("TRUE",!0),ti=y("FALSE",!0),ri=y("IN",!0),ni=y("IS",!0),ii=y("LIKE",!0),ai=y("ESCAPE",!0),si=y("NOT",!0),ui=y("AND",!0),oi=y("OR",!0),li=y("BETWEEN",!0),ci=y("FROM",!0),fi=y("FOR",!0),di=y("SUBSTRING",!0),pi=y("EXTRACT",!0),mi=y("TRIM",!0),vi=y("POSITION",!0),hi=y("TIMESTAMP",!0),wi=y("DATE",!0),Ii=y("TIME",!0),gi=y("LEADING",!0),yi=y("TRAILING",!0),Ti=y("BOTH",!0),Oi=y("CAST",!0),Ni=y("AS",!0),Si=y("INTEGER",!0),xi=y("INT",!0),Ci=y("SMALLINT",!0),Mi=y("FLOAT",!0),Ei=y("REAL",!0),Fi=y("VARCHAR",!0),bi=y("TO",!0),Ai=y("INTERVAL",!0),Di=y("YEAR",!0),Pi=y("TIMEZONE_HOUR",!0),Li=y("TIMEZONE_MINUTE",!0),Ri=y("MONTH",!0),_i=y("DAY",!0),Ui=y("HOUR",!0),$i=y("MINUTE",!0),Vi=y("SECOND",!0),Ji=y("CASE",!0),Zi=y("END",!0),zi=y("WHEN",!0),ki=y("THEN",!0),Hi=y("ELSE",!0),qi=y(",",!1),Yi=y("(",!1),ji=y(")",!1),Qi=k([" ","	",`
`,"\r"],!1,!1),ht=y("`",!1),wt=k(["`"],!0,!1),Bi=function(e){return e},Gi=function(e){return{type:"expression-list",location:I(),value:e}},It=function(e,r,s){return{op:r,expr:s,location:I()}},Wi=function(e,r){return fe(e,r)},gt=function(e,r,s){return{op:r,expr:s,location:I()}},Xi=function(e,r){return fe(e,r)},Ki=function(e){return Ho("NOT",e,I())},ea=function(e,r){return r==""||r==null||r==null?e:r.type=="arithmetic"?fe(e,r.tail):sr(r.op,e,r.right,r.escape,I())},yt=function(e,r){return{op:e,expr:r,location:I()}},ta=function(e){return{type:"arithmetic",tail:e}},ra=function(e,r){return{op:e+"NOT",right:r}},na=function(e,r){return{op:e,right:r}},ia=function(e,r,s){return H(I(),r,s)},aa=function(e,r){return{op:"NOT"+e,right:r}},sa=function(e,r,s){return H(I(),r,s)},ua=function(e,r){return{op:e,right:r}},oa=function(e){return e[0]+" "+e[2]},la=function(e){return e[0]+" "+e[2]},ca=function(e,r,s){return{op:e,right:r,escape:s.value}},fa=function(e,r){return{op:e,right:r,escape:""}},da=function(e,r){return{op:e,right:r}},pa=function(e,r){return{op:e,right:r}},Tt=function(e,r,s){return{op:r,expr:s,location:I()}},ma=function(e,r){return fe(e,r)},Ot=function(e,r,s){return{op:r,expr:s,location:I()}},va=function(e,r){return fe(e,r)},ha=function(e){return e.paren=!0,e},wa=function(e){return/^CURRENT_DATE$/i.test(e)?{type:"current-time",location:I(),mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(e)?{type:"current-time",location:I(),mode:"timestamp"}:/^CURRENT_TIME$/i.test(e)?{type:"current-time",location:I(),mode:"time"}:/^CURRENT_USER$/i.test(e)?{type:"current-user",location:I()}:{type:"column-reference",location:I(),table:"",column:e}},Ia=function(e){return{type:"column-reference",location:I(),table:"",column:e,delimited:!0}},ga=function(e){return e},ya=function(e,r){return e+r.join("")},Ta=function(e,r){return e+r.join("")},Oa=function(e){return e},Na=function(e){return e.join("")},Sa=function(){return'"'},xa=function(e){return{type:"parameter",location:I(),value:e[1]}},Ca=function(e,r){return H(I(),e,r)},Ma=function(e,r){return H(I(),e,r)},Ea=function(e){return{type:"function",location:I(),name:"extract",args:e}},Fa=function(e,r,s){return H(I(),e,r,...s?[s]:[])},ba=function(e,r,s){return H(I(),e,r,s)},Aa=function(e){return{type:"function",location:I(),name:"substring",args:e}},Da=function(e,r){return H(I(),e,r)},Pa=function(e,r){return H(I(),e,r)},La=function(e){return{type:"function",location:I(),name:"cast",args:e}},Ra=function(){return{type:"data-type",location:I(),value:{type:"integer"}}},_a=function(){return{type:"data-type",location:I(),value:{type:"smallint"}}},Ua=function(){return{type:"data-type",location:I(),value:{type:"float"}}},$a=function(){return{type:"data-type",location:I(),value:{type:"real"}}},Va=function(){return{type:"data-type",location:I(),value:{type:"date"}}},Ja=function(){return{type:"data-type",location:I(),value:{type:"timestamp"}}},Za=function(){return{type:"data-type",location:I(),value:{type:"time"}}},za=function(e){return{type:"data-type",location:I(),value:{type:"varchar",size:parseInt(e)}}},ka=function(e,r,s){return H(I(),e,r,s)},Ha=function(e,r){return H(I(),e,r)},qa=function(e){return{type:"function",location:I(),name:"trim",args:e}},Ya=function(e){return{type:"string",location:I(),value:e??"BOTH"}},ja=function(e,r){return H(I(),e,r)},Qa=function(e,r){return H(I(),e,r)},Ba=function(e){return{type:"function",location:I(),name:"position",args:e}},Ga=function(e,r){return{type:"function",location:I(),name:e,args:r}},Wa=function(e){return{type:"string",location:I(),value:e}},Xa=function(e){return e.type==="string"&&qo(e.value),{type:"timestamp",location:I(),value:e.value}},Ka=function(e){return e.type==="string"&&Yo(e.value),{type:"time",location:I(),value:e.value}},es=function(e,r,s){return{type:"interval",location:I(),value:r,qualifier:s,op:e}},ts=function(e,r){return{type:"interval",location:I(),value:e,qualifier:r,op:""}},rs=function(e,r){return{type:"interval-qualifier",location:I(),start:e,end:r}},ns=function(e,r){return{type:"interval-period",location:I(),period:e.value,precision:r,secondary:null}},is=function(e){return{type:"interval-period",location:I(),period:e.value,precision:null,secondary:null}},as=function(e){return{type:"interval-period",location:I(),period:e.value,precision:null,secondary:null}},ss=function(e,r){return{type:"interval-period",location:I(),period:"second",precision:e,secondary:r}},us=function(e){return{type:"interval-period",location:I(),period:"second",precision:e,secondary:null}},os=function(){return{type:"interval-period",location:I(),period:"second",precision:null,secondary:null}},ls=function(e,r){return{type:"interval-period",location:I(),period:e.value,precision:r,secondary:null}},cs=function(e){return{type:"interval-period",location:I(),period:e.value,precision:null,secondary:null}},fs=function(e,r){return{type:"interval-period",location:I(),period:"second",precision:e,secondary:r}},ds=function(e){return{type:"interval-period",location:I(),period:"second",precision:e,secondary:null}},ps=function(){return{type:"interval-period",location:I(),period:"second",precision:null,secondary:null}},ms=function(){return{type:"string",location:I(),value:"day"}},vs=function(){return{type:"string",location:I(),value:"hour"}},hs=function(){return{type:"string",location:I(),value:"minute"}},ws=function(){return{type:"string",location:I(),value:"month"}},Is=function(){return{type:"string",location:I(),value:"year"}},gs=function(e){return parseFloat(e)},ys=function(e){return parseFloat(e)},Ts=function(e){return e.type==="string"&&jo(e.value),{type:"date",location:I(),value:e.value}},Os=function(){return{type:"null",location:I(),value:null}},Ns=function(){return{type:"boolean",location:I(),value:!0}},Ss=function(){return{type:"boolean",location:I(),value:!1}},Nt=function(){return"'"},xs=function(e){return{type:"string",location:I(),value:e.join("")}},Cs=function(e,r){return{type:"case-expression",location:I(),format:"simple",operand:e,clauses:r,else:null,elseLocation:null}},Ms=function(e,r,s){return{type:"case-expression",location:I(),format:"simple",operand:e,clauses:r,else:s.value,elseLocation:s.location}},Es=function(e){return{type:"case-expression",location:I(),format:"searched",clauses:e,else:null,elseLocation:null}},Fs=function(e,r){return{type:"case-expression",location:I(),format:"searched",clauses:e,else:r.value,elseLocation:r.location}},bs=function(e,r){return{type:"when-clause",location:I(),operand:e,value:r}},As=function(e,r){return{type:"when-clause",location:I(),operand:e,value:r}},Ds=function(e){return{type:"else-clause",location:I(),value:e}},Ps=function(e){return{type:"number",location:I(),value:e}},Ls=function(e,r,s){return parseFloat(e+r+s)},Rs=function(e,r){return parseFloat(e+r)},_s=function(e,r){return parseFloat(e+r)},Us=function(e){return parseFloat(e)},$s=function(e,r){return e[0]+r},Vs=function(e){return"."+(e??"")},Js=function(e,r){return e+r},Zs=function(e){return e.join("")},zs=function(e,r){return"e"+(r===null?"":r)},ks=function(){return"IN"},Hs=function(){return"IS"},qs=function(){return"LIKE"},Ys=function(){return"ESCAPE"},js=function(){return"NOT"},Qs=function(){return"AND"},Bs=function(){return"OR"},Gs=function(){return"BETWEEN"},Ws=function(){return"FROM"},Xs=function(){return"FOR"},Ks=function(){return"SUBSTRING"},eu=function(){return"EXTRACT"},tu=function(){return"TRIM"},ru=function(){return"POSITION"},nu=function(){return"TIMESTAMP"},iu=function(){return"DATE"},au=function(){return"TIME"},su=function(){return"LEADING"},uu=function(){return"TRAILING"},ou=function(){return"BOTH"},lu=function(){return"CAST"},cu=function(){return"AS"},fu=function(){return"INTEGER"},du=function(){return"INT"},pu=function(){return"SMALLINT"},mu=function(){return"FLOAT"},vu=function(){return"REAL"},hu=function(){return"VARCHAR"},wu=function(){return"TO"},Iu=function(){return"INTERVAL"},gu=function(){return"YEAR"},yu=function(){return"TIMEZONE_HOUR"},Tu=function(){return"TIMEZONE_MINUTE"},Ou=function(){return"MONTH"},Nu=function(){return"DAY"},Su=function(){return"HOUR"},xu=function(){return"MINUTE"},Cu=function(){return"SECOND"},Mu=function(){return"CASE"},Eu=function(){return"END"},Fu=function(){return"WHEN"},bu=function(){return"THEN"},Au=function(){return"ELSE"},Du=function(e){return e},Pu=function(e){return e.join("")},n=0|i.peg$currPos,f=n,ue=[{line:1,column:1}],j=n,we=i.peg$maxFailExpected||[],c=0|i.peg$silentFails;if(i.startRule){if(!(i.startRule in v))throw new Error(`Can't start parsing from rule "`+i.startRule+'".');g=v[i.startRule]}function I(){return Ie(f,n)}function Re(e,r){throw Ru(e,r=r!==void 0?r:Ie(f,n))}function y(e,r){return{type:"literal",text:e,ignoreCase:r}}function k(e,r,s){return{type:"class",parts:e,inverted:r,ignoreCase:s}}function Lu(){return{type:"end"}}function St(e){var r,s=ue[e];if(s)return s;if(e>=ue.length)r=ue.length-1;else for(r=e;!ue[--r];);for(s={line:(s=ue[r]).line,column:s.column};r<e;)a.charCodeAt(r)===10?(s.line++,s.column=1):s.column++,r++;return ue[e]=s,s}function Ie(e,r,s){var o=St(e),h=St(r);return{source:l,start:{offset:e,line:o.line,column:o.column},end:{offset:r,line:h.line,column:h.column}}}function w(e){n<j||(n>j&&(j=n,we=[]),we.push(e))}function Ru(e,r){return new se(e,null,null,r)}function _u(e,r,s){return new se(se.buildMessage(e,r),e,r,s)}function xt(){var e,r;return e=n,p(),(r=M())!==t?(p(),f=e,e=Bi(r)):(n=e,e=t),e}function Ct(){var e,r,s,o,h,C;if(e=n,R()!==t){for(p(),r=[],s=M();s!==t;)r.push(s),s=n,o=n,h=p(),(C=W())!==t?o=h=[h,C,p()]:(n=o,o=t),o!==t&&(o=M())===t?(n=s,s=t):s=o;s=p(),(o=_())!==t?(f=e,e=Gi(r)):(n=e,e=t)}else n=e,e=t;return e}function M(){var e,r,s,o,h,C;if(e=n,(r=_e())!==t){for(s=[],o=n,p(),(h=qt())!==t?(p(),(C=_e())!==t?(f=o,o=It(r,h,C)):(n=o,o=t)):(n=o,o=t);o!==t;)s.push(o),o=n,p(),(h=qt())!==t?(p(),(C=_e())!==t?(f=o,o=It(r,h,C)):(n=o,o=t)):(n=o,o=t);f=e,e=Wi(r,s)}else n=e,e=t;return e}function _e(){var e,r,s,o,h,C;if(e=n,(r=ge())!==t){for(s=[],o=n,p(),(h=Ce())!==t?(p(),(C=ge())!==t?(f=o,o=gt(r,h,C)):(n=o,o=t)):(n=o,o=t);o!==t;)s.push(o),o=n,p(),(h=Ce())!==t?(p(),(C=ge())!==t?(f=o,o=gt(r,h,C)):(n=o,o=t)):(n=o,o=t);f=e,e=Xi(r,s)}else n=e,e=t;return e}function ge(){var e,r,s,o,h;return e=n,(r=ce())===t&&(r=n,a.charCodeAt(n)===33?(s=T,n++):(s=t,c===0&&w(Rn)),s!==t?(o=n,c++,a.charCodeAt(n)===61?(h=S,n++):(h=t,c===0&&w(_n)),c--,h===t?o=void 0:(n=o,o=t),o!==t?r=s=[s,o]:(n=r,r=t)):(n=r,r=t)),r!==t?(s=p(),(o=ge())!==t?(f=e,e=Ki(o)):(n=e,e=t)):(n=e,e=t),e===t&&(e=Uu()),e}function Uu(){var e,r,s,o;return e=n,(r=G())!==t?(s=n,p(),(o=$u())!==t?s=o:(n=s,s=t),s===t&&(s=null),f=e,e=ea(r,s)):(n=e,e=t),e}function $u(){var e;return(e=Vu())===t&&(e=ku())===t&&(e=Zu())===t&&(e=Ju())===t&&(e=zu()),e}function Vu(){var e,r,s,o,h;if(e=n,r=[],s=n,p(),(o=Mt())!==t?(p(),(h=G())!==t?(f=s,s=yt(o,h)):(n=s,s=t)):(n=s,s=t),s!==t)for(;s!==t;)r.push(s),s=n,p(),(o=Mt())!==t?(p(),(h=G())!==t?(f=s,s=yt(o,h)):(n=s,s=t)):(n=s,s=t);else r=t;return r!==t&&(f=e,r=ta(r)),e=r}function Mt(){var e;return a.substr(n,2)===N?(e=N,n+=2):(e=t,c===0&&w(Un)),e===t&&(a.charCodeAt(n)===62?(e=x,n++):(e=t,c===0&&w($n)),e===t&&(a.substr(n,2)===D?(e=D,n+=2):(e=t,c===0&&w(Vn)),e===t&&(a.substr(n,2)===E?(e=E,n+=2):(e=t,c===0&&w(Jn)),e===t&&(e=a.charAt(n),Mn.test(e)?n++:(e=t,c===0&&w(Zn)),e===t&&(a.substr(n,2)===K?(e=K,n+=2):(e=t,c===0&&w(zn))))))),e}function Ju(){var e,r,s,o;return e=n,(r=kt())!==t?(p(),(s=ce())!==t?(p(),(o=G())!==t?(f=e,e=ra(r,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=kt())!==t?(p(),(s=G())!==t?(f=e,e=na(r,s)):(n=e,e=t)):(n=e,e=t)),e}function Zu(){var e,r,s,o,h,C,ie,ur;return e=n,(r=ce())!==t?(p(),(s=Yt())!==t?(o=p(),h=n,(C=G())!==t?(p(),(ie=Ce())!==t?(p(),(ur=G())!==t?(f=h,h=ia(s,C,ur)):(n=h,h=t)):(n=h,h=t)):(n=h,h=t),h!==t?(f=e,e=aa(s,h)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=Yt())!==t?(p(),s=n,(o=G())!==t?(h=p(),(C=Ce())!==t?(p(),(ie=G())!==t?(f=s,s=sa(r,o,ie)):(n=s,s=t)):(n=s,s=t)):(n=s,s=t),s!==t?(f=e,e=ua(r,s)):(n=e,e=t)):(n=e,e=t)),e}function Et(){var e,r,s,o,h;return e=n,r=n,(s=ce())!==t?(o=p(),(h=Ht())!==t?r=s=[s,o,h]:(n=r,r=t)):(n=r,r=t),r!==t&&(f=e,r=oa(r)),(e=r)===t&&(e=Ht()),e}function Ft(){var e,r,s,o,h;return e=n,r=n,(s=ce())!==t?(o=p(),(h=ze())!==t?r=s=[s,o,h]:(n=r,r=t)):(n=r,r=t),r!==t&&(f=e,r=la(r)),(e=r)===t&&(e=ze()),e}function zu(){var e,r,s,o;return e=n,(r=Et())!==t?(p(),(s=te())!==t?(p(),No()!==t?(p(),(o=Ze())!==t?(f=e,e=ca(r,s,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=Et())!==t?(p(),(s=te())!==t?(f=e,e=fa(r,s)):(n=e,e=t)):(n=e,e=t)),e}function ku(){var e,r,s;return e=n,(r=Ft())!==t?(p(),(s=Ct())!==t?(f=e,e=da(r,s)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=Ft())!==t?(p(),(s=Je())!==t?(f=e,e=pa(r,s)):(n=e,e=t)):(n=e,e=t)),e}function G(){var e,r,s,o,h,C;if(e=n,(r=Ue())!==t){for(s=[],o=n,p(),(h=bt())!==t?(p(),(C=Ue())!==t?(f=o,o=Tt(r,h,C)):(n=o,o=t)):(n=o,o=t);o!==t;)s.push(o),o=n,p(),(h=bt())!==t?(p(),(C=Ue())!==t?(f=o,o=Tt(r,h,C)):(n=o,o=t)):(n=o,o=t);f=e,e=ma(r,s)}else n=e,e=t;return e}function bt(){var e;return e=a.charAt(n),ve.test(e)?n++:(e=t,c===0&&w(he)),e===t&&(a.substr(n,2)===ee?(e=ee,n+=2):(e=t,c===0&&w(kn))),e}function Ue(){var e,r,s,o,h,C;if(e=n,(r=$e())!==t){for(s=[],o=n,p(),(h=At())!==t?(p(),(C=$e())!==t?(f=o,o=Ot(r,h,C)):(n=o,o=t)):(n=o,o=t);o!==t;)s.push(o),o=n,p(),(h=At())!==t?(p(),(C=$e())!==t?(f=o,o=Ot(r,h,C)):(n=o,o=t)):(n=o,o=t);f=e,e=va(r,s)}else n=e,e=t;return e}function At(){var e;return e=a.charAt(n),En.test(e)?n++:(e=t,c===0&&w(Hn)),e}function $e(){var e,r;return(e=no())===t&&(e=Wu())===t&&(e=Xu())===t&&(e=eo())===t&&(e=to())===t&&(e=Ku())===t&&(e=ro())===t&&(e=mo())===t&&(e=Hu())===t&&(e=Je())===t&&(e=n,R()!==t?(p(),(r=M())!==t?(p(),_()!==t?(f=e,e=ha(r)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}function Hu(){var e,r;return e=n,(r=qu())!==t&&(f=e,r=wa(r)),(e=r)===t&&(e=n,(r=ju())!==t&&(f=e,r=Ia(r)),e=r),e}function qu(){var e,r;return e=n,(r=Yu())!==t&&(f=e,r=ga(r)),e=r}function Yu(){var e,r,s,o;if(e=n,(r=Ve())!==t){for(s=[],o=Pt();o!==t;)s.push(o),o=Pt();f=e,e=ya(r,s)}else n=e,e=t;return e}function Dt(){var e,r,s,o;if(e=n,(r=Ve())!==t){for(s=[],o=O();o!==t;)s.push(o),o=O();f=e,e=Ta(r,s)}else n=e,e=t;return e}function Ve(){var e;return e=a.charAt(n),Fn.test(e)?n++:(e=t,c===0&&w(qn)),e}function O(){var e;return e=a.charAt(n),bn.test(e)?n++:(e=t,c===0&&w(Yn)),e}function Pt(){var e;return e=a.charAt(n),lt.test(e)?n++:(e=t,c===0&&w(dt)),e}function ju(){var e,r;return e=n,ye()!==t?(r=Qu(),ye()!==t?(f=e,e=Oa(r)):(n=e,e=t)):(n=e,e=t),e}function Qu(){var e,r,s;for(e=n,r=[],s=Lt();s!==t;)r.push(s),s=Lt();return f=e,e=r=Na(r)}function Lt(){var e;return(e=Gu())===t&&(e=Bu()),e}function Bu(){var e;return e=n,ye()!==t&&ye()!==t?(f=e,e=Sa()):(n=e,e=t),e}function Gu(){var e;return e=a.charAt(n),lt.test(e)?n++:(e=t,c===0&&w(dt)),e}function ye(){var e;return e=a.charAt(n),An.test(e)?n++:(e=t,c===0&&w(jn)),e}function Je(){var e,r,s,o;return e=n,r=n,a.charCodeAt(n)===64?(s=Fr,n++):(s=t,c===0&&w(Qn)),s!==t&&(o=Dt())!==t?r=s=[s,o]:(n=r,r=t),r!==t&&(f=e,r=xa(r)),e=r}function Wu(){var e,r,s,o;return e=n,jt()!==t?(p(),r=n,R()!==t?(p(),(s=Ut())!==t?(p(),ke()!==t?(p(),(o=M())!==t?(p(),_()!==t?(f=r,r=Ca(s,o)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,R()!==t?(p(),(s=Ut())!==t?(p(),W()!==t?(p(),(o=M())!==t?(p(),_()!==t?(f=r,r=Ma(s,o)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=Ea(r)):(n=e,e=t)):(n=e,e=t),e}function Xu(){var e,r,s,o,h,C,ie;return e=n,xo()!==t?(p(),r=n,R()!==t?(p(),(s=M())!==t?(p(),ke()!==t?(p(),(o=M())!==t?(p(),h=n,So()!==t?(C=p(),(ie=M())!==t?(p(),h=ie):(n=h,h=t)):(n=h,h=t),h===t&&(h=null),_()!==t?(f=r,r=Fa(s,o,h)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,R()!==t?(p(),(s=M())!==t?(p(),W()!==t?(p(),(o=M())!==t?(p(),(h=W())!==t?(p(),(C=M())!==t&&(ie=_())!==t?(f=r,r=ba(s,o,C)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=Aa(r)):(n=e,e=t)):(n=e,e=t),e}function Ku(){var e,r,s,o;return e=n,Ao()!==t?(p(),r=n,R()!==t?(p(),(s=M())!==t?(p(),Do()!==t?(p(),(o=Rt())!==t?(p(),_()!==t?(f=r,r=Da(s,o)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,R()!==t?(p(),(s=M())!==t?(p(),W()!==t?(p(),(o=Rt())!==t?(p(),_()!==t?(f=r,r=Pa(s,o)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=La(r)):(n=e,e=t)):(n=e,e=t),e}function Rt(){var e,r,s;return e=n,(r=Po())===t&&(r=Lo()),r!==t&&(f=e,r=Ra()),(e=r)===t&&(e=n,(r=Ro())!==t&&(f=e,r=_a()),(e=r)===t&&(e=n,(r=_o())!==t&&(f=e,r=Ua()),(e=r)===t&&(e=n,(r=Uo())!==t&&(f=e,r=$a()),(e=r)===t&&(e=n,(r=Bt())!==t&&(f=e,r=Va()),(e=r)===t&&(e=n,(r=Qt())!==t&&(f=e,r=Ja()),(e=r)===t&&(e=n,(r=Gt())!==t&&(f=e,r=Za()),(e=r)===t&&(e=n,(r=$o())!==t?(p(),R()!==t?(p(),(s=re())!==t?(p(),_()!==t?(f=e,e=za(s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)))))))),e}function eo(){var e,r,s,o,h;return e=n,Co()!==t?(p(),r=n,R()!==t?(p(),s=_t(),p(),(o=M())!==t?(p(),ke()!==t?(p(),(h=M())!==t?(p(),_()!==t?(f=r,r=ka(s,o,h)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,R()!==t?(p(),s=_t(),p(),(o=M())!==t?(p(),_()!==t?(f=r,r=Ha(s,o)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=qa(r)):(n=e,e=t)):(n=e,e=t),e}function _t(){var e,r;return e=n,(r=Eo())===t&&(r=Fo())===t&&(r=bo()),r===t&&(r=null),f=e,e=r=Ya(r)}function to(){var e,r,s,o;return e=n,Mo()!==t?(p(),r=n,R()!==t?(p(),(s=M())!==t?(p(),ze()!==t?(p(),(o=M())!==t?(p(),_()!==t?(f=r,r=ja(s,o)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t),r===t&&(r=n,R()!==t?(p(),(s=M())!==t?(p(),W()!==t?(p(),(o=M())!==t?(p(),_()!==t?(f=r,r=Qa(s,o)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)):(n=r,r=t)),r!==t?(f=e,e=Ba(r)):(n=e,e=t)):(n=e,e=t),e}function ro(){var e,r,s,o;return e=n,r=n,c++,s=jt(),c--,s===t?r=void 0:(n=r,r=t),r!==t&&(s=ko())!==t?(p(),(o=Ct())!==t?(f=e,e=Ga(s,o)):(n=e,e=t)):(n=e,e=t),e}function Ut(){var e,r;return e=n,(r=Xt())===t&&(r=Kt())===t&&(r=er())===t&&(r=tr())===t&&(r=rr())===t&&(r=ne())===t&&(r=Jo())===t&&(r=Zo()),r!==t&&(f=e,r=Wa(r)),e=r}function no(){var e;return(e=Ze())===t&&(e=wo())===t&&(e=po())===t&&(e=fo())===t&&(e=co())===t&&(e=io())===t&&(e=so())===t&&(e=ao()),e}function io(){var e,r;return e=n,Qt()!==t?(p(),(r=te())!==t?(f=e,e=Xa(r)):(n=e,e=t)):(n=e,e=t),e}function ao(){var e,r;return e=n,Gt()!==t?(p(),(r=te())!==t?(f=e,e=Ka(r)):(n=e,e=t)):(n=e,e=t),e}function so(){var e,r,s,o;return e=n,Wt()!==t?(p(),r=a.charAt(n),ve.test(r)?n++:(r=t,c===0&&w(he)),r!==t?(p(),(s=te())!==t?(p(),(o=$t())!==t?(f=e,e=es(r,s,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,Wt()!==t?(p(),(r=te())!==t?(p(),(s=$t())!==t?(f=e,e=ts(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}function $t(){var e,r,s;return e=n,(r=uo())!==t?(p(),Vo()!==t?(p(),(s=oo())!==t?(f=e,e=rs(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=lo()),e}function uo(){var e,r,s;return e=n,(r=le())!==t?(p(),R()!==t?(p(),(s=Oe())!==t?(p(),_()!==t?(f=e,e=ns(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=le())!==t&&(f=e,r=is(r)),e=r),e}function oo(){var e,r,s,o;return e=n,(r=le())!==t&&(f=e,r=as(r)),(e=r)===t&&(e=n,(r=ne())!==t?(p(),R()!==t?(p(),(s=Oe())!==t?(p(),W()!==t?(p(),(o=Te())!==t?(p(),_()!==t?(f=e,e=ss(s,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ne())!==t?(p(),R()!==t?(p(),(s=Oe())!==t?(p(),_()!==t?(f=e,e=us(s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ne())!==t&&(f=e,r=os()),e=r))),e}function lo(){var e,r,s,o;return e=n,(r=le())!==t?(p(),R()!==t?(p(),(s=Te())!==t?(p(),_()!==t?(f=e,e=ls(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=le())!==t&&(f=e,r=cs(r)),(e=r)===t&&(e=n,(r=ne())!==t?(p(),R()!==t?(p(),(s=Oe())!==t?(p(),W()!==t?(p(),(o=Te())!==t?(p(),_()!==t?(f=e,e=fs(s,o)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ne())!==t?(p(),R()!==t?(p(),(s=Te())!==t?(p(),_()!==t?(f=e,e=ds(s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(r=ne())!==t&&(f=e,r=ps()),e=r)))),e}function le(){var e,r;return e=n,(r=er())!==t&&(f=e,r=ms()),(e=r)===t&&(e=n,(r=tr())!==t&&(f=e,r=vs()),(e=r)===t&&(e=n,(r=rr())!==t&&(f=e,r=hs()),(e=r)===t&&(e=n,(r=Kt())!==t&&(f=e,r=ws()),(e=r)===t&&(e=n,(r=Xt())!==t&&(f=e,r=Is()),e=r)))),e}function Te(){var e,r;return e=n,(r=re())!==t&&(f=e,r=gs(r)),e=r}function Oe(){var e,r;return e=n,(r=re())!==t&&(f=e,r=ys(r)),e=r}function co(){var e,r;return e=n,Bt()!==t?(p(),(r=te())!==t?(f=e,e=Ts(r)):(n=e,e=t)):(n=e,e=t),e}function fo(){var e,r;return e=n,(r=yo())!==t&&(f=e,r=Os()),e=r}function po(){var e,r;return e=n,(r=To())!==t&&(f=e,r=Ns()),(e=r)===t&&(e=n,(r=Oo())!==t&&(f=e,r=Ss()),e=r),e}function te(){var e;return(e=Ze())===t&&(e=Je()),e}function Ze(){var e,r,s,o,h;if(e=n,a.charCodeAt(n)===39?(r=st,n++):(r=t,c===0&&w(pt)),r===t&&(a.substr(n,2)===ut?(r=ut,n+=2):(r=t,c===0&&w(Bn))),r!==t){for(s=[],o=n,a.substr(n,2)===me?(h=me,n+=2):(h=t,c===0&&w(mt)),h!==t&&(f=o,h=Nt()),(o=h)===t&&(o=a.charAt(n),ct.test(o)?n++:(o=t,c===0&&w(vt)));o!==t;)s.push(o),o=n,a.substr(n,2)===me?(h=me,n+=2):(h=t,c===0&&w(mt)),h!==t&&(f=o,h=Nt()),(o=h)===t&&(o=a.charAt(n),ct.test(o)?n++:(o=t,c===0&&w(vt)));a.charCodeAt(n)===39?(o=st,n++):(o=t,c===0&&w(pt)),o!==t?(f=e,e=xs(s)):(n=e,e=t)}else n=e,e=t;return e}function mo(){var e;return(e=vo())===t&&(e=ho()),e}function vo(){var e,r,s,o,h;if(e=n,Me()!==t)if(p(),(r=M())!==t){for(p(),s=[],o=n,(h=Se())!==t?(p(),o=h):(n=o,o=t);o!==t;)s.push(o),o=n,(h=Se())!==t?(p(),o=h):(n=o,o=t);(o=Ee())!==t?(f=e,e=Cs(r,s)):(n=e,e=t)}else n=e,e=t;else n=e,e=t;if(e===t)if(e=n,Me()!==t)if(p(),(r=M())!==t){for(p(),s=[],o=n,(h=Se())!==t?(p(),o=h):(n=o,o=t);o!==t;)s.push(o),o=n,(h=Se())!==t?(p(),o=h):(n=o,o=t);(o=Vt())!==t?(h=p(),Ee()!==t?(f=e,e=Ms(r,s,o)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;else n=e,e=t;return e}function ho(){var e,r,s,o;if(e=n,Me()!==t){for(p(),r=[],s=n,(o=Ne())!==t?(p(),s=o):(n=s,s=t);s!==t;)r.push(s),s=n,(o=Ne())!==t?(p(),s=o):(n=s,s=t);(s=Ee())!==t?(f=e,e=Es(r)):(n=e,e=t)}else n=e,e=t;if(e===t)if(e=n,Me()!==t){for(p(),r=[],s=n,(o=Ne())!==t?(p(),s=o):(n=s,s=t);s!==t;)r.push(s),s=n,(o=Ne())!==t?(p(),s=o):(n=s,s=t);(s=Vt())!==t?(o=p(),Ee()!==t?(f=e,e=Fs(r,s)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;return e}function Ne(){var e,r,s;return e=n,nr()!==t?(p(),(r=M())!==t?(p(),ir()!==t?(p(),(s=M())!==t?(f=e,e=bs(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function Se(){var e,r,s;return e=n,nr()!==t?(p(),(r=M())!==t?(p(),ir()!==t?(p(),(s=M())!==t?(f=e,e=As(r,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function Vt(){var e,r;return e=n,zo()!==t?(p(),(r=M())!==t?(f=e,e=Ds(r)):(n=e,e=t)):(n=e,e=t),e}function wo(){var e,r,s,o;return e=n,(r=Io())!==t?(s=n,c++,o=Ve(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Ps(r)):(n=e,e=t)):(n=e,e=t),e}function Io(){var e,r,s,o;return e=n,(r=xe())!==t&&(s=Jt())!==t&&(o=Zt())!==t?(f=e,e=Ls(r,s,o)):(n=e,e=t),e===t&&(e=n,(r=xe())!==t&&(s=Jt())!==t?(f=e,e=Rs(r,s)):(n=e,e=t),e===t&&(e=n,(r=xe())!==t&&(s=Zt())!==t?(f=e,e=_s(r,s)):(n=e,e=t),e===t&&(e=n,(r=xe())!==t&&(f=e,r=Us(r)),e=r))),e}function xe(){var e,r,s;return(e=re())===t&&(e=n,r=a.charAt(n),ve.test(r)?n++:(r=t,c===0&&w(he)),r!==t&&(s=re())!==t?(f=e,e=$s(r,s)):(n=e,e=t)),e}function Jt(){var e,r,s;return e=n,a.charCodeAt(n)===46?(r=br,n++):(r=t,c===0&&w(Gn)),r!==t?((s=re())===t&&(s=null),f=e,e=Vs(s)):(n=e,e=t),e}function Zt(){var e,r,s;return e=n,(r=go())!==t&&(s=re())!==t?(f=e,e=Js(r,s)):(n=e,e=t),e}function re(){var e,r,s;if(e=n,r=[],(s=zt())!==t)for(;s!==t;)r.push(s),s=zt();else r=t;return r!==t&&(f=e,r=Zs(r)),e=r}function zt(){var e;return e=a.charAt(n),Dn.test(e)?n++:(e=t,c===0&&w(Wn)),e}function go(){var e,r,s;return e=n,r=a.charAt(n),Pn.test(r)?n++:(r=t,c===0&&w(Xn)),r!==t?(s=a.charAt(n),ve.test(s)?n++:(s=t,c===0&&w(he)),s===t&&(s=null),f=e,e=zs(r,s)):(n=e,e=t),e}function yo(){var e,r,s,o;return e=n,(r=a.substr(n,4)).toLowerCase()===Ar?n+=4:(r=t,c===0&&w(Kn)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?e=r=[r,s]:(n=e,e=t)):(n=e,e=t),e}function To(){var e,r,s,o;return e=n,(r=a.substr(n,4)).toLowerCase()===Dr?n+=4:(r=t,c===0&&w(ei)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?e=r=[r,s]:(n=e,e=t)):(n=e,e=t),e}function Oo(){var e,r,s,o;return e=n,(r=a.substr(n,5)).toLowerCase()===Pr?n+=5:(r=t,c===0&&w(ti)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?e=r=[r,s]:(n=e,e=t)):(n=e,e=t),e}function ze(){var e,r,s,o;return e=n,(r=a.substr(n,2)).toLowerCase()===Lr?n+=2:(r=t,c===0&&w(ri)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=ks()):(n=e,e=t)):(n=e,e=t),e}function kt(){var e,r,s,o;return e=n,(r=a.substr(n,2)).toLowerCase()===Rr?n+=2:(r=t,c===0&&w(ni)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Hs()):(n=e,e=t)):(n=e,e=t),e}function Ht(){var e,r,s,o;return e=n,(r=a.substr(n,4)).toLowerCase()===_r?n+=4:(r=t,c===0&&w(ii)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=qs()):(n=e,e=t)):(n=e,e=t),e}function No(){var e,r,s,o;return e=n,(r=a.substr(n,6)).toLowerCase()===Ur?n+=6:(r=t,c===0&&w(ai)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Ys()):(n=e,e=t)):(n=e,e=t),e}function ce(){var e,r,s,o;return e=n,(r=a.substr(n,3)).toLowerCase()===$r?n+=3:(r=t,c===0&&w(si)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=js()):(n=e,e=t)):(n=e,e=t),e}function Ce(){var e,r,s,o;return e=n,(r=a.substr(n,3)).toLowerCase()===Vr?n+=3:(r=t,c===0&&w(ui)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Qs()):(n=e,e=t)):(n=e,e=t),e}function qt(){var e,r,s,o;return e=n,(r=a.substr(n,2)).toLowerCase()===Jr?n+=2:(r=t,c===0&&w(oi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Bs()):(n=e,e=t)):(n=e,e=t),e}function Yt(){var e,r,s,o;return e=n,(r=a.substr(n,7)).toLowerCase()===Zr?n+=7:(r=t,c===0&&w(li)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Gs()):(n=e,e=t)):(n=e,e=t),e}function ke(){var e,r,s,o;return e=n,(r=a.substr(n,4)).toLowerCase()===zr?n+=4:(r=t,c===0&&w(ci)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Ws()):(n=e,e=t)):(n=e,e=t),e}function So(){var e,r,s,o;return e=n,(r=a.substr(n,3)).toLowerCase()===kr?n+=3:(r=t,c===0&&w(fi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Xs()):(n=e,e=t)):(n=e,e=t),e}function xo(){var e,r,s,o;return e=n,(r=a.substr(n,9)).toLowerCase()===Hr?n+=9:(r=t,c===0&&w(di)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Ks()):(n=e,e=t)):(n=e,e=t),e}function jt(){var e,r,s,o;return e=n,(r=a.substr(n,7)).toLowerCase()===qr?n+=7:(r=t,c===0&&w(pi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=eu()):(n=e,e=t)):(n=e,e=t),e}function Co(){var e,r,s,o;return e=n,(r=a.substr(n,4)).toLowerCase()===Yr?n+=4:(r=t,c===0&&w(mi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=tu()):(n=e,e=t)):(n=e,e=t),e}function Mo(){var e,r,s,o;return e=n,(r=a.substr(n,8)).toLowerCase()===jr?n+=8:(r=t,c===0&&w(vi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=ru()):(n=e,e=t)):(n=e,e=t),e}function Qt(){var e,r,s,o;return e=n,(r=a.substr(n,9)).toLowerCase()===Qr?n+=9:(r=t,c===0&&w(hi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=nu()):(n=e,e=t)):(n=e,e=t),e}function Bt(){var e,r,s,o;return e=n,(r=a.substr(n,4)).toLowerCase()===Br?n+=4:(r=t,c===0&&w(wi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=iu()):(n=e,e=t)):(n=e,e=t),e}function Gt(){var e,r,s,o;return e=n,(r=a.substr(n,4)).toLowerCase()===Gr?n+=4:(r=t,c===0&&w(Ii)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=au()):(n=e,e=t)):(n=e,e=t),e}function Eo(){var e,r,s,o;return e=n,(r=a.substr(n,7)).toLowerCase()===Wr?n+=7:(r=t,c===0&&w(gi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=su()):(n=e,e=t)):(n=e,e=t),e}function Fo(){var e,r,s,o;return e=n,(r=a.substr(n,8)).toLowerCase()===Xr?n+=8:(r=t,c===0&&w(yi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=uu()):(n=e,e=t)):(n=e,e=t),e}function bo(){var e,r,s,o;return e=n,(r=a.substr(n,4)).toLowerCase()===Kr?n+=4:(r=t,c===0&&w(Ti)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=ou()):(n=e,e=t)):(n=e,e=t),e}function Ao(){var e,r,s,o;return e=n,(r=a.substr(n,4)).toLowerCase()===en?n+=4:(r=t,c===0&&w(Oi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=lu()):(n=e,e=t)):(n=e,e=t),e}function Do(){var e,r,s,o;return e=n,(r=a.substr(n,2)).toLowerCase()===tn?n+=2:(r=t,c===0&&w(Ni)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=cu()):(n=e,e=t)):(n=e,e=t),e}function Po(){var e,r,s,o;return e=n,(r=a.substr(n,7)).toLowerCase()===rn?n+=7:(r=t,c===0&&w(Si)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=fu()):(n=e,e=t)):(n=e,e=t),e}function Lo(){var e,r,s,o;return e=n,(r=a.substr(n,3)).toLowerCase()===nn?n+=3:(r=t,c===0&&w(xi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=du()):(n=e,e=t)):(n=e,e=t),e}function Ro(){var e,r,s,o;return e=n,(r=a.substr(n,8)).toLowerCase()===an?n+=8:(r=t,c===0&&w(Ci)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=pu()):(n=e,e=t)):(n=e,e=t),e}function _o(){var e,r,s,o;return e=n,(r=a.substr(n,5)).toLowerCase()===sn?n+=5:(r=t,c===0&&w(Mi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=mu()):(n=e,e=t)):(n=e,e=t),e}function Uo(){var e,r,s,o;return e=n,(r=a.substr(n,4)).toLowerCase()===un?n+=4:(r=t,c===0&&w(Ei)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=vu()):(n=e,e=t)):(n=e,e=t),e}function $o(){var e,r,s,o;return e=n,(r=a.substr(n,7)).toLowerCase()===on?n+=7:(r=t,c===0&&w(Fi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=hu()):(n=e,e=t)):(n=e,e=t),e}function Vo(){var e,r,s,o;return e=n,(r=a.substr(n,2)).toLowerCase()===ln?n+=2:(r=t,c===0&&w(bi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=wu()):(n=e,e=t)):(n=e,e=t),e}function Wt(){var e,r,s,o;return e=n,(r=a.substr(n,8)).toLowerCase()===cn?n+=8:(r=t,c===0&&w(Ai)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Iu()):(n=e,e=t)):(n=e,e=t),e}function Xt(){var e,r,s,o;return e=n,(r=a.substr(n,4)).toLowerCase()===fn?n+=4:(r=t,c===0&&w(Di)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=gu()):(n=e,e=t)):(n=e,e=t),e}function Jo(){var e,r,s,o;return e=n,(r=a.substr(n,13)).toLowerCase()===dn?n+=13:(r=t,c===0&&w(Pi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=yu()):(n=e,e=t)):(n=e,e=t),e}function Zo(){var e,r,s,o;return e=n,(r=a.substr(n,15)).toLowerCase()===pn?n+=15:(r=t,c===0&&w(Li)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Tu()):(n=e,e=t)):(n=e,e=t),e}function Kt(){var e,r,s,o;return e=n,(r=a.substr(n,5)).toLowerCase()===mn?n+=5:(r=t,c===0&&w(Ri)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Ou()):(n=e,e=t)):(n=e,e=t),e}function er(){var e,r,s,o;return e=n,(r=a.substr(n,3)).toLowerCase()===vn?n+=3:(r=t,c===0&&w(_i)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Nu()):(n=e,e=t)):(n=e,e=t),e}function tr(){var e,r,s,o;return e=n,(r=a.substr(n,4)).toLowerCase()===hn?n+=4:(r=t,c===0&&w(Ui)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Su()):(n=e,e=t)):(n=e,e=t),e}function rr(){var e,r,s,o;return e=n,(r=a.substr(n,6)).toLowerCase()===wn?n+=6:(r=t,c===0&&w($i)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=xu()):(n=e,e=t)):(n=e,e=t),e}function ne(){var e,r,s,o;return e=n,(r=a.substr(n,6)).toLowerCase()===In?n+=6:(r=t,c===0&&w(Vi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Cu()):(n=e,e=t)):(n=e,e=t),e}function Me(){var e,r,s,o;return e=n,(r=a.substr(n,4)).toLowerCase()===gn?n+=4:(r=t,c===0&&w(Ji)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Mu()):(n=e,e=t)):(n=e,e=t),e}function Ee(){var e,r,s,o;return e=n,(r=a.substr(n,3)).toLowerCase()===yn?n+=3:(r=t,c===0&&w(Zi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Eu()):(n=e,e=t)):(n=e,e=t),e}function nr(){var e,r,s,o;return e=n,(r=a.substr(n,4)).toLowerCase()===Tn?n+=4:(r=t,c===0&&w(zi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Fu()):(n=e,e=t)):(n=e,e=t),e}function ir(){var e,r,s,o;return e=n,(r=a.substr(n,4)).toLowerCase()===On?n+=4:(r=t,c===0&&w(ki)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=bu()):(n=e,e=t)):(n=e,e=t),e}function zo(){var e,r,s,o;return e=n,(r=a.substr(n,4)).toLowerCase()===Nn?n+=4:(r=t,c===0&&w(Hi)),r!==t?(s=n,c++,o=O(),c--,o===t?s=void 0:(n=s,s=t),s!==t?(f=e,e=Au()):(n=e,e=t)):(n=e,e=t),e}function W(){var e;return a.charCodeAt(n)===44?(e=Sn,n++):(e=t,c===0&&w(qi)),e}function R(){var e;return a.charCodeAt(n)===40?(e=xn,n++):(e=t,c===0&&w(Yi)),e}function _(){var e;return a.charCodeAt(n)===41?(e=Cn,n++):(e=t,c===0&&w(ji)),e}function p(){var e,r;for(e=[],r=ar();r!==t;)e.push(r),r=ar();return e}function ar(){var e;return e=a.charAt(n),Ln.test(e)?n++:(e=t,c===0&&w(Qi)),e}function ko(){var e,r,s,o;if(e=n,(r=Dt())!==t&&(f=e,r=Du(r)),(e=r)===t)if(e=n,a.charCodeAt(n)===96?(r=ot,n++):(r=t,c===0&&w(ht)),r!==t){if(s=[],o=a.charAt(n),ft.test(o)?n++:(o=t,c===0&&w(wt)),o!==t)for(;o!==t;)s.push(o),o=a.charAt(n),ft.test(o)?n++:(o=t,c===0&&w(wt));else s=t;s!==t?(a.charCodeAt(n)===96?(o=ot,n++):(o=t,c===0&&w(ht)),o!==t?(f=e,e=Pu(s)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;return e}function Ho(e,r,s){return{type:"unary-expression",location:s,operator:e,expr:r}}function sr(e,r,s,o,h){const C={type:"binary-expression",location:h,operator:e,left:r,right:s};return o!==void 0&&(C.escape=o),C}function H(e,...r){return{type:"expression-list",location:e,value:r}}function fe(e,r){let s=e;for(const{op:o,expr:h,location:{end:C}}of r)s=sr(o,s,h,void 0,{...s.location,end:C});return s}function qo(e){/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(e)!==!0&&Re("Timestamp literal is invalid")}function Yo(e){/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(e)!==!0&&Re("Time literal is invalid")}function jo(e){/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(e)!==!0&&Re("Date literal is invalid")}if(u=g(),i.peg$library)return{peg$result:u,peg$currPos:n,peg$FAILED:t,peg$maxFailExpected:we,peg$maxFailPos:j};if(u!==t&&n===a.length)return u;throw u!==t&&n<a.length&&w(Lu()),_u(we,j<a.length?a.charAt(j):null,j<a.length?Ie(j,j+1):Ie(j,j))}yc(se,Error),se.prototype.format=function(a){var i="Error: "+this.message;if(this.location){var u,t=null;for(u=0;u<a.length;u++)if(a[u].source===this.location.source){t=a[u].text.split(/\r\n|\n|\r/g);break}var l=this.location.start,v=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(l):l,g=this.location.source+":"+v.line+":"+v.column;if(t){var T=this.location.end,S=Ge("",v.line.toString().length," "),N=t[l.line-1],x=(l.line===T.line?T.column:N.length+1)-l.column||1;i+=`
 --> `+g+`
`+S+` |
`+v.line+" | "+N+`
`+S+" | "+Ge("",l.column-1," ")+Ge("",x,"^")}else i+=`
 at `+g}return i},se.buildMessage=function(a,i){var u={literal:function(N){return'"'+l(N.text)+'"'},class:function(N){var x=N.parts.map(function(D){return Array.isArray(D)?v(D[0])+"-"+v(D[1]):v(D)});return"["+(N.inverted?"^":"")+x.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(N){return N.description}};function t(N){return N.charCodeAt(0).toString(16).toUpperCase()}function l(N){return N.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(x){return"\\x0"+t(x)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(x){return"\\x"+t(x)})}function v(N){return N.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(x){return"\\x0"+t(x)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(x){return"\\x"+t(x)})}function g(N){return u[N.type](N)}function T(N){var x,D,E=N.map(g);if(E.sort(),E.length>0){for(x=1,D=1;x<E.length;x++)E[x-1]!==E[x]&&(E[D]=E[x],D++);E.length=D}switch(E.length){case 1:return E[0];case 2:return E[0]+" or "+E[1];default:return E.slice(0,-1).join(", ")+", or "+E[E.length-1]}}function S(N){return N?'"'+l(N)+'"':"end of input"}return"Expected "+T(a)+" but "+S(i)+" found."};class Oc{static parse(i){return Tc(i)}}function U(a,i){if(a!=null)switch(i(a),a.type){case"when-clause":U(a.operand,i),U(a.value,i);break;case"case-expression":for(const u of a.clauses)U(u,i);a.format==="simple"&&U(a.operand,i),a.else!==null&&U(a.else,i);break;case"expression-list":for(const u of a.value)U(u,i);break;case"unary-expression":U(a.expr,i);break;case"binary-expression":U(a.left,i),U(a.right,i);break;case"function":U(a.args,i);break;case"interval":U(a.value,i),U(a.qualifier,i);break;case"interval-qualifier":U(a.start,i),U(a.end,i)}}const Nc=new Set(["current_timestamp","current_date","current_time"]);class Ae{static makeBool(i){return xr(i)}static featureValue(i,u,t,l){return Er(i,u,t,l)}static equalsNull(i){return i===null}static applyLike(i,u,t){return et(i,u,t)}static ensureArray(i){return Xe(i)}static applyIn(i,u,t){return Ke(i,u)}static currentTimestamp(i){return Pe(new Date,i)}static currentDate(i){return Y.fromNow(i)}static currentTime(i){const u=Pe(new Date,i);return z.fromDateTime(u)}static makeSqlInterval(i,u,t){return L.createFromValueAndQualifier(i,u,t)}static convertInterval(i){return L.isInterval(i)?i.valueInMilliseconds():i}static compare(i,u,t,l){return Z(u,t,i)}static calculate(i,u,t,l){return Sr(i,u,t,l)}static evaluateTime(i){return rt(i)}static evaluateTimestamp(i,u,t){return Le(i,u,t)}static evaluateDate(i,u){return Tr(i,u)}static evaluateFunction(i,u,t){return nt(i,u,t)}static lookup(i,u){const t=u[i];return t===void 0?null:t}static between(i,u,t){return i==null||u[0]==null||u[1]==null?null:Z(i,u[0],">=")&&Z(i,u[1],"<=")}static notbetween(i,u,t){return i==null||u[0]==null||u[1]==null?null:Z(i,u[0],"<")||Z(i,u[1],">")}static ternaryNot(i){return De(i)}static ternaryAnd(i,u){return Cr(i,u)}static ternaryOr(i,u){return Mr(i,u)}}class at{constructor(i,u,t="UTC",l=null){this.fieldsIndex=u,this.timeZone=t,this.currentUser=l,this.parameters={},this._hasDateFunctions=void 0,this.parseTree=Oc.parse(i);const{isStandardized:v,isAggregate:g,currentUserRequired:T,referencedFieldNames:S}=this._extractExpressionInfo(u);this._referencedFieldNames=S,this.isStandardized=v,this.isAggregate=g,this.currentUserRequired=T}static convertValueToStorageFormat(i,u=null){if(u===null)return q(i)?i.getTime():F(i)?i.toMillis():A(i)?i.toStorageFormat():P(i)?i.toStorageString():b(i)?i.toStorageFormat():i;switch(u){case"date":return q(i)?i.getTime():F(i)?i.toMillis():A(i)?i.toMilliseconds():b(i)?i.toNumber():i;case"date-only":return q(i)?Y.fromDateJS(i).toString():A(i)?Y.fromSqlTimeStampOffset(i).toString():F(i)?Y.fromDateTime(i).toString():i;case"time-only":return q(i)?z.fromDateJS(i).toStorageString():F(i)?z.fromDateTime(i).toStorageString():A(i)?z.fromSqlTimeStampOffset(i).toStorageString():P(i)?i.toStorageString():i;case"timestamp-offset":if(q(i))return B.fromJSDate(i).toStorageFormat();if(F(i))return B.fromDateTime(i).toStorageFormat();if(A(i))return i.toStorageFormat()}return i}static create(i,u={}){return new at(i,u.fieldsIndex,u.timeZone??void 0,u.currentUser)}get fieldNames(){return this._referencedFieldNames}testSet(i,u=pe,t=this.currentUser){return!!this._evaluateNode(this.parseTree,null,u,i,t)}calculateValue(i,u=pe,t=this.currentUser){const l=this._evaluateNode(this.parseTree,i,u,null,t);return L.isInterval(l)?l.valueInMilliseconds()/864e5:l}calculateValueCompiled(i,u=pe,t=this.currentUser){return this.parseTree._compiledVersion!=null?this.parseTree._compiledVersion(i,this.parameters,u,this.fieldsIndex,this.timeZone,t??null):or("esri-csp-restrictions")?this.calculateValue(i,u):(this._compileMe(),this.parseTree._compiledVersion(i,this.parameters,u,this.fieldsIndex,this.timeZone,t??null))}testFeature(i,u=pe,t=this.currentUser){return!!this._evaluateNode(this.parseTree,i,u,null,t)}testFeatureCompiled(i,u=pe,t=this.currentUser){return this.parseTree._compiledVersion!=null?!!this.parseTree._compiledVersion(i,this.parameters,u,this.fieldsIndex,this.timeZone,t??null):or("esri-csp-restrictions")?this.testFeature(i,u):(this._compileMe(),!!this.parseTree._compiledVersion(i,this.parameters,u,this.fieldsIndex,this.timeZone,t??null))}get hasDateFunctions(){return this._hasDateFunctions!=null||(this._hasDateFunctions=!1,U(this.parseTree,i=>{i.type==="current-time"?this._hasDateFunctions=!0:i.type==="function"&&(this._hasDateFunctions=this._hasDateFunctions||Nc.has(i.name.toLowerCase()))})),this._hasDateFunctions}getFunctions(){const i=new Set;return U(this.parseTree,u=>{u.type==="function"&&i.add(u.name.toLowerCase())}),Array.from(i)}getExpressions(){const i=new Map;return U(this.parseTree,u=>{if(u.type==="function"){const t=u.name.toLowerCase(),l=u.args.value[0];if(l.type==="column-reference"){const v=l.column,g=`${t}-${v}`;i.has(g)||i.set(g,{aggregateType:t,field:v})}}}),[...i.values()]}getVariables(){const i=new Set;return U(this.parseTree,u=>{u.type==="parameter"&&i.add(u.value.toLowerCase())}),Array.from(i)}_compileMe(){const i="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","fieldsIndex","timeZone","currentUser",i).bind(Ae)}_extractExpressionInfo(i){const u=[],t=new Set;let l=!0,v=!1,g=!1;return U(this.parseTree,T=>{switch(T.type){case"column-reference":{const S=i?.get(T.column);let N,x;S?N=x=S.name??"":(x=T.column,N=x.toLowerCase()),t.has(N)||(t.add(N),u.push(x)),T.column=x;break}case"current-user":g=!0;break;case"function":{const{name:S,args:N}=T,x=N.value.length;l&&(l=Ol(S,x)),v===!1&&(v=fr(S,x));break}}}),{referencedFieldNames:Array.from(u),isStandardized:l,isAggregate:v,currentUserRequired:g}}evaluateNodeToJavaScript(i){switch(i.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(i.value)+", "+JSON.stringify(i.qualifier)+","+JSON.stringify(i.op)+")";case"case-expression":{let u="";if(i.format==="simple"){const t=this.evaluateNodeToJavaScript(i.operand);u="( ";for(let l=0;l<i.clauses.length;l++)u+=" (this.compare('=',"+t+","+this.evaluateNodeToJavaScript(i.clauses[l].operand)+") ? ("+this.evaluateNodeToJavaScript(i.clauses[l].value)+") : ";i.else!==null?u+=this.evaluateNodeToJavaScript(i.else):u+="null",u+=" )"}else{u="( ";for(let t=0;t<i.clauses.length;t++)u+=" this.makeBool("+this.evaluateNodeToJavaScript(i.clauses[t].operand)+")===true ? ("+this.evaluateNodeToJavaScript(i.clauses[t].value)+") : ";i.else!==null?u+=this.evaluateNodeToJavaScript(i.else):u+="null",u+=" )"}return u}case"parameter":return"this.lookup("+JSON.stringify(i.value.toLowerCase())+",lookups)";case"expression-list":{let u="[";for(const t of i.value)u!=="["&&(u+=","),u+=this.evaluateNodeToJavaScript(t);return u+="]",u}case"unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(i.expr)+")";case"binary-expression":switch(i.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(i.left)+","+this.evaluateNodeToJavaScript(i.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(i.left)+","+this.evaluateNodeToJavaScript(i.right)+" )";case"IS":if(i.right.type!=="null")throw new m(d.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(i.left)+")";case"ISNOT":if(i.right.type!=="null")throw new m(d.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(i.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(i.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(i.right)+"), timeZone)";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(i.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(i.right)+"), timeZone))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(i.left)+","+this.evaluateNodeToJavaScript(i.right)+", timeZone)";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(i.left)+","+this.evaluateNodeToJavaScript(i.right)+", timeZone)";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(i.left)+","+this.evaluateNodeToJavaScript(i.right)+","+JSON.stringify(i.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(i.left)+","+this.evaluateNodeToJavaScript(i.right)+","+JSON.stringify(i.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(i.operator)+","+this.evaluateNodeToJavaScript(i.left)+","+this.evaluateNodeToJavaScript(i.right)+", timeZone)";case"*":case"-":case"+":case"/":case"||":return"this.calculate("+JSON.stringify(i.operator)+","+this.evaluateNodeToJavaScript(i.left)+","+this.evaluateNodeToJavaScript(i.right)+", timeZone)";default:throw new m(d.UnsupportedOperator,{operator:i.operator})}case"null":case"boolean":case"string":case"number":return JSON.stringify(i.value);case"time":return"this.evaluateTime("+JSON.stringify(i.value)+")";case"date":return"this.evaluateDate("+JSON.stringify(i.value)+", 'unknown')";case"timestamp":return"this.evaluateTimestamp("+JSON.stringify(i.value)+", 'unknown')";case"current-time":return i.mode==="date"?"this.currentDate(timeZone)":i.mode==="time"?"this.currentTime(timeZone)":"this.currentTimestamp(timeZone)";case"current-user":return"currentUser";case"column-reference":return"this.featureValue(feature,"+JSON.stringify(i.column)+",fieldsIndex,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(i.name)+","+this.evaluateNodeToJavaScript(i.args)+", timeZone)"}throw new m(d.UnsupportedSyntax,{node:i.type})}_evaluateNode(i,u,t,l,v){let g;switch(i.type){case"interval":{const T=this._evaluateNode(i.value,u,t,l,v);return L.createFromValueAndQualifier(T,i.qualifier,i.op)}case"case-expression":if(i.format==="simple"){const T=this._evaluateNode(i.operand,u,t,l,v);for(let S=0;S<i.clauses.length;S++)if(Z(T,this._evaluateNode(i.clauses[S].operand,u,t,l,v),"=",this.timeZone))return this._evaluateNode(i.clauses[S].value,u,t,l,v);if(i.else!==null)return this._evaluateNode(i.else,u,t,l,v)}else{for(let T=0;T<i.clauses.length;T++)if(xr(this._evaluateNode(i.clauses[T].operand,u,t,l,v)))return this._evaluateNode(i.clauses[T].value,u,t,l,v);if(i.else!==null)return this._evaluateNode(i.else,u,t,l,v)}return null;case"parameter":return g=this.parameters[i.value.toLowerCase()],q(g)?V.fromJSDate(g):g!=null&&typeof g=="object"&&"toDateTime"in g?g.toDateTime():g;case"expression-list":{const T=[];for(const S of i.value)T.push(this._evaluateNode(S,u,t,l,v));return T}case"unary-expression":return De(this._evaluateNode(i.expr,u,t,l,v));case"binary-expression":switch(i.operator){case"AND":return Cr(this._evaluateNode(i.left,u,t,l,v),this._evaluateNode(i.right,u,t,l,v));case"OR":return Mr(this._evaluateNode(i.left,u,t,l,v),this._evaluateNode(i.right,u,t,l,v));case"IS":if(i.right.type!=="null")throw new m(d.UnsupportedIsRhs);return this._evaluateNode(i.left,u,t,l,v)===null;case"ISNOT":if(i.right.type!=="null")throw new m(d.UnsupportedIsRhs);return this._evaluateNode(i.left,u,t,l,v)!==null;case"IN":{const T=Xe(this._evaluateNode(i.right,u,t,l,v));return Ke(this._evaluateNode(i.left,u,t,l,v),T,this.timeZone)}case"NOT IN":{const T=Xe(this._evaluateNode(i.right,u,t,l,v));return De(Ke(this._evaluateNode(i.left,u,t,l,v),T,this.timeZone))}case"BETWEEN":{const T=this._evaluateNode(i.left,u,t,l,v),S=this._evaluateNode(i.right,u,t,l,v);return T==null||S[0]==null||S[1]==null?null:Z(T,S[0],">=",this.timeZone)&&Z(T,S[1],"<=",this.timeZone)}case"NOTBETWEEN":{const T=this._evaluateNode(i.left,u,t,l,v),S=this._evaluateNode(i.right,u,t,l,v);return T==null||S[0]==null||S[1]==null?null:Z(T,S[0],"<",this.timeZone)||Z(T,S[1],">",this.timeZone)}case"LIKE":return et(this._evaluateNode(i.left,u,t,l,v),this._evaluateNode(i.right,u,t,l,v),i.escape);case"NOT LIKE":return De(et(this._evaluateNode(i.left,u,t,l,v),this._evaluateNode(i.right,u,t,l,v),i.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return Z(this._evaluateNode(i.left,u,t,l,v),this._evaluateNode(i.right,u,t,l,v),i.operator,this.timeZone);case"-":case"+":case"*":case"/":case"||":return Sr(i.operator,this._evaluateNode(i.left,u,t,l,v),this._evaluateNode(i.right,u,t,l,v),this.timeZone)}case"null":case"boolean":case"string":case"number":return i.value;case"date":return i.parsedValue??=Tr(i.value,"unknown"),i.parsedValue;case"timestamp":return i.parsedValue??=Le(i.value,"unknown"),i.parsedValue;case"time":return rt(i.value);case"current-time":return i.mode==="date"?Ae.currentDate(this.timeZone):i.mode==="time"?Ae.currentTime(this.timeZone):Ae.currentTimestamp(this.timeZone);case"current-user":return v??null;case"column-reference":return Er(u,i.column,this.fieldsIndex,t);case"data-type":return i.value;case"function":{if(this.isAggregate&&fr(i.name,i.args.value.length)){const S=[];for(const N of i.args?.value||[]){const x=[];for(const D of l||[])x.push(this._evaluateNode(N,D,t,null,v));S.push(x)}return el(i.name,S)}const T=this._evaluateNode(i.args,u,t,l,v);return nt(i.name,T,this.timeZone)}}throw new m(d.UnsupportedSyntax,{node:i.type})}}function xr(a){return a===!0}function Xe(a){return Array.isArray(a)?a:[a]}function De(a){return a!==null?a!==!0:null}function Cr(a,i){return a!=null&&i!=null?a===!0&&i===!0:a!==!1&&i!==!1&&null}function Mr(a,i){return a!=null&&i!=null?a===!0||i===!0:a===!0||i===!0||null}function Ke(a,i,u){if(a==null)return null;let t=!1;for(const l of i)if(l==null)t=null;else{if(a===l){t=!0;break}if(We(a)&&We(l)&&(t=Z(a,l,"="),t))break}return t}const vr="-[]/{}()*+?.\\^$|";var ae;function Sc(a,i){const u=i;let t="",l=ae.Normal;for(let v=0;v<a.length;v++){const g=a.charAt(v);switch(l){case ae.Normal:g===u?l=ae.Escaped:vr.includes(g)?t+="\\"+g:t+=g==="%"?".*":g==="_"?".":g;break;case ae.Escaped:vr.includes(g)?t+="\\"+g:t+=g,l=ae.Normal}}return new RegExp("^"+t+"$","m")}function et(a,i,u){return a==null?null:Sc(i,u).test(a)}function xc(a){return a&&typeof a.attributes=="object"}function Er(a,i,u,t){if("getAttributeSQL"in t)return t.getAttributeSQL(a,i);const l=t.getAttribute(a,i),v=u?.get(i);return l==null||v?.type!=="esriFieldTypeDate"&&v?.type!=="date"?l==null||v?.type!=="esriFieldTypeDateOnly"&&v?.type!=="date-only"?l==null||v?.type!=="esriFieldTypeTimeOnly"&&v?.type!=="time-only"?l==null||v?.type!=="esriFieldTypeTimestampOffset"&&v?.type!=="timestamp-offset"?l:new B(l):z.fromReader(l):Y.fromReader(l):Pe(new Date(l),u?.getLuxonTimeZone(v.name)??Bo.utcInstance)}(function(a){a[a.Normal=0]="Normal",a[a.Escaped=1]="Escaped"})(ae||(ae={}));const pe={getAttribute:(a,i)=>(xc(a)?a.attributes:a)[i]},Ec=Object.freeze(Object.defineProperty({__proto__:null,default:at},Symbol.toStringTag,{value:"Module"}));export{at as D,Ec as W,d as a,B as i,m as n,el as u};
