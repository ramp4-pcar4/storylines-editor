import{v as a,S as l,Z as u,F as h,n as d,X as g,a0 as N,M as w,N as R,aR as J,q as O}from"./main-llKI7zRI.js";import{k as f}from"./persistable-DgPk2hdg-l9JwvBHu.js";import{L as v,s as x}from"./projectionUtils-B-CplN3q-DLVF5upa.js";var c;let o=c=class extends g{constructor(e){super(e),this.geometry=null,this.type="clip"}writeGeometry(e,r,s,t){if(t.layer?.spatialReference&&!t.layer.spatialReference.equals(this.geometry.spatialReference)){if(!v(e.spatialReference,t.layer.spatialReference))return void(t?.messages&&t.messages.push(new J("scenemodification:unsupported","Scene modifications with incompatible spatial references are not supported",{modification:this,spatialReference:t.layer.spatialReference,context:t})));const n=new u;x(e,n,t.layer.spatialReference),r[s]=n.toJSON(t)}else r[s]=e.toJSON(t);delete r[s].spatialReference}clone(){return new c({geometry:O(this.geometry),type:this.type})}};a([l({type:u}),f()],o.prototype,"geometry",void 0),a([h(["web-scene","portal-item"],"geometry")],o.prototype,"writeGeometry",null),a([l({type:["clip","mask","replace"],nonNullable:!0}),f()],o.prototype,"type",void 0),o=c=a([d("esri.layers.support.SceneModification")],o);var i;let p=i=class extends g.JSONSupportMixin(N.ofType(o)){constructor(e){super(e),this.url=null}clone(){return new i({url:this.url,items:this.items.map(e=>e.clone())})}toJSON(e){return this.toArray().map(r=>r.toJSON(e)).filter(r=>!!r.geometry)}static fromJSON(e,r){const s=new i;for(const t of e)s.add(o.fromJSON(t,r));return s}static async fromUrl(e,r,s){const t={url:w(e),origin:"service"},n=await R(e,{responseType:"json",signal:s?.signal}),S=r.toJSON(),m=[];for(const y of n.data)m.push(o.fromJSON({...y,geometry:{...y.geometry,spatialReference:S}},t));return new i({url:e,items:m})}};a([l({type:String})],p.prototype,"url",void 0),p=i=a([d("esri.layers.support.SceneModifications")],p);export{p};
