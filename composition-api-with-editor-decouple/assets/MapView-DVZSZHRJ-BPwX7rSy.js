const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Popup-BWCSLTGs-BAUXcP43.js","./main-DJKotNeA.js","./main-45itrjdR.css","./intl-BAA1onnp-D8S77-_C.js","./jsxFactory-Cua8zWVZ-D8xsvlbz.js","./uuid-Dj9mdEVg-BaKSCiyT.js","./sanitizerUtils-B1yRmbO2-B7KG_jBT.js","./substitute-B3zxyWVi-Csc52ohm.js","./unitFormatUtils-FAypDaT5-C4a0PfKr.js","./ByteSizeUnit-DL8UhsB0-B2-AmVRx.js","./Cyclical-DgD7_U1C-D9XAGOYJ.js","./quantityUtils-B1Ov7DZK-AT3OSStY.js","./AttachmentInfo-zWxchQNl-C63fONCw.js","./RelationshipQuery-CaEbQySU-DUGANr6D.js","./Query-n1aoaaFC-BAtHSjSK.js","./Field-BIQ-quF4-BSQv9vBj.js","./fieldType-PhcL4ff8-C2jeIUx8.js","./TimeExtent-Cf2Pienb-D0HuzG45.js","./featureUtils-BAuaRuK2-D6k_Rnri.js","./utils-CdIngiRE-DbwvTP5J.js","./mat4f32-BdRMyjXW-CWt6U0BP.js","./mat4-OOmHNWi7-DuXEks0B.js","./common-CYWrYyJl-E8-sukrT.js","./timeZoneUtils-d5p0Jda1-B4nKouKv.js","./utils-Dd8gTonD-BH8NpMR8.js","./Queue-DV3gpSdl-szFzyE30.js","./Version-CnwD6MZa-BW_zF5SH.js","./heatmapRampUtils-IW6a557l-DD9N5XYM.js","./typeUtils-CB2EGBWO-BQUdyfB0.js","./ClassBreaksRenderer-Bq2XGpfI-Co8artoO.js","./commonProperties-CJLeiNuA-D2JG08gj.js","./colorRamps-trM-CPFS-nDJQeww7.js","./ColorStop-CL7v3R-A-BSP_U7at.js","./visualVariableUtils-BTS148WR-CRJupgrc.js","./lengthUtils-C61nRlXw-B3ZOsSCs.js","./RendererLegendOptions-Bil_IDab-R_Oaa7JQ.js","./LRUCache-DPWdPNTF-Du_Z0yHt.js","./MemCache-qDGoejB7-9IozotvY.js","./DictionaryScriptEvaluator-DW5hOK9A-BwVrEx_J.js","./FieldsIndex-Bt0Y8aWr-C0u42udD.js","./UnknownTimeZone-DxjyzFvs-DyeTAFeP.js","./ArcadeExpression-XjY3x7KV-BwIXY_mL.js","./TimeOnly-CGkId3bj-j-EApR8j.js","./enum-g1DWyQyu-BuYzO6eV.js","./utils-BfXZnjCE-DP4GAjBr.js","./defaultCIMValues-BcSaJjm--58G-soMN.js","./enums-a_LDTPYU-CBIcy3mM.js","./heatmapUtils-DRTN9U3a-ByP7-8D1.js","./vec42-D8CJyqHG-DnfLTeQH.js","./vec4f64-DD-nkcCV-CSNWKRqG.js","./SimpleRenderer-C1YRhRzu-Bd_NVOQy.js","./UniqueValueRenderer-CLXHFtg9-DUDB9tIZ.js","./diffUtils-BxG8DCnW-gnBKAzUF.js","./styleUtils-DBPDLVBX-73Wvg4uS.js","./widget-p2YDjs4S-CpamuLvr.js","./a11yUtils-CoCwThtH-y4sPq6no.js","./utils-Cb2uXNfG-BrwlQd1E.js","./asyncUtils-BPUlNCrX-BcMqDN8D.js","./jsonUtils-BwLwuQj7-Vm3N6D7-.js","./parser-CWccHtwJ-CW4UgtNV.js","./cimSymbolUtils-DCedSSCN-BGxSNw3Y.js","./executeQueryJSON-D8fHgTZN-CXxD3MJf.js","./utils-BO8hgPs3-NGzkE5wh.js","./query-COAsogFA-C3FrFDBF.js","./normalizeUtils-u00NGW3M-B_8jd2GW.js","./normalizeUtilsCommon-ClagynAA-DhHCBYDt.js","./utils-DpLVEUvg-BxP4kXy-.js","./pbfQueryUtils-aBcHX3TJ-1bcV257K.js","./pbf-hoLeQyp2-BHxfWJwH.js","./memoryEstimations-DeWfxwaV-Bdvmk4ud.js","./OptimizedGeometry-pzfNw1AT-DeA1Chj6.js","./OptimizedFeature-mIz_HhJg-D28yNS2b.js","./OptimizedFeatureSet-Dz5hF8Qm-B1brSkRC.js","./queryZScale-CwrUzBjP-Cp-CWEOR.js","./projectionUtils-B-CplN3q--VlVEuZs.js","./FeatureSet-BVGGhhH9-yfYWciBX.js","./modeUtils-deizL-Tg-C4WiXKJs.js","./shared-DttuBH5Z-DHqXB83e.js","./FeatureLayer-D09djTpa-1Pj1-1zn.js","./MultiOriginJSONSupport-BqiFJbbt-DbbsmQ1h.js","./layerContainerType-ChWdCT09-G5sdAsSy.js","./FeatureLayerBase-B8QtBTYG-D9xj-y6E.js","./HeightModelInfo-C4voFc4k-B1q_sNQN.js","./OperationalLayer-CbXUnTH0-BTMYD0hC.js","./ElevationInfo-DE5to86a-Aw-W_9C8.js","./labelingInfo-DuLk-IW_-D87PNsiq.js","./NormalizationBinParametersMixin-70JA0FRq-CvaVuMKk.js","./labelUtils-Oapo6DRu-DDPl_PWY.js","./LayerFloorInfo-CkeH-P4_-CwaTYKTV.js","./Relationship-B6fQjk3--CSnk2dYj.js","./serviceCapabilitiesUtils-BerH-9mt-BxaCp7Cz.js","./infoFor3D-BeWnZejW-DJyBSoCy.js","./portalItemUtils-BfWDJg-S-CumIqVWb.js","./Layer-DvVVmz9x-B_fmB79f.js","./workers-CeRXsnNJ-DG-ZLCr5.js","./editsZScale-BWHgeDdL-Ci9Z7M1z.js","./APIKeyMixin-BNzYY3QS-DoZz1Cv6.js","./ArcGISService-B6M5rzsr-C8FJ6Bmp.js","./BlendLayer-DjW_5k0v-D4qGSvSb.js","./CustomParametersMixin-CSMgHDaw-tNrT-7bn.js","./DisplayFilteredLayer-DTxK0R7U-Bj5PqJ5n.js","./scaleUtils-Br-smv3A-BkvQ3fNL.js","./displayFilterUtils-DvWUbJDp-LaoS_XK8.js","./EditBusLayer-CAIKbP5V-PoleizIX.js","./FeatureEffectLayer-BVJTjFhg-Dklv82SK.js","./FeatureEffect-D3G_gJ5F-CLbBJgxW.js","./FeatureFilter-DXpQKGs4-YRo0FzmG.js","./FeatureReductionLayer-vR-evpIv-BZRfgsRS.js","./FeatureReductionSelection-DzXAxMK9-4A5IX-1l.js","./jsonUtils-CzRaZnmS-POpWBxgb.js","./MD5-CXHDUqXT-CMrYdOi6.js","./OrderedLayer-BD-wnvgD-DWSxrING.js","./OrderByInfo-SNGyPlhJ-BzLqIbjY.js","./PortalLayer-B34ZUA2x-BB6XMOG-.js","./PortalItem-BP-IQXnZ-C0op_jPu.js","./RefreshableLayer-Qpvyi8qY-DQ2zv-hj.js","./ScaleRangeLayer-x42fwED3-Dio7--Ih.js","./TemporalLayer-lQRje9wB-DvYs87fO.js","./TimeInfo-COHxjenm-sSQHto82.js","./TrackableLayer-D0OccxDX-DO9EQ7ry.js","./FeatureTemplate-CW5LOQ_p-CYjw9K-X.js","./FeatureType-DdIqcZ2U-DaW8qW7H.js","./fieldProperties-Cgp0UdcB-DieFcthl.js","./TitleCreator-DZ9r9lVc-BEg_KYem.js","./versionUtils-BwTR8Ufq-Bauhn9zP.js","./styleUtils-BnJpZ0Gl-DcL6HThk.js","./popupUtils-B99PyAFi-B0mm6iaD.js","./interfaces-Cwm0pihk-Ptzy6gTd.js","./ReactiveMap-iPeM8evD-DZWvxP-R.js","./NetworkElement-DPZIJwbn-C5OA1EuB.js","./ReactiveSet-CRNikQMW-D3LSc8Kq.js","./symbolUtils-D5Wjfwrf-UA3wH0Gu.js","./colorUtils-Eg6lOlXm-C4Lm3Ch-.js","./mat2df32-fg3OHsAI-BF2V2zqo.js","./mat2d-BQA-1WB--Pnyy0dhf.js","./webStyleSymbolUtils-r0H5toyk-BrpA97JD.js","./devEnvironmentUtils-CxrVv3RG-CX5aoxVE.js","./layerViewUtils-DLIaYA64-B0ShyAr-.js","./CollectionFlattener-DyEG1Q6J-DqyDc0gm.js","./TileInfo-U28GysF5-BZlJVE5F.js","./TileKey-B_6qmYK--BtZdR-Xy.js","./UpdatingHandles-Bd2FQ26N-B5rIN4f4.js","./Map-7V1pm_Jo-CzoTMaCx.js","./Basemap-C_NhFN5u-CXIQ3TCA.js","./loadAll-DQWsVoX1-wnyhDlfO.js","./writeUtils-DAOvycBP-DlBnHp9n.js","./persistable-DgPk2hdg-DZbC9ypz.js","./multiOriginJSONSupportUtils-DGETddQl-BrWaY9_8.js","./resourceExtension-DCCj0Izs-Diq42yp7.js","./PolygonCollection-Btw6sA7T-bzfT-bYb.js","./editableLayers-DFUBlMJy-BuIvdFLP.js","./TablesMixin-BORwbVPt-CHpspOXp.js","./GraphicsCollection-uWAVmks7-B1QDX86y.js","./IViewEvents-BE10MM98-CvMfjolG.js","./mat2df64-DDXwUeaJ-Tu7q-7Mk.js","./projectionUtils-Dt6hj1Xh-C_Kb4hEd.js","./ViewingMode-CdRKcXnc-Dab70bGf.js","./vec2-BnynUbeJ-CKtGJQAy.js","./vec2f64-CkowXrDb-3zFQ3LNH.js","./mat3-DOnW3DjW-C3hbW9XY.js","./vec2f32-hTAvipMV-C0AQcwEv.js","./Scheduler-BV4C4cVP-8I9Lhrd6.js","./debugFlags-8tOwPnHK-degGadwF.js","./vec32-Cj8pVsU0-YJ-zg-mR.js","./unitBezier-DhyPAQO8-B9kUb8N6.js","./enums-CQnCd4Rx-gH-Yxynf.js","./TileKey-_zikB14n-B4vTYQi8.js","./quickselect-DHTstthl-Ds_Aj0x5.js","./definitions-MCCItX4r-o3EUznKY.js","./enums-wEDHPbCF-Cf76M5_x.js","./Texture-D5XWO2GQ-B04SS3L4.js","./getDataTypeBytes-DYbftOSj-BNZIboqJ.js","./imageUtils-D3tfFRL_-BrFyHdkp.js","./capabilities-BaKzUyhi-y5w2NMiP.js","./ILyr3DWasmPerSceneView-ChV4bxX0-B4BXvxji.js","./ColorBackground-C0D6MT0d-Cw_gjYpB.js","./webglDeps-B1MbyxEI-BNtg1uWc.js","./VertexArrayObject-CieliEx4-CzrMvrSd.js","./FramebufferObject-D3QloItC-D5FVKPwL.js","./ProgramTemplate-C4wmhGXE-Bx3d-6Ez.js","./NestedMap-DL9KstBd-DcOmdaty.js","./mapViewDeps-C9uprLPQ-Br7Y9k1R.js","./fontUtils-C37p4Hgq-D5roRpcW.js","./FeatureCommandQueue-C2MKcQFq-D4KhX2AC.js","./CIMSymbolHelper-34UsTwam-BPN8gmPV.js","./BidiEngine-DusKzrO8-BlAgW8mu.js","./GeometryUtils-B8e3Iwyx-aS5kvRk_.js","./rasterizingUtils-1wASRzSP-CSAVDskZ.js","./floatRGBA-DRFmbkvz-BoKXgxQd.js","./Rect-DD6XS68q-D_hsV3ag.js","./BoundingBox-DlCd_wcU-DBB4UfPl.js","./TechniqueType-CMl1wqtX-7TDFwBxa.js","./GraphShaderModule-Baq-N_YO-DWcUS2TO.js","./ShaderBuilder-CU5v4tk1-Bn8ezsL7.js","./BindType-CKbZk6AG-Bqvzo9NX.js","./UpdateTracking2D-GEad80KZ-D53CLNxL.js","./utils-OrDMNKn4-r-4WltcN.js","./constants-oLcGh8d3-CJuD0gcX.js","./VertexElementDescriptor-DLvjNrmQ-BHK9ksow.js","./WGLContainer-qQmF3DRB-64lL6uMh.js","./Utils-Co3xiu1z-n1e2ehqU.js","./vec3f32-GX_cKsFD-UJPpzdNc.js","./Container-Dr2EdOEZ-CFY_ujCP.js","./EffectView-Bpu5U548-Do_HmycI.js","./StyleDefinition-BOKVAZI1-BlGlrLNa.js","./config-CmYJx2vm-DFBdNYhW.js","./earcut-C6NeZYSh-Da0ULCQ5.js","./featureConversionUtils-Bjjlcfdo-BBdrF6Di.js","./streamLayerUtils-Dae818Yl-CG3QJc_N.js","./QueueProcessor-BSpvDXZs-Ddm-qN9T.js","./SDFHelper-DBQuFSTG-nOOhiRFR.js","./PieChartMeshWriter-C17AlSWx-C9py-zLR.js","./libtess-C6mGekL8-Bm768436.js","./OverrideHelper-DgyARgwI-D8lDOnIE.js","./callExpressionWithFeature-Bk8k1lJI-BMwLNwHI.js","./quantizationUtils-D907S7Bm-86W3CGt2.js","./constants-BgwgMQXd-By4voKYl.js","./GridShader-DnwGuLhq-D51yYNHq.js","./CircularArray-DaQg3PQl-BXS52LZy.js","./testSVGPremultipliedAlpha-silsadBl-CyLj4YxP.js","./SymbolFader-R3zz-rtA-BmF1q0wK.js","./RenderingContext-Ce9q3uBe-KUGGLSQ_.js","./renderState-BM-MCKUz-CkGIEsl7.js","./basicInterfaces-Dsf65ICa-DkQ9Rsnx.js","./glsl-Z5uYj8ka-BRgh2Cgo.js","./CIMResourceManager-DyRf92xI-vwwf7X-z.js","./AttributeStore-Oa0mwyTc-DxeOmaEw.js","./queryUtils-DZy8hWx3-BhvchYa3.js","./json-BI97KiBB-Ce5cWfI2.js","./timeSupport-C2LrHIeW-_dcwLbYI.js","./utils-CkvAYvpE-rAydMOg-.js","./utils-DA6J6wjA-DDjZAYSk.js","./MeshWriterRegistry-_Hh-alxg-10rRdRA8.js","./projectOperator-BEghhU44-BAuIbsae.js","./SimpleGeometryCursor-DSF_YyIm-TAMgMsbK.js","./GraphicsView2D-D4hKcKkn-D8ONZmEq.js","./normalizeUtilsSync-DslYq1HB-_j2gfJSx.js","./mat3f64-BnNZDR5l-Bz3OL2oI.js","./dehydratedFeatures-CE8L86IW-Bq7d7qIt.js","./GraphicContainer-c1LxUVI--93M9I8ZC.js","./AGraphicContainer-DtNijdEa-OwPP8Y1d.js","./TechniqueInstance-CwLUZ8IR-BBGig5I8.js","./TileContainer-CAC1uSjc-Btna8Osl.js","./requestImageUtils-B2YN5Eb9-DBD2GTtw.js","./gridUtils-ZkKc2j-y-CYeYswHo.js","./geodesicUtils-DKS2UG72-tQdU1Mqj.js","./TileLayerView2D-BSVkAvgX-MYth2k7q.js","./imageUtils-BkF1paOz--dxcckig.js","./BitmapTechnique-CHUhq2KJ-DAZTSGOO.js","./bitmapUtils-CAdCGIbP-BCDRpv7Z.js","./LayerView2D-BaefGYf9-DzQJY7yd.js","./utils-C0LvbFCo-RMQaTNpt.js","./HighlightGraphicContainer-yIQjvQv5-B6JUuWGj.js","./LayerView-DdANuT-Y-C_ZK84pA.js","./RefreshableLayerView-CqFW21Do-Cw9QN1ef.js","./MapServiceLayerViewHelper-BFEkAhCr-CMAOHkQZ.js","./floorFilterUtils-4r-vVdzs-C43jLoAE.js","./drapedUtils-DARF9dbf-BqeeHkKY.js","./sublayerUtils-DUalPlkE-DXjKV7Yv.js","./popupUtils-B9dNptlM-Zor6KJ99.js","./FeatureLayerView2D-BFdoHjCO-D4f3aFaZ.js","./timeSupport-BlIpM2Fj-BxyMlL4p.js","./AttributeBinsFeatureSet-f4NTpSO_-CxzPT2nE.js","./AttributeBinsQuery-DHrHi_6j-XRbucV2B.js","./FixedIntervalBinParameters-CsFyInBi-CHALHbNQ.js","./featureReductionUtils-CT3zJdMo-COEl9dk_.js","./constants-5AlnYBiV-SxxbBSOD.js","./bundle-CEMFEMun-CfnQz3oA.js","./BaseDynamicLayerView2D-dp_1t_U7-BcfcH4ek.js","./BitmapContainer-CRol5kLe-BnG9DJSS.js","./ExportStrategy-B4Kq9k9u-DniQXewp.js","./CatalogLayerView2D-CYqGTGlX-B-3aoFtV.js","./CatalogDynamicGroupLayerView2D-D8lxLEXq-GHHdqbrW.js","./CatalogFootprintLayerView2D-RRjvPOvg-DNN99xNs.js","./GeoRSSLayerView2D-CSsrDcVh-Bh1SGlgI.js","./GraphicsLayerView2D-CT50MNVi-CXRV7u5I.js","./GroupLayerView2D-ENpdmUqF-DFEZP4R_.js","./ImageryLayerView2D-BYGSmiEO-BoC3p3vD.js","./RasterVFDisplayObject-CjEe9AcH-Dl0DDB5s.js","./dataUtils-CfR0oe2x-CJv7jKlF.js","./pixelRangeUtils-DcEknavd-DdeXXJfY.js","./rasterProjectionHelper-DGqzGF1m-niCrAqep.js","./ImageryTileLayerView2D-CW5oOMZX-BQif9btb.js","./datasetUtils-DYlC2Qty-DopkuwzT.js","./clipUtils-fw7VCGXU-BPBpB7a9.js","./rasterUtils-CV4tTwvB-gXpyS4SI.js","./RawBlockCache-B-F6OWAv-grKhSoGd.js","./KMLLayerView2D-CfGoqlrn-CJbirwx2.js","./kmlUtils-in2U-qbi-UL_kOZhu.js","./KnowledgeGraphLayerView2D-ByYte4jc-lxpi5pk9.js","./MapImageLayerView2D-DvTL_pk6-DbW1yuS_.js","./ExportImageParameters-CC1oba-O-BRt1XjZu.js","./MapNotesLayerView2D-DidvAQ85-CCiFV6hI.js","./MediaLayerView2D-CllOE04l-yhX-EfDy.js","./mediaLayerUtils-C13VQLM8-ChF8vMiZ.js","./OverlayContainer-Dk-Hr_7e-AJzCxzP3.js","./OGCFeatureLayerView2D-BbzYRCC9-BOBYIt2E.js","./RouteLayerView2D-CEC8Ef4W-BBvwRudv.js","./Stop-BdaAbrQ2-ClOc8l_C.js","./networkEnums-DHCOt6o_-DhTTJIeV.js","./StreamLayerView2D-CmjvwU1I-QMYN2XJt.js","./SubtypeGroupLayerView2D-tQVOrzZf-vQCVS_N9.js","./VectorTileLayerView2D-DOzhqxiW-DiSO6S75.js","./PooledRBush-DfSXIoUa-Bp5sPesJ.js","./SourceLayerData-DjFpKQco-DzPfbCIt.js","./StyleRepository-Du6efSBt-CCRNlxvG.js","./VideoLayerView2D-D0Fhesy8-DEPDZ-EM.js","./GraphicsLayer-BiEC2-gS-kXodoCoi.js","./videoUtils-yR40DhDQ-v8V17dsX.js","./WMSLayerView2D-LTJm2gFs-CizvogR3.js","./ExportWMSImageParameters-CF4triM8-DadguegO.js","./WMTSLayerView2D-BqZEnQWx-BeuRlijY.js","./index-CK6nlFfs-nahm5_a5.js","./index-D0o7KJz6-YmEGbIEm.js","./guid-Dls486Er-CBh637k4.js","./useT9n-Cp7CFBMO-DWMplZyj.js","./index-DV38aJMs-NHO8o_KZ.js","./dom-PjyVZjPa-DZfYcHVM.js","./observers-CJ7vGAr1-CQe6YCAi.js","./ref-XMc4F1eh-Cy0SUibh.js","./static-Dm6M7dSg-BpBo-yy0.js","./form-D_5VLLzu-DGTGO3Cj.js","./interactive-EVx-Nhoa-BUtiMhAU.js","./label-DeyAgFGa-BAGN4dPO.js","./component-DGkKmsFn-0xOVjWT4.js"])))=>i.map(i=>d[i]);
import{v as a,S as l,n as v,x as Sn,X as Pn,l as L,E as Mt,F as Wa,w as qa,I as jt,J as Ce,R as ja,$ as jn,K as Le,a0 as R,a1 as _,a2 as G,a3 as _i,a4 as rt,a5 as ms,a6 as C,a7 as se,a8 as Ee,D as Ua,a9 as Un,aa as Ba,ab as Bn,ac as x,ad as Ut,ae as gs,af as ys,ag as Ve,h as E,ah as kn,ai as Yt,aj as tt,ak as at,al as Kn,am as Ka,an as F,ao as nn,ap as wi,aq as Ya,o as Qt,ar as ai,as as fs,at as vs,au as Cn,av as En,aw as _s,ax as Qa,V as ws,ay as bi,az as bs,aA as Xa,aB as Ja,aC as tr,aD as Mi,aE as et,Z as Ms,aF as er,aG as j,aH as ir,aI as nr,aJ as or,aK as Oe,aL as sr,Y as ar,aM as on,H as xi,aN as rr,aO as Fe,s as lr,aP as hr,aQ as cr,aR as Yn,aS as pr,aT as xs,u as Bt,aU as dr,aV as me,aW as ur,aX as mr,aY as gr,aZ as Qn,a_ as yr,a$ as fr,b0 as vr,_ as M,b1 as _r,b2 as wr,b3 as Xn,b4 as Ze,b5 as br,b6 as Mr,b7 as xr,p as Jn,b8 as Ts,b9 as He,ba as Tr,bb as Sr,bc as $e,bd as Pr,be as X}from"./main-DJKotNeA.js";import{l as kr}from"./Cyclical-DgD7_U1C-D9XAGOYJ.js";import{e as Ss}from"./CollectionFlattener-DyEG1Q6J-DqyDc0gm.js";import{U as Cr}from"./workers-CeRXsnNJ-DG-ZLCr5.js";import{O as Ti,U as Er,k as Ps,L as ks,K as Cs}from"./projectionUtils-B-CplN3q--VlVEuZs.js";import{n as Vr,a as Rr}from"./TileInfo-U28GysF5-BZlJVE5F.js";import{$ as Ir,V as Si,s as to,Q as Es,D as Dr,W as Pi,K as U,P as Vn,z as Lr,Y as eo}from"./jsxFactory-Cua8zWVZ-D8xsvlbz.js";import{i as ki}from"./UpdatingHandles-Bd2FQ26N-B5rIN4f4.js";import{g as Rn,k as Or}from"./asyncUtils-BPUlNCrX-BcMqDN8D.js";import{S as zr,v as Li,P as A,g as Re,d as Vs,o as Ar,a as Nr,h as Fr,c as Zr,l as Hr,p as $r,_ as Gr,b as Wr,e as qr,r as Rs,s as Is,f as dt,k as jr,w as mt}from"./utils-Dd8gTonD-BH8NpMR8.js";import Ur from"./Map-7V1pm_Jo-CzoTMaCx.js";import{o as Ds,u as io,s as Br}from"./GraphicsCollection-uWAVmks7-B1QDX86y.js";import{i as Kr}from"./HeightModelInfo-C4voFc4k-B1q_sNQN.js";import{l as Yr}from"./TimeExtent-Cf2Pienb-D0HuzG45.js";import{g as Qr}from"./timeZoneUtils-d5p0Jda1-B4nKouKv.js";import{o as Xr}from"./ReactiveMap-iPeM8evD-DZWvxP-R.js";import{R as no}from"./Query-n1aoaaFC-BAtHSjSK.js";import"./IViewEvents-BE10MM98-CvMfjolG.js";import{u as sn,n as Ot}from"./mat2df64-DDXwUeaJ-Tu7q-7Mk.js";import{r as Ls}from"./a11yUtils-CoCwThtH-y4sPq6no.js";import{p as Jr,$ as tl,M as el}from"./projectionUtils-Dt6hj1Xh-C_Kb4hEd.js";import{o as oo}from"./ViewingMode-CdRKcXnc-Dab70bGf.js";import{v as Oi}from"./TablesMixin-BORwbVPt-CHpspOXp.js";import{e as il}from"./Layer-DvVVmz9x-B_fmB79f.js";import{m as z,v as Ci,k as Os,i as an,j as so,S as nl,P as ol,h as ao,b as sl,L as xt,d as ke,f as al,_ as rl}from"./vec2-BnynUbeJ-CKtGJQAy.js";import{r as ll,o as O}from"./vec2f64-CkowXrDb-3zFQ3LNH.js";import{r as zs,n as zi}from"./common-CYWrYyJl-E8-sukrT.js";import{j as hl,g as In,x as cl,_ as Ei,q as Ie,S as As,A as Ns,v as pl}from"./mat2d-BQA-1WB--Pnyy0dhf.js";import{l as Dn,a as dl}from"./normalizeUtils-u00NGW3M-B_8jd2GW.js";import{u as ul}from"./mat2df32-fg3OHsAI-BF2V2zqo.js";import{Q as ml,R as gl,D as ro,G as yl,E as fl}from"./mat3-DOnW3DjW-C3hbW9XY.js";import{r as lo}from"./vec2f32-hTAvipMV-C0AQcwEv.js";import{Q as vl,u as Ge}from"./Scheduler-BV4C4cVP-8I9Lhrd6.js";import{L as _l}from"./vec32-Cj8pVsU0-YJ-zg-mR.js";import{r as We}from"./unitBezier-DhyPAQO8-B9kUb8N6.js";import{J as ho,k as wl,z as bl,t as co,V as Ml}from"./enums-CQnCd4Rx-gH-Yxynf.js";import{s as xl}from"./TileKey-_zikB14n-B4vTYQi8.js";import{e as qe,u as Tl,i as Sl,t as po}from"./definitions-MCCItX4r-o3EUznKY.js";import{L as Pl,P as Ai,U as kl}from"./enums-wEDHPbCF-Cf76M5_x.js";import{Y as Cl,_ as El}from"./Texture-D5XWO2GQ-B04SS3L4.js";import{y as Vl}from"./imageUtils-D3tfFRL_-BrFyHdkp.js";import{s as Rl}from"./capabilities-BaKzUyhi-y5w2NMiP.js";import"./intl-BAA1onnp-D8S77-_C.js";import{u as Il}from"./modeUtils-deizL-Tg-C4WiXKJs.js";import"./ILyr3DWasmPerSceneView-ChV4bxX0-B4BXvxji.js";import Dl from"./ColorBackground-C0D6MT0d-Cw_gjYpB.js";import"./Queue-DV3gpSdl-szFzyE30.js";import"./TileKey-B_6qmYK--BtZdR-Xy.js";import"./uuid-Dj9mdEVg-BaKSCiyT.js";import"./sanitizerUtils-B1yRmbO2-B7KG_jBT.js";import"./Version-CnwD6MZa-BW_zF5SH.js";import"./Basemap-C_NhFN5u-CXIQ3TCA.js";import"./loadAll-DQWsVoX1-wnyhDlfO.js";import"./PortalItem-BP-IQXnZ-C0op_jPu.js";import"./writeUtils-DAOvycBP-DlBnHp9n.js";import"./persistable-DgPk2hdg-DZbC9ypz.js";import"./MD5-CXHDUqXT-CMrYdOi6.js";import"./multiOriginJSONSupportUtils-DGETddQl-BrWaY9_8.js";import"./resourceExtension-DCCj0Izs-Diq42yp7.js";import"./PolygonCollection-Btw6sA7T-bzfT-bYb.js";import"./editableLayers-DFUBlMJy-BuIvdFLP.js";import"./mat4f32-BdRMyjXW-CWt6U0BP.js";import"./mat4-OOmHNWi7-DuXEks0B.js";import"./Field-BIQ-quF4-BSQv9vBj.js";import"./fieldType-PhcL4ff8-C2jeIUx8.js";import"./normalizeUtilsCommon-ClagynAA-DhHCBYDt.js";import"./utils-BO8hgPs3-NGzkE5wh.js";import"./utils-DpLVEUvg-BxP4kXy-.js";import"./debugFlags-8tOwPnHK-degGadwF.js";import"./quickselect-DHTstthl-Ds_Aj0x5.js";import"./getDataTypeBytes-DYbftOSj-BNZIboqJ.js";let Ft=class extends Sn{constructor(t){super(t),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(t){return t!=null&&this.row===t.row&&this.rows===t.rows&&this.column===t.column&&this.columns===t.columns}};a([l({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Ft.prototype,"row",void 0),a([l({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Ft.prototype,"column",void 0),a([l({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Ft.prototype,"rows",void 0),a([l({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Ft.prototype,"columns",void 0),Ft=a([v("esri.CameraLayout")],Ft);const Fs=Ft;let ht=class extends Sn.ClonableMixin(Pn){constructor(...t){super(...t),this.position=new L([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new Fs}normalizeCtorArgs(t,e,i,n){if(t&&typeof t=="object"&&("x"in t||Array.isArray(t))){const o={position:t};return e!=null&&(o.heading=e),i!=null&&(o.tilt=i),n!=null&&(o.fov=n),o}return t}writePosition(t,e,i,n){const o=t.clone();o.x=Mt(t.x||0),o.y=Mt(t.y||0),o.z=t.hasZ?Mt(t.z||0):t.z,e[i]=o.write({},n)}readPosition(t,e){const i=new L;return i.read(t,e),i.x=Mt(i.x||0),i.y=Mt(i.y||0),i.z=i.hasZ?Mt(i.z||0):i.z,i}equals(t){return t!=null&&this.tilt===t.tilt&&this.heading===t.heading&&this.fov===t.fov&&this.position.equals(t.position)&&this.layout.equals(t.layout)}};a([l({type:L,json:{write:{isRequired:!0}}})],ht.prototype,"position",void 0),a([Wa("position")],ht.prototype,"writePosition",null),a([qa("position")],ht.prototype,"readPosition",null),a([l({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),jt(t=>kr.normalize(Mt(t)))],ht.prototype,"heading",void 0),a([l({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),jt(t=>Ce(Mt(t),-180,180))],ht.prototype,"tilt",void 0),a([l({type:Number,nonNullable:!0,json:{default:55,write:!0}}),jt(t=>Ce(Mt(t,55),1,170))],ht.prototype,"fov",void 0),a([l({type:Fs,nonNullable:!0,json:{read:!1,write:!1}})],ht.prototype,"layout",void 0),ht=a([v("esri.Camera")],ht);const Ll=ht;var rn;let Ct=rn=class extends Pn{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new rn({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};a([l({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:Ni}}}}})],Ct.prototype,"rotation",void 0),a([jt("rotation")],Ct.prototype,"castRotation",null),a([l({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:Ni}}}}})],Ct.prototype,"scale",void 0),a([l({types:ja,json:{read:jn,write:!0,origins:{"web-scene":{read:jn,write:{overridePolicy:Ni}}}}})],Ct.prototype,"targetGeometry",void 0),a([l({type:Ll,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],Ct.prototype,"camera",void 0),Ct=rn=a([v("esri.Viewpoint")],Ct);const it=Ct;function Ni(){return{enabled:!this.camera}}const Qe={widthBreakpoint:{getValue(t){const e=t.viewSize[0],i=t.breakpoints,n=this.values;return e<=i.xsmall?n.xsmall:e<=i.small?n.small:e<=i.medium?n.medium:e<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],i=t.breakpoints,n=this.values;return e<=i.xsmall?n.xsmall:e<=i.small?n.small:e<=i.medium?n.medium:e<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,i=e[0],n=e[1],o=this.values;return n>=i?o.portrait:o.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},Fi={xsmall:544,small:768,medium:992,large:1200};function Ol(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function Zi(t,e){return e?Qe[t].valueToClassName[e].split(" "):[]}const zl=t=>{let e=class extends t{constructor(...i){super(...i),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=Fi}initialize(){this.addHandles(_(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),G))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(i){if(i!==this._get("breakpoints")){if(!Ol(i)){const n=JSON.stringify(Fi,null,2);console.warn("provided breakpoints are not valid, using defaults:"+n),i=Fi}this._set("breakpoints",{...i})}}_updateClassNames(){if(!this.container)return;const i=Ze.acquire(),n=Ze.acquire();let o,s=!1;for(o in Qe){const r=this[o],h=Qe[o].getValue({viewSize:this.size,breakpoints:this.breakpoints});r!==h&&(s=!0,this[o]=h,Zi(o,r).forEach(c=>n.push(c)),Zi(o,h).forEach(c=>i.push(c)))}s&&(this._applyClassNameChanges(i,n),Ze.release(i),Ze.release(n))}_applyClassNameChanges(i,n){const o=this.container;o&&(n.forEach(s=>o.classList.remove(s)),i.forEach(s=>o.classList.add(s)))}_removeActiveClassNames(){const i=this.container;if(!i)return;let n;for(n in Qe)Zi(n,this[n]).forEach(o=>i.classList.remove(o))}};return a([l()],e.prototype,"breakpoints",null),a([l()],e.prototype,"orientation",void 0),a([l()],e.prototype,"widthBreakpoint",void 0),a([l()],e.prototype,"heightBreakpoint",void 0),e=a([v("esri.views.BreakpointsOwner")],e),e};let Et=class extends x{constructor(){super(...arguments),this.items=new R,this._watchUpdatingTracking=new ki,this._callbacks=new Map,this._projector=to(),this._hiddenProjector=to()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){const t=document.createElement("div");t.className="esri-overlay-surface",this._set("surface",t),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,e=>{for(const i of e.added){const n=()=>i.render();this._callbacks.set(i,n),this._projector.append(this.surface,n)}for(const i of e.removed){const n=this._projector.detach(this._callbacks.get(i));this.surface.removeChild(n.domNode),this._callbacks.delete(i)}})}addItem(t){this.items.add(t)}removeItem(t){this.items.remove(t)}destroy(){this.items.removeAll(),this._callbacks.forEach(t=>this._projector.detach(t)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(t){const e=this._hiddenSurface,i=this._hiddenProjector;let n;const o=()=>(n=t.render(),n);i.append(e,o),i.renderNow();const s={left:0,top:0,right:0,bottom:0};if(n?.domNode){const r=n.domNode.getBoundingClientRect();s.left=r.left,s.top=r.top,s.right=r.right,s.bottom=r.bottom}for(i.detach(o);e.firstChild;)e.removeChild(e.firstChild);return s}overlaps(t,e){const i=this.computeBoundingRect(t),n=this.computeBoundingRect(e);return Math.max(i.left,n.left)<=Math.min(i.right,n.right)&&Math.max(i.top,n.top)<=Math.min(i.bottom,n.bottom)}get hasVisibleItems(){return this.items.some(t=>t.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(t,e){const i=!!e?.disableDecorations;if(!this.items.some(o=>o.visible&&!(i&&o.isDecoration)))return;const n=t.getContext("2d");n.save(),n.font=this._fontString(),this.items.forEach(o=>{i&&o.isDecoration||(n.save(),o.renderCanvas(n),n.restore())}),n.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};a([l({readOnly:!0})],Et.prototype,"surface",void 0),a([l({readOnly:!0})],Et.prototype,"items",void 0),a([l({readOnly:!0})],Et.prototype,"needsRender",null),a([l({readOnly:!0})],Et.prototype,"_watchUpdatingTracking",void 0),a([l({readOnly:!0})],Et.prototype,"updating",null),Et=a([v("esri.views.overlay.ViewOverlay")],Et);const uo=Et,Hi=[0,0];function Al(t){const e=(t.ownerDocument||window.document).defaultView,i=t.getBoundingClientRect();return Hi[0]=i.left+(e?.pageXOffset??0),Hi[1]=i.top+(e?.pageYOffset??0),Hi}function mo(t){t&&(t.textContent="",t.parentNode&&t.parentNode.removeChild(t))}function Nl(t){const e=document.createElement("div");return t.appendChild(e),e}const te=16,ye=750,Fl=512,Zl=2,Hl=t=>{let e=class extends t{constructor(...i){super(...i),this._freqInfo={freq:te,time:ye},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([_(()=>this.cursor,n=>{const{surface:o}=this;o&&o.setAttribute("data-cursor",n)}),_(()=>this.navigating,n=>{const{surface:o}=this;o&&o.setAttribute("data-navigating",n.toString())})])}initialize(){this.addHandles([_(()=>this.ui,(i,n)=>this._handleUIChange(i,n),G),this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui?.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(i){const n=this._get("container"),o=Es(i);if(o||typeof i!="string"||C.getLogger(this).error("#container",`element with id '${i}' not found`),n===o)return;if(this._stopMeasuring(),n&&(n.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(mo(this.root),this._set("root",null)),this.userContent&&(eo(this.userContent,n),mo(this.userContent),this._set("userContent",null))),!o)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);o.classList.add("esri-view");const s=document.createElement("div");s.className="esri-view-user-storage",eo(o,s),o.appendChild(s),this._set("userContent",s);const r=document.createElement("div");r.className="esri-view-root",o.insertBefore(r,o.firstChild),this._set("root",r);const h=document.createElement("div");h.className="esri-view-surface",h.setAttribute("role","application"),h.tabIndex=0,r.appendChild(h),this._set("surface",h);const c=new uo;r.appendChild(c.surface),this._set("overlay",c),this.addHandles(_(()=>c.needsRender,p=>{p&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=me({render:()=>this.overlay?.render()}):this._overlayRenderTaskHandle=rt(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",o),this._startMeasuring()}get focused(){const i=document.activeElement===this.surface;return document.hasFocus()&&i}get size(){return[this.width,this.height]}set ui(i){const n=this._get("ui");n!==i&&n?.destroy(),this._set("ui",i)}blur(){this.surface?.blur()}focus(){this.surface?.focus()}pageToContainer(i,n,o){const s=this.position;return i-=s?s[0]:0,n-=s?s[1]:0,o?(o[0]=i,o[1]=n):o=[i,n],o}containerToPage(i,n,o){const s=this.position;return i+=s?s[0]:0,n+=s?s[1]:0,o?(o[0]=i,o[1]=n):o=[i,n],o}_handleUIChange(i,n){this.removeHandles("ui"),n&&n!==i&&n.destroy(),i&&(i.view=this,this.addHandles(_(()=>this.root,o=>{i.container=o?Nl(o):null},G),"ui")),this._set("ui",i)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const i=this._freqInfo;i.freq=te,i.time=ye;const n=me({prepare:r=>{const h=this._measure(),c=this._freqInfo;if(c.time+=r.deltaTime,h&&(c.freq=te,this._get("resizing")||this._set("resizing",!0)),c.time<c.freq)return;c.time=0;const p=this._position();c.freq=p||h?te:Math.min(ye,c.freq*Zl),!h&&c.freq>=Fl&&(n.pause(),this._get("resizing")&&this._set("resizing",!1))}}),o=new ResizeObserver(r=>{i.freq=te,i.time=ye,n.resume()});this.container!=null&&o.observe(this.container);const s=Mi(()=>o.disconnect());this.addHandles([ws(window,"resize",()=>{i.freq=te,i.time=ye,n.resume()}),s,n],"measuring"),this._measure(),this._position()}_measure(){const i=this.container,n=i?i.clientWidth:0,o=i?i.clientHeight:0;if(n===0||o===0)return this.suspended||this._set("suspended",!0),!1;const s=this.width,r=this.height;return n===s&&o===r?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",n),this._set("height",o),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:s,oldHeight:r,width:n,height:o}),!0)}_position(){const i=this.container,n=this.position,o=i&&Al(i);return!!o&&(!n||o[0]!==n[0]||o[1]!==n[1])&&(this._set("position",[o[0],o[1]]),!0)}forceDOMReadyCycle(){}};return a([l()],e.prototype,"container",null),a([l({readOnly:!0})],e.prototype,"focused",null),a([l({readOnly:!0})],e.prototype,"height",void 0),a([l()],e.prototype,"messagesCommon",void 0),a([l({type:uo})],e.prototype,"overlay",void 0),a([l({readOnly:!0})],e.prototype,"position",void 0),a([l({readOnly:!0})],e.prototype,"resizing",void 0),a([l({readOnly:!0})],e.prototype,"root",void 0),a([l({value:null,readOnly:!0})],e.prototype,"size",null),a([l({readOnly:!0})],e.prototype,"surface",void 0),a([l({readOnly:!0})],e.prototype,"suspended",void 0),a([l({nonNullable:!0})],e.prototype,"ui",null),a([l({readOnly:!0})],e.prototype,"userContent",void 0),a([l({readOnly:!0})],e.prototype,"width",void 0),a([l()],e.prototype,"widthBreakpoint",void 0),e=a([v("esri.views.DOMContainer")],e),e};function Pt(t){return t!=null&&"open"in t&&"declaredClass"in t}function go(t){return t!=null&&"declaredClass"in t&&"dockOptions"in t}const $l=t=>{let e=class extends t{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([_(()=>[this.ui,this.popup],([i,n],o)=>{const s="popup",r="manual";if(o){const[h,c]=o;h&&Pt(c)&&(c.view=null,go(c)&&(h.remove(c,s),c!==n&&n&&c.destroy()))}i&&Pt(n)&&(n.view=this,go(n)&&i.add(n,{key:s,position:r,internal:!0}))},tt),this.on("click",i=>{this.popup&&this.popupEnabled&&(i.pointerType!=="mouse"||i.button===0)&&(Pt(this.popup)?this.popup.viewModel.handleViewClick(i):i.defer(async()=>{await this.setupPopup(),Pt(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(i)}))},Re.WIDGET)]),kn(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>{M(()=>import("./Popup-BWCSLTGs-BAUXcP43.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175]),import.meta.url).then(i=>i.P)})}destroy(){this.destroyed||this.closePopup()}async openPopup(i){if(Pt(this.popup))return this.popup.open(i);try{if(await this.setupPopup(),!this.popup)return void C.getLogger(this).error(new E("view:null-popup","Popup is null and can't be opened"));this.popup.open(i)}catch{}}closePopup(){this._popupSetupTask?.abort(),Pt(this.popup)&&this.popup.close()}async fetchPopupFeatures(i,n){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(i,n),n)}async setupPopup(){if(this._popupSetupTask?.abort(),this.popup&&!Pt(this.popup))return this._popupSetupTask=Rn(async i=>{const{default:n}=await M(()=>import("./Popup-BWCSLTGs-BAUXcP43.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175]),import.meta.url).then(s=>s.P);if(Bt(i),!this.popup||Pt(this.popup))return;const o=this.popup;delete o.open,delete o.close,this.popup=new n(o)}),this._popupSetupTask.promise}async _popupHitsToFeatures({location:i,hits:n},o){const s=[],r=[];let h=!1;const c=br(o,F("popup-view-fetch-timeout")??Wl),p=u=>{const g=new Gl(u);return r.push(g),s.push(g.promise),g},d=u=>{const g=r.at(-1);return g&&g.layerView===u&&!h?g:p(u)};for(const u of n)"graphic"in u?(d(u.layerView).graphics.push(u.graphic),h=!1):(s.push(u.layerView.fetchPopupFeaturesAtLocation(u.mapPoint,c)),h=!0);r.map(u=>u.resolve(c));const m=Mr(s).then(u=>u.filter(g=>!!g).flat());return{pendingFeatures:s,allGraphicsPromise:m,location:i}}async _getPopupHits(i,n){const{hits:o,location:s}=await this.popupHitTest(i);Bt(n);const r=[];for(const h of o)if("graphic"in h){if(this._isValidPopupGraphic(h.graphic,n)){const c=this._isValidPopupGraphicsLayerView(h.layerView)?h.layerView:void 0;r.push({graphic:h.graphic,layerView:c})}}else this._isValidPopupLocationLayerView(h.layerView)&&r.push({mapPoint:h.mapPoint,layerView:h.layerView});return{hits:r,location:s}}_isValidPopupGraphic(i,n){return i&&!!i.getEffectivePopupTemplate(n?.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(i){return!i||(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesFromGraphics"in i}_isValidPopupLocationLayerView(i){return(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesAtLocation"in i}};return a([l()],e.prototype,"popup",void 0),a([l()],e.prototype,"popupEnabled",void 0),e=a([v("esri.views.PopupView")],e),e};let Gl=class{constructor(t){this.layerView=t,this._resolver=xi(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(t){const{layerView:e,graphics:i,_resolver:n}=this;if(!e)return n.resolve(i),n.promise;let o;return e.fetchPopupFeaturesFromGraphics(i,t).catch(s=>(o=s,null)).then(s=>{s?n.resolve(s):n.reject(o)}),n.promise}};const Wl=5e3;let ri=class extends Br{constructor(t){super(t),this.addHandles(this.on("before-add",e=>{e.item!=null&&e.item.parent===this.owner&&(C.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),e.preventDefault())}))}_own(t){t.parent=this.owner}_release(t){t.parent=null}};ri=a([v("esri.support.AnalysesCollection")],ri);let Vt=class extends x{constructor(t){super(t),this.view=null,this.baseLayerViews=new R,this.referenceLayerViews=new R,this._loadingHandle=_(()=>this.view?.map?.basemap,e=>{e&&e.load().catch(()=>{})},G)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const t of this.baseLayerViews)t.destroy();this.baseLayerViews.length=0;for(const t of this.referenceLayerViews)t.destroy();this.referenceLayerViews.length=0}get suspended(){return this.view?.suspended??!0}get updating(){return this.view?.suspended?!1:!!this.view?.map?.basemap?.loaded&&(this.baseLayerViews.some(t=>t.updating)||this.referenceLayerViews.some(t=>t.updating))}};a([l({constructOnly:!0})],Vt.prototype,"view",void 0),a([l({readOnly:!0})],Vt.prototype,"baseLayerViews",void 0),a([l({readOnly:!0})],Vt.prototype,"referenceLayerViews",void 0),a([l({readOnly:!0})],Vt.prototype,"suspended",null),a([l({type:Boolean,readOnly:!0})],Vt.prototype,"updating",null),Vt=a([v("esri.views.BasemapView")],Vt);const ql=Vt;let K=class extends x{constructor(t){super(t),this.factor=1.5,this.offset=j(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};a([l({type:Number})],K.prototype,"factor",void 0),a([l({nonNullable:!0})],K.prototype,"offset",void 0),a([l()],K.prototype,"position",void 0),a([l({type:Number,range:{min:0}})],K.prototype,"size",void 0),a([l()],K.prototype,"maskUrl",void 0),a([l()],K.prototype,"maskEnabled",void 0),a([l()],K.prototype,"overlayUrl",void 0),a([l()],K.prototype,"overlayEnabled",void 0),a([l({readOnly:!0})],K.prototype,"version",null),a([l({type:Boolean})],K.prototype,"visible",void 0),K=a([v("esri.views.Magnifier")],K);const Zs=K;function kt(t){return!(t==null||typeof t!="object"||!("createQuery"in t)||!t.createQuery)}let J=class extends Le.EventedAccessor{constructor(t){super(t),this._selectionMap=new Xr,this._sources=new R,this._trashCan=[],this._layerEditHandles=new R,this._vizTaskId=0,this.view=null,this.showHighlight=!0,this.highlightName="default"}initialize(){this.addHandles([_(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),_(()=>this.view,t=>{t?.when().then(()=>this.syncSources())},G),_i(()=>this.sources,"change",t=>{const e=this._selectionMap,i=[];for(const n of t.removed){const o=e.get(n);o&&(e.delete(n),o.highlightHandle?.remove(),i.push({layer:n,selection:[],added:[],removed:[...o.selection]}))}this._refreshListeners(),i.length&&this._onSelectionChange(i)},{onListenerAdd:()=>this._refreshListeners()})])}destroy(){this.clear(),this._layerEditHandles.drain(rt)}get selections(){return Array.from(this._selectionMap.entries()).map(t=>{const[e,i]=t;return{layer:e,selection:[...i.selection]}})}get count(){let t=0;for(const e of this._selectionMap.values())t+=e.selection.length;return t}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(t){ms(t,this._sources)}syncSources(){const t=new Set,e=this.view?.map;if(!e)return;const i=n=>{ir(n)?(n.layers?.forEach(i),n.tables?.forEach(i)):nr(n)?(n.sublayers?.forEach(i),n.subtables?.forEach(i)):Bn(n)?n.sublayers?.forEach(i):kt(n)&&t.add(n)};e.allLayers.forEach(i),e.allTables.forEach(i),this.sources=[...t]}async getSelectedFeatures(t,e={},i="layerView"){const{view:n,selections:o}=this;if(!n&&i==="layerView")return C.getLogger(this).warn("Cannot query layer views without a view."),[];const s=(t?.length?o.filter(r=>t.includes(r.layer)):o).map(async r=>{const{layer:h,selection:c}=r;if(!c.length)return;const p=se(h)?h.parent:h;if(p!=null){if(n&&i==="layerView"&&!yo(p)&&fo(p)){const d=await n.whenLayerView(p).catch(()=>null);if(d)return vo(d,c,e)}return vo(p,c,e)}}).filter(Ee);return(await Promise.all(s)).filter(Ee)}updateSelection(t){const e=new Map;for(const[o,s]of this._selectionMap)e.set(o,[...s.selection]);let i=!1;const n=t.current.concat(t.added);for(const o of n){const s=o.sourceLayer,r=o.getObjectId();if(this.sources.includes(s)&&(kt(s)||se(s))&&r!==null){const h=Ua(e,s,()=>[]);h.includes(r)||(h.push(r),i=!0)}}for(const o of t.removed){const s=o.sourceLayer,r=o.getObjectId();if(this.sources.includes(s)&&(kt(s)||se(s))&&r!==null){const h=e.get(s),c=h?.indexOf(r);c!==void 0&&c>=0&&(h?.splice(c,1),i=!0)}}if(i){const{_selectionMap:o,_trashCan:s}=this,r=[];for(const[h,c]of e){const p=o.get(h);p!==void 0&&s.push(p),o.set(h,{selection:c}),r.push({layer:h,selection:c,...Un(p!==void 0?p.selection:[],c)})}this._onSelectionChange(r)}}setSelection(t,e){this._setSelection(t,e)}getSelection(t){return this._selectionMap.get(t)?.selection}appendToSelection(t,e){const i=this._selectionMap.get(t),n=i!==void 0?[...i.selection]:[];for(const o of e)n.includes(o)||n.push(o);this._setSelection(t,n)}removeFromSelection(t,e){const i=this._selectionMap.get(t);if(!i)return;const n=[];for(const o of i.selection)e.includes(o)||n.push(o);this._setSelection(t,n)}toggleInSelection(t,e){const i=this._selectionMap.get(t);if(!i||i.selection.length===0)return void this._setSelection(t,e);const n=new Set(i.selection),o=new Set(e),s=Ba(n,o);this._setSelection(t,Array.from(s))}clear(){const t=this._selectionMap.values();this._trashCan.push(...t);const e=[];for(const[i,n]of this._selectionMap.entries())e.push({layer:i,added:[],removed:[...n.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(e)}_onSelectionChange(t){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:t})}_refreshVisualization(){for(this._vizTaskId++;this._trashCan.length>0;)this._trashCan.pop()?.highlightHandle?.remove();if(this.view==null)return;const{sources:t,view:e,_selectionMap:i,showHighlight:n}=this,o=this._vizTaskId;for(const s of t){const r=i.get(s),h=se(s)?s.parent:s;if(h!=null&&fo(h)){if(yo(h))continue;e.whenLayerView(h).then(c=>{r?.highlightHandle?.remove(),r!=null&&n&&o===this._vizTaskId&&"highlight"in c&&typeof c.highlight=="function"&&r.selection.length>0&&(r.highlightHandle=c.highlight(r.selection,this.highlightName))}).catch(()=>{r?.highlightHandle?.remove()})}}}_refreshListeners(){this._layerEditHandles.drain(rt);const t=new Set(this.sources.map(e=>se(e)?e.parent:e));for(const e of t)kt(e)&&"on"in e&&e.on&&this._layerEditHandles.push(e.on("edits",i=>this._onLayerEdit(i,e)))}_onLayerEdit(t,e){if(Bn(e))this._onParentLayerEdit(t,e);else if(t.deletedFeatures.length&&this._selectionMap.has(e)){const i=[];t.deletedFeatures.forEach(({error:n,objectId:o})=>{o!=null&&n==null&&i.push(o)}),this.removeFromSelection(e,i)}}_onParentLayerEdit(t,e){const{deletedFeatures:i,edits:n,updatedFeatures:o}=t;if(n?.updateFeatures?.forEach(s=>{const r=s.getObjectId()??s.attributes[e.objectIdField];if(r==null||o.find(p=>p.objectId===r)?.error)return;const h=e.findSublayerForFeature(s);if(!kt(h))return;const c=e.sublayers.find(p=>!(!kt(p)||!this.getSelection(p)?.includes(r)));kt(c)&&c!==h&&(this.removeFromSelection(c,[r]),this.appendToSelection(h,[r]))}),i.length){const s=[];i.forEach(({error:r,objectId:h})=>{h!=null&&r==null&&s.push(h)}),e.sublayers.forEach(r=>{kt(r)&&this._selectionMap.has(r)&&this.removeFromSelection(r,s)})}}_setSelection(t,e){if(!this.sources.includes(t))throw new Error(`Cannot set selection on layer ${t.title} because it is not in 'sources'`);const i=this._selectionMap.get(t);if(i===void 0||!Ul(i,{selection:e})){i!==void 0&&this._trashCan.push(i),this._selectionMap.set(t,{selection:[...e]});const n={layer:t,selection:[...e],...Un(i!==void 0?i.selection:[],e)};this._onSelectionChange([n])}}};a([l()],J.prototype,"_selectionMap",void 0),a([l()],J.prototype,"_sources",void 0),a([l({readOnly:!0,nonNullable:!0})],J.prototype,"selections",null),a([l({readOnly:!0,nonNullable:!0})],J.prototype,"count",null),a([l()],J.prototype,"view",void 0),a([l({readOnly:!0,nonNullable:!0})],J.prototype,"hasSelection",null),a([l()],J.prototype,"showHighlight",void 0),a([l()],J.prototype,"sources",null),a([l()],J.prototype,"highlightName",void 0),J=a([v("esri.views.SelectionManager")],J);const yo=t=>se(t)?t.parent?.isTable===!0:t.isTable,jl=t=>t.layer!==void 0,fo=t=>t?.when!==void 0,Ul=(t,e)=>{if(t==null&&e==null)return!0;if(t!=null&&e==null||t==null&&e!=null)return!1;if(t!=null&&e!=null&&t.selection!=null&&e.selection!=null){const i=[...t.selection],n=[...e.selection];if(i.length!==n.length)return!1;i.sort(),n.sort();for(let o=0;o<i.length;o++)if(i[o]!==n[o])return!1}return!0},vo=async(t,e,i={})=>{let n;if(jl(t)){const o=t;n=o===void 0?null:await o.queryFeatures(new no({...i,objectIds:e})).then(s=>({data:s,layer:t.layer}))}else{const o=t;n=o===void 0?null:await o.queryFeatures(new no({...i,objectIds:e})).then(s=>({data:s,layer:o}))}return n},Bl=J;let be=class extends Sn.ClonableMixin(x){constructor(t){super(t),this.accentColor=new Ut([255,127,0]),this.textColor=new Ut([255,255,255])}};a([l({type:Ut,nonNullable:!0})],be.prototype,"accentColor",void 0),a([l({type:Ut,nonNullable:!0})],be.prototype,"textColor",void 0),be=a([v("esri.views.Theme")],be);const ln=be,Hs=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],$s={};function Gs(t){return!!$s[t]}function Kl(t){for(const e of t)if(!Gs(e))return!1;return!0}Hs.forEach(t=>{$s[t]=!0});let Ws=class{constructor(t){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=t,this.inputManager=null}connect(t){t&&this.disconnect(),this.inputManager=t,this._handlers.forEach(({handler:e,priority:i},n)=>this.inputManager?.installHandlers(n,[e],i))}disconnect(){this.inputManager&&this._handlers.forEach((t,e)=>this.inputManager?.uninstallHandlers(e)),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(t,e,i,n){const o=Array.isArray(t)?t:t.split(",");if(!Kl(o))return o.some(Gs)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let s,r;Array.isArray(e)?r=e:(s=e,r=[]),typeof i=="function"?s=i:n=i,n=n??Re.DEFAULT;const h=this._createUniqueGroupName(),c=new Yl(this.view,o,r,s);this._handlers.set(h,{handler:c,priority:n});for(const p of o){const d=this._handlerCounts.get(p)||0;this._handlerCounts.set(p,d+1)}return this.inputManager&&this.inputManager.installHandlers(h,[c],n),Mi(()=>this._removeHandler(h,o))}hasHandler(t){return!!this._handlerCounts.get(t)}_removeHandler(t,e){if(this._handlers.has(t)){this._handlers.delete(t);for(const i of e){const n=this._handlerCounts.get(i);n===void 0||(n===1?this._handlerCounts.delete(i):this._handlerCounts.set(i,n-1))}}this.inputManager&&this.inputManager.uninstallHandlers(t)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},Yl=class extends A{constructor(t,e,i,n){super(!0),this._latestDragStart=void 0,this.view=t;for(const o of e)switch(o){case"click":this.registerIncoming("click",i,s=>n(Jl(t,s)));break;case"double-click":this.registerIncoming("double-click",i,s=>n(th(t,s)));break;case"immediate-click":this.registerIncoming("immediate-click",i,s=>n(eh(t,s)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",i,s=>n(ih(t,s)));break;case"hold":this.registerIncoming("hold",i,s=>n(nh(t,s)));break;case"drag":this.registerIncoming("drag",i,s=>{const r=this._wrapDrag(s);r&&n(r)});break;case"key-down":this.registerIncoming("key-down",i,s=>n(oh(s)));break;case"key-up":this.registerIncoming("key-up",i,s=>n(sh(s)));break;case"pointer-down":this.registerIncoming("pointer-down",i,s=>n(fe(s,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",i,s=>n(fe(s,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",i,s=>n(fe(s,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",i,s=>n(ah(s)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",i,s=>n(rh(s)));break;case"pointer-enter":this.registerIncoming("pointer-enter",i,s=>n(fe(s,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",i,s=>n(fe(s,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",i,s=>{n(lh(s))});break;case"focus":this.registerIncoming("focus",i,s=>{n(Ql(s))});break;case"blur":this.registerIncoming("blur",i,s=>{n(Xl(s))})}}_wrapDrag(t){const e=t.data,{x:i,y:n}=e.center,{action:o,pointerType:s,button:r}=e;if(o==="start"&&(this._latestDragStart=e),!this._latestDragStart)return;const h=e.pointer.native,c=e.buttons,{cancelable:p,timestamp:d}=t,m={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return o==="end"&&(this._latestDragStart=void 0),{type:"drag",action:o,x:i,y:n,origin:m,pointerType:s,button:r,buttons:c,radius:e.radius,angle:or(e.angle),native:h,timestamp:d,cancelable:p,stopPropagation:()=>t.stopPropagation(),defer:u=>t.defer(u),preventDefault:()=>t.preventDefault()}}};function Ql(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function Xl(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function Jl(t,e){const{pointerType:i,button:n,buttons:o,x:s,y:r,native:h,eventId:c}=e.data,{cancelable:p,timestamp:d}=e;return{type:"click",pointerType:i,button:n,buttons:o,x:s,y:r,native:h,timestamp:d,screenPoint:j(s,r),mapPoint:ze(t,s,r),eventId:c,cancelable:p,stopPropagation:()=>e.stopPropagation(),defer:m=>e.defer(m),preventDefault:()=>e.preventDefault()}}function th(t,e){const{pointerType:i,button:n,buttons:o,x:s,y:r,native:h,eventId:c}=e.data,{cancelable:p,timestamp:d}=e;return{type:"double-click",pointerType:i,button:n,buttons:o,x:s,y:r,native:h,timestamp:d,mapPoint:ze(t,s,r),eventId:c,cancelable:p,stopPropagation:()=>e.stopPropagation(),defer:m=>e.defer(m),preventDefault:()=>e.preventDefault()}}function eh(t,e){const{pointerType:i,button:n,buttons:o,x:s,y:r,native:h,eventId:c}=e.data,p=h.pointerId,{cancelable:d,timestamp:m}=e;return{type:"immediate-click",pointerId:p,pointerType:i,button:n,buttons:o,x:s,y:r,native:h,timestamp:m,mapPoint:ze(t,s,r),eventId:c,cancelable:d,stopPropagation:()=>e.stopPropagation(),defer:u=>e.defer(u),preventDefault:()=>e.preventDefault()}}function ih(t,e){const{pointerType:i,button:n,buttons:o,x:s,y:r,native:h,eventId:c}=e.data,p=h.pointerId,{cancelable:d,timestamp:m}=e;return{type:"immediate-double-click",pointerId:p,pointerType:i,button:n,buttons:o,x:s,y:r,native:h,timestamp:m,mapPoint:ze(t,s,r),eventId:c,cancelable:d,stopPropagation:()=>e.stopPropagation(),defer:u=>e.defer(u),preventDefault:()=>e.preventDefault()}}function nh(t,e){const{pointerType:i,button:n,buttons:o,x:s,y:r,native:h}=e.data,{cancelable:c,timestamp:p}=e;return{type:"hold",pointerType:i,button:n,buttons:o,x:s,y:r,native:h,timestamp:p,mapPoint:ze(t,s,r),cancelable:c,stopPropagation:()=>e.stopPropagation(),defer:d=>e.defer(d),preventDefault:()=>e.preventDefault()}}function ze(t,e,i){return t.toMap(j(e,i),{exclude:[]})}function oh(t){const{key:e,repeat:i,native:n}=t.data,{cancelable:o,timestamp:s}=t;return{type:"key-down",key:e,repeat:i,native:n,timestamp:s,cancelable:o,stopPropagation:()=>t.stopPropagation(),defer:r=>t.defer(r),preventDefault:()=>t.preventDefault()}}function sh(t){const{key:e,native:i}=t.data,{cancelable:n,timestamp:o}=t;return{type:"key-up",key:e,native:i,timestamp:o,cancelable:n,stopPropagation:()=>t.stopPropagation(),defer:s=>t.defer(s),preventDefault:()=>t.preventDefault()}}function fe(t,e){const{x:i,y:n,button:o,buttons:s,native:r,eventId:h}=t.data,c=r.pointerId,p=r.pointerType,{cancelable:d,timestamp:m}=t;return{type:e,x:i,y:n,pointerId:c,pointerType:p,button:o,buttons:s,native:r,timestamp:m,eventId:h,cancelable:d,stopPropagation:()=>t.stopPropagation(),defer:u=>t.defer(u),preventDefault:()=>t.preventDefault()}}function ah(t){const{x:e,y:i,buttons:n,native:o,eventId:s}=t.data.currentEvent,{button:r}=t.data.startEvent,h=t.data.startEvent.native.pointerId,c=t.data.startEvent.native.pointerType,p=t.data.action,d={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:m,timestamp:u}=t;return{type:"pointer-drag",x:e,y:i,pointerId:h,pointerType:c,button:r,buttons:n,action:p,origin:d,native:o,timestamp:u,eventId:s,cancelable:m,stopPropagation:()=>t.stopPropagation(),defer:g=>t.defer(g),preventDefault:()=>t.preventDefault()}}function rh(t){const{cancelable:e,data:i,timestamp:n}=t,{x:o,y:s,deltaY:r,native:h}=i;return{type:"mouse-wheel",x:o,y:s,deltaY:r,native:h,timestamp:n,cancelable:e,stopPropagation:()=>t.stopPropagation(),defer:c=>t.defer(c),preventDefault:()=>t.preventDefault()}}function lh(t){const{action:e,state:i,device:n}=t.data,{cancelable:o,timestamp:s}=t,{buttons:r,axes:h}=i;return{type:"gamepad",device:n,timestamp:s,action:e,buttons:r,axes:h,cancelable:o,stopPropagation:()=>t.stopPropagation(),defer:c=>t.defer(c),preventDefault:()=>t.preventDefault()}}function hh(t){return[t.on("before-add",e=>{const i=e.item;if(i==null||t.includes(i))return C.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();i.onAdd()}),t.on("after-remove",e=>{const i=e.item;i.active&&(i.view.activeTool=null),i.destroy()})]}function hn(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(sn.USER)&&t.getEditableFlag(sn.MANAGER)}function ch(t){return t.type==="key-down"&&t.key===jr.cancel}let ph=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(t,e){const i=()=>t.stopPropagation();switch(t.type){case"pointer-move":wo(t.pointerType)&&this._pointerLocations.set(t.pointerId,{x:t.x,y:t.y,pointerType:t.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:t.action==="start"?this._externallyDragging=!0:t.action==="end"&&(this._externallyDragging=!1),this._stopDrag&&(i(),t.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!bo(t))break;const n=mt(t),o=ee(n,t.pointerType,e.forEachTool);if(o==null)break;const s=o.manipulator,r=o.tool;s==null||r==null||!s.interactive||s.grabbable&&s.grabbableForEvent(t)||!s.grabbing||s.dragging||this._releaseManipulatorBeforeDragging(s,t,e),s!=null&&r!=null&&s.interactive&&s.grabbable&&s.grabbableForEvent(t)&&!s.grabbing&&(this._grabbedManipulators.set(t.pointerId,{manipulator:s,tool:r,start:n,pointerType:t.pointerType}),this._grabbedManipulators.size===1&&e.activeTool==null&&(this._revertToNullActiveTool=!0,e.setActiveTool(o.tool)),s.grabbing=!0,s.events.emit("grab-changed",{action:"start",pointerType:t.pointerType,screenPoint:n}),i());break}case"pointer-up":this._draggedManipulators.has(t.pointerId)||this._handlePointerEnd(t,e);break;case"pointer-drag":{if(!bo(t))break;const n=this._grabbedManipulators.get(t.pointerId),o=n?.manipulator,s=n?.tool;if(o==null||s==null)break;const r=mt(t);r.x=Ce(r.x,0,e.view.width),r.y=Ce(r.y,0,e.view.height);const h=n.start,c=this._draggedManipulators.get(t.pointerId);switch(t.action){case"start":case"update":t.action!=="update"&&this._grabbedManipulators.size!==1||(o.dragging=!0,c?o.events.emit("drag",{action:"update",start:h,screenPoint:r}):o.events.emit("drag",{action:"start",start:h,screenPoint:r,pointerType:t.pointerType}),this._draggedManipulators.set(t.pointerId,{tool:s,manipulator:o,start:h}));break;case"end":o.dragging=!1,c&&o.events.emit("drag",{action:"end",start:h,screenPoint:r}),this._draggedManipulators.delete(t.pointerId),this._handlePointerEnd(t,e)}i();break}case"immediate-click":{const n=mt(t),o=ee(n,t.pointerType,e.forEachTool);if(dh(t)||e.forEachTool(c=>{if((o==null||o.tool!==c||c.automaticManipulatorSelection)&&c.manipulators){let p=!1;c.manipulators.forEach(({manipulator:d})=>{d.selected&&(d.selected=!1,p=!0)}),p&&c.onManipulatorSelectionChanged&&c.onManipulatorSelectionChanged()}}),o==null)break;const{manipulator:s,tool:r}=o;if(!s.interactive)break;s.selectable&&r.automaticManipulatorSelection&&(s.selected=!s.selected,r.onManipulatorSelectionChanged&&r.onManipulatorSelectionChanged());const h=t.native.shiftKey;s.events.emit("immediate-click",{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:h,stopPropagation:i}),$i(s,i);break}case"click":{const n=mt(t),o=ee(n,t.pointerType,e.forEachTool),s=o?.manipulator;if(s==null||!s.interactive)break;const r=t.native.shiftKey;s.events.emit(t.type,{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:r}),i();break}case"double-click":{const n=mt(t),o=ee(n,t.pointerType,e.forEachTool),s=o!=null?o.manipulator:null;if(s==null||!s.interactive)break;const r=t.native.shiftKey;s.events.emit("double-click",{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:r,stopPropagation:i}),$i(s,i);break}case"immediate-double-click":{const n=mt(t),o=ee(n,t.pointerType,e.forEachTool),s=o!=null?o.manipulator:null;if(s==null||!s.interactive)break;const r=t.native.shiftKey;s.events.emit("immediate-double-click",{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:r,stopPropagation:i}),t.pointerType==="mouse"&&$i(s,i);break}}this._onFocusChange(e.forEachTool)}_releaseManipulatorBeforeDragging(t,e,i){t.grabbing=!1,t.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:mt(e)}),this._grabbedManipulators.forEach(({manipulator:n},o)=>{n===t&&this._grabbedManipulators.delete(o)}),this._afterManipulatorRelease(i.setActiveTool)}_handlePointerEnd(t,e){const i=this._grabbedManipulators.get(t.pointerId)?.manipulator;i!=null&&i.grabbing&&(i.grabbing=!1,i.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:mt(t)}),this._grabbedManipulators.delete(t.pointerId),this._afterManipulatorRelease(e.setActiveTool))}_onFocusChange(t){this._updateCursor(),this._updateFocusedManipulatorTools(t)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=_o(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=_o(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(t){const e=new Set,i=new Set;this._grabbedManipulators.forEach(({tool:n})=>{e.add(n)}),this._hoveredManipulators.forEach(({tool:n})=>{i.add(n)}),t(n=>{n.hasGrabbedManipulators=e.has(n),n.hasHoveredManipulators=i.has(n);const o=this._grabbedManipulators.values(),s=xr(o,({tool:r})=>r===n);n.firstGrabbedManipulator=s!=null?s.manipulator:null})}clearPointers(t,{forEachTool:e,setActiveTool:i},n=!0,o){const s=(r,h)=>r===t&&(o==null||o===h);this._grabbedManipulators.forEach(({tool:r,manipulator:h,pointerType:c},p)=>{s(r,h)&&(this._grabbedManipulators.delete(p),h.grabbing=!1,h.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:c}))}),this._draggedManipulators.forEach(({tool:r,manipulator:h},c)=>{s(r,h)&&(this._draggedManipulators.delete(c),h.dragging=!1,h.events.emit("drag",{action:"cancel"}))}),n&&this._hoveredManipulators.forEach(({tool:r,manipulator:h},c)=>{s(r,h)&&(this._hoveredManipulators.delete(c),h.hovering=!1)}),this._afterManipulatorRelease(i),this._onFocusChange(e)}updateHoveredStateFromKnownPointers(t){this._pointerLocations.forEach((e,i)=>{this._updateHoveredStateForPointerAtScreenPosition(j(e.x,e.y),i,e.pointerType,t)})}handleHoverEvent(t,e){const i=t.type;i!=="pointer-up"&&i!=="immediate-click"&&i!=="pointer-move"||!wo(t.pointerType)||(i!=="pointer-up"&&this._externallyDragging?this._clearHoveredManipulatorStates(t.pointerId):this._updateHoveredStateForPointerAtScreenPosition(mt(t),t.pointerId,t.pointerType,e))}_updateHoveredStateForPointerAtScreenPosition(t,e,i,n){let o=ee(t,i,n);const s=this._hoveredManipulators.get(e)?.manipulator;o==null||o.manipulator.interactive||(o=null),o!=null&&s===o.manipulator||(s!=null&&(s.hovering=!1),o!=null?(o.manipulator.hovering=!0,this._hoveredManipulators.set(e,o)):this._hoveredManipulators.delete(e),this._onFocusChange(n))}_afterManipulatorRelease(t){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(t(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(t){this._hoveredManipulators.forEach(({manipulator:e},i)=>{t===i&&(this._hoveredManipulators.delete(t),e.hovering=!1)})}};function _o(t){for(const{manipulator:e}of t.values())if(e!=null&&e.interactive){if(e.grabbing&&e.grabCursor)return e.grabCursor;if(e.cursor)return e.cursor}return null}function ee(t,e,i){let n=null;return i(o=>{if(o.manipulators==null||!hn(o))return!1;const s=o.manipulators.intersect(t,e);return s!=null&&(n={tool:o,manipulator:s},!0)}),n}function wo(t){return t==="mouse"}function bo(t){return t.pointerType!=="mouse"||t.button===0}function dh(t){return!!t.native.shiftKey}function $i(t,e){t?.consumesClicks&&e()}const Mo="attached",Gi="tools",uh=1e3;let ct=class extends x{constructor(t){super(t),this._updatingHandles=new ki,this._clock=Oe,this._manipulatorState=new ph,this.tools=new R,this.cursor=null,this._interacting=!1,this._interactingTimeout=uh,this._interactingTimeoutHandle=null,this._forEachTool=e=>{for(const i of this.tools.items)if(e(i))return}}initialize(){this.addHandles([this.view.on(Hs,t=>{this._handleInputEvent(t)},Re.TOOL),...hh(this.tools),this.tools.on("before-add",({item:t})=>{this._updateToolEditableFlag(t)}),this.tools.on("before-remove",({item:t})=>{this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(t=>t.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:t=>{this.activeTool=t},view:this.view}}set activeTool(t){if(t!=null&&!this.view.ready)return void C.getLogger(this).error("Cannot set active tool while view is not ready.");if(t===this.activeTool)return;const e=this.activeTool;this._set("activeTool",t),e?.deactivate(),t?.activate(),this._removeIncompleteTools(t);for(const i of this.tools){this._updateToolEditableFlag(i);const n=hn(i);this.activeTool!=null&&n||this._manipulatorState.clearPointers(i,this._manipulatorStateEventArgs,!n)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some(t=>t.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=rt(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){this.view.type==="3d"?this.addHandles([_(()=>{const{state:t}=this.view;return"camera"in t&&t.camera},()=>this._forEachManipulator(t=>t.onViewChange())),this.view.elevationProvider?.on("elevation-change",t=>this._forEachManipulator(e=>e.onElevationChange(t)))],Mo):this.addHandles(_(()=>this.view.extent,()=>this._forEachManipulator(t=>t.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(Mo),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(t){this._forEachTool(e=>{e.manipulators&&e.manipulators.forEach(({manipulator:i})=>t(i,e))})}_handleInputEvent(t){let e=!1;const i={...t,stopPropagation:()=>{e=!0,t.stopPropagation()}};this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i):this._forEachTool(n=>{!e&&n.visible&&n.handleInputEvent(i)}),!e&&ch(t)&&this.activeTool&&(t.stopPropagation(),t.preventDefault(),this.activeTool.cancel(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,this._manipulatorStateEventArgs),e||this.activeTool==null||this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this._forEachTool),this._updateCursor(),t.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(Gi),this._forEachTool(t=>{if(t instanceof x){const e=_(()=>[t.cursor,t.visible,t.editable],()=>{hn(t)||this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs),this._updateCursor()});this.addHandles(e,Gi)}t.manipulators&&this.addHandles([t.manipulators.on("after-remove",e=>{this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs,!0,e.item.manipulator)}),t.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],Gi)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(t){t.setEditableFlag?.(sn.MANAGER,this.activeTool==null||t===this.activeTool)}_updateCursor(){let t=this._manipulatorState.cursor;t==null&&this._forEachTool(e=>!(e.cursor==null||!e.visible)&&(t=e.cursor,!0)),this._get("cursor")!==t&&this._set("cursor",t)}_removeIncompleteTools(t){this.tools.filter(e=>(t==null||e!==t)&&!e.created&&e.removeIncompleteOnCancel).forEach(e=>{this.tools.remove(e)})}get test(){}};a([l({constructOnly:!0,nonNullable:!0})],ct.prototype,"view",void 0),a([l({value:null})],ct.prototype,"activeTool",null),a([l({readOnly:!0,type:R})],ct.prototype,"tools",void 0),a([l({readOnly:!0})],ct.prototype,"cursor",void 0),a([l({readOnly:!0})],ct.prototype,"updating",null),a([l()],ct.prototype,"_interacting",void 0),a([l({readOnly:!0})],ct.prototype,"interacting",null),ct=a([v("esri.views.ToolViewManager")],ct);var cn;let Y=cn=class extends x{constructor(t){super(t),this.name=Vs,this.color=Ar.clone(),this.haloColor=null,this.haloOpacity=Nr,this.fillOpacity=Fr,this.shadowColor=Zr.clone(),this.shadowOpacity=Hr,this.shadowDifference=$r,this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(t){return this.color.equals(t.color)&&(this.haloColor||this.color).equals(t.haloColor||t.color)&&this.haloOpacity===t.haloOpacity&&this.fillOpacity===t.fillOpacity&&this.haloWidth===t.haloWidth&&this.haloBlur===t.haloBlur&&this.shadowColor.equals(t.shadowColor)&&this.shadowOpacity===t.shadowOpacity&&this.shadowDifference===t.shadowDifference}clone(){return new cn({...this,color:this.color.clone(),haloColor:this.haloColor?.clone(),shadowColor:this.shadowColor?.clone()})}assignFrom(t){this.color=t.color.clone(),this.haloColor=t.haloColor?.clone(),this.haloOpacity=t.haloOpacity,this.fillOpacity=t.fillOpacity,this.shadowColor=t.shadowColor.clone(),this.shadowDifference=t.shadowDifference,this.shadowOpacity=t.shadowOpacity,this.haloBlur=t.haloBlur,this.haloWidth=t.haloWidth}};a([l({type:String,constructOnly:!0,nonNullable:!0})],Y.prototype,"name",void 0),a([l({type:Ut,nonNullable:!0})],Y.prototype,"color",void 0),a([l({type:Ut})],Y.prototype,"haloColor",void 0),a([l({nonNullable:!0})],Y.prototype,"haloOpacity",void 0),a([l({nonNullable:!0})],Y.prototype,"fillOpacity",void 0),a([l({type:Ut,nonNullable:!0})],Y.prototype,"shadowColor",void 0),a([l({nonNullable:!0})],Y.prototype,"shadowOpacity",void 0),a([l({nonNullable:!0})],Y.prototype,"shadowDifference",void 0),a([l({nonNullable:!0})],Y.prototype,"haloWidth",void 0),a([l({nonNullable:!0})],Y.prototype,"haloBlur",void 0),Y=cn=a([v("esri.views.support.HighlightOptions")],Y);const zt=Y;function mh(){return new(R.ofType(zt))([new zt({name:Vs}),new zt({name:Gr,color:Wr})])}let ae=class extends x{constructor(t){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",t.mapping==="standard"?this._detectedDeviceType="standard":gh.test(t.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=t.index}get native(){const t=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<t.length?t[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return yh[this.deviceType]}};a([l({nonNullable:!0,readOnly:!0})],ae.prototype,"nativeIndex",void 0),a([l({type:String,readOnly:!0})],ae.prototype,"deviceType",null),a([l({type:Number,readOnly:!0})],ae.prototype,"axisThreshold",null),ae=a([v("esri.views.input.gamepad.GamepadInputDevice")],ae);const Ln=ae,gh=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),yh={standard:.15,spacemouse:.025,unknown:0};let Me=class extends x{constructor(...t){super(...t),this.devices=new R,this.enabledFocusMode="document"}};a([l({type:R.ofType(Ln),readOnly:!0})],Me.prototype,"devices",void 0),a([l({type:["document","view","none"]})],Me.prototype,"enabledFocusMode",void 0),Me=a([v("esri.views.input.gamepad.GamepadSettings")],Me);const fh=Me;let Xe=class extends x{constructor(){super(...arguments),this.gamepad=new fh}};a([l({readOnly:!0})],Xe.prototype,"gamepad",void 0),Xe=a([v("esri.views.input.Input")],Xe);const vh=Xe,Wi=()=>l({type:["pan","rotate","zoom","none"],nonNullable:!0});let Zt=class extends x{constructor(t){super(t),this.dragPrimary="pan",this.dragSecondary="rotate",this.dragTertiary="zoom",this.mouseWheel="zoom"}};a([Wi()],Zt.prototype,"dragPrimary",void 0),a([Wi()],Zt.prototype,"dragSecondary",void 0),a([Wi()],Zt.prototype,"dragTertiary",void 0),a([l({type:["zoom","none"],nonNullable:!0})],Zt.prototype,"mouseWheel",void 0),Zt=a([v("esri.views.navigation.NavigationActionMap")],Zt);const On=Zt;let Rt=class extends x{constructor(t){super(t),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};a([l({type:Boolean,nonNullable:!0})],Rt.prototype,"enabled",void 0),a([l({type:Ln})],Rt.prototype,"device",void 0),a([l({type:["pan","zoom"],nonNullable:!0})],Rt.prototype,"mode",void 0),a([l({type:["forward-down","forward-up"],nonNullable:!0})],Rt.prototype,"tiltDirection",void 0),a([l({type:Number,nonNullable:!0})],Rt.prototype,"velocityFactor",void 0),Rt=a([v("esri.views.navigation.gamepad.GamepadSettings")],Rt);const qs=Rt;let It=class extends x{constructor(t){super(t),this.actionMap=new On,this.browserTouchPanEnabled=!0,this.gamepad=new qs,this.momentumEnabled=!0}get effectiveMomentumEnabled(){return this.momentumEnabled&&!Ls()}get mouseWheelZoomEnabled(){return this.actionMap.mouseWheel==="zoom"}set mouseWheelZoomEnabled(t){sr(C.getLogger(this),"mouseWheelZoomEnabled",{replacement:"actionMap.mouseWheel",version:"4.32",warnOnce:!0}),this.actionMap.mouseWheel=t?"zoom":"none"}};a([l({type:On,nonNullable:!0})],It.prototype,"actionMap",void 0),a([l({type:Boolean})],It.prototype,"browserTouchPanEnabled",void 0),a([l({type:qs,nonNullable:!0})],It.prototype,"gamepad",void 0),a([l({type:Boolean})],It.prototype,"momentumEnabled",void 0),a([l({type:Boolean})],It.prototype,"mouseWheelZoomEnabled",null),It=a([v("esri.views.navigation.Navigation")],It);const Vi=It;let S=class extends x{constructor(t){super(t),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=nn(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){const t=this.map?.(),e=[];return this.priorityCollection!=null&&e.push(this.priorityCollection),e.push({parent:t?.basemap,layers:t?.basemap?.baseLayers},{layers:t?.layers},{parent:t?.ground,layers:t?.ground?.layers},{parent:t?.basemap,layers:t?.basemap?.referenceLayers}),e}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let t;if(this._collectLayers(this.mapCollections,i=>{const n=this._getSupportedSpatialReferences(i);if(n.length>0){const o=this._narrowDownSpatialReferenceCandidates(t,n);o!=null&&(t=o)}return t?.length===1})&&t?.length!==1)return{updating:!0};const e=this._pickSpatialReferenceCandidate(t);return{spatialReference:e?.spatialReference??null,viewingMode:e?.viewingMode??null,updating:!1}}get _tileInfoTask(){if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const t=this.map?.(),e=this.spatialReference;if(!e)return{updating:this._spatialReferenceTask.updating};let i;const n=this._collectLayers([{parent:t?.basemap,layers:t?.basemap?.baseLayers},{layers:t?.layers}],o=>!(!("tileInfo"in o)||!o.tileInfo?.spatialReference.equals(e))&&(i=o,!0),o=>"tileInfo"in o);return i?{tileInfo:i.tileInfo,updating:!1}:{updating:n}}get _heightModelInfoTask(){if(!this.required.heightModelInfo||this.suspended&&this._get("_heightModelInfoTask")?.heightModelInfo)return this._get("_heightModelInfoTask")??{updating:!1};let t={};const e=this._collectLayers(this.mapCollections,i=>{const n=Jr(i);return!!n&&(t={heightModelInfo:n,vcsWkid:i.spatialReference?.vcsWkid,latestVcsWkid:i.spatialReference?.latestVcsWkid},!0)},i=>tl(i));return{...t,updating:e}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const t=[],e=this._collectLayers(this.mapCollections,i=>{const n="fullExtents"in i&&i.fullExtents||(i.fullExtent!=null?[i.fullExtent]:[]),o=this.requiresExtentInSpatialReference?null:n[0],s=n.find(r=>r.spatialReference.equals(this.spatialReference))??o;if(s)return t.push({extent:s,layer:i}),!0;if(this._getSupportedSpatialReferences(i).length>0)for(const r of n)t.push({extent:r,layer:i});return!1});return{candidates:t,updating:e}}get _extentTask(){const{candidates:t,updating:e}=this._extentCandidatesTask;if(e)return{updating:e};if(t==null||t.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const i=this._pickExtentCandidate(t),n=this.spatialReference;return i.extent.equals(this._projectExtentTask.input)&&n.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=nn(this._projectExtentTask.task)),this._projectExtentTask={input:i.extent.clone(),output:null,spatialReference:n.clone(),task:Rn(async o=>{try{const s=await el(i.extent,n,"portalItem"in i.layer?i.layer.portalItem:void 0,o);this._projectExtentTask={...this._projectExtentTask,task:null,output:s}}catch{if(ar(o))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(t,e){if(t==null)return e;const i=new Array;for(const n of t)for(const o of e){if(!n.spatialReference.equals(o.spatialReference))continue;const s=wh(n.viewingMode,o.viewingMode);if(s!==!1){i.push({spatialReference:n.spatialReference,viewingMode:s});break}}return i.length>0?i:null}_pickSpatialReferenceCandidate(t){const e=this.defaultSpatialReference;return t==null||t.length<1?e?{spatialReference:e,viewingMode:null}:null:(e!=null&&t.length>1&&t.some(({spatialReference:i})=>i.equals(e))&&(t=t.filter(({spatialReference:i})=>i.equals(e))),t.length>1&&t.some(({viewingMode:i})=>i!==oo.Local)&&(t=t.filter(({viewingMode:i})=>i!==oo.Local)),t[0])}_getSupportedSpatialReferences(t){const e="supportedSpatialReferences"in t&&t.supportedSpatialReferences||(t.spatialReference?[t.spatialReference]:[]);if(e.length===0)return[];const i=[];for(const n of e){const o=this.getSpatialReferenceSupport(n,t);if(o!=null){const s=o.constraints??[{spatialReference:n,viewingMode:null}];for(const{spatialReference:r,viewingMode:h}of s)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!r.equals(this.userSpatialReference)||i.push({spatialReference:r,viewingMode:h})}}return i}_pickExtentCandidate(t){const e=this.spatialReference;return t.find(({extent:i})=>e.equals(i.spatialReference))||t[0]}_collectLayers(t,e,i=()=>!0){switch(this._loadMaybe(this.map?.())){case"loading":return!0;case"failed":return!1}const n=new _h(i,e);for(const o of t)if(this._collectCollection(o,n),n.done||n.preloading===this.sourcePreloadCount)break;return n.updating}_collectCollection(t,e){if(t.layers){switch(this._loadMaybe(t.parent)){case"loading":return e.updating=!0,void++e.preloading;case"failed":return}for(const i of t.layers)if(e.layerFilter(i)){switch(this._loadMaybe(i)){case"failed":continue;case"loading":e.updating=!0,++e.preloading;break;case"loaded":if(e.updating||(e.done=e.pushLayer(i)),e.done||e.preloading===this.sourcePreloadCount)break;"layers"in i&&this._collectCollection({layers:i.layers},e)}if(e.done||e.preloading===this.sourcePreloadCount)break}}}_loadMaybe(t){return t&&"loadStatus"in t&&t.loadStatus!=null?t.loadStatus==="not-loaded"?(t.load().catch(e=>{on(e)}),"loading"):t.loadStatus:"loaded"}};a([l()],S.prototype,"required",void 0),a([l({constructOnly:!0})],S.prototype,"map",void 0),a([l({constructOnly:!0})],S.prototype,"getSpatialReferenceSupport",void 0),a([l()],S.prototype,"defaultSpatialReference",void 0),a([l()],S.prototype,"userSpatialReference",void 0),a([l()],S.prototype,"sourcePreloadCount",void 0),a([l()],S.prototype,"priorityCollection",void 0),a([l()],S.prototype,"requiresExtentInSpatialReference",void 0),a([l()],S.prototype,"suspended",void 0),a([l({readOnly:!0})],S.prototype,"ready",null),a([l({readOnly:!0})],S.prototype,"heightModelInfoReady",null),a([l({readOnly:!0})],S.prototype,"spatialReference",null),a([l({readOnly:!0})],S.prototype,"extent",null),a([l({readOnly:!0})],S.prototype,"heightModelInfo",null),a([l({readOnly:!0})],S.prototype,"vcsWkid",null),a([l({readOnly:!0})],S.prototype,"latestVcsWkid",null),a([l({readOnly:!0})],S.prototype,"viewingMode",null),a([l({readOnly:!0})],S.prototype,"tileInfo",null),a([l({readOnly:!0})],S.prototype,"mapCollections",null),a([l({readOnly:!0})],S.prototype,"_spatialReferenceTask",null),a([l({readOnly:!0})],S.prototype,"_tileInfoTask",null),a([l({readOnly:!0})],S.prototype,"_heightModelInfoTask",null),a([l({readOnly:!0})],S.prototype,"_extentCandidatesTask",null),a([l()],S.prototype,"_extentTask",null),a([l()],S.prototype,"_projectExtentTask",void 0),S=a([v("esri.views.support.DefaultsFromMap")],S);let _h=class{constructor(t,e){this.layerFilter=t,this.pushLayer=e,this.preloading=-1,this.updating=!1,this.done=!1}};function wh(t,e){return t!=null?e!=null?t===e&&t:t:e}function bh(t){return"tryRecycleWith"in t}let Mh=class{constructor(t,e,i){this.layer=t,this.view=e,this.layerViewImporter=i,this._controller=new AbortController,this._deferred=xi(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,Jn(this._controller.signal,()=>{this._recycleController?.abort();const n=new E("cancelled:layerview-create","layerview creation cancelled",{layer:t});this._deferred.reject(n)})}tryRecycle(t){if(!this.done||!this.layerView||!bh(this.layerView))return null;this._recycleController?.abort(),this._recycleController=new AbortController;const e=this.layer.type,i=this._recycleController.signal;for(let n=0;n<t.length;n++){const o=t[n];if(o.type!==e)continue;const s=this.layerView.tryRecycleWith(o,{signal:i});if(s){t.splice(n,1),this.layer=o;const r=this.layerView,h=r.view;return this.promise=s.then(()=>(Bt(i),o.emit("layerview-destroy",{view:h,layerView:r}),h.emit("layerview-destroy",{view:h,layerView:r}),o.emit("layerview-create",{view:h,layerView:r}),h.emit("layerview-create",{view:h,layerView:r}),r)),this.promise}}return null}destroy(){this._controller.abort();const{layerView:t}=this;if(t){const{layer:e,view:i}=this;e.emit("layerview-destroy",{view:i,layerView:t}),i.emit("layerview-destroy",{layer:e,layerView:t})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null,this.promise=null,this._deferred=null}async start(){const{view:t}=this;if(this._started||!t.map)return;this._started=!0;const{_controller:{signal:e},layer:i}=this;this._map=t.map;try{let n,o;if(await i.load({signal:e}),i.prefetchResources&&await i.prefetchResources({signal:e}),xh(i))n=await i.createLayerView(t,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(i))throw new E("layer:view-not-supported","No layerview implementation was found");const r=await this.layerViewImporter.importLayerView(i);Bt(e),n="default"in r?new r.default({layer:i,view:t}):new r({layer:i,view:t})}const s=()=>{o=rt(o),n.destroyed||n.destroy(),n.layer=null,n.parent=null,n.view=null,this.done=!0};o=Jn(e,s),Bt(e);try{await n.when()}catch(r){throw s(),r}if(!this._map?.allLayers?.includes(i))return s(),void this._deferred.reject(new E("view:no-layerview-for-layer","The layer has been removed from the map",{layer:i}));this.layerView=n,i.emit("layerview-create",{view:t,layerView:n}),t.emit("layerview-create",{layer:i,layerView:n}),this.done=!0,this._deferred.resolve(n)}catch(n){i.emit("layerview-create-error",{view:t,error:n}),t.emit("layerview-create-error",{layer:i,error:n}),this.done=!0,this._deferred.reject(new E("layerview:create-error","layerview creation failed",{layer:i,error:n}))}}};function xh(t){return t.createLayerView!==il.prototype.createLayerView}function Th(t){return t!=null&&typeof t=="object"&&"layerViews"in t}let Q=class extends x{constructor(t){super(t),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new ki,this.supportsGround=!0,this._preloadLayerViewModules=()=>{const e=this.view.map?.allLayers;if(e)for(const i of e)this.layerViewFilter?.(i)!==!1&&this.layerViewImporter.hasLayerViewModule(i)&&this.layerViewImporter.importLayerView(i)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=xi(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(rr(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{const e=this.view.map;if(this.destroyed||!e)return void this.clear();if(this._map!==e&&(this.clear(),this._map=e),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const i=new Set,n=[],o=this.view.ready,s=p=>{if(p!=null){for(const d of p)if(d){if(this.layerViewFilter?.(d)===!1)continue;i.add(d);const m=this._layerLayerViewInfoMap.get(d);m&&o?m.start():m||this._recyclingInfoMap.has(d)||n.push(d),"layers"in d&&d.layers&&s(d.layers)}}};for(const p of this._rootCollectionNames)s(Fe(this,p));const r=new Array,h=p=>{const d=p.tryRecycle(n);d?(this._recyclingInfoMap.set(p.layer,p),this.notifyChange("updating"),d.then(()=>{this._recyclingInfoMap.delete(p.layer),this._layerLayerViewInfoMap.set(p.layer,p),this._reschedule(),this.notifyChange("updating")}).catch(m=>{on(m)||(this._recyclingInfoMap.delete(p.layer),p.destroy(),this._reschedule(),this.notifyChange("updating"))})):r.push(p)};for(const p of this._layerLayerViewInfoMap.values())i.has(p.layer)||(this._layerLayerViewInfoMap.delete(p.layer),h(p));for(const p of this._recyclingInfoMap.values())i.has(p.layer)||(this._recyclingInfoMap.delete(p.layer),h(p));for(const p of n)this._createLayerView(p);this._refreshCollections(),r.forEach(p=>p.destroy());const c=[e?.ground?.layers,e?.basemap?.baseLayers,e?.basemap?.referenceLayers,e?.layers].filter(p=>!!p);i.forEach(p=>"layers"in p&&c.push(p.layers)),this.addHandles(c.map(p=>this._watchUpdatingTracking.addOnCollectionChange(()=>p,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([_i(()=>this.view?.map?.allLayers,"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),_(()=>{const t=this.view,e=t?.map;return[e?.basemap,e?.ground,e?.layers,t?.ready]},()=>this._reschedule(),tt)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),Oi(this._recyclingInfoMap),Oi(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(lr()),this._workPromise=null)}get _layersToLayerViews(){const t=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&t.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(t)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||hr(this._layerLayerViewInfoMap,t=>!t.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let t=0;for(const e of this._layerLayerViewInfoMap.values())e.done||++t;return t}clear(){this.destroyed||(this._clearCollections(),Oi(this._layerLayerViewInfoMap))}async whenLayerView(t){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(t)){if(this._recyclingInfoMap.has(t))return this._recyclingInfoMap.get(t).promise;throw new E("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:t})}return this._layerLayerViewInfoMap.get(t).promise}isCreatingLayerViewsForLayer(t,e){this.commitProperty("updatingRemaining");const i=this._layerLayerViewInfoMap.get(t);if(!i?.done)return!0;const n=i.layerView;return!(!n||!e||n.parent===e)||!!(i.done&&n&&"layers"in t&&t.layers?.length)&&t.layers.some(o=>this.isCreatingLayerViewsForLayer(o,n))}_refreshCollections(){for(const[t,e]of this._layersToLayerViews)this._populateLayerViewsOwners(Fe(this,t),Fe(this,e),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_clearCollections(){for(const t of this._layersToLayerViews.values())Fe(this,t)?.removeAll()}_populateLayerViewsOwners(t,e,i){if(!t||!e)return void e?.removeAll();let n=0;for(const o of t){const s=this._layerLayerViewInfoMap.get(o);if(!s?.layerView)continue;const r=s.layerView;r.layer=o,r.parent=i,e.at(n)!==r&&e.splice(n,0,r),"layers"in o&&Th(r)&&this._populateLayerViewsOwners(o.layers,r.layerViews,r),n+=1}n<e.length&&e.splice(n)}_createLayerView(t){t.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(t)&&this.layerViewImporter.importLayerView(t);const e=new Mh(t,this.view,this.layerViewImporter);e.promise.then(()=>this._refreshCollections(),i=>{i&&(on(i)||i.name==="cancelled:layerview-create")||C.getLogger(this).error(`Failed to create layerview for layer title:'${t.title??"no title"}', id:'${t.id??"no id"}' of type '${t.type}'.`,{layer:t,error:i}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(t,e),this.view.ready&&e.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};a([l()],Q.prototype,"_workPromise",void 0),a([l({readOnly:!0})],Q.prototype,"_watchUpdatingTracking",void 0),a([l({readOnly:!0})],Q.prototype,"_layersToLayerViews",null),a([l({readOnly:!0})],Q.prototype,"_rootCollectionNames",null),a([l({constructOnly:!0})],Q.prototype,"layerViewFilter",void 0),a([l()],Q.prototype,"layerViewImporter",void 0),a([l()],Q.prototype,"supportsGround",void 0),a([l({readOnly:!0})],Q.prototype,"updating",null),a([l({readOnly:!0})],Q.prototype,"updatingRemaining",null),a([l({constructOnly:!0})],Q.prototype,"view",void 0),Q=a([v("esri.views.support.LayerViewManager")],Q);const Sh=Q;let re=class extends x{constructor(t){super(t),this.featureTitleFields=!1,this.utilityNetworkFields=!1,this.globalIdField=!1}};a([l()],re.prototype,"featureTitleFields",void 0),a([l()],re.prototype,"utilityNetworkFields",void 0),a([l()],re.prototype,"globalIdField",void 0),re=a([v("esri.views.support.RequiredFieldsOptions")],re);const Ph=re;var xe;let f=class extends Le.EventedMixin(gs.EsriPromiseMixin(x)){static{xe=this}constructor(t){super(t),this._userSpatialReference=null,this._cursor=null,this.handles=new ys,this.updatingHandles=new ki,this.allLayerViews=new Ss({getCollections:()=>[this.basemapView?.baseLayerViews,this.groundView?.layerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:Ch}),this.analyses=new ri,this.basemapView=null,this.displayFilterEnabled=!0,this.fatalError=null,this.graphics=new Ds,this.groundView=null,this.typeSpecificPreconditionsReady=!0,this.layerViews=new R,this.magnifier=new Zs,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this._readyStateWaitingTask=null,this.supportsGround=!0,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new vh,this.navigation=new Vi,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new Ws(this),this.persistableViewModels=new R,this.requiredFieldsOptions=new Ph,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add(_(()=>this.preconditionsReady,e=>{const i=this.ready;if(e?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,xe.views.add(this)):(this._lockedSpatialReference=null,xe.views.remove(this)),this.notifyChange("spatialReference"),!e&&i)this.toolViewManager?.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),this.layerViewManager?.clear(),this._teardown();else if(e&&!i){try{this._startup()}catch(n){return void queueMicrotask(()=>{this.fatalError=new E("view:startup-error","View._startup failed",n)})}this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach()}},Ve))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then(()=>(this._isValid=!0,kn(()=>this.ready)))),this.basemapView=new ql({view:this}),this.layerViewManager=new Sh({view:this,layerViewFilter:t=>this.layerViewFilter?.(t)??!0,layerViewImporter:{importLayerView:t=>this.importLayerView(t),hasLayerViewModule:t=>this.hasLayerViewModule(t)},supportsGround:this.supportsGround}),this.toolViewManager=new ct({view:this}),this.selectionManager=new Bl({view:this}),this.addHandles([Yt(()=>this.readyState==="map-content-error"&&!this.spatialReference,()=>{C.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),_(()=>this.initialExtentRequired,t=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:t},tt),_(()=>this.ready,t=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=t,this.defaultsFromMap.userSpatialReference=t?this.spatialReference:this._userSpatialReference)},Ve),_(()=>this._userSpatialReference,t=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=t)},tt)])}destroy(){this.destroyed||(xe.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=at(this.graphics),this.analyses=at(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),at(this.analysisViewManager),this.toolViewManager=at(this.toolViewManager),this.layerViewManager=at(this.layerViewManager),this.selectionManager=at(this.selectionManager),this.basemapView=at(this.basemapView),this.groundView?.destroy(),this.layerViews?.forEach(t=>t.destroy()),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=at(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return C.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){return this.toolViewManager?.activeTool}set activeTool(t){this.toolViewManager&&(this.toolViewManager.activeTool=t)}get animation(){return this._get("animation")}set animation(t){this._set("animation",t)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new S({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(t,e)=>this.getSpatialReferenceSupport(t,e),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(t){this._set("extent",t)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get highlights(){return this._get("highlights")??mh()}set highlights(t){this._set("highlights",ms(t,this._get("highlights"),R.ofType(zt)))}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){return!this.destroying&&!this.destroyed&&!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||Kn.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!this.defaultsFromMap?.ready||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(t){t!==this._get("map")&&(t?.destroyed&&(C.getLogger(this).warn("#map","The provided map is already destroyed",{map:t}),t=null),Kn.isLoadable(t)&&t.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",t))}get readyState(){if(this.destroyed)return this._get("readyState");if(!this.map)return"missing-map";if("container"in this&&!this.container)return"missing-container";if(this.fatalError)return"rendering-error";if((this.defaultsFromMap?.ready??!1)&&!this.spatialReference){const t=!("loaded"in this.map)||this.map.loaded,e=this.map.ground.loaded,i=this.map.basemap?.loaded??!0;return t&&i&&e&&!this.map?.allLayers.length?"empty-map":(this._readyStateWaitingTask||(this._readyStateWaitingTask=Rn(n=>Ka(F("view-readyState-waiting-delay"),null,n)),this.addHandles(this._readyStateWaitingTask),this.addHandles(this._readyStateWaitingTask,"ready-state-task")),this._readyStateWaitingTask?.finished?"map-content-error":"loading")}return this._readyStateWaitingTask=nn(this._readyStateWaitingTask),this.removeHandles("ready-state-task"),this.ready?"ready":"loading"}get spatialReference(){const t=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(t&&this.defaultsFromMap?.required?.heightModelInfo){const e=t.clone();return e.vcsWkid=this.defaultsFromMap.vcsWkid,e.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,e}return t}set spatialReference(t){const e=!wi(t,this._get("spatialReference"));this._set("_userSpatialReference",t),e&&(this._set("spatialReference",t),this._spatialReferenceChanged(t))}_spatialReferenceChanged(t){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(t){this._userTimeExtent=t}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??Ya}set timeZone(t){this._userTimeZone=t,Qr(t)||C.getLogger(this).warn("#timeZone",`the parsed value '${t}' may not be a valid IANA time zone`)}get tools(){return this.toolViewManager?.tools}get initialExtent(){return this.defaultsFromMap?.extent}get cursor(){return this.toolViewManager?.cursor??this._cursor??"default"}set cursor(t){this._cursor=t,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new ln}whenLayerView(t){return this.layerViewManager?.whenLayerView(t)??Promise.reject()}getDefaultSpatialReference(){return this.defaultsFromMap?.spatialReference}getDefaultHeightModelInfo(){return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??this.defaultsFromMap?.heightModelInfo??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}importLayerView(t){throw new E("view:importLayerView-missing","importLayerView() not implemented")}hasLayerViewModule(t){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(t){return this.getSpatialReferenceSupport(t)!=null}when(t,e){return this.isResolved()&&!this.ready&&C.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(t,e)}forceReadyCycle(){this.ready&&(Yt(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(t){this.toolViewManager.tools.add(t),this.activeTool=t}tryFatalErrorRecovery(){this.fatalError=null}static{this.views=new R}};a([l()],f.prototype,"_userSpatialReference",void 0),a([l()],f.prototype,"activeTool",null),a([l({readOnly:!0})],f.prototype,"allLayerViews",void 0),a([l(io(ri,"analyses"))],f.prototype,"analyses",void 0),a([l()],f.prototype,"animation",null),a([l()],f.prototype,"basemapView",void 0),a([l()],f.prototype,"center",null),a([l()],f.prototype,"defaultsFromMapSettings",null),a([l()],f.prototype,"defaultsFromMap",null),a([l()],f.prototype,"displayFilterEnabled",void 0),a([l({type:Qt})],f.prototype,"extent",null),a([l()],f.prototype,"fatalError",void 0),a([l(io(Ds,"graphics"))],f.prototype,"graphics",void 0),a([l()],f.prototype,"groundView",void 0),a([l({readOnly:!0,type:Kr})],f.prototype,"heightModelInfo",null),a([l({type:R.ofType(zt)})],f.prototype,"highlights",null),a([l({readOnly:!0})],f.prototype,"interacting",null),a([l({constructOnly:!0})],f.prototype,"layerViewFilter",void 0),a([l({readOnly:!0})],f.prototype,"navigating",null),a([l({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],f.prototype,"preconditionsReady",null),a([l({readOnly:!0})],f.prototype,"typeSpecificPreconditionsReady",void 0),a([l({type:R,readOnly:!0})],f.prototype,"layerViews",void 0),a([l()],f.prototype,"resolution",null),a([l({type:Zs})],f.prototype,"magnifier",void 0),a([l({value:null,type:Ur})],f.prototype,"map",null),a([l()],f.prototype,"padding",void 0),a([l({readOnly:!0})],f.prototype,"ready",void 0),a([l()],f.prototype,"_readyStateWaitingTask",void 0),a([l({readOnly:!0})],f.prototype,"readyState",null),a([l({type:ai})],f.prototype,"spatialReference",null),a([l()],f.prototype,"stationary",null),a([l({readOnly:!0})],f.prototype,"supportsGround",void 0),a([l({type:Yr})],f.prototype,"timeExtent",null),a([l({type:String,nonNullable:!0})],f.prototype,"timeZone",null),a([l()],f.prototype,"tools",null),a([l()],f.prototype,"toolViewManager",void 0),a([l({readOnly:!0})],f.prototype,"type",void 0),a([l({type:Number})],f.prototype,"scale",void 0),a([l({readOnly:!0})],f.prototype,"updating",void 0),a([l({readOnly:!0})],f.prototype,"initialExtentRequired",void 0),a([l({readOnly:!0})],f.prototype,"initialExtent",null),a([l()],f.prototype,"cursor",null),a([l({readOnly:!0})],f.prototype,"input",void 0),a([l({type:Vi,nonNullable:!0})],f.prototype,"navigation",void 0),a([l()],f.prototype,"layerViewManager",void 0),a([l()],f.prototype,"analysisViewManager",void 0),a([l()],f.prototype,"selectionManager",void 0),a([l()],f.prototype,"width",void 0),a([l()],f.prototype,"height",void 0),a([l({readOnly:!0})],f.prototype,"resizing",void 0),a([l({value:null,readOnly:!0})],f.prototype,"size",null),a([l({readOnly:!0})],f.prototype,"suspended",void 0),a([l({readOnly:!0})],f.prototype,"viewEvents",void 0),a([l({readOnly:!0})],f.prototype,"persistableViewModels",void 0),a([l()],f.prototype,"_isValid",void 0),a([l()],f.prototype,"_readyCycleForced",void 0),a([l()],f.prototype,"_lockedSpatialReference",void 0),a([l()],f.prototype,"_userTimeZone",void 0),a([l()],f.prototype,"_lockedTimeZone",void 0),a([l()],f.prototype,"_userTimeExtent",void 0),a([l()],f.prototype,"_lockedTimeExtent",void 0),a([l({type:ln})],f.prototype,"theme",void 0),a([l({readOnly:!0,type:ln})],f.prototype,"effectiveTheme",null),f=xe=a([v("esri.views.View")],f);const qi=globalThis.$arcgis;qi&&!qi.views&&Object.defineProperty(qi,"views",{configurable:!1,enumerable:!0,writable:!1,value:f.views});const kh=f;function Ch(t){return t.layerViews}const js=96,Us=39.37,Eh=180/Math.PI;function Bs(t){return t.wkid?t:t.spatialReference||ai.WGS84}function zn(t,e){return e.type?z(t,e.x,e.y):ke(t,e)}function Ks(t){return bs(t)}function Ri(t,e,i=0){let n=t.width,o=t.height;if(i!==0){const h=bi(i),c=Math.abs(Math.cos(h)),p=Math.abs(Math.sin(h));n=t.width*c+t.height*p,o=t.width*p+t.height*c}const s=Math.max(1,e[0]),r=Math.max(1,e[1]);return Math.max(n/s,o/r)*Ah(t.spatialReference)}async function Te(t,e,i,n){let o,s;if(!t||Array.isArray(t)&&!t.length)return null;if(R.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){const h=t.every(d=>"attributes"in d),c=t.some(d=>!d.geometry);let p=t;if(h&&c&&e&&e.allLayerViews){const d=new Map;for(const y of t){const w=y.layer,I=d.get(w)||[],V=y.attributes[w.objectIdField];V!=null&&I.push(V),d.set(w,I)}const m=[];d.forEach((y,w)=>{const I=e.allLayerViews?.find(V=>V.layer.id===w.id);if(I&&"queryFeatures"in I){const V=w.createQuery();V.objectIds=y,V.returnGeometry=!0,m.push(I.queryFeatures(V))}});const u=await Promise.all(m),g=[];for(const y of u)if(y&&y.features&&y.features.length)for(const w of y.features)w.geometry!=null&&g.push(w.geometry);p=g}for(const d of p)n=await Te(d,e,i,n);return n}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")o=new L(t);else if(t instanceof Ts)o=t;else if("geometry"in t){if(t.geometry)o=t.geometry;else if(t.layer){const h=t.layer,c=e.allLayerViews?.find(p=>p.layer.id===h.id);if(c&&"queryFeatures"in c){const p=h.createQuery();p.objectIds=[t.attributes[h.objectIdField]],p.returnGeometry=!0,o=(await c.queryFeatures(p))?.features?.[0]?.geometry}}}if(o==null)return null;switch(o.type){case"point":s=new Qt({xmin:o.x,ymin:o.y,xmax:o.x,ymax:o.y,spatialReference:o.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":s=dl(o);break;default:s=o.extent}if(!s)return null;Ps()||ks(s.spatialReference,i)||await Cs();const r=Ti(s,i);if(!r)return null;if(n){const h=r.center,c=h.clone();c.x=Dn(h.x,n.center.x,i),c.x!==h.x&&r.centerAt(c),n=n.union(r)}else n=r;return n}function Vh(t){if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&t.layer?.minScale!=null&&t.layer.maxScale!=null){const e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every(e=>"layer"in e)){let e=0,i=0;for(const n of t){const o=n.layer;o?.minScale&&o.maxScale&&(e=o.minScale<e?o.minScale:e,i=o.maxScale>i?o.maxScale:i)}return e&&i?{min:e,max:i}:null}}}function xo(t,e){const i=Bs(t);return wi(i,e)||i.imageCoordinateSystem||e.imageCoordinateSystem?t:Ti(t,e)}async function Rh(t,e){if(!t||!e)return new it({targetGeometry:new L,scale:0,rotation:0});let i=e.spatialReference;const{constraints:n,padding:o,viewpoint:s,size:r}=e,h=[o?r[0]-o.left-o.right:r[0],o?r[1]-o.top-o.bottom:r[1]];let c=null;t instanceof it?c=t:t.viewpoint?c=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(c=t.target);let p=null;c?.targetGeometry?p=c.targetGeometry:t instanceof Qt?p=t:t instanceof Ts?p=await Te(t,e,i):t&&(p=await Te(t.center,e,i)||await Te(t.target,e,i)||await Te(t,e,i)),!p&&s?.targetGeometry?p=s.targetGeometry:!p&&e.extent&&(p=e.extent),i||(i=Bs(e.spatialReference||e.extent||p)),Ps()||wi(p.spatialReference,i)||ks(p.spatialReference,i)||await Cs();const d=xo(p,i),m="center"in d?d.center:d;e.pickClosestTarget!==!1&&m.type==="point"&&s.targetGeometry?.type==="point"&&(m.x=Dn(m.x,s.targetGeometry.x,m.spatialReference));let u=0;c?u=c.rotation:t.hasOwnProperty("rotation")?u=t.rotation:s&&(u=s.rotation);let g=0;g=c?.targetGeometry!=null&&c.targetGeometry.type==="point"?c.scale:"scale"in t&&t.scale?t.scale:"zoom"in t&&t.zoom!==-1&&n&&n.effectiveLODs?n.zoomToScale(t.zoom):Array.isArray(p)||p.type==="point"||p.type==="extent"&&p.width===0&&p.height===0?s.scale:Ri(xo(p.extent,i),h,u);const y=Vh(t.target??t);y&&(y.min&&y.min<g?g=y.min:y.max&&y.max>g&&(g=y.max));let w=new it({targetGeometry:m,scale:g,rotation:u});return n&&(w=n.fit(w),n.constrainByGeometry(w),n.rotationEnabled||(w.rotation=s.rotation)),w}function Z(t,e){const i=t.targetGeometry,n=e.targetGeometry;return i.x=n.x,i.y=n.y,i.spatialReference=n.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function Ih(t,e,i){return i?z(t,.5*(e[0]-i.right+i.left),.5*(e[1]-i.bottom+i.top)):Ci(t,e,.5)}const Dh=function(){const t=O();return function(e,i,n){const o=i.targetGeometry;zn(t,o);const s=.5*ge(i);return e.xmin=t[0]-s*n[0],e.ymin=t[1]-s*n[1],e.xmax=t[0]+s*n[0],e.ymax=t[1]+s*n[1],e.spatialReference=o.spatialReference,e}}();function Lh(t,e,i,n,o){return pn(t,e,i.center),t.scale=Ri(i,n),o?.constraints?.constrain(t),t}function Oh(t,e,i,n){return Fn(t,e,i,n),As(t,t)}const Ys=function(){const t=O();return function(e,i,n){return Os(e,Nh(e,i),Ih(t,i,n))}}(),zh=function(){const t=Ot(),e=O();return function(i,n,o,s){const r=ge(n),h=An(n);return z(e,r,r),pl(t,e),Ei(t,t,h),Ie(t,t,Ys(e,o,s)),Ie(t,t,[0,s.top-s.bottom]),z(i,t[4],t[5])}}();function ge(t){return t.scale*Qs(t.targetGeometry?.spatialReference)}function Qs(t){return fs(t)?1/(Ks(t)*Us*js):1}function An(t){return zs(t.rotation)||0}function Ah(t){return fs(t)?Ks(t)*Us*js:1}function Nh(t,e){return Ci(t,e,.5)}const Nn=function(){const t=O(),e=O(),i=O();return function(n,o,s,r,h,c){return rl(t,o),Ci(e,s,.5*c),z(i,1/r*c,-1/r*c),Ns(n,e),h&&Ei(n,n,h),In(n,n,i),Ie(n,n,t),n}}(),Fn=function(){const t=O();return function(e,i,n,o){const s=ge(i),r=An(i);return zn(t,i.targetGeometry),Nn(e,t,n,s,r,o)}}(),Fh=function(){const t=O();return function(e,i,n,o){const s=ge(i);return zn(t,i.targetGeometry),Nn(e,t,n,s,0,o)}}();function Xs(t){const e=vs(t);return e?e.valid[1]-e.valid[0]:0}function Zh(t,e){return Math.round(Xs(t)/e)}const Hh=function(){const t=O(),e=O(),i=[0,0,0];return function(n,o,s){an(t,n,o),so(t,t),an(e,n,s),so(e,e),nl(i,t,e);let r=Math.acos(ol(t,e)/(ao(t)*ao(e)))*Eh;return i[2]<0&&(r=-r),isNaN(r)&&(r=0),r}}(),$h=function(){const t=O();return function(e,i,n,o){const s=e.targetGeometry;return Z(e,i),zh(t,i,n,o),s.x+=t[0],s.y+=t[1],e}}(),pn=function(t,e,i){Z(t,e);const n=t.targetGeometry;return n.x=i.x,n.y=i.y,n.spatialReference=i.spatialReference,t},Gh=function(){const t=O();return function(e,i,n,o,s){s||(s="center"),Os(t,n,o),Ci(t,t,.5);const r=t[0],h=t[1];switch(s){case"center":z(t,0,0);break;case"left":z(t,-r,0);break;case"top":z(t,0,h);break;case"right":z(t,r,0);break;case"bottom":z(t,0,-h);break;case"top-left":z(t,-r,h);break;case"bottom-left":z(t,-r,-h);break;case"top-right":z(t,r,h);break;case"bottom-right":z(t,r,-h)}return Ii(e,i,t),e}}();function Wu(t,e,i){return Z(t,e),t.rotation+=i,t}function Wh(t,e,i){return Z(t,e),t.rotation=i,t}const qh=function(){const t=O();return function(e,i,n,o,s){return Z(e,i),isNaN(n)||n===0||(ta(t,o,i,s),e.scale=i.scale*n,ea(t,t,e,s),Ii(e,e,z(t,t[0]-o[0],o[1]-t[1]))),e}}();function To(t,e,i){return Z(t,e),t.scale=i,t}const Js=function(){const t=O();return function(e,i,n,o,s,r){return Z(e,i),isNaN(n)||n===0||(ta(t,s,i,r),e.scale=i.scale*n,e.rotation+=o,ea(t,t,e,r),Ii(e,e,z(t,t[0]-s[0],s[1]-t[1]))),e}}(),qu=function(){const t=O(),e=O();return function(i,n,o,s,r,h,c){return Ys(e,h,c),sl(t,r,e),s?Js(i,n,o,s,t,h):qh(i,n,o,t,h)}}(),ta=function(){const t=Ot();return function(e,i,n,o){return xt(e,i,Oh(t,n,o,1))}}(),ea=function(){const t=Ot();return function(e,i,n,o){return xt(e,i,Fn(t,n,o,1))}}(),Ii=function(){const t=O(),e=Ot();return function(i,n,o){Z(i,n);const s=ge(n),r=i.targetGeometry;return hl(e,An(n)),In(e,e,ll(s,s)),xt(t,o,e),r.x+=t[0],r.y+=t[1],i}}();function Je(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function jh(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Uh(t,e,i,n,o,s,r,h,c){const p=new Float32Array(9);return p[0]=t,p[1]=e,p[2]=i,p[3]=n,p[4]=o,p[5]=s,p[6]=r,p[7]=h,p[8]=c,p}Object.freeze(Object.defineProperty({__proto__:null,clone:jh,create:Je,fromValues:Uh},Symbol.toStringTag,{value:"Module"}));function Bh(t){return t instanceof Float32Array&&t.length>=2}function Kh(t){return Array.isArray(t)&&t.length>=2}function ji(t){return Bh(t)||Kh(t)}var dn;const gt=[0,0];let vt=dn=class extends Pn{constructor(t){super(t),this._viewpoint2D={center:O(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Qt,this.id=0,this.inverseTransform=Ot(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=Ot(),this.transformNoRotation=Ot(),this.displayMat3=Je(),this.displayViewMat3=Je(),this.viewMat3=Je(),this.viewMat2d=ul(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,i=t.targetGeometry;e.center[0]=i.x,e.center[1]=i.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=i.spatialReference}this._update()}get visibleArea(){const[t,e]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,e),this.toMap([0,0],t,e),this.toMap([0,0],t,0)]}copy(t){const e=this.size,i=this.viewpoint;return i&&e?(this.viewpoint=Z(i,t.viewpoint),this._set("size",ke(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new dn({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,i){return ji(e)?xt(t,e,this.inverseTransform):(gt[0]=e,gt[1]=i,xt(t,gt,this.inverseTransform))}toScreen(t,e,i){return ji(e)?xt(t,e,this.transform):(gt[0]=e,gt[1]=i,xt(t,gt,this.transform))}toScreenNoRotation(t,e,i){return ji(e)?xt(t,e,this.transformNoRotation):(gt[0]=e,gt[1]=i,xt(t,gt,this.transformNoRotation))}wrapMapCoordinate(t,e){ke(t,e);const[i]=e,[n]=this.center,{extent:o,spatialReference:s}=this;let{xmin:r,xmax:h}=o;if(s.isWrappable){const c=Xs(s)/2;r=Math.max(r,n-c),h=Math.min(h,n+c)}return(i<r||i>h)&&(t[0]=Dn(i,n,s)),t}getScreenTransform(t,e){const{center:i}=this._viewpoint2D,n=this._get("pixelRatio")||1,o=this._get("size");return Nn(t,i,o,e,0,n),t}_update(){const{center:t,spatialReference:e,scale:i,rotation:n}=this._viewpoint2D,o=this._get("pixelRatio")||1,s=this._get("size"),r=new it({targetGeometry:new L(t[0],t[1],e),scale:i,rotation:n});if(this._set("viewpoint",r),!s||!e||!i)return;this.resolution=ge(r),this.rotation=n,this.scale=i,this.spatialReference=e,ke(this.center,t);const h=s[0]!==0?2/s[0]:0,c=s[1]!==0?-2/s[1]:0;ml(this.displayMat3,h,0,0,0,c,0,-1,1,1);const p=gl(this.viewMat3),d=lo(s[0]/2,s[1]/2),m=lo(-s[0]/2,-s[1]/2),u=zs(n);ro(p,p,d),yl(p,p,u),ro(p,p,m),fl(this.displayViewMat3,this.displayMat3,p);const g=Ns(this.viewMat2d,d);return Ei(g,g,u),Ie(g,g,m),Dh(this.extent,r,s),Fn(this.transform,r,s,o),As(this.inverseTransform,this.transform),Fh(this.transformNoRotation,r,s,o),this.worldScreenWidth=Zh(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};a([l({readOnly:!0})],vt.prototype,"id",void 0),a([l({value:1,json:{write:!0}})],vt.prototype,"pixelRatio",null),a([l({json:{write:!0}})],vt.prototype,"size",null),a([l()],vt.prototype,"spatialReference",void 0),a([l({type:it,json:{write:!0}})],vt.prototype,"viewpoint",null),a([l({readOnly:!0})],vt.prototype,"visibleArea",null),vt=dn=a([v("esri.views.2d.ViewState")],vt);const So=vt;var un,mn;let Tt=un=class extends x{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new un({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};a([l()],Tt.prototype,"left",void 0),a([l()],Tt.prototype,"top",void 0),a([l()],Tt.prototype,"right",void 0),a([l()],Tt.prototype,"bottom",void 0),Tt=un=a([v("esri.views.2d.PaddedViewState.Padding")],Tt);let le=mn=class extends So{constructor(...t){super(...t),this.paddedViewState=new So,this._updateContent=(()=>{const e=O();return()=>{const i=this._get("size"),n=this._get("padding");if(!i||!n)return;const o=this.paddedViewState;z(e,n.left+n.right,n.top+n.bottom),an(e,i,e),ke(o.size,e);const s=o.viewpoint;s&&(this.viewpoint=s)}})(),this.addHandles(_(()=>[this.size,this.padding],()=>this._updateContent(),Ve)),this.padding=new Tt,this.size=[0,0]}set padding(t){this._set("padding",t||new Tt)}set viewpoint(t){if(t){this.paddedViewState.viewpoint=t;let e=t;const i=this._get("padding");i&&(e=$h(t.clone(),t,this._get("size"),i));const{targetGeometry:n,rotation:o,scale:s}=e,{x:r,y:h,spatialReference:c}=n,p=this._viewpoint2D;p.center[0]=r,p.center[1]=h,p.rotation=o,p.scale=s,p.spatialReference=c,this._update()}}clone(){return new mn({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};a([l()],le.prototype,"paddedViewState",void 0),a([l({type:Tt})],le.prototype,"padding",null),a([l()],le.prototype,"viewpoint",null),le=mn=a([v("esri.views.2d.PaddedViewState")],le);const Zn=le;let Yh=class{constructor(t){this.view=t,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=vl(),this._schedulerHandle=Yt(()=>this._scheduler.updating,()=>this.requestFrame()),this.stationary=!0,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),this.view.animation?.target==null||xs(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=e=>{if(this._updateRequested=!1,this.view?.destroyed)return;const{allLayerViews:i,graphicsView:n,labelManager:o,state:{id:s}}=this.view;i?.forEach(this._updateLayerView,this),o!=null&&(o.lastUpdateId!==s&&(o.viewChange(),o.lastUpdateId=s),o.updateRequested&&o.processUpdate(this._updateParameters)),n!=null&&(n.lastUpdateId!==s&&(n.viewChange(),n.lastUpdateId=s),n.updateRequested&&n.processUpdate(this._updateParameters)),this.view.graphicsTileStore?.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=Ge.ANIMATING:this.view.interacting?this._scheduler.state=Ge.INTERACTING:this._scheduler.state=Ge.IDLE,this._scheduler.frame(e)||this._updateRequested||this._scheduler.state!==Ge.IDLE||this._frameTaskHandle?.pause()}}destroy(){this.stop(),this._schedulerHandle.remove(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const t=this.view;this.stationary=t.stationary,this._updateParameters={state:t.state,targetState:new Zn,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:t.renderingOptions},this._stationaryHandle=_(()=>t.stationary,e=>{this.stationary=e,this.requestFrame()}),this._frameTaskHandle=me(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle?.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(t){if(!t.attached)return void this.requestUpdate();const e=this.view.state,i=t.lastUpdateId;i!=null&&(this.stationary||t.moving)||(t.moving=!0),i!==e.id&&t.viewChange(),this.stationary&&t.moving&&(t.moving=!1,t.moveEnd()),t.lastUpdateId=e.id,t.updateRequested&&t.processUpdate(this._updateParameters),"layerViews"in t&&t.layerViews?.forEach(this._updateLayerView,this)}};function Qh(t,e){const{spatialReference:i}=e,n=[e.x,e.y];let o,s,r,h;const c=[0,0],p=Xh(t);for(let u=0;u<p.length;u++){const g=p[u];for(let y=0;y<g.length-1;y++){cr(c,n,g,y);const w=al(n,c);(o==null||w<o)&&(o=w,s=[...c],r=u,h=y)}}if(o==null||!s||r==null||h==null)throw new E("nearest-coordinate:failed","Failed to find the nearest coordinate");const[d,m]=s;return{coordinate:new L({x:d,y:m,spatialReference:i}),distance:o}}function Xh(t){switch(t.type){case"extent":return[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]];case"polygon":return t.rings;case"polyline":return t.paths}}var gn;let qt=gn=class extends Cn.NumericIdentifiableMixin(x){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return Ti(this.geometry,this.spatialReference)}catch(t){return C.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(this.normalizedGeometry==null)return t;const i=t.targetGeometry;if(this.normalizedGeometry.type==="extent"?En(this.normalizedGeometry,i):_s(this.normalizedGeometry,i))return t;const{coordinate:n}=Qh(this.normalizedGeometry,i);return n&&(t.targetGeometry=n),t}clone(){return new gn({geometry:this.geometry?.clone(),spatialReference:this.spatialReference?.clone()})}};a([l({constructOnly:!0})],qt.prototype,"geometry",void 0),a([l({readOnly:!0})],qt.prototype,"normalizedGeometry",null),a([l({constructOnly:!0})],qt.prototype,"spatialReference",void 0),qt=gn=a([v("esri.views.2d.constraints.GeometryConstraint")],qt);var yn;let Se=yn=class extends Cn.NumericIdentifiableMixin(x){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e&&(this.rotationEnabled||(t.rotation=e.rotation)),t}clone(){return new yn({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};a([l()],Se.prototype,"enabled",void 0),a([l()],Se.prototype,"rotationEnabled",void 0),Se=yn=a([v("esri.views.2d.constraints.RotationConstraint")],Se);const ia=Se;var fn;let q=fn=class extends Cn.NumericIdentifiableMixin(x){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:i,maxScale:n,minZoom:o,maxZoom:s}=this,r=-1,h=-1,c=!1,p=!1;if(i!==0&&n!==0&&i<n&&([i,n]=[n,i]),!e?.length)return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",n);e=e.map(d=>d.clone()),e.sort((d,m)=>m.scale-d.scale),e.forEach((d,m)=>d.level=m);for(const d of e)!c&&i>0&&i>=d.scale&&(r=d.level,c=!0),!p&&n>0&&n>=d.scale&&(h=t?t.level:-1,p=!0),t=d;o===-1&&(o=i===0?0:r),s===-1&&(s=n===0?e.length-1:h),o=Math.max(o,0),o=Math.min(o,e.length-1),s=Math.max(s,0),s=Math.min(s,e.length-1),o>s&&([o,s]=[s,o]),i=e[o].scale,n=e[s].scale,e.splice(0,o),e.splice(s-o+1),e.forEach((d,m)=>{this._lodByScale[d.scale]=d,this._scales[m]=d.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",o),this._set("effectiveMaxZoom",s),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",n)}constrain(t,e){if(e&&t.scale===e.scale)return t;const i=this.effectiveMinScale,n=this.effectiveMaxScale,o=t.targetGeometry,s=e&&e.targetGeometry,r=n!==0&&t.scale<n,h=i!==0&&t.scale>i;if(r||h){const c=h?i:n;if(e&&s){const p=(c-e.scale)/(t.scale-e.scale);o.x=s.x+(o.x-s.x)*p,o.y=s.y+(o.y-s.y)*p}t.scale=c}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),i=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(i>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const i=Math.floor(t),n=Math.ceil(t);return e[i]+(t-i)*(e[n]-e[i])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let i,n;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let o=0;o<e.length-1;o++){if(i=e[o],n=e[o+1],n===t)return o+this.effectiveMinZoom+1;if(i>t&&n<t)return o+this.effectiveMinZoom+1-(t-n)/(i-n)}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i-1)}clone(){return new fn({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce((e,i)=>Math.abs(i-t)<=Math.abs(e-t)?i:e,this._scales[0])),this._lodByScale[t].scale}};a([l({readOnly:!0})],q.prototype,"effectiveLODs",void 0),a([l({readOnly:!0})],q.prototype,"effectiveMinZoom",void 0),a([l({readOnly:!0})],q.prototype,"effectiveMaxZoom",void 0),a([l({readOnly:!0})],q.prototype,"effectiveMinScale",void 0),a([l({readOnly:!0})],q.prototype,"effectiveMaxScale",void 0),a([l()],q.prototype,"lods",void 0),a([l()],q.prototype,"minZoom",void 0),a([l()],q.prototype,"maxZoom",void 0),a([l()],q.prototype,"minScale",void 0),a([l()],q.prototype,"maxScale",void 0),a([l()],q.prototype,"snapToZoom",void 0),q=fn=a([v("esri.views.2d.constraints.ZoomConstraint")],q);const na=q,Jh={base:null,key:"type",typeMap:{extent:Qt,polygon:Ms}};let D=class extends x{constructor(t){super(t),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new R}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(t){t?this._set("geometry",t):this._set("geometry",null)}get version(){return`${this._zoom?.uid}/${this._rotation?.uid}/${this._geometry?.uid}`}get _geometry(){const t=this._get("_geometry");return t&&this.geometry===t.geometry&&this.view?.constraintsInfo.spatialReference===t.spatialReference?t:new qt({geometry:this.geometry,spatialReference:this.view?.constraintsInfo.spatialReference})}get _rotation(){return new ia({rotationEnabled:this.rotationEnabled})}get _zoom(){const t=this._get("_zoom"),e=this.lods||this.view?.constraintsInfo.lods,i=this.minZoom,n=this.maxZoom,o=this.minScale,s=this.maxScale,r=this.snapToZoom;return t&&t.lods===e&&t.minZoom===i&&t.maxZoom===n&&t.minScale===o&&t.maxScale===s&&t.snapToZoom===r?t:new na({lods:e,minZoom:i,maxZoom:n,minScale:o,maxScale:s,snapToZoom:r})}canZoomInTo(t){const e=this.effectiveMaxScale;return e===0||t>=e}canZoomOutTo(t){const e=this.effectiveMinScale;return e===0||t<=e}constrain(t,e){return this._zoom.constrain(t,e),this._rotation.constrain(t,e),this._geometry.constrain(t,e),this.customConstraints.forEach(i=>i.constrain(t,e)),t}constrainByGeometry(t){return this._geometry.constrain(t),this.customConstraints.forEach(e=>e.applyPanConstraint?.(t)),t}fit(t){return this._zoom.fit(t)}zoomToScale(t){return this._zoom.zoomToScale(t)}scaleToZoom(t){return this._zoom.scaleToZoom(t)}snapScale(t){return this._zoom.snapToClosestScale(t)}snapToNextScale(t){return this._zoom.snapToNextScale(t)}snapToPreviousScale(t){return this._zoom.snapToPreviousScale(t)}};a([l({readOnly:!0})],D.prototype,"effectiveLODs",null),a([l({readOnly:!0})],D.prototype,"effectiveMinScale",null),a([l({readOnly:!0})],D.prototype,"effectiveMaxScale",null),a([l({readOnly:!0})],D.prototype,"effectiveMinZoom",null),a([l({readOnly:!0})],D.prototype,"effectiveMaxZoom",null),a([l({types:Jh,value:null})],D.prototype,"geometry",null),a([l({type:[Vr]})],D.prototype,"lods",void 0),a([l()],D.prototype,"minScale",void 0),a([l()],D.prototype,"maxScale",void 0),a([l()],D.prototype,"minZoom",void 0),a([l()],D.prototype,"maxZoom",void 0),a([l()],D.prototype,"rotationEnabled",void 0),a([l()],D.prototype,"snapToZoom",void 0),a([l({type:R})],D.prototype,"customConstraints",void 0),a([l()],D.prototype,"view",void 0),a([l({readOnly:!0})],D.prototype,"version",null),a([l({type:qt,readOnly:!0})],D.prototype,"_geometry",null),a([l({type:ia})],D.prototype,"_rotation",null),a([l({readOnly:!0,type:na})],D.prototype,"_zoom",null),D=a([v("esri.views.2d.MapViewConstraints")],D);const Po=D;let N=class extends x{constructor(t){super(t),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([_(()=>this.constraints?.version,e=>{this.constraints&&e&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},Ve)])}get center(){if(!this.ready)return this._get("center");const{center:t,spatialReference:e}=this.state.paddedViewState;return this.state.commitProperty("id"),new L({x:t[0],y:t[1],spatialReference:e})}set center(t){if(t==null)return;if(!this.ready)return void this._set("center",t);let e;try{e=this._project(t,this.state.spatialReference)}catch(n){return void C.getLogger(this).error(new E("mapview:invalid-center","could not project the value in the view's spatial reference",{input:t,error:n}))}const i=this.viewpoint;pn(i,i,e),this.viewpoint=i}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(t){if(t==null)return;if(!t.width||!t.height)return void C.getLogger(this).error(new E("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",t),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let e;try{e=this._project(t,this.state.spatialReference)}catch(n){return void C.getLogger(this).error(new E("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:n}))}const i=this.viewpoint;Lh(i,i,e,this.state.size,{constraints:this.constraints}),this.viewpoint=i}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(t){this.ready?(this.state.padding=t,this._set("padding",this.state.padding)):this._set("padding",t)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(t){if(isNaN(t))return;if(!this.ready)return void this._set("rotation",t);const e=this.viewpoint;Wh(e,e,t),this.viewpoint=e}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(t){if(!t||isNaN(t))return;if(!this.ready){this._set("scale",t),this._set("zoom",void 0);const i=this._get("extent");return void(i&&(this._set("extent",void 0),this._set("center",i.center)))}const e=this.viewpoint;To(e,e,t),this.viewpoint=e}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(t){if(t==null)return;if(!this.ready)return this._set("viewpoint",t),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let e,i;try{e=this._project(t,this.state.spatialReference),!t.scale||isNaN(t.scale)?i=new E("mapview:invalid-viewpoint",`invalid scale value of ${t.scale}`):t.targetGeometry==null&&(i=new E("mapview:invalid-viewpoint","geometry not defined"))}catch(o){i=new E("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:o})}if(i)return void C.getLogger(this).error(i);this._scaleBeforeChangingSpatialReference=null;const n=new it({targetGeometry:new L,scale:0,rotation:0});Z(n,e),this.constraints?.constrain(n,this.state.paddedViewState.viewpoint),this.state.viewpoint=n,this._set("viewpoint",n)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){return this.ready?this.constraints?.scaleToZoom(this.scale)??-1:this._get("zoom")}set zoom(t){if(!(t>=0))return;if(!this.ready){this._set("zoom",t),this._set("scale",void 0);const n=this._get("extent");return void(n&&(this._set("extent",void 0),this._set("center",n.center)))}const e=this.constraints?.zoomToScale(t)??0;if(!e)return void this._set("zoom",-1);const i=this.viewpoint;To(i,i,e),this.viewpoint=i,this._set("zoom",this.constraints?.scaleToZoom(this.scale)??-1)}getUserStartupOptions(t){if(!t[0]&&!t[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:e,constraints:i}=this,n=this._get("center"),o=this._get("extent"),s=this._get("scale"),r=this._get("rotation"),h=this._get("viewpoint"),c=this._get("zoom"),p=c!=null&&i!=null&&i.zoomToScale(c)||void 0;let d,m,u;const g=h?.rotation,y=h?.targetGeometry;y?.type==="extent"?d=y:y?.type==="point"&&(m=y,u=h?.scale);const w=o??d;return{center:n??m??w?.center,rotation:r??g,scale:(s??p??u??(w&&Ri(w,[t[0]-e.left-e.right,t[1]-e.top-e.bottom])))||void 0}}startup(t,e,i,n){const o=t.targetGeometry;try{this._project(t,i)}catch(s){C.getLogger(this).warn(new Yn("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:o.toJSON(),spatialReference:i,error:s})),t.targetGeometry=n||new L({x:0,y:0,spatialReference:i})}this.constraints?.fit(t),this._set("state",new Zn({padding:this.padding,size:e,viewpoint:t})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[t,e],spatialReference:i,rotation:n,scale:o}=this.state.paddedViewState,s=new L({x:t,y:e,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",s),this._set("zoom",-1),this._set("rotation",n),this._set("scale",o),this._set("state",null)}changeSpatialReference(t){const e=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=e.scale;else{const h=e.viewpoint.clone();h.scale=this._scaleBeforeChangingSpatialReference,e.viewpoint=h}const i=e.clone(),[n,o]=e.center;let s=null;try{s=this._project(new L({x:n,y:o,spatialReference:e.spatialReference}),t)}catch(h){pr()||C.getLogger(this).warn(new Yn("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:s?.toJSON(),spatialReference:t,error:h}))}s||(s=new L({x:0,y:0,spatialReference:t}));const r=pn(new it({targetGeometry:new L,scale:0,rotation:0}),e.viewpoint,s);i.viewpoint=r;try{const h=[e.size[0]/2,e.size[1]/2],c=[h[0]+20,h[1]],p=e.toMap([0,0],c),{x:d,y:m}=this._project(new L({x:p[0],y:p[1],spatialReference:e.spatialReference}),t);p[0]=d,p[1]=m,i.toScreen(p,p);const u=Hh(h,p,c),g=Math.hypot(p[0]-h[0],p[1]-h[1])/20;!Number.isFinite(g)||Math.abs(g)>4?(r.rotation=0,r.targetGeometry=new L({x:0,y:0,spatialReference:t})):(r.scale*=g,r.scale>F("mapview-srswitch-adjust-rotation-scale-threshold")?r.rotation=0:r.rotation+=Number.isFinite(u)?u:0)}catch{}this._get("constraints")?.constrain(r,void 0),this._get("state").viewpoint=r}resize(t,e){if(!this.ready)return;const i=this.state;let n=this.state.paddedViewState.viewpoint;const o=this.state.paddedViewState.size.slice();i.size=[t,e],Gh(n,n,o,this.state.paddedViewState.size,this.resizeAlign),n=this.constraints?.constrain(n,void 0)??n,this.state.viewpoint=n}toMap(t){if(!this.ready)return null;const e=[0,0],[i,n]=this.state.toMap(e,[t.x,t.y]),o=this.state.spatialReference;return new L({x:i,y:n,spatialReference:o})}toScreen(t,e){if(!this.ready)return null;const i=this._project(t,this.state.spatialReference),n=[i.x,i.y];return e?.pickClosestTarget===!1||this.state.paddedViewState.wrapMapCoordinate(n,n),this.state.toScreen(n,n),j(n[0],n[1])}_project(t,e){const i=t?.targetGeometry||t;if(!e)return t;if(!i)return null;if(e.imageCoordinateSystem||i.spatialReference?.imageCoordinateSystem||wi(e,i.spatialReference))return t;const n=Ti(i,e);if(!n)throw new E("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:i,spatialReference:e});return tc(t)?(t.targetGeometry=n,t):n}};function tc(t){return t?.declaredClass==="esri.Viewpoint"}a([l({type:L})],N.prototype,"center",null),a([l()],N.prototype,"constraints",void 0),a([l({type:Qt})],N.prototype,"extent",null),a([l({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],N.prototype,"padding",null),a([l()],N.prototype,"ready",void 0),a([l()],N.prototype,"resizeAlign",void 0),a([l({readOnly:!0})],N.prototype,"resolution",null),a([l({type:Number})],N.prototype,"rotation",null),a([l({type:Number})],N.prototype,"scale",null),a([l({readOnly:!0})],N.prototype,"state",void 0),a([l({type:it})],N.prototype,"viewpoint",null),a([l({readOnly:!0})],N.prototype,"visibleArea",null),a([l()],N.prototype,"zoom",null),N=a([v("esri.views.2d.ViewStateManager")],N);const ko=160;let Pe=class extends x{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval(()=>{performance.now()-this._timestamp>=ko&&this.clear()},ko))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};a([l()],Pe.prototype,"_timer",void 0),a([l()],Pe.prototype,"stationary",null),Pe=a([v("esri.views.2d.support.StationaryManager")],Pe);const ec=t=>{let e=class extends t{constructor(...i){super(...i),this.fullOpacity=1,this.stateManager=new N({constraints:new Po({view:this})}),this.stationaryManager=new Pe,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!1,labelsAnimationTime:0,labelCollisionsEnabled:!1},this.frameTask=new Yh(this),this.viewEvents=new Ws(this),this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([_(()=>this.viewpoint,()=>this.stationaryManager.flip(),Ve)])}get constraintsInfo(){return{lods:null,spatialReference:null}}get extent(){return this.stateManager?.extent??null}set extent(i){this.stateManager.extent=i}get state(){return this.stateManager.state}get interacting(){return!1}get stationary(){return!this.animation&&this.stationaryManager.stationary}set animation(i){const n=this._get("animation");if(i===n)return;if(n&&n.stop(),i!==this.animationManager.animation&&this.animationManager.stop(),!i||i.isFulfilled())return void this._set("animation",null);this._set("animation",i);const o=()=>{this.destroyed||i===this._get("animation")&&(this._set("animation",null),this.frameTask?.requestFrame())};i.when(o,o)}get constraints(){return this.stateManager?.constraints}set constraints(i){i.view=this;const n=this.stateManager.constraints;this.stateManager.constraints=i,n?.destroy()}get padding(){return this.stateManager?.padding}set padding(i){this.stateManager&&(this.stateManager.padding=i)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(i){this.stateManager.resizeAlign=i}get rotation(){return this.stateManager.rotation??0}set rotation(i){const{rotationEnabled:n}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=i,this.constraints.rotationEnabled=n}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(i){this.stateManager.viewpoint=i,this.frameTask.requestFrame()}};return a([l({readOnly:!0})],e.prototype,"animationManager",void 0),a([l({readOnly:!0})],e.prototype,"fullOpacity",void 0),a([l()],e.prototype,"stateManager",void 0),a([l()],e.prototype,"constraintsInfo",null),a([l()],e.prototype,"extent",null),a([l({readOnly:!0})],e.prototype,"state",null),a([l({readOnly:!0})],e.prototype,"mapViewNavigation",void 0),a([l()],e.prototype,"renderingOptions",void 0),a([l({readOnly:!0})],e.prototype,"interacting",null),a([l()],e.prototype,"stationary",null),a([l()],e.prototype,"animation",null),a([l({type:Po})],e.prototype,"constraints",null),a([l()],e.prototype,"padding",null),a([l()],e.prototype,"resizeAlign",null),a([l()],e.prototype,"rotation",null),a([l({readOnly:!0})],e.prototype,"viewEvents",void 0),a([l({type:it})],e.prototype,"viewpoint",null),e=a([v("esri.views.Viewport2DBaseMixin")],e),e};let Dt=class extends gs{constructor(t){super(t),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=xi(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),this._resolver?.reject(new E("view:animation-stopped","ViewAnimation stopped")))}finish(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),this._resolver?.resolve())}update(t,e){e||(e=xs(t)?"waiting-for-target":"running"),this._set("target",t),this._set("state",e)}};a([l({readOnly:!0})],Dt.prototype,"done",null),a([l({readOnly:!0,type:String})],Dt.prototype,"state",void 0),a([l()],Dt.prototype,"target",void 0),Dt=a([v("esri.views.ViewAnimation")],Dt),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(Dt||(Dt={}));const vn=Dt;let ti=class extends x{constructor(t){super(t),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(t,e){if(!t)return void C.getLogger(this).error("#goTo()","target cannot be null or undefined");const i=new vn;this.view.animation=i,await kn(()=>this.view.ready,e);const n={...e,animate:e?.animate??!Ls(),animationMode:e?.animationMode??"auto"},{extent:o,spatialReference:s,size:r,viewpoint:h,constraints:c,padding:p,allLayerViews:d}=this.view,m=Rh(t,{extent:o,spatialReference:s,size:r,viewpoint:h,constraints:c,padding:p,allLayerViews:d,pickClosestTarget:e?.pickClosestTarget??!0});return i?.update(m),this._gotoTask={},n.animate?this._gotoAnimated(m,n):this._gotoImmediate(m,n)}_gotoImmediate(t,e){const i=this._gotoTask,n=this.view.animation,o=t.then(s=>{if(Bt(e),i!==this._gotoTask)throw new E("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=n.target=s,n.finish()});return this._cancellableGoTo(i,n,o,e)}_gotoAnimated(t,e){const i=this._gotoTask,n=this.view.animation;if(!n)return Promise.resolve();const o=t.then(s=>{if(Bt(e),i!==this._gotoTask)throw new E("view:goto-interrupted","Goto was interrupted");return n.update(s),this.view.animationManager.animate(n,this.view.viewpoint,e),n.when().then(()=>{},()=>{})});return this._cancellableGoTo(i,n,o,e)}_cancellableGoTo(t,e,i,n){const o=()=>t===this._gotoTask;return dr(i,n).finally(()=>{o()&&(e.done||e.stop())})}};a([l({constructOnly:!0})],ti.prototype,"view",void 0),ti=a([v("esri.views.2d.GoToManager")],ti);function oa(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}function sa(t,e){return e.some(i=>oa(t,i))}function Co(t,{dragPrimary:e,dragSecondary:i,dragTertiary:n}){return[{key:"primary",value:e},{key:"secondary",value:i},{key:"tertiary",value:n}].filter(o=>o.value===t).map(o=>o.key)}let Eo=class extends A{constructor(t,e){super(!0),this._view=t,this.registerIncoming("double-click",e,i=>this._handleDoubleClick(i,e))}_handleDoubleClick(t,e){oa(t.data,"primary")&&(t.stopPropagation(),e?this._view.mapViewNavigation.zoomOut([t.data.x,t.data.y]):this._view.mapViewNavigation.zoomIn([t.data.x,t.data.y]))}},ic=class extends A{constructor(t,e,i){super(!0),this.view=t,this.pointerType=e,this.registerIncoming("double-tap-drag",i,n=>this._handleDoubleTapDrag(n))}_handleDoubleTapDrag(t){const{data:e}=t,{pointerType:i}=e;if(i!==this.pointerType)return;t.stopPropagation();const{action:n,delta:o}=e,{view:s}=this,{mapViewNavigation:r}=s;switch(n){case"begin":{const{scale:h}=s;this._startScale=h,this._currentScale=h,this._previousDelta=o,r.begin();break}case"update":{if(this._previousDelta.y===o.y)return;this._previousDelta=o;const h=1.015**o.y,c=this._startScale*h,p=c/this._currentScale;r.setViewpointImmediate(p),this._currentScale=c;break}case"end":{const{constraints:h}=s,{effectiveLODs:c,snapToZoom:p}=h;if(!p||!c)return void r.end();const d=h.snapScale(this._currentScale),m=(o.y>0?Math.max(d,h.snapToPreviousScale(this._startScale)):Math.min(d,h.snapToNextScale(this._startScale)))/this._currentScale;r.zoom(m).then(()=>{r.end()});break}}}},Di=class{constructor(t){this._callbacks=t,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(t){const e=t.data,i=e.pointers.size;switch(e.action){case"start":this._currentCount=i,this._emitStart(t);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(t);break;case"update":this._emitUpdate(t);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(t);break;case"end":this._emitEnd(t),this._currentCount=0}this._previousEvent=t}_emitStart(t){this._startEvent=t,this._callbacks.condition?.(this._currentCount,t)&&this._callbacks.start(this._currentCount,t,this._startEvent)}_emitUpdate(t){this._callbacks.condition?.(this._currentCount,t)&&this._callbacks.update(this._currentCount,t,this._startEvent)}_emitEnd(t){this._callbacks.condition?.(this._currentCount,t)&&this._callbacks.end(this._currentCount,t,this._startEvent),this._startEvent=null}},nc=class extends A{constructor(t,e,i){super(!0),this.view=t,this.pointerActions=e,this.registerIncoming("drag",i,n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(t){super.onInstall(t),this._dragEventSeparator=new Di({start:(e,i)=>{this.view.mapViewNavigation.pan.begin(this.view,i.data),i.stopPropagation()},update:(e,i)=>{this.view.mapViewNavigation.pan.update(this.view,i.data),i.stopPropagation()},end:(e,i)=>{this.view.mapViewNavigation.pan.end(this.view,i.data),i.stopPropagation()},condition:(e,i)=>e===1&&sa(i.data,this.pointerActions)})}_handleDrag(t){const e=this.view.mapViewNavigation;e.pinch.zoomMomentum||e.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(t)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},oc=class extends A{constructor(t,e,i){super(!0),this._view=t,this.pointerActions=e;const n=this._view.mapViewNavigation;this._dragEventSeparator=new Di({start:(o,s)=>{n.rotate.begin(this._view,s.data),s.stopPropagation()},update:(o,s)=>{n.rotate.update(this._view,s.data),s.stopPropagation()},end:(o,s)=>{n.rotate.end(),s.stopPropagation()},condition:(o,s)=>o===1&&sa(s.data,this.pointerActions)}),this.registerIncoming("drag",i,o=>this._dragEventSeparator.handle(o))}};function st(t){let e=t*t;return t<0&&(e*=-1),e}function sc(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function ac(t,e,i){const n=i,o=t.state,s=t.device,r=e.tiltDirection==="forward-down"?1:-1,h=1;return s.deviceType==="standard"?(n.translation[0]=st(o.axes[0]),n.translation[1]=st(o.axes[1]),n.translation[2]=st(o.buttons[7])-st(o.buttons[6]),n.heading=st(o.axes[2]),n.tilt=st(o.axes[3])):s.deviceType==="spacemouse"&&(n.translation[0]=1.2*st(o.axes[0]),n.translation[1]=1.2*st(o.axes[1]),n.translation[2]=2*-st(o.axes[2]),n.heading=1.2*st(o.axes[5]),n.tilt=1.2*st(o.axes[3])),n.tilt*=r,_l(n.translation,n.translation,h),n}function rc(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}let lc=class extends A{constructor(t){super(!0),this._view=t,this._frameTask=null,this._watchHandles=new ys,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",e=>this._handleGamePadEvent(e)),this._handle.pause()}onInstall(t){super.onInstall(t),this._watchHandles.add([_(()=>this._view.navigation.gamepad?.enabled,e=>{e?(this._handle.resume(),this._frameTask||(this._frameTask=me({update:i=>this._frameUpdate(i.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},G)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(t){const e=this._view.navigation.gamepad.device;e&&t.data.device!==e||this._currentDevice&&this._currentDevice!==t.data.device||(t.data.action==="end"?(this._currentDevice=null,sc(this._transformation)):(this._currentDevice=t.data.device,ac(t.data,this._view.navigation.gamepad,this._transformation)),this._frameTask?.resume())}_frameUpdate(t){const e=this._transformation;if(rc(e))return void this._frameTask?.pause();const i=this._view.viewpoint.clone(),n=this._view.navigation.gamepad.velocityFactor,o=cc*n*t;Ii(i,i,[e.translation[0]*o,-e.translation[1]*o]);const s=1+e.translation[2]*pc*t,r=this._view.constraints.rotationEnabled?-e.heading*hc*t:0,h=this._view.size,c=[h[0]/2,h[1]];Js(i,i,s,r,c,h);const p=this._view.constraints.constrain(i,this._view.viewpoint);this._view.viewpoint=p}};const hc=.06,cc=.7,pc=6e-4;function aa(t){const e=()=>t(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),Mi(()=>document.removeEventListener("visibilitychange",e))}let dc=class extends A{constructor(t,e,i){super(!0),this.view=t,this.keys=e,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=n=>{const o=this._keyMap[n.data.key];if(n.modifiers.has("Meta")||n.modifiers.has("Control"))return void this._stopMovement();if(o==null)return;n.stopPropagation(),n.preventDefault();const s=n.type==="key-down";if(this._pressedKeys[s?"add":"delete"](o),s){if(this._direction===o)return;this._direction=o,this._isSticky=!1,this._setTimeout(()=>{this._isSticky&&this._handlePopKey()})}else{const r=this._timeout===void 0,h=this._pressedKeys.size>0;r||h?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[e.left]:"left",[e.right]:"right",[e.up]:"up",[e.down]:"down"},this.registerIncoming("key-down",i,this._handleKey),this.registerIncoming("key-up",i,this._handleKey),this.registerIncoming("blur",i,this._stopMovement),this._visibilityHandle=aa(n=>n?null:this._stopMovement())}onUninstall(){this._stopMovement(),this._visibilityHandle?.remove()}get _direction(){return this._currentDirection}set _direction(t){const e=this._currentDirection!=null;if(t!=null){if(e||this.view.mapViewNavigation.begin(),this._currentDirection!==t)switch(t){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else e&&this.view.mapViewNavigation.stop();this._currentDirection=t}_setTimeout(t){clearTimeout(this._timeout),this._timeout=t===void 0?void 0:setTimeout(()=>{this._timeout=void 0,t()},this._stickyKeyDuration)}},uc=class extends A{constructor(t,e,i){super(!0),this.view=t,this.keys=e,this._keyToDirection=new Map,this._pressed=!1,this._addKeysMapping(e),this.registerIncoming("key-down",i,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",i,n=>this._handleKeyUp(n)),this.registerIncoming("blur",i,()=>this._handleStop()),this._visibilityHandle=aa(n=>n?null:this._handleStop())}onUninstall(){this._visibilityHandle?.remove(),this._handleStop()}_addKeysMapping(t){this._addKeyMapping(t.clockwise,"clockwise"),this._addKeyMapping(t.counterClockwise,"counterClockwise"),this._addKeyMapping(t.reset,"reset")}_addKeyMapping(t,e){for(const i of t)this._keyToDirection.set(i,e)}_handleKeyDown(t){t.data.repeat||this._handleKey(t,!0)}_handleKeyUp(t){this._handleKey(t,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(t,e){const i=t.modifiers;if(i.size>0&&!i.has("Shift")||!this.view.constraints.rotationEnabled)return;const n=this._keyToDirection.get(t.data.key);if(this._pressed=n!=null,this._pressed){if(t.preventDefault(),e)switch(this.view.mapViewNavigation.begin(),n){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();t.stopPropagation()}}};var ue;(function(t){t[t.IN=0]="IN",t[t.OUT=1]="OUT"})(ue||(ue={}));let mc=class extends A{constructor(t,e,i){super(!0),this.view=t,this.keys=e,this._keysToZoomAction={},this.registerIncoming("key-down",i,n=>this._handleKeyDown(n)),e.zoomIn.forEach(n=>this._keysToZoomAction[n]=ue.IN),e.zoomOut.forEach(n=>this._keysToZoomAction[n]=ue.OUT)}_handleKeyDown(t){this._handleKey(t)}_handleKey(t){const e=t.modifiers;if(e.size>0&&!e.has("Shift"))return;const{key:i}=t.data;if(!(i in this._keysToZoomAction))return;const n=this._keysToZoomAction[i],{mapViewNavigation:o}=this.view;let s=null;switch(n){case ue.IN:s=o.zoomIn();break;case ue.OUT:s=o.zoomOut();break;default:return}o.begin(),s.then(()=>o.end()),t.stopPropagation()}};const gc=.6;let yc=class extends A{constructor(t,e){super(!0),this._view=t,this._canZoom=!0,this.registerIncoming("mouse-wheel",e,i=>this._handleMouseWheel(i))}_handleMouseWheel(t){if(this._view.navigation.actionMap.mouseWheel!=="zoom"||(t.preventDefault(),t.stopPropagation(),!this._canZoom))return;const e=this._view.mapViewNavigation,{x:i,y:n,deltaY:o}=t.data,s=1/gc**(1/60*o),r=e.zoom(s,[i,n]);r&&(this._canZoom=!1,r.catch(()=>{}).then(()=>{this._canZoom=!0,e.end()}))}},fc=class extends A{constructor(t){super(!0),this.view=t,this.registerIncoming("drag",i=>this._handleDrag(i)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const e=this.view.mapViewNavigation;this._dragEventSeparator=new Di({start:(i,n)=>{e.pinch.begin(this.view,n.data),n.stopPropagation()},update:(i,n)=>{e.pinch.update(this.view,n.data),n.stopPropagation()},end:(i,n)=>{e.pinch.end(this.view),n.stopPropagation()},condition:i=>i>=2})}_handleDrag(t){this._dragEventSeparator.handle(t)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function Vo(t){const e=t.native;return e?{buttons:e.buttons.map(i=>i.pressed?i.value||1:0),axes:e.axes.map(i=>wc(i,t.axisThreshold))}:{buttons:[],axes:[]}}function vc(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let i=0;i<t.axes.length;i++)if(t.axes[i]!==e.axes[i])return!1;for(let i=0;i<t.buttons.length;i++)if(t.buttons[i]!==e.buttons[i])return!1;return!0}function _c(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function wc(t,e){const i=Math.abs(t);return i<e?0:Math.sign(t)*(i-e)/(1-e)}let bc=class{constructor(t,e){this._element=t,this._input=e,this._hasEventListeners=!1,this._onConnectGamepad=o=>{this._connectGamepad(o.gamepad)},this._onDisconnectGamepad=o=>{const s=o.gamepad,r=s.index,h=this._inputDevices[r];h&&(this._emitGamepadEvent(s,Vo(h),!1),this._inputDevices.splice(r,1),this._latestUpdate.splice(r,1),this._input.gamepad.devices.remove(h),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const i="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=i&&n,this.supported&&(Ro(o=>this._connectGamepad(o)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(t){this._hasEventListeners!==t&&(this._hasEventListeners=t,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(t){this._callback=t}_connectGamepad(t){const e=new Ln(t);e.deviceType!=="unknown"&&(this._inputDevices[t.index]=e,this._input.gamepad.devices.add(e)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=me({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const t=document.hasFocus(),e=this._element.contains(document.activeElement),i=this._input.gamepad.enabledFocusMode==="document"&&!t||this._input.gamepad.enabledFocusMode==="view"&&!e;Ro(n=>{const o=this._inputDevices[n.index];if(!o)return;const s=this._latestUpdate[n.index],r=Vo(o),h=i||_c(r);s&&(s.timestamp===n.timestamp||!s.active&&h||vc(s.state,r))||this._emitGamepadEvent(n,r,!h)})}_emitGamepadEvent(t,e,i){const n=this._latestUpdate[t.index],o=n&&n.active;if(!o&&!i)return;const s=!o&&i?"start":o&&i?"update":"end";this._latestUpdate[t.index]={timestamp:t.timestamp,state:e,active:i},this._callback&&this._callback({device:this._inputDevices[t.index],state:e,action:s})}};function Mc(t){if(!t||!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}function Ro(t){for(const e of navigator.getGamepads())Mc(e)&&t(e)}const Io=F("edge"),xc=F("chrome"),Tc=F("ff"),Sc=F("safari"),Do="esri-view-surface",ie={touchNone:`${Do}--touch-none`,touchPan:`${Do}--touch-pan`};let Pc=class ra{static{this.test={disableSubpixelCoordinates:!1}}constructor(e,i){this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new bc(e,i),this._gamepadSource.onEvent=n=>this._callback("gamepad",n)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>this._releasePointerCaptureSafe(e)),this._activePointerCaptures.clear(),this._gamepadSource=at(this._gamepadSource),this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const i in this._active)if(!e||!e.has(i)){const n=this._active[i];this._element.removeEventListener(Ui[i],n),delete this._active[i]}e&&e.forEach(i=>{if(!this._active[i]&&Ui[i]){const n=(this._eventHandlers[i]||this._handleDefault).bind(this,i);this._element.addEventListener(Ui[i],n),this._active[i]=n}}),this._gamepadSource&&(this._gamepadSource.hasEventListeners=e?.has("gamepad")??!1)}setPointerCapture(e,i){i?this._setPointerCaptureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?ie.touchNone:ie.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?ie.touchPan:ie.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(ie.touchNone),this._element.classList.remove(ie.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCaptureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,i){const n=zr(this._element,e);return ra.test.disableSubpixelCoordinates&&(n.x=Math.round(n.x),n.y=Math.round(n.y)),i.x=n.x,i.y=n.y,i}_handleKey(e,i){const{key:n}=i;n&&e==="key-up"&&this._keyDownState.delete(n);const o={native:i,key:n,repeat:!!n&&this._keyDownState.has(n)};n&&e==="key-down"&&this._keyDownState.add(o.key),this._callback(e,o)}_handlePointer(e,i){const n=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});this._callback(e,n)}_handlePointerPreventDefault(e,i){const n=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});i.preventDefault(),this._callback(e,n)}_getDeltaFromTrackpadOrMouseWheel(e){return e.shiftKey&&F("mac")&&e.deltaY===0?e.deltaX:e.deltaY}_handleMouseWheel(e,i){let n=this._getDeltaFromTrackpadOrMouseWheel(i);switch(i.deltaMode){case 0:Io&&(n=n/document.documentElement.clientHeight*600);break;case 1:n*=30;break;case 2:n*=900}Io?n*=.7:xc||Sc?n*=.6:Tc&&(n*=1.375);const o=100,s=Math.abs(n);s>o&&(n=n/s*200/(1+Math.exp(-.02*(s-o))));const r=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,deltaY:n});this._callback(e,r)}_handlePointerCaptureLost(e,i){this._activePointerCaptures.delete(i.pointerId),this._handleDefault(e,i)}_handleDefault(e,i){const n={native:i};i.preventDefault(),this._callback(e,n)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};const Ui={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let kc=class extends A{constructor(){super(!0),this.registerIncoming("context-menu",t=>t.data.native.preventDefault())}};const la=()=>({maximumClickDelay:300}),Cc=(t={})=>({...la(),movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,...t}),Hn=(t={})=>({...la(),maximumDoubleClickDistance:10,maximumDoubleTouchDistance:35,maximumDoubleClickDelay:250,maximumDoubleTouchDelay:350,...t});function li(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function Ec(t,e){const i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)}function Vc(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:j()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[P,T]=t,[H,B]=[T.x-P.x,T.y-P.y];return e.radius=Math.sqrt(H*H+B*B)/2,e.center.x=(P.x+T.x)/2,e.center.y=(P.y+T.y)/2,e}let i=0,n=0;for(let P=0;P<t.length;P++)i+=t[P].x,n+=t[P].y;i/=t.length,n/=t.length;const o=t.map(P=>P.x-i),s=t.map(P=>P.y-n);let r=0,h=0,c=0,p=0,d=0,m=0,u=0;for(let P=0;P<o.length;P++){const T=o[P],H=s[P],B=T*T,ut=H*H;r+=B,h+=ut,c+=T*H,p+=B*T,d+=ut*H,m+=T*ut,u+=H*B}const g=.5*(p+m),y=.5*(d+u),w=r*h-c*c,I=(g*h-y*c)/w,V=(r*y-c*g)/w,lt=j(I+i,V+n);return{radius:Math.sqrt(I*I+V*V+(r+h)/t.length),center:lt}}function Kt(t){const{native:e}=t,{pointerId:i,button:n,pointerType:o}=e;return o==="mouse"?`${i}:${n}`:`${o}`}let Rc=class extends A{constructor(t={},e=Oe){super(!1),this._clock=e,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=j(0,0),this._pointerState=new Map,this._parameters=Hn(t),this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new Di({start:(i,n)=>this._dragStart(i,n),update:(i,n)=>this._dragUpdate(n),end:(i,n)=>this._dragEnd(n)}),this.registerIncoming("drag",i=>this._dragEventSeparator.handle(i)),this.registerIncoming("pointer-down",i=>this._handlePointerDown(i)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(t=>{t.doubleTapTimeout=rt(t.doubleTapTimeout)})}get hasPendingInputs(){for(const t of this._pointerState.values())if(t.doubleTapTimeout!=null)return!0;return!1}_clearPointerDown(t){const e=this._pointerState.get(t);e&&(e.doubleTapTimeout=rt(e.doubleTapTimeout),this._pointerState.delete(t),this.refreshHasPendingInputs())}_dragStart(t,e){if(!this._doubleTapDragReady||t!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:i,modifiers:n}=e,{center:o}=i;this._dragStartCenter=o;const s=Bi("begin",j(0,0),i);this._doubleTapDrag.emit(s,void 0,n),e.stopPropagation()}_dragUpdate(t){if(!this._doubleTapDragActive)return;const{data:e,modifiers:i}=t,{center:n}=e,o=Bi("update",j(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),e);this._doubleTapDrag.emit(o,void 0,i),t.stopPropagation()}_dragEnd(t){if(!this._doubleTapDragActive)return;const{data:e,modifiers:i}=t,{center:n}=e,o=Bi("end",j(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),e);this._doubleTapDrag.emit(o,void 0,i),this._doubleTapDragActive=!1,t.stopPropagation()}_handlePointerDown(t){const{data:e}=t,i=Kt(e),n=this._pointerState.get(i),{pointerType:o}=e.native;if(n){const s=o==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;this._clearPointerDown(i),li(n.event.data,e)>s?this._storePointerDown(t):this._doubleTapDragReady=!0}else this._storePointerDown(t)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(t){const{data:e}=t,{pointerType:i}=e.native,n=Kt(e),o=i==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,s=this._clock.setTimeout(()=>this._clearPointerDown(n),o);this._pointerState.set(n,{event:t,doubleTapTimeout:s}),this.refreshHasPendingInputs()}};function Bi(t,e,i){const{button:n,buttons:o,pointer:s,pointers:r,pointerType:h,timestamp:c}=i;return{action:t,delta:e,button:n,buttons:o,pointer:s,pointers:r,pointerType:h,timestamp:c}}let Ic=class extends A{constructor(t){super(!1),this._navigationTouch=t,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(t,e,i,n){return{action:t,pointerType:this._pointerType,button:this._mouseButton,buttons:e.buttons,timestamp:n,pointers:Dc(this._activePointerMap),pointer:e,angle:i.angle,radius:i.radius,center:i.center}}_addPointer(t){const e=t.native.pointerId,i=je(this._activePointerMap).angle,n={event:t,initialAngle:0,lastAngle:0};this._activePointerMap.set(e,n);const o=ei(n,ha(this._activePointerMap));n.initialAngle=o,n.lastAngle=o,this._updatePointerAngles(i)}_updatePointer(t){if(t&&t.x==null&&t.y==null)return;const e=t.native.pointerId,i=this._activePointerMap.get(e);i?i.event=t:this._addPointer(t)}_removePointer(t){const e=je(this._activePointerMap).angle;this._activePointerMap.delete(t),this._updatePointerAngles(e)}_updatePointerAngles(t){const e=je(this._activePointerMap);this._activePointerMap.forEach(i=>{i.initialAngle=ei(i,e)-t,i.lastAngle=ei(i,e)-t})}_emitEvent(t,e,i){const n=je(this._activePointerMap);this._drag.emit(this._createPayload(t,e,n,i),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(t){const e=t.data.native.pointerId,i=et(t.timestamp);this._activePointerMap.get(e)&&(this._activePointerMap.size===1?(this._updatePointer(t.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",t.data,i),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(e)):(this._removePointer(e),this._emitEvent("removed",t.data,et(t.timestamp))))}_handlePointerDrag(t){const e=t.data,i=e.currentEvent,n=et(t.timestamp);switch(e.action){case"start":case"update":this._isDragging?this._activePointerMap.has(i.native.pointerId)?(this._updatePointer(i),!this._isCurrentDragSuppressed&&this._emitEvent("update",i,n)):(this._addPointer(i),this._emitEvent("added",i,n),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(i),this._pointerType=t.data.startEvent.pointerType,this._mouseButton=t.data.startEvent.button,this._startStateModifiers=t.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",i,n))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function ha(t){const e=[];return t.forEach(i=>{e.push(j(i.event.x,i.event.y))}),Vc(e)}function je(t){const e=ha(t);let i=0;return t.forEach(n=>{let o=ei(n,e),s=o-n.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;o=n.lastAngle+s,n.lastAngle=o;const r=o-n.initialAngle;i+=r}),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function Dc(t){const e=new Map;return t.forEach((i,n)=>e.set(n,i.event)),e}function ei(t,e){const i=t.event,n=i.x-e.center.x,o=i.y-e.center.y;return Math.atan2(o,n)}var Lo;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined"})(Lo||(Lo={}));let Lc=class extends A{constructor(t={},e=Oe){super(!1),this._clock=e,this._pointerState=new Map,this._parameters=Hn(t),this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(t=>{t.immediateDoubleClick&&t.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(t){const e=t.data,i=Kt(e);if(!this._pointerState.has(i)){const n={downButton:e.native.button,x:e.x,y:e.y,immediateDoubleClick:null};this._pointerState.set(i,n),this.startCapturingPointer(e.native)}}_handlePointerUp(t){const e=t.data,i=Kt(e),n=this._pointerState.get(i);if(n&&n.downButton===e.native.button){const o=n.immediateDoubleClick,s=t.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;o?(o.timeoutHandle.remove(),li(o,t.data)>s?this._startImmediateDoubleClick(t,n):(this._immediateDoubleClick.emit(t.data,void 0,o.modifiers),this._removeState(e))):li(n,t.data)>s?this._removeState(e):this._startImmediateDoubleClick(t,n)}}_startImmediateDoubleClick(t,e){const i=t.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay;e.immediateDoubleClick={x:t.data.x,y:t.data.y,modifiers:t.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(t.data),i)}}_removeState(t){const e=Kt(t);this._pointerState.delete(e),this.stopCapturingPointer(t.native),this.refreshHasPendingInputs()}},Oc=class extends A{constructor(t={},e=Oe){super(!1),this._clock=e,this._pointerState=new Map,this._parameters=Cc(t),this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",i=>this._handlePointerDown(i)),this.registerIncoming("pointer-up",i=>this._handlePointerLoss(i,"pointer-up")),this.registerIncoming("pointer-capture-lost",i=>this._handlePointerLoss(i,"pointer-capture-lost")),this.registerIncoming("pointer-cancel",i=>this._handlePointerLoss(i,"pointer-cancel")),this._moveHandle=this.registerIncoming("pointer-move",i=>this._handlePointerMove(i)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(t=>{t.holdTimeout=rt(t.holdTimeout)}),super.onUninstall()}_handlePointerDown(t){const e=t.data,i=e.native.pointerId;let n=null;this._pointerState.size===0&&(n=this._clock.setTimeout(()=>{const s=this._pointerState.get(i);if(s){if(!s.isDragging){const r=s.previousEvent;this._pointerHold.emit(r,void 0,t.modifiers),s.holdEmitted=!0}s.holdTimeout=null}},this._parameters.holdDelay));const o={startEvent:e,previousEvent:e,startTimestamp:t.timestamp,isDragging:!1,downButton:e.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(i,o),this.startCapturingPointer(e.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(t)}_handlePointerMove(t){const e=t.data,i=e.native.pointerId,n=this._pointerState.get(i);n&&(n.isDragging?this._pointerDrag.emit(Ue("update",n,e),void 0,n.modifiers):Ec(e,n.startEvent)>this._getDragThreshold(e.native.pointerType)&&this._startDragging(t),n.previousEvent=e)}_getDragThreshold(t){switch(t){case"touch":return this._parameters.movementUntilTouchDrag;case"pen":return this._parameters.movementUntilPenDrag;default:return this._parameters.movementUntilMouseDrag}}_startDragging(t){const e=t.data,i=e.native.pointerId;this._pointerState.forEach(n=>{n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=t.modifiers,n.isDragging=!0,i===n.startEvent.native.pointerId?this._pointerDrag.emit(Ue("start",n,e)):this._pointerDrag.emit(Ue("start",n,n.previousEvent),t.timestamp))})}_handlePointerLoss(t,e){const i=t.data,n=i.native.pointerId,o=this._pointerState.get(n);o&&(o.holdTimeout!=null&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging?this._pointerDrag.emit(Ue("end",o,e==="pointer-up"?i:o.previousEvent),void 0,o.modifiers):e==="pointer-up"&&o.downButton===i.native.button&&t.timestamp-o.startTimestamp<=this._parameters.maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(i),this._pointerState.delete(n),this.stopCapturingPointer(i.native),this._pointerState.size===0&&this._moveHandle.pause())}};function Ue(t,e,i){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:i}}let zc=class extends A{constructor(t={},e=Oe){super(!1),this._clock=e,this._pointerState=new Map,this._parameters=Hn(t),this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",i=>this._handleImmediateClick(i)),this.registerIncoming("pointer-down",i=>this._handlePointerDown(i))}onUninstall(){this._pointerState.forEach(t=>t.doubleClickTimer=rt(t.doubleClickTimer))}get hasPendingInputs(){for(const t of this._pointerState.values())if(t.doubleClickTimer!=null)return!0;return!1}_clearDoubleClickTimer(t,e){const i=this._pointerState.get(t);i&&(i.doubleClickTimer=rt(i.doubleClickTimer),e&&this._click.emit(i.event.data,void 0,i.event.modifiers),this._pointerState.delete(t),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(t){const e=this._pointerState.get(t);e.pointerDownCount===1&&this._click.emit(e.event.data,void 0,e.event.modifiers),e.doubleClickTimer=null,this._pointerState.delete(t),this.refreshHasPendingInputs()}_handleImmediateClick(t){const e=t.data,{pointerType:i}=e.native,n=Ac(e);if(!this._pointerState.has(n))return void this._startClick(t);const o=this._pointerState.get(n),{data:s,modifiers:r}=o.event,h=i==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;li(s,e)>h?(this._clearDoubleClickTimer(n,!0),this._startClick(t)):(this._clearDoubleClickTimer(n,!1),o.pointerDownCount===2&&this._doubleClick.emit(s,void 0,r))}_handlePointerDown(t){const e=Kt(t.data),i=this._pointerState.get(e);i&&(i.pointerDownCount+=1)}_startClick(t){const{data:e}=t,{native:{pointerType:i}}=e,n=Kt(e),o=i==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,s=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(n),o);this._pointerState.set(n,{event:t,doubleClickTimer:s,pointerDownCount:1}),this.refreshHasPendingInputs()}};function Ac(t){const{pointerId:e,pointerType:i,button:n}=t.native;return i==="mouse"?`${e}:${n}`:`${i}`}const Be={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwise:["a","A"],counterClockwise:["d","D"],reset:["n","N"]}},Oo=Symbol("handles");let Ht=class extends x{initialize(){const t=()=>this.view?.ready;this.addHandles([Yt(()=>!t(),()=>this._disconnect()),Yt(t,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerType(){return this._inputManager?.latestPointerType}get latestPointerLocation(){return this._inputManager?.latestPointerLocation}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(t){return this._inputManager?.isModifierKeyDown(t)??!1}_disconnect(){this.view.viewEvents.disconnect(),this.removeHandles(Oo),this._inputManager=at(this._inputManager)}_connect(){const t=this.view.surface,e=new Pc(t,this.view.input),i=[new Lc,new Oc,new zc,new Ic(this.view.navigation),new Rc],n=new qr({eventSource:e,recognizers:i}),o=new nc(this.view,["primary"]),s=new oc(this.view,["secondary"]);n.installHandlers("prevent-context-menu",[new kc],Re.INTERNAL),n.installHandlers("navigation",[new fc(this.view),new lc(this.view),new yc(this.view),new Eo(this.view),new Eo(this.view,[Be.counter]),o,new dc(this.view,Be.pan),new mc(this.view,Be.zoom),new uc(this.view,Be.rotate),s,new ic(this.view,"touch")],Re.INTERNAL),this.view.viewEvents.connect(n),this._source=e,this._inputManager=n,this.addHandles([_(()=>this.view?.navigation?.browserTouchPanEnabled,r=>{this._source&&(this._source.browserTouchPanningEnabled=!r)},G),_(()=>{const{actionMap:r}=this.view.navigation;return{panActions:Co("pan",r),rotateActions:Co("rotate",r)}},({panActions:r,rotateActions:h})=>{o.pointerActions=r,s.pointerActions=h},tt)],Oo)}get test(){}};a([l()],Ht.prototype,"view",void 0),a([l()],Ht.prototype,"latestPointerType",null),a([l()],Ht.prototype,"latestPointerLocation",null),a([l()],Ht.prototype,"multiTouchActive",null),Ht=a([v("esri.views.2d.input.MapViewInputManager")],Ht);const Nc=Ht,Fc=t=>{let e=class extends t{constructor(...i){super(...i),this.goToManager=new ti({view:this}),this.inputManager=new Nc({view:this}),this.addHandles([this.on("resize",n=>this.stateManager.resize(n.width,n.height))])}get interacting(){return this.navigating}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}on(i,n,o,s){return this.inputManager&&this.viewEvents.on(i,n,o,s)||super.on(i,n)}hasEventListener(i){return super.hasEventListener(i)||this.viewEvents.hasHandler(i)}goTo(i,n){return this.goToManager.goTo(i,n)}toMap(i){if(!this.ready)return null;const n=Rs(i)?Is(this,i):i;return this.stateManager.toMap(n)}};return a([l()],e.prototype,"goToManager",void 0),a([l({readOnly:!0})],e.prototype,"interacting",null),a([l()],e.prototype,"stationary",null),a([l({readOnly:!0})],e.prototype,"inputManager",void 0),e=a([v("esri.views.Viewport2DMixin")],e),e};let zo=class{constructor(t){this._view=t,this.viewpoint=new it({targetGeometry:new L,scale:0,rotation:0})}get view(){return this._view}get size(){const[t,e]=this._view.size;return Math.sqrt(t*t+e*e)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return Qs(this.center.spatialReference)}pixelsPerPanAtZoom(t){return 1/(t*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(t){return 1/(t*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(t,e){e.pan=Sr(this.center,t.center);let i=Math.abs(t.rotation-this.rotation);i=i>=180?360-i:i,e.rotate=bi(i),e.sourceZoom=this.scale,e.targetZoom=t.scale}interpolate(t,e,i){const{pan:n,rotate:o,zoom:s,zoomOffset:r}=i,{center:h}=this;h.spatialReference=t.center.spatialReference,h.x=$e(t.center.x,e.center.x,n),h.y=$e(t.center.y,e.center.y,n),this.viewpoint.scale=$e(t.scale,e.scale+r,s);let c=t.rotation;const p=e.rotation;Math.abs(p-c)>=180&&(c+=360*(c<p?1:-1)),this.viewpoint.rotation=$e(c,p,o)}copyFrom(t){Z(this.viewpoint,t.viewpoint),this._view=t.view}};const Zc=t=>t,De=t=>t*t,hi=t=>1-De(1-t),Ao=t=>t<.5?De(2*t)/2:(hi(2*(t-.5))+1)/2,ci=t=>t*t*t,_n=t=>1-ci(1-t),No=t=>t<.5?ci(2*t)/2:(_n(2*(t-.5))+1)/2,pi=t=>t*t*t*t,wn=t=>1-pi(1-t),Fo=t=>t<.5?pi(2*t)/2:(wn(2*(t-.5))+1)/2,di=t=>t*t*t*t*t,bn=t=>1-di(1-t),Zo=t=>t<.5?di(2*t)/2:(bn(2*(t-.5))+1)/2,ui=t=>1-Math.cos(t*Math.PI/2),Mn=t=>1-ui(1-t),Ho=t=>t<.5?ui(2*t)/2:(Mn(2*(t-.5))+1)/2,mi=t=>2**(10*(t-1)),gi=t=>1-mi(1-t),$o=t=>t<.5?mi(2*t)/2:(gi(2*(t-.5))+1)/2,yi=t=>-(Math.sqrt(1-t*t)-1),xn=t=>1-yi(1-t),Go=t=>t<.5?yi(2*t)/2:(xn(2*(t-.5))+1)/2;function nt(t){const e=2*(t-Math.sqrt((t-1)*t)),i=e/2/t;return n=>n<i?t*n*n:e*n-e+1}function ot(t,e){return(i,n)=>i<e?e*t(i/e,n):1-t((1-i)/(1-e),n)*(1-e)}const Wo=ot(nt(1),1),qo=ot(nt(1),0),fi=ot(nt(1),.5),jo=ot(nt(2),1),Uo=ot(nt(2),0),Bo=ot(nt(2),.5),Ko=ot(nt(3),1),Yo=ot(nt(3),0),Qo=ot(nt(3),.5),Xo=ot(nt(4),1),Jo=ot(nt(4),0),ts=ot(nt(4),.5),es={linear:Zc,"in-quad":De,"out-quad":hi,"in-out-quad":Ao,"in-coast-quad":Wo,"out-coast-quad":qo,"in-out-coast-quad":fi,"in-cubic":ci,"out-cubic":_n,"in-out-cubic":No,"in-coast-cubic":jo,"out-coast-cubic":Uo,"in-out-coast-cubic":Bo,"in-quart":pi,"out-quart":wn,"in-out-quart":Fo,"in-coast-quart":Ko,"out-coast-quart":Yo,"in-out-coast-quart":Qo,"in-quint":di,"out-quint":bn,"in-out-quint":Zo,"in-coast-quint":Xo,"out-coast-quint":Jo,"in-out-coast-quint":ts,"in-sine":ui,"out-sine":Mn,"in-out-sine":Ho,"in-expo":mi,"out-expo":gi,"in-out-expo":$o,"in-circ":yi,"out-circ":xn,"in-out-circ":Go,"quad-in":De,"quad-out":hi,"quad-in-out":Ao,"quad-in-coast":Wo,"quad-out-coast":qo,"quad-in-out-coast":fi,"cubic-in":ci,"cubic-out":_n,"cubic-in-out":No,"cubic-in-coast":jo,"cubic-out-coast":Uo,"cubic-in-out-coast":Bo,"quart-in":pi,"quart-out":wn,"quart-in-out":Fo,"quart-in-coast":Ko,"quart-out-coast":Yo,"quart-in-out-coast":Qo,"quint-in":di,"quint-out":bn,"quint-in-out":Zo,"quint-in-coast":Xo,"quint-out-coast":Jo,"quint-in-out-coast":ts,"sine-in":ui,"sine-out":Mn,"sine-in-out":Ho,"expo-in":mi,"expo-out":gi,"expo-in-out":$o,"circ-in":yi,"circ-out":xn,"circ-in-out":Go,ease:t=>We.ease(t),"ease-in":t=>We.easeIn(t),"ease-out":t=>We.easeOut(t),"ease-in-out":t=>We.easeInOut(t)};let Hc=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const vi={desiredScreenFlow:2,minDuration:et(500),maxDuration:et(8e3)},ca={maxDuration:et(4e3)};let $c=class pa{constructor(e){this._createCamera=e,this.compared=new Hc,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:vi.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new pa(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,i,n){this.source!==e&&this.source.copyFrom(e),this.target!==i&&this.target.copyFrom(i),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=n.desiredScreenFlow??vi.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const i=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/i}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>zi()}get hasFov(){return Math.abs(this.compared.fov)>zi()}get hasRotate(){return this.compared.rotate>zi()}},Gc=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},Wc=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce((t,e)=>X(t+e.time),X(0))}interpolateComponentsAt(t,e){t=Math.min(Math.max(t,0),1),t*=this.time;let i=0,n=0;const o=this.definition,s=this.segments.reduce((r,h)=>r||h.definition.hasZoom,!1);for(let r=0;r<this.segments.length;r++){const h=this.segments[r],c=h.definition;if(t<=h.time||r===this.segments.length-1){if(this.segmentInterpolateComponentsAt(h,h.time===0?0:t/h.time,e),o.hasPan&&!isNaN(e.pan)&&isFinite(o.compared.pan)?e.pan=(i+c.compared.pan*e.pan)/o.compared.pan:e.pan=1,o.hasRotate&&!isNaN(e.rotate)&&isFinite(o.compared.rotate)?e.rotate=(n+c.compared.rotate*e.rotate)/o.compared.rotate:e.rotate=1,s&&!isNaN(e.zoom)&&isFinite(c.compared.targetZoom)){const{sourceZoom:p,targetZoom:d}=c.compared,m=e.zoom*(d-p)+p,u=this.segments[0].definition.compared.sourceZoom,g=this.segments[this.segments.length-1].definition.compared.targetZoom,y=Math.abs(d-u)>Math.abs(p-u)?d:p;e.zoomOffset=y-g,e.zoom=(m-u)/(y-u)}else e.zoom=1;return e}t-=h.time,i+=c.compared.pan,n+=c.compared.rotate}}segmentInterpolateComponentsAt(t,e,i){t.interpolateComponentsAt(e,i)}},Ki=class{get time(){return this._time}constructor(t){t&&this.update(t)}update(t){t&&(this.definition?this.definition.copyFrom(t):this.definition=t.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const t=this.definition,e=t.compared,i=e.sourceZoom,n=e.targetZoom;this._zoomSign=i>n?1:-1,this._panPixelsAtSource=e.pan*t.source.pixelsPerPanAtZoom(i);const o=(t.source.pixelsPerRotate()+t.target.pixelsPerRotate())/2;this._rotatePixels=e.rotate*o}_updatePixelFlow(){const t=this.definition.compared.sourceZoom,e=this.definition.compared.targetZoom,{hasZoom:i,hasPan:n,hasRotate:o}=this.definition;let s=0,r=0;i&&(n&&(s=(e/t-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),o&&(r=this._zoomSign*(Math.log(t/e)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const h=this.definition.desiredPixelFlow;if(i&&n&&o){const c=s+r+s*r;this._zoomPixelFlow=s*r/c*h,this._panPixelFlow=r/c*h,this._rotatePixelFlow=s/c*h}else if(i&&n){const c=1+s;this._zoomPixelFlow=s/c*h,this._panPixelFlow=1/c*h}else if(i&&o){const c=1+r;this._zoomPixelFlow=r/c*h,this._rotatePixelFlow=1/c*h}else if(n&&o){const c=this._panPixelsAtSource/this._rotatePixels,p=1+c;this._panPixelFlow=c/p*h,this._rotatePixelFlow=1/p*h}else n?this._panPixelFlow=h:i?this._zoomPixelFlow=h:o&&(this._rotatePixelFlow=h);if(this._time=X(Math.max(this.rotateTime,this.zoomTime,this.panTime)),this.fovTime>this._time){const c=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=c,this._panPixelFlow/=c,this._rotatePixelFlow/=c}}get rotateTime(){return this.definition.hasRotate?X(this._rotatePixels/this._rotatePixelFlow):X(0)}get zoomTime(){return this.definition.hasZoom?X(this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow):X(0)}get fovTime(){return this.definition.hasFov?X(Math.abs(this.definition.compared.fov)/qc):X(0)}get panTime(){if(!this.definition.hasPan)return X(0);if(this.definition.hasZoom){const t=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,e=t*this._panPixelsAtSource;return X(Math.log(e*(this._zoomPixelFlow/this._panPixelFlow)+1)/(t*this._zoomPixelFlow))}return X(this._panPixelsAtSource/this._panPixelFlow)}_interpolateComponentsZoom(t){if(t===0||t===1)return t;if(this.definition.hasZoom){const e=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom;return(e*(e/i)**-t-e)/(i-e)}return t}_interpolateComponentsFov(t){if(t===0)return this.definition.segmentStart;if(t===1)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:e,segmentEnd:i}=this.definition;return e+t*(i-e)}return this.definition.segmentStart}_interpolateComponentsPan(t){if(t===0||t===1)return t;if(this.definition.hasPan&&this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(e*t*this._time)-1))/(e*Math.LN2)}return t}_interpolateComponentsRotate(t){return t}interpolateComponentsAt(t,e){t=Math.min(Math.max(t,0),1),e.zoom=this._interpolateComponentsZoom(t),e.pan=this._interpolateComponentsPan(t),e.rotate=this._interpolateComponentsRotate(t),e.zoomOffset=0,e.fov=this._interpolateComponentsFov(t)}};const qc=bi(45);function jc(t,e,i){const n=e-t.compared.sourceZoom,o=t.halfWindowPanAtZoom(n);return-t.halfWindowSize*(i.ascensionFactor*Math.LN2*t.compared.pan+o)*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2*o)}function Uc(t,e,i){const n=1/e,o=Math.log(t.compared.sourceZoom*n),s=1/t.desiredPixelFlow,r=1/Math.LN2,h=e-t.compared.sourceZoom,c=1/h,p=(i.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(h))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*n*s*r*c*p-t.halfWindowSize*o*s*r*c+t.halfWindowSize*o*s*r*p/(h*h)}function Bc(t,e,i){const n=e-t.compared.sourceZoom,o=1/n,s=1/e,r=Math.log(t.compared.sourceZoom*s),h=(i.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(n))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*o*(-2*o*s*h+2*o*r+2*s-2*r*h/(n*n)-h/(e*e))/(t.desiredPixelFlow*Math.LN2)}function Kc(t,e){return-t.halfWindowSize*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2)}function Yc(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function Qc(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function Xc(t,e,i){return-t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e))}function Jc(t,e,i){return t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e))}function tp(t,e,i){return-2*t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e*e))}function ep(t,e,i){return t.halfWindowSize*(-t.halfWindowPanAtZoom(e)-i.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*t.halfWindowPanAtZoom(-e+t.compared.targetZoom))}function ip(t,e,i){const n=Math.log(e/t.compared.targetZoom),o=1/t.desiredPixelFlow,s=1/Math.LN2,r=-e+t.compared.targetZoom,h=1/r,c=(-t.halfWindowPanAtZoom(e)-i.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return-t.halfWindowSize*n*o*s*h+t.halfWindowSize*n*o*s*c/(r*r)+t.halfWindowSize*o*s*h*c/e}function np(t,e,i){const n=e-t.compared.targetZoom,o=1/n,s=1/e,r=Math.log(e/t.compared.targetZoom),h=(t.halfWindowPanAtZoom(e)+i.descensionFactor*Math.LN2*t.compared.pan-t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*o*(-2*o*s*h-2*o*r+2*s+2*r*h/(n*n)-h/(e*e))/(t.desiredPixelFlow*Math.LN2)}function op(t,e){return t.halfWindowSize*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2)}function sp(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function ap(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function rp(t){const e=t.compared.sourceZoom-t.compared.targetZoom;if(e===0)return t.compared.pan*t.halfWindowSize/(t.desiredPixelFlow*t.halfWindowPanAtZoom(t.compared.sourceZoom));const i=Math.LN2*t.compared.pan,n=e,o=t.halfWindowPanAtZoom(n),s=t.halfWindowSize*Math.log(t.compared.sourceZoom/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*o);return t.compared.sourceZoom<=t.compared.targetZoom?s*(i-o):s*(i+o)}function lp(t,e){let i=hp(t,e);const n={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},o=n.ascensionFactor===0,s=n.descensionFactor===0,r=o?Kc:jc,h=o?Yc:Uc,c=o?Qc:Bc,p=s?op:ep,d=s?sp:ip,m=s?ap:np,u=T=>r(t,T,n)+Xc(t,T,n)+p(t,T,n),g=T=>h(t,T,n)+Jc(t,T,n)+d(t,T,n),y=T=>c(t,T,n)+tp(t,T,n)+m(t,T,n);let w=u(i);const I=rp(t);let V;const lt=e.maximumIterations||20,P=e.maximumDistance!=null?e.maximumDistance:1/0;for(V=0;V<lt;V++){const T=e.desiredSlope??1e-6;let H=g(i);Math.abs(H)>T&&(H+=T);const B=H/y(i);if(isNaN(B)||i>=P&&B<0){if(!isFinite(P))return null;i=P,w=u(i);break}if(i-=B,i<=t.compared.sourceZoom||i<=t.compared.targetZoom)return null;const ut=u(i);if(Math.abs(ut-w)/w<=.005)break;w=ut}return isNaN(w)||w>I*(1-.3)||i<=t.compared.sourceZoom||i<=t.compared.targetZoom?null:i}function hp(t,e){const i=Math.max(t.compared.sourceZoom,t.compared.targetZoom),n=t.source.zoomAtPixelsPerPan(t.desiredPixelFlow/t.compared.pan)/2;return n<i?e.maximumDistance!=null?i+(e.maximumDistance-i)/2:1.5*i:e.maximumDistance?Math.min(e.maximumDistance,n):n}let cp=class extends Wc{constructor(t,e){super(),this._preallocSegments=[new Ki,new Ki,new Ki],this._ascensionSegment=null,this._descensionSegment=null,this.update(t,e)}update(t,e){if(!t)return;this.definition?this.definition.copyFrom(t):this.definition=t.clone();const i=e?.apex?lp(t,e.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,i?this._updateWithApex(i,e?.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(t,e,i){t.interpolateComponentsAt(e,i),t===this._ascensionSegment?i.zoom=hi(i.zoom):t===this._descensionSegment&&(i.zoom=De(i.zoom))}_updateWithApex(t,e){const[i,n,o]=this._preallocSegments,s=e?.ascensionFactor??.5,r=Math.min(1-s,e?.ascensionFactor!=null&&e.descensionFactor!=null?e.descensionFactor:.5),h=1-s-r;i.definition?i.definition.copyFrom(this.definition):i.definition=this.definition.clone(),i.definition.compared.targetZoom=t,i.definition.compared.pan=this.definition.compared.pan*s,i.definition.compared.rotate=this.definition.compared.rotate*s,i.definition.segmentEnd=s,i.update(),this._ascensionSegment=i,this.segments.push(i),h>0&&(n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.copyFrom(this.definition),n.definition.compared.sourceZoom=t,n.definition.compared.targetZoom=t,n.definition.compared.pan=this.definition.compared.pan*h,n.definition.compared.rotate=this.definition.compared.rotate*h,n.definition.segmentStart=i.definition.segmentEnd,n.definition.segmentEnd=i.definition.segmentEnd+h,n.update(),this.segments.push(n)),o.definition?o.definition.copyFrom(this.definition):o.definition=this.definition.clone(),o.definition.compared.sourceZoom=t,o.definition.compared.pan=this.definition.compared.pan*r,o.definition.compared.rotate=this.definition.compared.rotate*r,o.definition.segmentStart=s+h,o.update(),this._descensionSegment=o,this.segments.push(o)}_updateWithoutApex(){const[t]=this._preallocSegments;t.update(this.definition),this.segments.push(t)}};const pp=new Gc;let dp=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(t){this._time=et(0),this._easing=fi,this.definition=new $c(t),this.path=new cp}update(t,e,i){this.definition.update(t,e,i),this.path.update(this.definition,i),this._time=this._applyTimeSettings(Pr(isFinite(this.path.time)?this.path.time:X(0)),i),this._easing=i.easing??(this._time>=1e3?fi:gi)}cameraAt(t,e){t=Math.min(Math.max(0,t),1),t=this._normalizedEasing(t);const i=this.path.interpolateComponentsAt(t,pp);e.interpolate(this.definition.source,this.definition.target,i)}_normalizedEasing(t){const e=this._easing(0,this._time),i=this._easing(1,this._time);return(this._easing(t,this._time)-e)/(i-e)}_applyTimeSettings(t,e){const i=e.speedFactor!=null?e.speedFactor:1,n=e.minDuration??vi.minDuration/i,o=e.maxDuration??vi.maxDuration/i;return t=e.duration!=null?et(e.duration):et(Math.min(Math.max(t/i,n),o))}};const up=2e3,mp=64;let gp=class{constructor(t){this._view=t,this._animation=new dp(()=>new zo(this._view)),this._current=new zo(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(t,e,i={}){Z(this._current.viewpoint,t),Z(this._source.viewpoint,t),Z(this._target.viewpoint,e),this._animation.update(this._source,this._target,i)}applyRatio(t,e){this._animation.cameraAt(e,this._current),Z(t,this._current.viewpoint)}},he=class extends x{constructor(t){super(t),this._animation=null,this._destinationViewState=new Zn,this.updateFunction=null,this.easing=es.ease,this.viewpoint=new it({targetGeometry:new L,scale:0,rotation:0}),this._updateTask=me({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new gp(t.view)}destroy(){this._updateTask=rt(this._updateTask)}get animation(){return this._animation}set animation(t){this._animation=t,this.view.animation=t}animate(t,e,i){this.stop();const n=this.viewpoint;Z(n,e);const o=t.target;this._transition.update(this.viewpoint,o,{apex:{maximumDistance:Math.min(Math.min(e.scale,o.scale)*mp,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:i?.duration,maxDuration:i?.animationMode==="auto"?et(1/0):i?.maxDuration??ca.maxDuration,speedFactor:i?.speedFactor,easing:(typeof i?.easing=="string"?es[i.easing]:i?.easing)||this.easing}),i?.animationMode==="auto"&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=o,yp(this._transition.animation,i,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,o,{duration:et(0)}));const s=()=>{this.animation===t&&this._updateTask&&(t.state==="finished"&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return t.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=t,t}animateContinuous(t,e){this.stop(),this.updateFunction=e,this.viewpoint=t;const i=new vn({target:t.clone()}),n=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(t){const e=this.animation;if(e&&e.state!==vn.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,t.deltaTime),this.animation?.update(this.viewpoint);else{const i=performance.now()-this._startTime,n=this._transition.duration,o=n>0?i/n:1,s=o>=1;this._transition.applyRatio(this.viewpoint,o),s&&this.animation?.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function yp(t,e,i,n){if(e?.duration!=null)return!0;const{time:o,isLinear:s}=t,r=e?.speedFactor||1;if(o>(e?.maxDuration??ca.maxDuration/r))return!1;if(s){const h=O(),c=j(...n.toScreen(h,...i.center)),p=j(...i.toScreen(h,...n.center)),d=p!=null&&p.x>-1*i.size[0]&&p.x<(1.5+.5)*i.size[0]&&p.y>-1*i.size[1]&&p.y<(1.5+.5)*i.size[1],m=c!=null&&c.x>-1*n.size[0]&&c.x<(1.5+.5)*n.size[0]&&c.y>-1*n.size[1]&&c.y<(1.5+.5)*n.size[1];if(o>up/r&&!d&&!m)return!1}return!0}a([l()],he.prototype,"easing",void 0),a([l()],he.prototype,"view",void 0),a([l()],he.prototype,"viewpoint",void 0),he=a([v("esri.views.2d.AnimationManager")],he);const fp=he;function k(){return Promise.all([M(()=>import("./webglDeps-B1MbyxEI-BNtg1uWc.js"),__vite__mapDeps([176,177,1,2,170,169,171,69,178,179,180]),import.meta.url),M(()=>import("./mapViewDeps-C9uprLPQ-Br7Y9k1R.js"),__vite__mapDeps([181,1,2,132,48,22,49,182,183,184,185,70,69,186,46,44,45,168,187,188,134,133,157,160,189,190,165,166,25,128,167,14,15,16,17,191,192,170,169,171,178,177,179,193,194,195,141,196,197,159,198,199,200,163,201,202,203,59,20,21,204,205,206,158,207,71,72,34,208,173,209,210,211,212,213,39,40,23,41,42,43,214,215,216,176,180,217,218,219,220,24,26,221,222,223,224,225,172,68,226,3,87,52,227,74,64,65,62,66,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,57,243,101,244,245,10,138,94,139,140,4,5,6,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,153,154,55,155,156,161,162,164,76,174,175]),import.meta.url)])}const ve=()=>k().then(()=>M(()=>import("./TileLayerView2D-BSVkAvgX-MYth2k7q.js"),__vite__mapDeps([246,1,2,152,132,48,22,49,45,46,188,168,195,128,141,186,184,185,182,70,69,44,187,134,133,157,160,189,190,213,39,40,23,41,42,43,214,215,203,59,20,21,202,165,166,25,167,14,15,16,17,199,200,169,171,198,179,170,177,159,163,201,204,205,206,158,207,71,72,216,217,192,178,193,194,196,197,218,219,220,24,26,68,191,183,34,208,173,209,211,212,222,223,224,235,226,3,87,52,227,74,64,65,62,66,228,229,236,237,238,57,247,248,249,242,250,251,137,252,240,241,253,254,255,101,256,257,258,259,161,162,10,138,94,139,140,4,5,6,142,143,144,114,145,146,110,147,148,149,150,151,93,82,153,154,55,155,156,164,172,76,174,175]),import.meta.url)),At=()=>k().then(()=>M(()=>import("./FeatureLayerView2D-BFdoHjCO-D4f3aFaZ.js"),__vite__mapDeps([260,1,2,141,203,59,20,21,22,207,71,69,70,72,106,14,15,16,17,85,57,5,50,30,31,32,33,34,51,52,35,53,13,86,87,261,24,25,26,75,262,263,227,74,64,65,62,66,228,264,23,250,251,202,128,137,241,168,195,200,169,165,166,157,167,190,160,171,198,178,177,170,242,199,179,133,134,159,163,201,204,46,205,206,158,183,184,185,182,186,44,45,187,188,189,191,192,193,194,196,197,208,173,209,218,94,3,265,112,47,48,49,210,266,267,102,105,58,256,259,253,254,10,138,139,140,4,6,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,153,154,55,155,156,161,162,164,172,76,174,175]),import.meta.url).then(t=>t.F)),is={"base-dynamic":()=>k().then(()=>M(()=>import("./BaseDynamicLayerView2D-dp_1t_U7-BcfcH4ek.js"),__vite__mapDeps([268,1,2,269,165,166,157,22,25,128,167,14,15,16,17,199,200,169,168,190,160,171,198,179,170,177,69,133,134,159,163,201,202,203,59,20,21,204,46,205,206,158,207,71,70,72,248,192,178,193,194,191,249,250,251,137,270,139,140,253,141,254,10,138,94,3,74,4,5,6,57,24,26,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,23,153,154,55,155,156,64,65,62,66,161,162,164,172,173,76,174,175]),import.meta.url)),"base-tile":ve,"bing-maps":ve,catalog:()=>k().then(()=>M(()=>import("./CatalogLayerView2D-CYqGTGlX-B-3aoFtV.js"),__vite__mapDeps([271,1,2,250,251,202,203,59,20,21,22,128,137,253,141,10,138,94,25,3,74,139,140,4,5,6,57,24,26,142,143,144,114,145,146,110,147,148,149,150,151,93,17,152,82,23,14,15,16,153,154,55,155,156,157,158,134,64,65,62,66,133,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,76,174,175]),import.meta.url)),"catalog-dynamic-group":()=>k().then(()=>M(()=>import("./CatalogDynamicGroupLayerView2D-D8lxLEXq-GHHdqbrW.js"),__vite__mapDeps([272,1,2,250,251,202,203,59,20,21,22,128,137,253,141,10,138,94,25,3,74,139,140,4,5,6,57,24,26,142,143,144,114,145,146,110,147,148,149,150,151,93,17,152,82,23,14,15,16,153,154,55,155,156,157,158,134,64,65,62,66,133,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,76,174,175]),import.meta.url)),"catalog-footprint":()=>k().then(()=>M(()=>import("./CatalogFootprintLayerView2D-RRjvPOvg-DNN99xNs.js"),__vite__mapDeps([273,1,2,260,141,203,59,20,21,22,207,71,69,70,72,106,14,15,16,17,85,57,5,50,30,31,32,33,34,51,52,35,53,13,86,87,261,24,25,26,75,262,263,227,74,64,65,62,66,228,264,23,250,251,202,128,137,241,168,195,200,169,165,166,157,167,190,160,171,198,178,177,170,242,199,179,133,134,159,163,201,204,46,205,206,158,183,184,185,182,186,44,45,187,188,189,191,192,193,194,196,197,208,173,209,218,94,3,265,112,47,48,49,210,266,267,102,105,58,256,259,253,254,10,138,139,140,4,6,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,153,154,55,155,156,161,162,164,172,76,174,175]),import.meta.url)),csv:At,"geo-rss":()=>k().then(()=>M(()=>import("./GeoRSSLayerView2D-CSsrDcVh-Bh1SGlgI.js"),__vite__mapDeps([274,1,2,50,30,31,32,33,34,109,28,29,35,36,37,38,26,39,40,23,41,42,43,44,45,46,47,48,22,49,51,52,53,75,15,16,250,251,202,203,59,20,21,128,137,239,165,166,157,25,167,14,17,240,241,168,195,141,200,169,190,160,171,198,178,177,170,69,242,199,179,133,134,159,163,201,204,205,206,158,207,71,70,72,183,184,185,182,186,187,188,189,191,192,193,194,196,197,208,173,209,64,65,62,66,235,213,132,214,215,226,3,87,227,74,228,229,236,237,238,253,10,138,94,139,140,4,5,6,57,24,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,153,154,55,155,156,161,162,164,172,76,174,175]),import.meta.url)),feature:At,geojson:At,parquet:At,graphics:()=>k().then(()=>M(()=>import("./GraphicsLayerView2D-CT50MNVi-CXRV7u5I.js"),__vite__mapDeps([275,1,2,250,251,202,203,59,20,21,22,128,137,239,165,166,157,25,167,14,15,16,17,240,241,168,195,141,200,169,190,160,171,198,178,177,170,69,242,199,179,133,134,159,163,201,204,46,205,206,158,207,71,70,72,183,184,185,182,186,44,45,187,188,189,191,192,193,194,196,197,34,208,173,209,64,65,62,66,235,39,40,23,213,132,48,49,41,42,43,214,215,226,3,87,52,227,74,228,229,236,237,238,253,24,26,10,138,94,139,140,4,5,6,57,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,153,154,55,155,156,161,162,164,172,76,174,175]),import.meta.url)),group:()=>k().then(()=>M(()=>import("./GroupLayerView2D-ENpdmUqF-DFEZP4R_.js"),__vite__mapDeps([276,1,2,250,251,202,203,59,20,21,22,128,137,253,141,10,138,94,25,3,74,139,140,4,5,6,57,24,26,142,143,144,114,145,146,110,147,148,149,150,151,93,17,152,82,23,14,15,16,153,154,55,155,156,157,158,134,64,65,62,66,133,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,76,174,175]),import.meta.url)),imagery:()=>k().then(()=>M(()=>import("./ImageryLayerView2D-BYGSmiEO-BoC3p3vD.js"),__vite__mapDeps([277,1,2,152,278,159,22,177,170,169,171,69,198,279,280,199,200,168,165,166,157,25,128,167,14,15,16,17,190,160,179,133,134,163,201,202,203,59,20,21,204,46,205,206,158,207,71,70,72,250,251,137,235,39,40,23,184,185,182,186,44,45,187,188,189,213,132,48,49,41,42,43,214,215,226,195,141,3,87,52,197,227,74,64,65,62,66,228,229,183,191,192,178,193,194,196,34,208,173,209,236,237,238,252,240,241,242,269,248,249,270,139,140,281,261,24,26,259,253,254,10,138,94,4,5,6,57,142,143,144,114,145,146,110,147,148,149,150,151,93,82,153,154,55,155,156,161,162,164,172,76,174,175]),import.meta.url)),"imagery-tile":()=>k().then(()=>M(()=>import("./ImageryTileLayerView2D-CW5oOMZX-BQif9btb.js"),__vite__mapDeps([282,1,2,283,15,16,278,159,22,177,170,169,171,69,198,279,280,199,200,168,165,166,157,25,128,167,14,17,190,160,179,133,134,163,201,202,203,59,20,21,204,46,205,206,158,207,71,70,72,250,251,137,284,285,242,192,178,193,194,191,249,196,197,141,139,140,286,281,74,161,162,173,261,24,26,259,253,254,10,138,94,3,4,5,6,57,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,23,153,154,55,155,156,64,65,62,66,164,172,76,174,175]),import.meta.url)),kml:()=>k().then(()=>M(()=>import("./KMLLayerView2D-CfGoqlrn-CJbirwx2.js"),__vite__mapDeps([287,1,2,74,288,109,28,29,30,31,32,33,34,35,36,37,38,26,39,40,23,41,42,43,44,45,46,47,48,22,49,50,51,52,53,75,15,16,62,152,248,159,160,202,203,59,20,21,169,170,171,168,192,165,166,157,25,128,167,14,17,178,177,69,179,193,194,191,249,269,199,200,190,198,133,134,163,201,204,205,206,158,207,71,70,72,250,251,137,239,240,241,195,141,242,183,184,185,182,186,187,188,189,196,197,208,173,209,64,65,66,235,213,132,214,215,226,3,87,227,228,229,236,237,238,253,233,234,281,221,176,180,222,223,224,219,285,10,138,94,139,140,4,5,6,57,24,142,143,144,114,145,146,110,147,148,149,150,151,93,82,153,154,55,155,156,161,162,164,172,76,174,175]),import.meta.url)),"knowledge-graph":()=>k().then(()=>M(()=>import("./KnowledgeGraphLayerView2D-ByYte4jc-lxpi5pk9.js"),__vite__mapDeps([289,1,2,250,251,202,203,59,20,21,22,128,137,253,141,10,138,94,25,3,74,139,140,4,5,6,57,24,26,142,143,144,114,145,146,110,147,148,149,150,151,93,17,152,82,23,14,15,16,153,154,55,155,156,157,158,134,64,65,62,66,133,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,76,174,175]),import.meta.url)),"link-chart":()=>k().then(()=>M(()=>import("./KnowledgeGraphLayerView2D-ByYte4jc-lxpi5pk9.js"),__vite__mapDeps([289,1,2,250,251,202,203,59,20,21,22,128,137,253,141,10,138,94,25,3,74,139,140,4,5,6,57,24,26,142,143,144,114,145,146,110,147,148,149,150,151,93,17,152,82,23,14,15,16,153,154,55,155,156,157,158,134,64,65,62,66,133,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,76,174,175]),import.meta.url)),"knowledge-graph-sublayer":At,"map-image":()=>k().then(()=>M(()=>import("./MapImageLayerView2D-DvTL_pk6-DbW1yuS_.js"),__vite__mapDeps([290,1,2,152,269,165,166,157,22,25,128,167,14,15,16,17,199,200,169,168,190,160,171,198,179,170,177,69,133,134,159,163,201,202,203,59,20,21,204,46,205,206,158,207,71,70,72,248,192,178,193,194,191,249,250,251,137,235,39,40,23,184,185,182,186,44,45,187,188,189,213,132,48,49,41,42,43,214,215,226,195,141,3,87,52,197,227,74,64,65,62,66,228,229,183,196,34,208,173,209,236,237,238,252,240,241,242,270,139,140,253,291,101,256,258,261,24,26,254,255,257,259,10,138,94,4,5,6,57,142,143,144,114,145,146,110,147,148,149,150,151,93,82,153,154,55,155,156,161,162,164,172,76,174,175]),import.meta.url)),"map-notes":()=>k().then(()=>M(()=>import("./MapNotesLayerView2D-DidvAQ85-CCiFV6hI.js"),__vite__mapDeps([292,1,2,250,251,202,203,59,20,21,22,128,137,239,165,166,157,25,167,14,15,16,17,240,241,168,195,141,200,169,190,160,171,198,178,177,170,69,242,199,179,133,134,159,163,201,204,46,205,206,158,207,71,70,72,183,184,185,182,186,44,45,187,188,189,191,192,193,194,196,197,34,208,173,209,64,65,62,66,235,39,40,23,213,132,48,49,41,42,43,214,215,226,3,87,52,227,74,228,229,236,237,238,253,10,138,94,139,140,4,5,6,57,24,26,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,153,154,55,155,156,161,162,164,172,76,174,175]),import.meta.url)),media:()=>k().then(()=>M(()=>import("./MediaLayerView2D-CllOE04l-yhX-EfDy.js"),__vite__mapDeps([293,1,2,294,74,236,65,159,22,237,157,163,50,30,31,32,33,34,132,48,49,45,46,188,168,195,128,141,186,184,185,182,70,69,44,187,134,133,160,189,190,213,39,40,23,41,42,43,214,215,203,59,20,21,202,165,166,25,167,14,15,16,17,199,200,169,171,198,179,170,177,201,204,205,206,158,207,71,72,216,217,192,178,193,194,196,197,218,219,220,24,26,68,191,183,208,173,209,211,212,222,223,224,235,226,3,87,52,227,64,62,66,228,229,238,57,230,295,231,250,251,137,253,161,162,10,138,94,139,140,4,5,6,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,153,154,55,155,156,164,172,76,174,175]),import.meta.url)),"ogc-feature":()=>k().then(()=>M(()=>import("./OGCFeatureLayerView2D-BbzYRCC9-BOBYIt2E.js"),__vite__mapDeps([296,1,2,260,141,203,59,20,21,22,207,71,69,70,72,106,14,15,16,17,85,57,5,50,30,31,32,33,34,51,52,35,53,13,86,87,261,24,25,26,75,262,263,227,74,64,65,62,66,228,264,23,250,251,202,128,137,241,168,195,200,169,165,166,157,167,190,160,171,198,178,177,170,242,199,179,133,134,159,163,201,204,46,205,206,158,183,184,185,182,186,44,45,187,188,189,191,192,193,194,196,197,208,173,209,218,94,3,265,112,47,48,49,210,266,267,102,105,58,256,259,253,254,10,138,139,140,4,6,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,153,154,55,155,156,161,162,164,172,76,174,175]),import.meta.url)),"open-street-map":ve,"oriented-imagery":At,route:()=>k().then(()=>M(()=>import("./RouteLayerView2D-CEC8Ef4W-BBvwRudv.js"),__vite__mapDeps([297,1,2,138,298,299,250,251,202,203,59,20,21,22,128,137,239,165,166,157,25,167,14,15,16,17,240,241,168,195,141,200,169,190,160,171,198,178,177,170,69,242,199,179,133,134,159,163,201,204,46,205,206,158,207,71,70,72,183,184,185,182,186,44,45,187,188,189,191,192,193,194,196,197,34,208,173,209,64,65,62,66,235,39,40,23,213,132,48,49,41,42,43,214,215,226,3,87,52,227,74,228,229,236,237,238,253,10,94,139,140,4,5,6,57,24,26,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,153,154,55,155,156,161,162,164,172,76,174,175]),import.meta.url)),stream:()=>k().then(()=>M(()=>import("./StreamLayerView2D-CmjvwU1I-QMYN2XJt.js"),__vite__mapDeps([300,1,2,75,15,16,260,141,203,59,20,21,22,207,71,69,70,72,106,14,17,85,57,5,50,30,31,32,33,34,51,52,35,53,13,86,87,261,24,25,26,262,263,227,74,64,65,62,66,228,264,23,250,251,202,128,137,241,168,195,200,169,165,166,157,167,190,160,171,198,178,177,170,242,199,179,133,134,159,163,201,204,46,205,206,158,183,184,185,182,186,44,45,187,188,189,191,192,193,194,196,197,208,173,209,218,94,3,265,112,47,48,49,210,266,267,102,105,58,256,259,253,254,10,138,139,140,4,6,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,153,154,55,155,156,161,162,164,172,76,174,175]),import.meta.url)),"subtype-group":()=>k().then(()=>M(()=>import("./SubtypeGroupLayerView2D-tQVOrzZf-vQCVS_N9.js"),__vite__mapDeps([301,1,2,260,141,203,59,20,21,22,207,71,69,70,72,106,14,15,16,17,85,57,5,50,30,31,32,33,34,51,52,35,53,13,86,87,261,24,25,26,75,262,263,227,74,64,65,62,66,228,264,23,250,251,202,128,137,241,168,195,200,169,165,166,157,167,190,160,171,198,178,177,170,242,199,179,133,134,159,163,201,204,46,205,206,158,183,184,185,182,186,44,45,187,188,189,191,192,193,194,196,197,208,173,209,218,94,3,265,112,47,48,49,210,266,267,102,105,58,256,259,253,254,10,138,139,140,4,6,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,153,154,55,155,156,161,162,164,172,76,174,175]),import.meta.url)),tile:ve,"vector-tile":()=>k().then(()=>M(()=>import("./VectorTileLayerView2D-DOzhqxiW-DiSO6S75.js"),__vite__mapDeps([302,1,2,52,216,94,25,3,189,169,170,171,68,69,187,188,45,46,168,166,36,37,165,157,22,128,167,14,15,16,17,220,205,186,204,159,177,199,200,190,160,198,179,133,134,163,201,202,203,59,20,21,206,158,207,71,70,72,139,140,242,303,304,305,132,48,49,164,250,251,137,253,141,254,161,162,10,138,74,4,5,6,57,24,26,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,23,153,154,55,155,156,64,65,62,66,172,173,76,174,175]),import.meta.url)),video:()=>k().then(()=>M(()=>import("./VideoLayerView2D-D0Fhesy8-DEPDZ-EM.js"),__vite__mapDeps([306,1,2,307,152,93,17,98,80,58,59,20,21,22,116,84,34,308,60,44,45,46,56,57,36,37,295,159,160,201,64,65,62,66,165,166,157,25,128,167,14,15,16,199,200,169,168,190,171,198,179,170,177,69,133,134,163,202,203,204,205,206,158,207,71,70,72,183,184,185,182,186,187,188,189,191,192,178,193,194,195,141,196,197,208,173,209,231,74,250,251,137,239,240,241,242,235,39,40,23,213,132,48,49,41,42,43,214,215,226,3,87,52,227,228,229,236,237,238,253,10,138,94,139,140,4,5,6,24,26,142,143,144,114,145,146,110,147,148,149,150,151,82,153,154,55,155,156,161,162,164,172,76,174,175]),import.meta.url)),wcs:()=>k().then(()=>M(()=>import("./ImageryTileLayerView2D-CW5oOMZX-BQif9btb.js"),__vite__mapDeps([282,1,2,283,15,16,278,159,22,177,170,169,171,69,198,279,280,199,200,168,165,166,157,25,128,167,14,17,190,160,179,133,134,163,201,202,203,59,20,21,204,46,205,206,158,207,71,70,72,250,251,137,284,285,242,192,178,193,194,191,249,196,197,141,139,140,286,281,74,161,162,173,261,24,26,259,253,254,10,138,94,3,4,5,6,57,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,23,153,154,55,155,156,64,65,62,66,164,172,76,174,175]),import.meta.url)),"web-tile":ve,wfs:At,wms:()=>k().then(()=>M(()=>import("./WMSLayerView2D-LTJm2gFs-CizvogR3.js"),__vite__mapDeps([309,1,2,269,165,166,157,22,25,128,167,14,15,16,17,199,200,169,168,190,160,171,198,179,170,177,69,133,134,159,163,201,202,203,59,20,21,204,46,205,206,158,207,71,70,72,248,192,178,193,194,191,249,250,251,137,270,139,140,253,141,254,310,261,24,26,10,138,94,3,74,4,5,6,57,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,23,153,154,55,155,156,64,65,62,66,161,162,164,172,173,76,174,175]),import.meta.url)),wmts:()=>k().then(()=>M(()=>import("./WMTSLayerView2D-BqZEnQWx-BeuRlijY.js"),__vite__mapDeps([311,1,2,247,248,159,22,160,202,203,59,20,21,169,170,171,168,192,165,166,157,25,128,167,14,15,16,17,178,177,69,179,193,194,191,249,199,200,190,198,133,134,163,201,204,46,205,206,158,207,71,70,72,242,250,251,137,253,141,254,161,162,10,138,94,3,74,139,140,4,5,6,57,24,26,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,23,153,154,55,155,156,64,65,62,66,164,172,173,76,174,175]),import.meta.url)),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,viewshed:null,voxel:null,scene:null,unknown:null,unsupported:null};function vp(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",i=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new E(`${i}:view-not-supported`,`${e} is not supported in 2D`)}const ns={hasLayerViewModule:t=>is[t.type]!=null,importLayerView:t=>{const e=is[t.type];if(e==null)throw vp(t);return e(t)}};let _p=class{constructor(t,e={}){this.events=new Le,this._hasMajorPerformanceCaveat=!1,this._lastRenderFrameCounter=0,t!=null?(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("style","width: 100%; height:100%; display:block; willChange:transform"),t.contains(this._canvas)||t.appendChild(this._canvas)):e.canvas!=null&&(this._canvas=e.canvas);const i={failIfMajorPerformanceCaveat:!0,alpha:!0,antialias:!1,depth:!0,stencil:!0,powerPreference:"high-performance"};let n=this._canvas.getContext("webgl2",i);n||(n=this._canvas.getContext("webgl2",{...i,failIfMajorPerformanceCaveat:!1}),this._hasMajorPerformanceCaveat=!0),this._gl=n,this._handles=Qa([ws(this._canvas,"webglcontextlost",o=>this.events.emit("webgl-context-lost",o))])}destroy(){this._canvas.remove(),this._canvas=null,this._handles.remove(),this._gl=null}get gl(){return this._gl}get canvas(){return this._canvas}render(t,e){if(this._hasMajorPerformanceCaveat||F("esri-force-performance-mode")){if(++this._lastRenderFrameCounter>=F("esri-performance-mode-frames-between-render")&&(e(),this._lastRenderViewState=t.state.clone(),this._lastRenderFrameCounter=0),this._lastRenderViewState){const[i,n,o,s,r,h]=this._computeViewTransform(this._lastRenderViewState,t.state);this._canvas.style.transform=`matrix(${i}, ${n}, ${o}, ${s}, ${r}, ${h})`}}else e()}resize(t){const e=this._canvas,i=e.style,{state:{size:n},pixelRatio:o}=t,s=n[0],r=n[1],h=Math.round(s*o),c=Math.round(r*o);e.width===h&&e.height===c||(e.width=h,e.height=c),i.width=s+"px",i.height=r+"px"}_computeViewTransform(t,e){const[i,n]=t.center,[o,s]=e.center,[r,h]=t.toScreen([0,0],o,s),[c,p]=t.toScreen([0,0],i,n),d=c-r,m=p-h,u=t.scale/e.scale,g=e.rotation-t.rotation,y=Ot();return cl(y),In(y,y,[u,u]),Ei(y,y,bi(g)),Ie(y,y,[d,m]),y}};const Nt={added:[],removed:[]},Yi=new Set,wp=new xl(0,0,0,0);function bp(t,e){const i=vs(e);if(!i)return null;const[n,o]=i.valid;return t[2]>o?[He([t[0],t[1],o,t[3]]),He([n,t[1],n+t[2]-o,t[3]])]:t[0]<n?[He([n,t[1],t[2],t[3]]),He([o-(n-t[0]),t[1],o,t[3]])]:null}let Mp=class extends Le{constructor(t){super(),this._tiles=new Map,this._index=bl(9,F("esri-csp-restrictions")?e=>({minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=t}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(t){return this._tiles.has(t)}get(t){return this._tiles.get(t)}getIntersectingTiles(t){if(!t||ur(t)===0||mr(t)===0)return[];const e=bp(t,this.tileScheme.spatialReference);return e!=null?[...new Set([...this.boundsIntersections(e[0]),...this.boundsIntersections(e[1])])]:this.boundsIntersections(t)}boundsIntersections(t){return this._index.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})}updateTiles(t){const e={added:[],removed:[]};for(const i of t.added)if(!this.has(i)){const n=new co(this.tileScheme,i);this._tiles.set(i,n),this._index.insert(n),e.added.push(n)}for(const i of t.removed)if(this.has(i)){const n=this.get(i);this._tiles.delete(i),this._index.remove(n),e.removed.push(n)}this.tiles.length=0,this._tiles.forEach(i=>this.tiles.push(i)),(e.added.length||e.removed.length)&&this.emit("update",e)}setViewState(t){const e=this.tileScheme.getTileCoverage(t,0);if(!e)return;const{spans:i,lodInfo:n}=e,{level:o}=n;if(i.length>0)for(const{row:s,colFrom:r,colTo:h}of i)for(let c=r;c<=h;c++){const p=wp.set(o,s,n.normalizeCol(c),n.getWorldForColumn(c)).id;if(Yi.add(p),!this.has(p)){const d=new co(this.tileScheme,p);this._tiles.set(p,d),this._index.insert(d),this.tiles.push(d),Nt.added.push(d)}}for(let s=this.tiles.length-1;s>=0;s--){const r=this.tiles[s];Yi.has(r.id)||(this._tiles.delete(r.id),this.tiles.splice(s,1),this._index.remove(r),Nt.removed.push(r))}(Nt.added.length||Nt.removed.length)&&this.emit("update",Nt),Ml.pool.release(e),Yi.clear(),Nt.added.length=0,Nt.removed.length=0}};const xp=1,ju=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],Uu=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_e=256,Qi=()=>C.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function Tp(t,e){e.fillColor[0]=t.color.r/255,e.fillColor[1]=t.color.g/255,e.fillColor[2]=t.color.b/255,e.fillColor[3]=t.color.a,t.haloColor?(e.outlineColor[0]=t.haloColor.r/255,e.outlineColor[1]=t.haloColor.g/255,e.outlineColor[2]=t.haloColor.b/255,e.outlineColor[3]=t.haloColor.a):(e.outlineColor[0]=e.fillColor[0],e.outlineColor[1]=e.fillColor[1],e.outlineColor[2]=e.fillColor[2],e.outlineColor[3]=e.fillColor[3]),e.fillColor[3]*=t.fillOpacity,e.outlineColor[3]*=t.haloOpacity,e.fillColor[0]*=e.fillColor[3],e.fillColor[1]*=e.fillColor[3],e.fillColor[2]*=e.fillColor[3],e.outlineColor[0]*=e.outlineColor[3],e.outlineColor[1]*=e.outlineColor[3],e.outlineColor[2]*=e.outlineColor[3],e.outlineWidth=(1-t.haloBlur)*t.haloWidth,e.outerHaloWidth=t.haloBlur*t.haloWidth/2,e.innerHaloWidth=t.haloBlur*t.haloWidth/2,e.outlinePosition=0}const Sp=[0,0,0,0];let da=class{constructor(){this.type="single",this._highlightOptions=new zt,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*_e),this._minMaxDistance=[0,0]}setHighlightOptions(t){this._highlightOptions=t}applyHighlightOptions(t,e){this._updateGradientTexture(t),t.bindTexture(this._shadeTex,Tl),e.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<Sl)-1,activeGradient:this}]}_updateGradientTexture(t){const e=Pp(this._highlightOptions);if(e===this._optionsShadeTexKey)return;this._optionsShadeTexKey=e,Tp(this._highlightOptions,this._convertedHighlightOptions);const i=this._convertedHighlightOptions,n=i.outlinePosition-i.outlineWidth/2-i.outerHaloWidth,o=i.outlinePosition-i.outlineWidth/2,s=i.outlinePosition+i.outlineWidth/2,r=i.outlinePosition+i.outlineWidth/2+i.innerHaloWidth,h=Math.sqrt(Math.PI/2)*xp,c=Math.abs(n)>h?Math.round(10*(Math.abs(n)-h))/10:0,p=Math.abs(r)>h?Math.round(10*(Math.abs(r)-h))/10:0;let d;c&&!p?Qi().error("The outer rim of the highlight is "+c+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!c&&p?Qi().error("The inner rim of the highlight is "+p+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):c&&p&&Qi().error("The highlight is "+Math.max(c,p)+"px away from the edge of the feature; consider reducing some width values.");const m=[void 0,void 0,void 0,void 0];function u(y,w,I){m[0]=(1-I)*y[0]+I*w[0],m[1]=(1-I)*y[1]+I*w[1],m[2]=(1-I)*y[2]+I*w[2],m[3]=(1-I)*y[3]+I*w[3]}const{_texelData:g}=this;for(let y=0;y<_e;++y)d=n+y/(_e-1)*(r-n),d<n?(m[0]=0,m[1]=0,m[2]=0,m[3]=0):d<o?u(Sp,i.outlineColor,(d-n)/(o-n)):d<s?[m[0],m[1],m[2],m[3]]=i.outlineColor:d<r?u(i.outlineColor,i.fillColor,(d-s)/(r-s)):[m[0],m[1],m[2],m[3]]=i.fillColor,g[4*y]=255*m[0],g[4*y+1]=255*m[1],g[4*y+2]=255*m[2],g[4*y+3]=255*m[3];if(this._minMaxDistance[0]=n,this._minMaxDistance[1]=r,!this._shadeTex){const y=new Cl;y.wrapMode=kl.CLAMP_TO_EDGE,y.width=_e,y.height=1,this._shadeTex=new El(t,y)}this._shadeTex.updateData(0,0,0,_e,1,this._texelData)}};function Pp(t){return`${t.color};${t.haloColor};${t.haloOpacity};${t.fillOpacity};${t.haloWidth};${t.haloBlur}`}let kp=class{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(t){for(let e=0;e<t.length;e++)this.gradients[e]||(this.gradients[e]=new da),this.gradients[e].setHighlightOptions(t[e]);for(let e=t.length+1;e<this.gradients.length;e++)this.gradients[e].destroy();this.gradients.length=t.length}destroy(){for(const t of this.gradients)t.destroy()}getReasonsWithGradients(){let t=1;const e=[];for(let i=0;i<this.gradients.length;i++){const n=this.gradients[i];e.push({activeReasons:t,activeGradient:n}),t<<=1}return e}};const ua={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:t=>t.stencilRef,compare:Pl.EQUAL,mask:255,op:{fail:Ai.KEEP,zFail:Ai.KEEP,zPass:Ai.REPLACE}}}},Cp={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},Ep={...ua,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function Vp({pixelRatio:t,state:e,displayLevel:i,requiredLevel:n},o){const s=1/2**(i-o.key.level),r=1/2**(n-o.key.level);return{displayMat3:e.displayMat3,displayViewMat3:e.displayViewMat3,displayViewScreenMat3:o.transforms.displayViewScreenMat3,viewMat3:e.viewMat3,tileMat3:o.transforms.tileMat3,displayZoomFactor:s,requiredZoomFactor:r,tileOffset:[o.x,o.y],currentScale:e.scale,currentZoom:i,metersPerSRUnit:bs(e.spatialReference),rotation:e.rotation,pixelRatio:t}}function ma(t){return t.passOptions?.type==="highlight"}function ga(t){return t.passOptions?.type==="hittest"}function Rp(t){if(!ga(t))return null;const{position:e,distance:i,smallSymbolDistance:n,smallSymbolSizeThreshold:o}=t.passOptions;return{position:e,distance:i,smallSymbolDistance:n,smallSymbolSizeThreshold:o}}function Ip(t){if(!ma(t))return null;const{activeReasons:e,highlightAll:i}=t.passOptions;return{activeReasons:e,highlightAll:i?1:0}}function Bu(t,e,i){const n={};for(const o in i)typeof i[o]!="function"?n[o]=i[o]:n[o]=i[o](t,e);return n}function Ku(t,e){const{attributeView:i,context:n}=t;return{storage:i.getUniforms(n),view:Vp(t,e),hittestRequest:Rp(t),highlight:Ip(t)}}function Yu(t){return{inside:t.selection===ho.InsideEffect,outside:t.selection===ho.OutsideEffect}}function Dp(t){return ga(t)?Cp:ma(t)&&t.passOptions.stepType==="clear"?Ep:ua}function Qu(t){const{row:e,col:i}=t.key,n=i*po,o=e*po;return{tileOffsetFromLocalOrigin:[n%qe,o%qe],maxIntsToLocalOrigin:[Math.floor(n/qe),Math.floor(o/qe)]}}const Lp=new Xa({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function Xu(t){return Lp.toJSON(t)}function Ju(t){const{bandCount:e,attributeTable:i,colormap:n,pixelType:o}=t.raster.rasterInfo;return e===1&&(i!=null||n!=null||o==="u8"||o==="s8")}function Op(t,e){return e==null?(t?.destroy(),null):(t?.type==="single"&&Array.isArray(e)&&(t.destroy(),t=null),t?.type!=="multi"||Array.isArray(e)||(t.destroy(),t=null),t||(t=Array.isArray(e)?new kp:new da),Array.isArray(e)?t.type==="multi"&&t.setHighlightOptions(e):t.type==="single"&&t.setHighlightOptions(e),t)}function tm(t,e,i,n){const{painter:o,highlightGradient:s}=t,{highlight:r}=o.effects;if(!s)return;const h=t.passOptions,c=s.getReasonsWithGradients();for(let p=0;p<c.length;p++){const d={...t,passOptions:{type:"highlight",activeGradient:c[p].activeGradient,activeReasons:c[p].activeReasons,stepType:"burn",highlightAll:e}};if(r.bind(d),i(d),p<c.length-1){let u=0;for(let g=p+1;g<c.length;g++)u|=c[g].activeReasons;i({...t,passOptions:{type:"highlight",activeGradient:c[p].activeGradient,activeReasons:u,stepType:"clear",highlightAll:e}})}const m={...t,passOptions:{type:"highlight",activeGradient:c[p].activeGradient,activeReasons:c[p].activeReasons,stepType:"draw",highlightAll:e}};o.setPipelineState(Dp(t)),o.updatePipelineState(t.context),r.draw(m),r.unbind()}t.passOptions=h}const Ke=t=>parseFloat(t)/100;function zp(t,e,i){const n=typeof t.left=="string"?Ke(t.left)*e:t.left,o=typeof t.right=="string"?Ke(t.right)*e:t.right,s=typeof t.top=="string"?Ke(t.top)*i:t.top,r=typeof t.bottom=="string"?Ke(t.bottom)*i:t.bottom,h=s;return{xmin:n,xmax:Math.max(e-o,n),ymin:h,ymax:Math.max(i-r,s)}}function ya(t,e,i,n){switch(e.type){case"rect":{const{width:o,height:s}=t,{xmin:r,xmax:h,ymin:c,ymax:p}=zp(e,o,s),{x:d,y:m}=i;return d>r&&d<h&&m>c&&m<p}case"path":return e.path.length===0||!Array.isArray(e.path[0][0])||gr(e.path,[i.x,i.y]);case"geometry":return e.geometry==null||(e.geometry.type==="polygon"?_s(e.geometry,n):En(e.geometry,n))}}function Ap(t){if(!t.highlights)return null;const e=t.highlights.findIndex(i=>i.name==="default");return e===-1?null:t.highlights.items[e]}function Np(t,e){if(!t.highlights){if(!e)return;t.highlights=new R([new zt])}const i=t.highlights.findIndex(n=>n.name==="default");e?t.highlights.items[i].assignFrom(e):(t.highlights.removeAt(i),t.highlights.length===0&&(t.highlights=null))}async function Fp(t,e,i){const n=Rs(e)?Is(t,e):e;if(!t.ready||isNaN(n.x)||isNaN(n.y))return{screenPoint:n,results:[]};let o=new Set;const s=new Set;let r=!1,h=null,c=null;i?.include?ss(i.include,os(t,u=>{o.add(u),Xi(u,g=>s.add(g))},(u,g)=>{s.add(u),o.add(g)},u=>{h||(h=new Set),h.add(u)},u=>o.add(u),()=>r=!0)):(r=!0,o=new Set(t.allLayerViews),o.forEach(u=>{Xi(u,g=>s.add(g))})),i?.exclude&&ss(i.exclude,os(t,u=>{o.delete(u),Xi(u,g=>s.delete(g))},u=>s.delete(u),u=>{c||(c=new Set),c.add(u)}));const p=t.toMap(n),d=t.allLayerViews.filter(u=>!u.suspended&&o.has(u)&&u.clips.every(g=>ya(t,g,n,p))).reverse();let m=[...r?t.graphicsView.hitTest(p).map(u=>({type:"graphic",graphic:u,layer:null,mapPoint:p})):[],...await Promise.all(d.map(u=>u.hitTest(p,n)).toArray())].filter(Ee).flat().filter(Ee);return m=m.filter(u=>u.type!=="graphic"||u.layer?.type!=="subtype-group"||s.has(u.graphic.layer)),h&&(m=m.filter(u=>!("graphic"in u)||!u.graphic||h?.has(Tn(u.graphic)))),c&&(m=m.filter(u=>!("graphic"in u)||!u.graphic||!c?.has(Tn(u.graphic)))),{screenPoint:n,results:m}}function os(t,e,i,n,o,s){return r=>{if(r instanceof Tr){if(r.layer===t)s?.();else{const h=t.allLayerViews.find(c=>c.layer===r.layer);h&&o?.(h)}n(Tn(r))}else if(!("layer"in r&&"element"in r))if(r.type==="subtype-sublayer"){const h=t.allLayerViews.find(c=>c.layer===r.parent);h&&i(r,h)}else{const h=t.allLayerViews.find(c=>c.layer===r);h&&e(h)}}}function ss(t,e){if(t)if(Qn(t))for(const i of t)if(Qn(i))for(const n of i)e(n);else e(i);else e(t)}function Tn(t){const e=t.getObjectId();return e?`${t.layer?.uid??t.sourceLayer?.uid??"MapView"}/${e}`:`"MapView/${t.uid}`}function Xi({layer:t},e){t?.type==="subtype-group"&&t.sublayers.forEach(i=>{e(i)})}function fa(t,e,i){const{ctx:n,canvas:o}=_a(t,i),s=n.getImageData(0,0,t.width,t.height),r=ba(o,e);return wa(o),{dataUrl:r,data:s}}function va(t,e){const{ctx:i,canvas:n}=_a(t,e),o=i.getImageData(0,0,t.width,t.height);return wa(n),o}function _a(t,e){const i=Zp();e.premultipliedAlpha&&Wp(t),i.width=t.width,i.height=t.height;const n=i.getContext("2d",{willReadFrequently:!0});return n.putImageData(t,0,0),e.flipY&&Gp(n),{ctx:n,canvas:i}}function wa(t){t.width=0,t.height=0}function Zp(){return Ji==null&&(Ji=document.createElement("canvas")),Ji}let Ji=null;function ba(t,e){const i=qp[e.format],n=e.quality/100;return t.toDataURL(i,n)}function Ma(t,e){const i=$p(t),n=Up[i];return{format:i,quality:Ce(e??n,0,100)}}function xa(t,e){return e/Math.max(t[0],t[1])}function Hp(t,e,i,n=0,o=0,s=t.width-n,r=t.height-o,h=!1){const{data:c}=t,{width:p,height:d,data:m}=e,u=s/p,g=r/d,y=Math.ceil(u/2),w=Math.ceil(g/2),I=t.width;for(let V=0;V<d;V++)for(let lt=0;lt<p;lt++){const P=4*(lt+(h?d-V-1:V)*p);let T=0,H=0,B=0,ut=0,$n=0,Gn=0;const Ha=(V+.5)*g;for(let Ae=Math.floor(V*g);Ae<(V+1)*g;Ae++){const Wn=Math.abs(Ha-(Ae+.5))/w,$a=(lt+.5)*u,Ga=Wn*Wn;for(let Ne=Math.floor(lt*u);Ne<(lt+1)*u;Ne++){const qn=Math.abs($a-(Ne+.5))/y,Xt=Math.sqrt(Ga+qn*qn);if(Xt>=1)continue;let St=2*Xt*Xt*Xt-3*Xt*Xt+1;const Jt=4*(n+Ne+(o+Ae)*I);Gn+=St*c[Jt+3],H+=St,!i&&c[Jt+3]<255&&(St=St*c[Jt+3]/255),B+=St*c[Jt],ut+=St*c[Jt+1],$n+=St*c[Jt+2],T+=St}}m[P]=B/T,m[P+1]=ut/T,m[P+2]=$n/T,m[P+3]=Gn/H}return e}function $p(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return jp}}function Gp(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function Wp(t){const e=t.data,i=e.length;for(let n=0;n<i;n+=4){const o=e[n+3];if(o!==255&&o>0){const s=255/o;e[n]=e[n]*s,e[n+1]=e[n+1]*s,e[n+2]=e[n+2]*s}}}const qp={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},as=98,jp="png",Up={png:100,jpg:as,jpeg:as},em=Object.freeze(Object.defineProperty({__proto__:null,createEmptyImageData:Vl,encode:fa,encodeData:va,getFormatAndQuality:Ma,getMaximumResolutionScale:xa,resampleHermite:Hp,toDataUrl:ba},Symbol.toStringTag,{value:"Module"})),Ta={flipY:!0,premultipliedAlpha:!0};async function Bp(t,e){const i=await Sa(t,e),{format:n,quality:o}=Ma(e?.format,e?.quality);return fa(i,{format:n,quality:o},Ta)}async function Kp(t,e){const i=await Sa(t,e);return va(i,Ta)}function Sa(t,e){const i=Xp(e||{},Qp(t.stage,t.size),t.size,t.padding),n=Yp(e,t.allLayerViews);return t.stage.takeScreenshot(i,n,t.backgroundColor,e?.rotation)}function Yp(t={},e){if(!t.layers)return;const i=[];return t.layers.forEach(n=>{const o=e.find(s=>s.layer.id===n.id);o?.container&&i.push(o.container)}),i}function Qp(t,e){return Math.min(4,xa(e,Math.min(4096,t.context.parameters.maxTextureSize)))}function Xp(t,e,i,n){t.ignorePadding&&(n={left:0,right:0,top:0,bottom:0});let o=null;t.width!=null&&t.height!=null?o=[t.width,t.height]:t.width==null&&t.height!=null?o=[t.height,t.height]:t.width!=null&&t.height==null?o=[t.width,t.width]:t.width==null&&t.height==null&&(o=null);const s=i[0]-(n.left+n.right),r=i[1]-(n.top+n.bottom);let h,c,p=t.area||{x:0,y:0,width:s,height:r};if(o){const d=s/r,m=o[0]/o[1];if(m>d){const u=p.width/m;p={x:p.x,y:Math.round(p.y+(p.height-u)/2),width:p.width,height:Math.round(u)}}else{const u=p.height*m;p={x:Math.round(p.x+(p.width-u)/2),y:p.y,width:Math.round(u),height:p.height}}}else o=[p.width,p.height];return o[0]>p.width?(h=Math.min(o[0]/p.width,e),c=o[0]/p.width/h):(h=1,c=o[0]/p.width),{cropArea:{x:Math.round((p.x+n.left)*h),y:Math.round((p.y+n.top)*h),width:Math.round(p.width*h),height:Math.round(p.height*h)},outputScale:c,resolutionScale:h}}const Jp=t=>t.includes("Brush");let Pa=class{constructor(){this._names=new Map}begin(t){this._names.has(t)||(this._names.set(t,!1),Jp(t)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${t}.Start`))}end(t){this._names.has(t)&&!this._names.get(t)&&(this._names.set(t,!0),performance.mark(`Esri.${t}.End`))}record(t){this._names.has(t)||(this._names.set(t,!0),performance.mark(`Esri.${t}`))}};function td(t){const e=Rl();return e.available?t==="3d"&&e.majorPerformanceCaveat?new E("webgl:major-performance-caveat-detected",`Your WebGL implementation (${e.unmaskedRenderer}) doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.`):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new E("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new E("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new E("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function ed(t){return t&&"nodeType"in t}function id(t){return t&&typeof t.render=="function"}const rs={component:"esri-component"};let $t=class extends x{constructor(){super(...arguments),this.widget=null}destroy(){this.node=null,this.widget?.destroy()}get id(){return this._get("id")??this.widget?.id??this.node?.id}set id(t){this._set("id",t)}set node(t){const e=this._get("node");t!==e&&(t&&t.classList.add(rs.component),e&&e.classList.remove(rs.component),this._set("node",t))}castNode(t){return this.widget?.destroy(),t?typeof t=="string"||ed(t)?(this._set("widget",null),Es(t)):(id(t)&&!t.domNode&&(t.domNode=document.createElement("div")),this._set("widget",t),t.domNode):(this._set("widget",null),null)}};a([l()],$t.prototype,"id",null),a([l()],$t.prototype,"node",null),a([jt("node")],$t.prototype,"castNode",null),a([l({readOnly:!0})],$t.prototype,"widget",void 0),$t=a([v("esri.views.ui.Component")],$t);const ii=$t,nd={left:0,top:0,bottom:0,right:0},ka={bottom:30,top:15,right:15,left:15},yt="esri-ui",W={ui:yt,corner:`${yt}-corner`,innerContainer:`${yt}-inner-container`,manualContainer:`${yt}-manual-container`,cornerContainer:`${yt}-corner-container`,topLeft:`${yt}-top-left`,topRight:`${yt}-top-right`,bottomLeft:`${yt}-bottom-left`,bottomRight:`${yt}-bottom-right`};function od(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function Ye(t){return t===0?"0":`${t}px`}function tn(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function en(t,{top:e,bottom:i,left:n,right:o}){t.style.top=e,t.style.bottom=i,t.style.left=n,t.style.right=o}let pt=class extends Le.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=Ja(),this.view=null,this._applyViewPadding=()=>{const e=this.container;e&&en(e,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const e=this._innerContainer;e&&en(e,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([_(()=>[this.view?.padding,this.container],this._applyViewPadding,G),_(()=>this.padding,this._applyUIPadding,G),_(()=>[this.container,this._locale],([t,e])=>{t&&t.setAttribute("lang",e)},G),tr(t=>{this._locale=t})])}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._componentMap.clear()}set container(t){const e=this._get("container");t!==e&&(t&&(t.classList.add(W.ui),Il(t),this._attachContainers(t)),e&&(e.classList.remove(W.ui),en(e,{top:"",bottom:"",left:"",right:""}),e.textContent=""),this._set("container",t))}get height(){const t=this.view?.height??0;if(t===0)return t;const e=this._getViewPadding(),{top:i,bottom:n}=e;return Math.max(t-i-n,0)}get padding(){return this._get("padding")}set padding(t){this._overrideIfSome("padding",t)}castPadding(t){return typeof t=="number"?{bottom:t,top:t,right:t,left:t}:{...ka,...t}}get width(){const t=this.view?.width??0;if(t===0)return t;const e=this._getViewPadding(),{left:i,right:n}=e;return Math.max(t-i-n,0)}add(t,e){let i,n,o;if(Array.isArray(t))return void t.forEach(r=>this.add(r,e));const s=tn(t);s&&({index:i,position:e,component:t,key:n}=s),e&&typeof e=="object"&&({index:i,key:n,position:e,internal:o}=e),!t||e&&!this._isValidPosition(e)||this._add(t,e,i??this._getNumComponentsAtPosition(e),n,o)}remove(t,e){if(!t)return;if(Array.isArray(t))return t.map(n=>this.remove(n,e));const i=this._find(t);if(i){const n=this._componentMap.get(i);if(!n||n.key!==e)return;const o=this._components.indexOf(i);return i.node.parentNode?.removeChild(i.node),this._componentMap.delete(i),i.widget?.removeHandlesReference(this._removeWidgetHandleKey),this._components.forEach(s=>{const r=this._componentMap.get(s);r&&r.position===n.position&&r.index>n.index&&r.index--}),this._components.splice(o,1)[0]}}empty(t,e={removeInternal:!1}){if(Array.isArray(t)){for(const o of t)this.empty(o,e);return}const i=this._positionNameToContainerLookup[t??"manual"],n=Array.prototype.slice.call(i.children).map(o=>this._findByNode(o)).filter(o=>o==null?!1:!(this._componentMap.get(o)?.internal??!1)||e.removeInternal);for(const o of n)this.remove(o)}move(t,e){if(Array.isArray(t)&&t.forEach(s=>this.move(s,e)),!t)return;let i;const n=tn(t)||tn(e);if(n&&(i=n.index,e=n.position,t=n.component||t),e&&!this._isValidPosition(e))return;const o=this.remove(t);o&&this.add(o,{position:e,index:i})}find(t){if(!t)return null;const e=this._findById(t);return e&&(e.widget||e.node)}getComponents(t,e={includeInternal:!1}){return t?Array.isArray(t)?t.flatMap(i=>this._getComponentsAtPosition(i,e)):this._getComponentsAtPosition(t,e):this._components.filter(i=>e.includeInternal||!this._componentMap.get(i)?.internal).map(({widget:i,node:n})=>i??n)}getPosition(t){for(const e in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[e].contains(t))return e;return null}_add(t,e,i,n,o){t instanceof ii||(t=new ii({node:t}));const{widget:s}=t;s!=null&&s instanceof x&&s.addHandles(Mi(()=>{queueMicrotask(()=>this.remove(t))}),this._removeWidgetHandleKey),this._components.some(r=>this._componentMap.get(r)?.position===e&&this._componentMap.get(r)?.index===i)&&this._components.forEach(r=>{const h=this._componentMap.get(r);h&&h.position===e&&h.index>=i&&h.index++}),this._place({component:t,position:e,index:i}),this._components.push(t),this._componentMap.set(t,{key:n,position:e,internal:o,index:i})}_find(t){return t?t instanceof ii?this._findByComponent(t):typeof t=="string"?this._findById(t):"domNode"in t?this._findByNode(t.domNode):this._findByNode(t):null}_getViewPadding(){return this.view?.padding??nd}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer)}_initContainers(){const t=document.createElement("div");t.classList.add(W.innerContainer,W.cornerContainer);const e=document.createElement("div");e.classList.add(W.innerContainer,W.manualContainer);const i=document.createElement("div");i.classList.add(W.topLeft,W.corner),t.appendChild(i);const n=document.createElement("div");n.classList.add(W.topRight,W.corner),t.appendChild(n);const o=document.createElement("div");o.classList.add(W.bottomLeft,W.corner),t.appendChild(o);const s=document.createElement("div");s.classList.add(W.bottomRight,W.corner),t.appendChild(s),this._innerContainer=t,this._manualContainer=e;const r=Ir();this._cornerNameToContainerLookup={"top-left":i,"top-right":n,"bottom-left":o,"bottom-right":s,"top-leading":r?n:i,"top-trailing":r?i:n,"bottom-leading":r?s:o,"bottom-trailing":r?o:s},this._positionNameToContainerLookup={manual:e,...this._cornerNameToContainerLookup}}_isValidPosition(t){return!!this._positionNameToContainerLookup[t]}_place(t){const e=t.position??"manual",{component:i,index:n}=t,o=this._positionNameToContainerLookup[e],s=n!=null&&n>-1;if(od(i.widget)&&i.widget.startup(),!s)return void o.appendChild(i.node);const r=Array.from(o.children);if(r.length!==0){for(const h of r){const c=this._findByNode(h);if(c&&n<(this._componentMap.get(c)?.index??0))return void h.parentNode?.insertBefore(i.node,h)}o.appendChild(i.node)}else o.appendChild(i.node)}_toPixelPosition(t){return{top:Ye(t.top),left:Ye(t.left),right:Ye(t.right),bottom:Ye(t.bottom)}}_findByComponent(t){return this._components.find(e=>e===t)??null}_findById(t){return this._components.find(({id:e})=>e===t)??null}_findByNode(t){return t?this._components.find(({node:e})=>e===t):null}_getComponentsAtPosition(t,e){const i=this._positionNameToContainerLookup[t];return Array.prototype.slice.call(i.children).map(n=>this._findByNode(n)).filter(Ee).filter(n=>e.includeInternal||!this._componentMap.get(n)?.internal).map(({widget:n,node:o})=>n??o)}_getNumComponentsAtPosition(t){return this._positionNameToContainerLookup[t]?.children.length??0}};a([l()],pt.prototype,"_locale",void 0),a([l()],pt.prototype,"container",null),a([l()],pt.prototype,"height",null),a([l({value:ka})],pt.prototype,"padding",null),a([jt("padding")],pt.prototype,"castPadding",null),a([l()],pt.prototype,"view",void 0),a([l()],pt.prototype,"width",null),pt=a([v("esri.views.ui.UI")],pt);const sd=pt,ad=new Map;function rd(t){return ad.get(t)}function ls(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function ld(t,e){return t.length!==e.length||t.some((i,n)=>i.text!==e[n].text)}function we(t,e,i){!i||!e||t.find(n=>n.layerView===e&&n.text===i)||t.push({text:i,layerView:e})}function hd(t){return t.type==="bing-maps"}const ft=[];let ce=class extends x{constructor(t){super(t),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new R,this.view=null,this._allLayerViewsChange=e=>{this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const i=this.view?.allLayerViews;i&&(this.addHandles(i.map(n=>_(()=>[n.suspended,n.layer?.attributionVisible],()=>this._updateAttributionItems())).toArray(),"suspension"),i.forEach(n=>{n.declaredClass==="esri.views.3d.layers.Tiles3DLayerView3D"&&this.addHandles(n.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),e?.removed&&e.removed.forEach(n=>{this._pendingAttributions.delete(n),this._fetchedAttributionData.delete(n)}),this._updateAttributionItems()},this.addHandles([_i(()=>this.view?.allLayerViews,"change",e=>this._allLayerViewsChange(e),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),Yt(()=>this.view?.stationary===!0,()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.view?.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const t=this.view,e=t?.allLayerViews;if(ft.length=0,!t||!e)return void this._clear();e.forEach(n=>{if(n.suspended||!n.layer?.attributionVisible)return;const o=n.layer;if(ls(o,"user"))return void we(ft,n,o.copyright);if(o.hasAttributionData){if(this._fetchedAttributionData.has(n)){const r=this._fetchedAttributionData.get(n);return void(r?we(ft,n,this._getDynamicAttribution(r,t,o)):ls(o)&&we(ft,n,o.copyright))}return void this._fetchAttributionData(n)}const s="portalItem"in o?o.portalItem?.accessInformation:void 0;we(ft,n,s||o.copyright)});const i=e.find(n=>n.layer?.type==="integrated-mesh-3dtiles");if(this.view&&i){const n=rd(this.view);if(n){const o=n.getAttributionText();for(let s=0;s<o.length;++s)we(ft,i,o[s])}}ld(this.items,ft)&&(this.items.removeAll(),this.items.addMany(ft)),ft.length=0,this.notifyChange("state")}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const e=await Or(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const i=e.ok?this._createContributionIndex(e.value,hd(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,i)}this._updateAttributionItems()}_createContributionIndex(t,e){const i=t.contributors,n={};if(!i)return n;for(let o=0;o<i.length;o++){const s=i[o],r=s.coverageAreas;if(!r)return;for(const h of r){const c=h.bbox,p=h.zoomMin-(e&&h.zoomMin?1:0),d=h.zoomMax-(e&&h.zoomMax?1:0),m=new Qt({xmin:c[1],ymin:c[0],xmax:c[3],ymax:c[2],spatialReference:ai.WGS84}),u={extent:yr(m),attribution:s.attribution||"",score:h.score!=null?h.score:100,id:o};for(let g=p;g<=d;g++)n[g]??=[],n[g].push(u)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(t,e,i){const{extent:n,scale:o}=e;let s=i.tileInfo?.scaleToZoom(o)??0;if(s=Math.min(t.maxKey??0,Math.round(s)),!n||s==null||s<=-1)return"";const r=t[s],h=fr(n.center.clone().normalize(),ai.WebMercator),c=new Set;return r?r.filter(p=>{const d=p.id,m=!c.has(d)&&h&&p.extent&&En(p.extent,h);return m&&c.add(d),m}).sort((p,d)=>d.score-p.score||p.objectId-d.objectId).map(p=>p.attribution).join(", "):""}};a([l({readOnly:!0,type:R})],ce.prototype,"items",void 0),a([l({readOnly:!0})],ce.prototype,"state",null),a([l()],ce.prototype,"view",void 0),ce=a([v("esri.widgets.Attribution.AttributionViewModel")],ce);const Ca=ce;function cd(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:dd(t[e])}}}function pd(t){const e=t?.type;return t instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function dd(t){return function(e,...i){pd(e)?Dr(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...i)}}const ne="esri-attribution",oe={base:ne,poweredBy:`${ne}__powered-by`,sources:`${ne}__sources`,open:`${ne}--open`,sourcesOpen:`${ne}__sources--open`,link:`${ne}__link`};let $=class extends Pi{constructor(t,e){super(t,e),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(i=>i.forEach(({target:n})=>this._checkSourceTextOverflow(n))),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new Ca}initialize(){this.addHandles(_i(()=>this.viewModel?.items,"change",()=>this.scheduleRender()))}destroy(){this._resizeObserver?.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((t,e)=>(t.includes(e.text)||t.push(e.text),t),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){const t={[oe.open]:this._isOpen};return U("div",{bind:this,class:this.classes(oe.base,dt.widget,t),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return U("div",{class:oe.poweredBy},"Powered by"," ",U("a",{class:oe.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const t=this._isOpen,e=this._isInteractive,i=e?0:void 0,{attributionText:n}=this,o={[oe.sourcesOpen]:t,[dt.interactive]:e};return U("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(oe.sources,o),innerHTML:n,tabIndex:i})}_afterSourcesNodeCreate(t){this._prevSourceNodeHeight=t.clientWidth,this._resizeObserver.observe(t)}_checkSourceTextOverflow(t){let e=!1;const{clientHeight:i,clientWidth:n,scrollWidth:o}=t,s=o>n,r=this._attributionTextOverflowed!==s;if(this._attributionTextOverflowed=s,r&&(e=!0),this._isOpen){const h=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,h&&(this._isOpen=!1,e=!0)}e&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};a([l()],$.prototype,"_isOpen",void 0),a([l()],$.prototype,"_isInteractive",null),a([l()],$.prototype,"_attributionTextOverflowed",void 0),a([l()],$.prototype,"_prevSourceNodeHeight",void 0),a([l({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],$.prototype,"attributionText",null),a([l()],$.prototype,"icon",null),a([l()],$.prototype,"itemDelimiter",void 0),a([l()],$.prototype,"label",null),a([l(),Si("esri/widgets/Attribution/t9n/Attribution")],$.prototype,"messages",void 0),a([l()],$.prototype,"view",null),a([l({type:Ca})],$.prototype,"viewModel",void 0),a([cd()],$.prototype,"_toggleState",null),$=a([v("esri.widgets.Attribution")],$);const ud=$;function md(){const t=F("mapview-essential-goto-duration");return t==null?t:et(t)}function gd(t){return t?.spatialReference?.isWebMercator||t?.spatialReference?.isGeographic||!1}function yd(t,e,i){return t.goTo(e,i)}const fd=t=>{let e=class extends t{constructor(...i){super(...i),this.goToOverride=null,this.view=null}callGoTo(i){const{view:n}=this;return vr(n),this.goToOverride?this.goToOverride(n,i):yd(n,i.target,i.options)}};return a([l()],e.prototype,"goToOverride",void 0),a([l()],e.prototype,"view",void 0),e=a([v("esri.widgets.support.GoTo")],e),e};let Gt=class extends fd(x){constructor(t){super(t),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._watchForView(G)}destroy(){this.view=null}get canShowNorth(){return gd(this.view)}get state(){return!this.view?.ready||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){this.view?.ready&&(this.view?.type==="2d"?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:md()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(t){t!=null&&this._set("orientation",{z:t})}_updateForCamera(t){if(!t)return;const e=-t.heading;this._set("orientation",{x:0,y:0,z:e})}_updateRotationWatcher(t){this.removeAllHandles(),this._watchForView(),t&&this.addHandles(t.type==="2d"?_(()=>t?.rotation,this._updateForRotation,G):_(()=>t?.camera,this._updateForCamera,G))}_watchForView(t){this.addHandles(_(()=>this.view,this._updateRotationWatcher,t))}};a([l({readOnly:!0})],Gt.prototype,"canShowNorth",null),a([l({readOnly:!0})],Gt.prototype,"orientation",void 0),a([l({readOnly:!0})],Gt.prototype,"state",null),a([l()],Gt.prototype,"view",void 0),Gt=a([v("esri.widgets.Compass.CompassViewModel")],Gt);const Ea=Gt,hs="esri-compass",cs={base:hs,iconContainer:`${hs}__icon-container`};let _t=class extends Pi{constructor(t,e){super(t,e),this.messages=null,this.viewModel=new Ea,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=i=>({transform:`rotateZ(${i.z}deg)`})}loadDependencies(){return Vn({button:()=>M(()=>import("./index-CK6nlFfs-nahm5_a5.js"),__vite__mapDeps([312,313,4,1,2,3,5,6,314,315,316,317,318,319,320,321,322,323,324]),import.meta.url),icon:()=>M(()=>import("./index-DV38aJMs-NHO8o_KZ.js"),__vite__mapDeps([316,4,1,2,3,5,6,317,318]),import.meta.url).then(t=>t.i)})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}reset(){return this.viewModel.reset()}render(){const{orientation:t,state:e}=this.viewModel,{messages:i}=this;return U("div",{class:this.classes(cs.base,dt.widget)},U("calcite-button",{class:dt.widgetButton,disabled:e==="disabled",kind:"neutral",label:i.reset,onclick:this._reset,round:!0,scale:"s",title:i.reset},U("div",{"aria-hidden":"true",class:cs.iconContainer,title:i.reset},U("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(t)}))))}};a([l()],_t.prototype,"goToOverride",null),a([l()],_t.prototype,"icon",null),a([l()],_t.prototype,"label",null),a([l(),Si("esri/widgets/Compass/t9n/Compass")],_t.prototype,"messages",void 0),a([l()],_t.prototype,"view",null),a([l({type:Ea})],_t.prototype,"viewModel",void 0),_t=a([v("esri.widgets.Compass")],_t);const vd=_t,ps="esri-navigation-toggle",ds={base:ps,isLayoutHorizontal:`${ps}--horizontal`};let pe=class extends x{constructor(t){super(t),this._navigationMode="pan",this.view=null,t?.isDefaultViewModel||_r(C.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.33"})}normalizeCtorArgs(t={}){const{isDefaultViewModel:e,...i}=t;return i}initialize(){this.addHandles(Yt(()=>this.view?.navigation?.actionMap,()=>this._updateNavigationActionMap()))}destroy(){this.view=null}get state(){return this.view?.ready&&this.view?.type==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(t){this._navigationMode=t,this._updateNavigationActionMap()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_updateNavigationActionMap(){const t=this.view?.navigation?.actionMap;if(!t)return;const e=this._navigationMode==="pan";t.dragPrimary=e?"pan":"rotate",t.dragSecondary=e?"rotate":"pan"}};a([l({readOnly:!0})],pe.prototype,"state",null),a([l()],pe.prototype,"_navigationMode",void 0),a([l()],pe.prototype,"view",void 0),pe=a([v("esri.widgets.NavigationToggle.NavigationToggleViewModel")],pe);const Va=pe;let wt=class extends Pi{constructor(t,e){super(t,e),this.messages=null,this.viewModel=new Va({isDefaultViewModel:!0}),this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{const i=this.viewModel?.navigationMode==="pan"?this._rotateButton:this._panButton;Lr(i),this.toggle()},t?.isDefaultUI||wr(C.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.32"})}normalizeCtorArgs(t={}){const{isDefaultUI:e,...i}=t;return i}loadDependencies(){return Vn({button:()=>M(()=>import("./index-CK6nlFfs-nahm5_a5.js"),__vite__mapDeps([312,313,4,1,2,3,5,6,314,315,316,317,318,319,320,321,322,323,324]),import.meta.url)})}get icon(){return"move"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}set layout(t){t!=="horizontal"&&(t="vertical"),this._set("layout",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){const t=this.viewModel?.state==="disabled",e=this.viewModel?.navigationMode==="pan",i=this.messages.toggle;return U("div",{class:this.classes(ds.base,dt.widget,{[ds.isLayoutHorizontal]:this.layout==="horizontal"})},U("calcite-button",{afterCreate:n=>{this._panButton=n},appearance:e?"outline-fill":"solid",class:dt.widgetButton,disabled:t,iconStart:"move",kind:"neutral",label:i,onclick:this._toggle,tabIndex:e?void 0:-1,title:i}),U("calcite-button",{afterCreate:n=>{this._rotateButton=n},appearance:e?"solid":"outline-fill",class:dt.widgetButton,disabled:t,iconStart:"rotate",kind:"neutral",label:i,onclick:this._toggle,tabIndex:e?-1:void 0,title:i}))}};a([l()],wt.prototype,"icon",null),a([l()],wt.prototype,"label",null),a([l({value:"vertical"})],wt.prototype,"layout",null),a([l(),Si("esri/widgets/NavigationToggle/t9n/NavigationToggle")],wt.prototype,"messages",void 0),a([l()],wt.prototype,"view",null),a([l({type:Va})],wt.prototype,"viewModel",void 0),wt=a([v("esri.widgets.NavigationToggle")],wt);const _d=wt;let Wt=class extends x{get canZoomIn(){if(!this.view?.ready)return!1;const t=this.view?.constraints?.effectiveMaxScale;return t===0||this._scale>t}get canZoomOut(){const{view:t}=this;if(!t?.ready)return!1;const e=t.constraints?.effectiveMinScale;return e===0||this._scale<e}get _scale(){const t=this.view?.animation?.target;return(t&&"then"in t?void 0:t?.scale)??this.view?.scale??0}};a([l({readOnly:!0})],Wt.prototype,"canZoomIn",null),a([l({readOnly:!0})],Wt.prototype,"canZoomOut",null),a([l()],Wt.prototype,"view",void 0),a([l()],Wt.prototype,"_scale",null),Wt=a([v("esri.widgets.Zoom.ZoomConditions2D")],Wt);const wd=Wt;let de=class extends x{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};a([l({readOnly:!0})],de.prototype,"canZoomIn",null),a([l({readOnly:!0})],de.prototype,"canZoomOut",null),a([l()],de.prototype,"view",void 0),de=a([v("esri.widgets.Zoom.ZoomConditions3D")],de);const bd=de;let Lt=class extends x{constructor(t){super(t)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){return this._zoomConditions!=null&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(t){t?t.type==="2d"?this._zoomConditions=new wd({view:t}):t.type==="3d"&&(this._zoomConditions=new bd({view:t})):this._zoomConditions=null,this._set("view",t)}zoomIn(){const t=this.view;this.canZoomIn&&t&&(t.type==="2d"?t.mapViewNavigation.zoomIn():Xn(t.goTo({zoomFactor:2})))}zoomOut(){const t=this.view;this.canZoomOut&&t&&(t.type==="2d"?t.mapViewNavigation.zoomOut():Xn(t.goTo({zoomFactor:.5})))}};a([l()],Lt.prototype,"_zoomConditions",void 0),a([l()],Lt.prototype,"canZoomIn",null),a([l()],Lt.prototype,"canZoomOut",null),a([l({readOnly:!0})],Lt.prototype,"state",null),a([l()],Lt.prototype,"view",null),Lt=a([v("esri.widgets.Zoom.ZoomViewModel")],Lt);const Ra=Lt,us={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let bt=class extends Pi{constructor(t,e){super(t,e),this.messages=null,this.viewModel=new Ra,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return Vn({button:()=>M(()=>import("./index-CK6nlFfs-nahm5_a5.js"),__vite__mapDeps([312,313,4,1,2,3,5,6,314,315,316,317,318,319,320,321,322,323,324]),import.meta.url)})}get icon(){return"magnifying-glass-plus"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}set layout(t){t!=="horizontal"&&(t="vertical"),this._set("layout",t)}set view(t){this.viewModel.view=t}get view(){return this.viewModel.view}render(){const t={[us.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:e,canZoomOut:i}=this.viewModel,{zoomIn:n,zoomOut:o}=this.messages;return U("div",{class:this.classes(us.base,dt.widget,t)},U("calcite-button",{class:dt.widgetButton,disabled:!e,iconStart:"plus",kind:"neutral",label:n,onclick:this.zoomIn,title:n}),U("calcite-button",{class:dt.widgetButton,disabled:!i,iconStart:"minus",kind:"neutral",label:o,onclick:this.zoomOut,title:o}))}};a([l()],bt.prototype,"icon",null),a([l()],bt.prototype,"label",null),a([l({value:"vertical"})],bt.prototype,"layout",null),a([l(),Si("esri/widgets/Zoom/t9n/Zoom")],bt.prototype,"messages",void 0),a([l()],bt.prototype,"view",null),a([l({type:Ra})],bt.prototype,"viewModel",void 0),bt=a([v("esri.widgets.Zoom")],bt);const Md=bt;function xd(t){return t?.view!==void 0}let ni=class extends sd{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=e=>{this.components.forEach(i=>{const n=this._find(i),o=n?.widget;xd(o)&&(o.view=e)})},this._componentsWatcher=(e,i)=>{this._removeComponents(i),this._addComponents(e),this._adjustPadding(e)}}initialize(){this.addHandles([_(()=>this.components,this._componentsWatcher,G),_(()=>this.view,this._updateViewAwareWidgets,G)])}_add(t,e,i,n,o){let s=t;if(typeof t=="string"&&this._defaultPositionLookup[t]){if(this._find(t))return;s=this._createComponent(t)}super._add(s,e,i,n,o)}_removeComponents(t){t.forEach(e=>{const i=this._find(e);i&&(this.remove(i),i.destroy())})}_adjustPadding(t){if(!t.includes("attribution")&&!this._isOverridden("padding")){const{top:e}=this.padding;this.padding=e}}_addComponents(t){this.constructed&&t.forEach(e=>this.add(this._createComponent(e),this._defaultPositionLookup[e]))}_createComponent(t){const e=this._createWidget(t);return new ii({id:t,node:e})}_createWidget(t){const e=this.view;switch(t){case"attribution":return new ud({view:e});case"compass":return new vd({view:e});case"navigation-toggle":return new _d({view:e,isDefaultUI:!0});case"zoom":return new Md({view:e})}}};a([l()],ni.prototype,"components",void 0),ni=a([v("esri.views.ui.DefaultUI")],ni);const Ia=ni;let oi=class extends Ia{constructor(t){super(t),this.components=["attribution","zoom"]}};a([l()],oi.prototype,"components",void 0),oi=a([v("esri.views.ui.2d.DefaultUI2D")],oi);const Da=oi;let La,Oa,za,Aa,Na,Fa,Za;async function Td(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:i,MapViewNavigation:n,MagnifierView2D:o,GridView2D:s,Stage:r}]=await Promise.all([M(()=>import("./webglDeps-B1MbyxEI-BNtg1uWc.js"),__vite__mapDeps([176,177,1,2,170,169,171,69,178,179,180]),import.meta.url),M(()=>import("./mapViewDeps-C9uprLPQ-Br7Y9k1R.js"),__vite__mapDeps([181,1,2,132,48,22,49,182,183,184,185,70,69,186,46,44,45,168,187,188,134,133,157,160,189,190,165,166,25,128,167,14,15,16,17,191,192,170,169,171,178,177,179,193,194,195,141,196,197,159,198,199,200,163,201,202,203,59,20,21,204,205,206,158,207,71,72,34,208,173,209,210,211,212,213,39,40,23,41,42,43,214,215,216,176,180,217,218,219,220,24,26,221,222,223,224,225,172,68,226,3,87,52,227,74,64,65,62,66,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,57,243,101,244,245,10,138,94,139,140,4,5,6,142,143,144,114,145,146,110,147,148,149,150,151,93,152,82,153,154,55,155,156,161,162,164,76,174,175]),import.meta.url)]);Oa=t,za=e,Aa=i,Na=n,Fa=o,Za=s,La=r}let b=class extends Fc(ec(zl($l(Hl(kh))))){constructor(t){super(t),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new Ss({getCollections:()=>[this.basemapView?.baseLayerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.graphicsView=null,this.labelManager=null,this.navigation=new Vi({actionMap:new On({dragTertiary:"none"})}),this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.floors=new R,this.grid=null,this.map=null,this.spatialReferenceLocked=!1,this.timeline=new Pa,this.type="2d",this.view2dType=null,this.ui=new Da,this.test={takeScreenshot:async e=>Kp(this._getScreenshotView(e),e)},this.padding={top:0,right:0,bottom:0,left:0},Cr()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=at(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new Mp(this.featuresTilingScheme)}get constraintsInfo(){const t=this.defaultsFromMap?.tileInfo,e=this.spatialReference;return{lods:t?.spatialReference?.equals(e)?t.lods:null,spatialReference:e}}get initialExtentRequired(){if(!this.stateManager)return!1;const{scale:t,constraints:e,center:i,viewpoint:n,extent:o}=this;let s=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties?.viewpoint)&&!o&&(e?.effectiveLODs||(s=-1),(!i||t===0&&s===-1)&&(n?.targetGeometry==null||n.targetGeometry.type!=="extent"&&!n.scale))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const t=this._getDefaultViewpoint();if(!t)return!1;const e=t.targetGeometry,i=this.spatialReference;return Er(e.spatialReference,i)}get background(){return Li(this.map)?this.map.initialViewProperties.background:null}set background(t){this._override("background",t)}get center(){return this.stateManager?.center??null}set center(t){this.stateManager.center=t}get highlightOptions(){return Ap(this)}set highlightOptions(t){Np(this,t)}get padding(){return this.stateManager?.padding}set padding(t){this.stateManager&&(this.stateManager.padding=t)}get rendering(){return this.stage?.renderRequested??!1}get resolution(){return this.stateManager.resolution??0}get scale(){return this.stateManager?.scale??0}set scale(t){this.stateManager&&(this.stateManager.scale=t)}get tileInfo(){return this.featuresTilingScheme?.tileInfo}get updating(){const t=!(!this.magnifier.visible||this.magnifier.position===null||!this._magnifierView?.updatingHandles.updating),e=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(i=>!i.destroyed&&!("layerViews"in i)&&i.updating===!0)||t);if(F("esri-2d-log-updating")){const i=this.allLayerViews.reduce((n,o)=>({...n,[`${o.layer.id}(${o.layer.type})`]:!o.destroyed&&!("layerViews"in o)&&o.updating}),{});console.log(`Updating MapView: ${e}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${this.layerViewManager?.updating}
-> labelManager.updating: ${this.labelManager?.updating}
-> graphicsView.updating: ${this.graphicsView?.updating}
-> allLayerViews: ${JSON.stringify(i)}
-> updatingMagnifier: ${t}
`)}return e}get visibleArea(){const t=this.stateManager.visibleArea;return t&&new Ms({rings:[t.map(e=>[e[0],e[1]])],spatialReference:this.spatialReference})}get zoom(){return this.stateManager.zoom??-1}set zoom(t){this.stateManager.zoom=t}get navigating(){return this.mapViewNavigation?.interacting??!1}async hitTest(t,e){return Fp(this,t,e)}async takeScreenshot(t){return Bp(this._getScreenshotView(t),t)}toScreen(t,e){return this.stateManager.toScreen(t,e)}whenLayerView(t){return super.whenLayerView(t)}graphicChanged(t){this.graphicsView&&this.graphicsView.graphicUpdateHandler(t)}whenReady(){return new Promise(t=>{this.ready?t(this):this._resolveWhenReady.push(t)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||this.defaultsFromMap?.spatialReference||null}getDefaultTimeZone(){return Li(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return Li(this.map)?this.map.initialViewProperties.timeExtent:null}hasLayerViewModule(t){return ns.hasLayerViewModule(t)}importLayerView(t){return ns.importLayerView(t)}pixelSizeAt(){return this.ready?this.resolution:(C.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(t){const e=this.toMap(t),i=await this.hitTest(t),n=this.allLayerViews.toArray().filter(c=>c.clips.every(p=>ya(this,p,t,e))).reverse(),o=new globalThis.Map(n.map(c=>[c.layer.uid,c])),s=[];let r=0,h=0;for(;r<i.results.length||h<n.length;){const c=i.results.at(r);if(c&&c.type!=="graphic"){++r;continue}const p=o.get((c?.layer??c?.graphic.layer)?.uid);if((!c||p)&&h<n.length&&n.at(h)!==p){const d=n.at(h);"fetchPopupFeaturesAtLocation"in d&&s.push({mapPoint:e,layerView:d}),++h}else c&&(s.push({graphic:c.graphic,layerView:p}),++r)}return{hits:s,location:e}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let t=td(this.type);if(F("safari")&&F("safari")<9&&(t=new E("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:F("safari")})),t!=null){C.getLogger(this).warn("#validate()",t.message);const e=document.createElement("div");e.setAttribute("style","display: flex; flex-direction: column; gap: 8px; padding: 20px; height: 100%; justify-content: center; color: black; background: white; font-family: sans-serif;");const i=document.createElement("div");i.innerHTML="Unable to display map. WebGL2 support is required.",i.setAttribute("style","font-size: 24px; font-weight: bold;");const n=document.createElement("div");n.innerHTML="Ensure that your browser and hardware meet the minimum requirements.",n.setAttribute("style","font-size: 18px;");const o=document.createElement("a");throw o.innerHTML="https://esriurl.com/systemRequirements",o.target="_blank",o.setAttribute("style","font-size: 18px;"),o.href="https://esriurl.com/systemRequirements",e.appendChild(i),e.appendChild(n),e.appendChild(o),this.surface.appendChild(e),t}}loadAsyncDependencies(){return Td()}_getDefaultViewpoint(){const{constraints:t,initialExtent:e,map:i,padding:n,size:o}=this;if(!t)return null;const s=i&&"initialViewProperties"in i?i.initialViewProperties:void 0,r=this.stateManager.getUserStartupOptions(this.size),h=s?.viewpoint,c=h?.targetGeometry?.extent??e,p=c?.center,d=h?.rotation??0,m=h?.scale||c&&Ri(c,[o[0]-n.left-n.right,o[1]-n.top-n.bottom]),u=r.center??p,g=r.rotation??d,y=r.scale??m;return u&&y?new it({targetGeometry:u,scale:y,rotation:g}):null}_startup(){this.timeline.begin("MapView Startup");const t=this._getDefaultViewpoint();this.stateManager.startup(t,this.size,this.spatialReference,this.defaultsFromMap.extent?.center),this.graphics.owner=this;const e=new _p(this.surface),i=new La(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline},e);this.stage=i,this._magnifierView=new Fa,this._magnifierView.magnifier=this.magnifier,this._gridView=new Za;const n=new Aa({view:this});this._set("labelManager",n);const o=new fp({view:this});this._set("animationManager",o);const s=new Na({view:this,animationManager:o});this._set("mapViewNavigation",s),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",()=>this._updateStageChildren()),i.on("webgl-error",h=>this.fatalError=h.error),_(()=>this.stationary,h=>i.stationary=h,tt),_(()=>this.background,h=>{i.backgroundColor=h?.color,this._magnifierView.backgroundColor=h?.color},tt),_(()=>this.magnifier,h=>this._magnifierView.magnifier=h,tt),_(()=>this.grid,h=>this._gridView.grid=h,tt),_(()=>this.renderingOptions,h=>i.renderingOptions=h,tt),_(()=>this.highlights.items.map(h=>({name:h.name,options:{fillColor:h.color,haloColor:h.haloColor,fillOpacity:h.fillOpacity,haloOpacity:h.haloOpacity,haloWidth:h.haloWidth,haloBlur:h.haloBlur}})),()=>{i.highlightGradient=Op(i.highlightGradient,this.highlights.items)},tt),_(()=>this.state.id,()=>i.state=this.state,tt)],"map-view"),this._updateStageChildren();const r=this._resolveWhenReady;this._resolveWhenReady=[],r.forEach(h=>h(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach(e=>{this.stage.addChild(e.container)});const t=this.graphicsView;this.stage.addChild(t.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const t=new wl(Rr.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",t);const e=new Oa({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new za(t)});this._set("graphicsView",e)}_destroySpatialReferenceDependentProperties(){const t=this.graphicsView;this._set("graphicsView",null),t.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(t){const{allLayerViews:e,padding:i,size:n,stage:o}=this;return{allLayerViews:e,backgroundColor:t?.ignoreBackground?null:this.background?.color,padding:i,size:n,stage:o}}_spatialReferenceChanged(t){if(this.ready){this.frameTask.stop();for(const e of this.allLayerViews)e.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(t),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const e of this.allLayerViews)e.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}static{this.type="2d"}};a([l({constructOnly:!0})],b.prototype,"deactivatedWebGLExtensions",void 0),a([l({constructOnly:!0})],b.prototype,"debugWebGLExtensions",void 0),a([l({readOnly:!0})],b.prototype,"featuresTilingScheme",void 0),a([l({readOnly:!0})],b.prototype,"graphicsTileStore",null),a([l()],b.prototype,"graphicsView",void 0),a([l()],b.prototype,"constraintsInfo",null),a([l()],b.prototype,"initialExtentRequired",null),a([l()],b.prototype,"labelManager",void 0),a([l({type:Vi,nonNullable:!0})],b.prototype,"navigation",void 0),a([l({constructOnly:!0})],b.prototype,"renderCanvas",void 0),a([l()],b.prototype,"renderingOptions",void 0),a([l({constructOnly:!0})],b.prototype,"supersampleScreenshotsEnabled",void 0),a([l({readOnly:!0})],b.prototype,"supportsGround",void 0),a([l()],b.prototype,"defaultsFromMapSettings",null),a([l({readOnly:!0})],b.prototype,"typeSpecificPreconditionsReady",null),a([l({type:Dl})],b.prototype,"background",null),a([l()],b.prototype,"center",null),a([l({type:R})],b.prototype,"floors",void 0),a([l()],b.prototype,"grid",void 0),a([l({type:zt})],b.prototype,"highlightOptions",null),a([l()],b.prototype,"map",void 0),a([l()],b.prototype,"padding",null),a([l({readOnly:!0})],b.prototype,"rendering",null),a([l({readOnly:!0})],b.prototype,"resolution",null),a([l()],b.prototype,"scale",null),a([l({constructOnly:!0})],b.prototype,"spatialReferenceLocked",void 0),a([l({readOnly:!0})],b.prototype,"tileInfo",null),a([l({type:Pa,readOnly:!0})],b.prototype,"timeline",void 0),a([l({readOnly:!0})],b.prototype,"type",void 0),a([l({readOnly:!0})],b.prototype,"updating",null),a([l({readOnly:!0})],b.prototype,"view2dType",void 0),a([l({readOnly:!0})],b.prototype,"visibleArea",null),a([l()],b.prototype,"zoom",null),a([l({readOnly:!0})],b.prototype,"navigating",null),a([l(),jt(t=>t instanceof Ia?t:er(Da,t))],b.prototype,"ui",void 0),b=a([v("esri.views.View2D")],b);const Sd=b;let si=class extends Sd{constructor(t){super(t),this.view2dType="map"}};a([l({readOnly:!0})],si.prototype,"view2dType",void 0),si=a([v("esri.views.MapView")],si);const Pd=si,im=Object.freeze(Object.defineProperty({__proto__:null,default:Pd},Symbol.toStringTag,{value:"Module"}));export{Ih as $,Qu as A,Ku as B,Bu as C,ma as D,Vp as E,em as F,Js as G,im as H,Dp as M,qu as R,Op as a,jh as b,Qs as c,it as d,Je as e,Ys as f,Np as g,tm as h,Wu as i,ga as j,Ii as k,Xu as l,Xs as m,zp as n,ju as o,Hh as p,Uu as q,md as r,xp as s,Ap as t,zt as u,Pa as v,_p as w,fd as x,Ju as y,Yu as z};
