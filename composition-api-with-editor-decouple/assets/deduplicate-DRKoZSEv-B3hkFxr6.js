import{j0 as j}from"./main-D8YsASU7.js";import{E as v,h as L}from"./Indices-BuIC5D20-BZ2NRrs2.js";function B(f,n,a){const r=Array.isArray(f),e=r?f.length/n:f.byteLength/(4*n),y=r?f:new Uint32Array(f,0,e*n),A=a?.minReduction??0,s=a?.originalIndices||null,q=s?s.length:0,o=a?.componentOffsets||null;let U=0;if(o)for(let t=0;t<o.length-1;t++){const u=o[t+1]-o[t];u>U&&(U=u)}else U=e;const m=Math.floor(1.1*U)+1;(c==null||c.length<2*m)&&(c=new Uint32Array(j(2*m)));for(let t=0;t<2*m;t++)c[t]=0;let i=0;const w=!!o&&!!s,b=w?q:e;let h=v(e);const p=new Uint32Array(q),E=1.96;let x=A!==0?Math.ceil(4*E*E/(A*A)*A*(1-A)):b,d=1,C=o?o[1]:b;for(let t=0;t<b;t++){if(t===x){const l=1-i/t;if(l+E*Math.sqrt(l*(1-l)/t)<A)return null;x*=2}if(t===C){for(let l=0;l<2*m;l++)c[l]=0;if(s)for(let l=o[d-1];l<o[d];l++)p[l]=h[s[l]];C=o[++d]}const u=w?s[t]:t,I=u*n,$=N(y,I,n);let g=$%m,k=i;for(;c[2*g+1]!==0;){if(c[2*g]===$){const l=c[2*g+1]-1;if(z(y,I,l*n,n)){k=h[l];break}}g++,g>=m&&(g-=m)}k===i&&(c[2*g]=$,c[2*g+1]=u+1,i++),h[u]=k}if(A!==0&&1-i/e<A)return null;if(w){for(let t=o[d-1];t<p.length;t++)p[t]=h[s[t]];h=L(p)}const M=r?new Array(i):new Uint32Array(i*n);i=0;for(let t=0;t<b;t++)h[t]===i&&(G(y,(w?s[t]:t)*n,M,i*n,n),i++);if(s&&!w){const t=new Uint32Array(q);for(let u=0;u<t.length;u++)t[u]=h[s[u]];h=L(t)}return{buffer:Array.isArray(M)?M:M.buffer,indices:h,uniqueCount:i}}function z(f,n,a,r){for(let e=0;e<r;e++)if(f[n+e]!==f[a+e])return!1;return!0}function G(f,n,a,r,e){for(let y=0;y<e;y++)a[r+y]=f[n+y]}function N(f,n,a){let r=0;for(let e=0;e<a;e++)r=f[n+e]+r|0,r=r+(r<<11)+(r>>>2)|0;return r>>>0}let c=null;export{B as v};
