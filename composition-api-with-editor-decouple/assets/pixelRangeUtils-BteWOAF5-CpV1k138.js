const E=9999999e31,L=2e-7,S={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function k(n){return S[n]??[-34028234663852886e22,34028234663852886e22]}function w(n,t){return n==null||t==null?"s32":n<0?n>=-128&&t<128?"s8":n>=-32768&&t<32768?"s16":"s32":t<256?"u8":t<65536?"u16":"u32"}function y(n){return(n?.startsWith("s")||n?.startsWith("u"))??!1}function I(n,t,u,r){let[a,i]=k(u);const e=y(u);return e&&(a-=1e-5,i+=1e-5),e?u.startsWith("u")?U(n,t,r,[a,i]):V(n,t,r,[a,i]):v(n,t,r,[a,i])}function O(n,t){for(let u=0;u<t.length;u++)t[u]&&isNaN(n[u])&&(t[u]=0,n[u]=0)}function U(n,t,u,r){const[a,i]=r;for(let e=0;e<t.length;e++)if(t[e]){const l=n[e];l<a||l>i?t[e]=0:u[e]=l+.5|0}}function V(n,t,u,r){const[a,i]=r;for(let e=0;e<t.length;e++)if(t[e]){const l=n[e];l<a||l>i?t[e]=0:u[e]=l+(l>0?.5:-.5)|0}}function v(n,t,u,r){const[a,i]=r;for(let e=0;e<t.length;e++)if(t[e]){const l=n[e];l<a||l>i?t[e]=0:u[e]=l}}function P(n,t,u){if(n.depthCount&&n.depthCount>1)return;const{pixels:r,statistics:a,pixelType:i}=n,e=r[0].length,l=n.bandMasks??[],g=n.mask??new Uint8Array(e).fill(255),A=i==="f32"||i==="f64",p=k(i);let N=!1;for(let o=0;o<r.length;o++){const s=typeof t=="number"?t:t[o];if(s==null)continue;const d=a?.[o]?.minValue??p[0],m=a?.[o]?.maxValue??p[1];if(d>s+Number.EPSILON||m<s-Number.EPSILON)continue;const h=l[o]||g.slice(),c=r[o],M=u?.customFloatTolerance;if(A&&M!==0){let f=M;f||(f=Math.abs(s)>=E?L*Math.abs(s):i==="f32"?2**-23:Number.EPSILON);for(let b=0;b<c.length;b++)h[b]&&Math.abs(c[b]-s)<f&&(c[b]=0,h[b]=0,g[b]=0,N=!0)}else for(let f=0;f<c.length;f++)h[f]&&c[f]===s&&(c[f]=0,h[f]=0,g[f]=0,N=!0);l[o]=h}if(N){const o=n.bandMasks||n.pixels.length>1?l:null;u?.matchAllNoData?n.mask=o&&o.length>1?x(o):g:(n.bandMasks=o,n.mask=g)}function x(o){if(o.length<2)return o[0];const s=o[0].length,d=new Uint8Array(s).fill(0);for(let m=0;m<o.length;m++){const h=o[m];for(let c=0;c<s;c++)h[c]&&(d[c]=255)}return d}N&&"updateStatistics"in n&&n.updateStatistics()}export{y as A,P,w as U,I as V,k as p,O as v};
