import{ci as sr,cj as ur,ck as cr,cl as lr,h as F,a6 as ir,cm as ar,cn as fr,co as hr,cp as E,b0 as gr}from"./main-BTSN56ll.js";import{F as L}from"./OptimizedFeature-mIz_HhJg-S7foeqDf.js";import{s as dr}from"./OptimizedFeatureSet-Dz5hF8Qm-B1brSkRC.js";import{c as P}from"./OptimizedGeometry-pzfNw1AT-Df37wV8I.js";function w(r,n){return r?n?4:3:n?3:2}const R=()=>ir.getLogger("esri.layers.graphics.featureConversionUtils"),q={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},mr=(r,n,t,o,u,e)=>{r[t]=u,r[t+1]=e},j=(r,n,t,o,u,e)=>{r[t]=u,r[t+1]=e,r[t+2]=n[o+2]},yr=(r,n,t,o,u,e)=>{r[t]=u,r[t+1]=e,r[t+2]=n[o+3]},pr=(r,n,t,o,u,e)=>{r[t]=u,r[t+1]=e,r[t+2]=n[o+2],r[t+3]=n[o+3]};function A(r,n,t,o){if(r){if(t)return n&&o?pr:j;if(n&&o)return yr}else if(n&&o)return j;return mr}function V({scale:r,translate:n},t){return Math.round((t-n[0])/r[0])}function Y({scale:r,translate:n},t){return Math.round((n[1]-t)/r[1])}function $({scale:r,translate:n},t){return Math.round((t-n[0])/r[0])}function z({scale:r,translate:n},t){return Math.round((t-n[1])/r[1])}function S({scale:r,translate:n},t,o){return t*r[o]+n[o]}function qr(r,n,t){return r?n?t?O(r):C(r):t?D(r):U(r):null}function U(r){const n=r.coords;return{x:n[0],y:n[1]}}function J(r,n){return r.coords[0]=n.x,r.coords[1]=n.y,r}function C(r){const n=r.coords;return{x:n[0],y:n[1],z:n[2]}}function wr(r,n){return r.coords[0]=n.x,r.coords[1]=n.y,r.coords[2]=n.z,r}function D(r){const n=r.coords;return{x:n[0],y:n[1],m:n[2]}}function Mr(r,n){return r.coords[0]=n.x,r.coords[1]=n.y,r.coords[2]=n.m,r}function O(r){const n=r.coords;return{x:n[0],y:n[1],z:n[2],m:n[3]}}function Gr(r,n){return r.coords[0]=n.x,r.coords[1]=n.y,r.coords[2]=n.z,r.coords[3]=n.m,r}function br(r,n,t,o){let u=U;t&&o?u=O:t?u=C:o&&(u=D);for(const e of n){const{geometry:s,attributes:c}=e,i=s!=null?u(s):null;r.push({attributes:c,geometry:i})}return r}function Q(r,n){return r&&n?Gr:r?wr:n?Mr:J}function Pr(r,n,t,o,u){const e=Q(t,o);for(const s of n){const c=s.geometry!=null?e(new P,s.geometry):null;r.push(new L(c,s.attributes,null,E(s,u)))}return r}function Tr(r,n,t=Q(n.z!=null,n.m!=null)){return t(r,n)}function Ir(r,n,t,o){for(const{geometry:u,attributes:e}of n)r.push({attributes:e,geometry:u!=null?K(u,t,o):null});return r}function K(r,n,t){if(r==null)return null;const o=w(n,t),u=[];for(let e=0;e<r.coords.length;e+=o){const s=[];for(let c=0;c<o;c++)s.push(r.coords[e+c]);u.push(s)}return n?t?{points:u,hasZ:n,hasM:t}:{points:u,hasZ:n}:t?{points:u,hasM:t}:{points:u}}function Zr(r,n,t,o,u){const e=w(t,o);for(const s of n){const c=s.geometry!=null?W(new P,s.geometry,e):null;r.push(new L(c,s.attributes,null,E(s,u)))}return r}function W(r,n,t=w(n.hasZ,n.hasM)){r.lengths[0]=n.points.length;const o=r.coords;let u=0;for(const e of n.points)for(let s=0;s<t;s++)o[u++]=e[s];return r}function xr(r,n,t,o){for(const{geometry:u,attributes:e}of n)r.push({attributes:e,geometry:u!=null?X(u,t,o):null});return r}function X(r,n,t){if(!r)return null;const o=w(n,t),{coords:u,lengths:e}=r,s=[];let c=0;for(const i of e){const l=[];for(let a=0;a<i;a++){const f=[];for(let h=0;h<o;h++)f.push(u[c++]);l.push(f)}s.push(l)}return n?t?{paths:s,hasZ:n,hasM:t}:{paths:s,hasZ:n}:t?{paths:s,hasM:t}:{paths:s}}function Nr(r,n,t,o,u){const e=w(t,o);for(const s of n){const c=s.geometry!=null?rr(new P,s.geometry,e):null,i=s.centroid!=null?Tr(new P,s.centroid):null;r.push(new L(c,s.attributes,i,E(s,u)))}return r}function rr(r,n,t=w(n.hasZ,n.hasM)){const{lengths:o,coords:u}=r;let e=0;for(const s of n.paths){for(const c of s)for(let i=0;i<t;i++)u[e++]=c[i];o.push(s.length)}return r}function kr(r,n,t,o){for(const{geometry:u,attributes:e,centroid:s}of n){const c=u!=null?nr(u,t,o):null;if(s!=null){const i=U(s);r.push({attributes:e,centroid:i,geometry:c})}else r.push({attributes:e,geometry:c})}return r}function nr(r,n,t){if(!r)return null;const o=w(n,t),{coords:u,lengths:e}=r,s=[];let c=0;for(const i of e){const l=[];for(let a=0;a<i;a++){const f=[];for(let h=0;h<o;h++)f.push(u[c++]);l.push(f)}s.push(l)}return n?t?{rings:s,hasZ:n,hasM:t}:{rings:s,hasZ:n}:t?{rings:s,hasM:t}:{rings:s}}function Lr(r,n,t,o,u){for(const e of n){const s=e.geometry!=null?tr(new P,e.geometry,t,o):null,c=E(e,u);e.centroid!=null?r.push(new L(s,e.attributes,J(new P,e.centroid),c)):r.push(new L(s,e.attributes,null,c))}return r}function tr(r,n,t=n.hasZ,o=n.hasM){return vr(r,n.rings,t,o)}function vr(r,n,t,o){const u=w(t,o),{lengths:e,coords:s}=r;let c=0;Z(r);for(const i of n){for(const l of i)for(let a=0;a<u;a++)s[c++]=l[a];e.push(i.length)}return r}const k=[],v=[];function Ar(r,n,t,o,u){k[0]=r;const[e]=or(v,k,n,t,o,u);return T(k),T(v),e}function or(r,n,t,o,u,e){if(T(r),!t){for(const s of n){const c=E(s,e);r.push(new L(null,s.attributes,null,c))}return r}switch(t){case"esriGeometryPoint":return Pr(r,n,o,u,e);case"esriGeometryMultipoint":return Zr(r,n,o,u,e);case"esriGeometryPolyline":return Nr(r,n,o,u,e);case"esriGeometryPolygon":case"esriGeometryMultiPatch":return Lr(r,n,o,u,e);default:R().error("convertToFeatureSet:unknown-geometry",new F("internal:geometry",`Unable to parse unknown geometry type '${t}'`)),T(r)}return r}function Cr(r,n,t,o){v[0]=r,er(k,v,n,t,o);const u=k[0];return T(k),T(v),u}function Dr(r,n,t){if(r==null)return null;const o=new P;return"hasZ"in r&&n==null&&(n=r.hasZ),"hasM"in r&&t==null&&(t=r.hasM),sr(r)?Q(n??r.z!=null,t??r.m!=null)(o,r):ur(r)?tr(o,r,n,t):cr(r)?rr(o,r,w(n,t)):lr(r)?W(o,r,w(n,t)):void R().error("convertFromGeometry:unknown-geometry",new F("internal:geometry",`Unable to parse unknown geometry type '${r}'`))}function Er(r,n,t,o){const u=r&&("coords"in r?r:r.geometry);if(u==null)return null;switch(n){case"esriGeometryPoint":{let e=U;return t&&o?e=O:t?e=C:o&&(e=D),e(u)}case"esriGeometryMultipoint":return K(u,t,o);case"esriGeometryPolyline":return X(u,t,o);case"esriGeometryPolygon":return nr(u,t,o);default:return R().error("convertToGeometry:unknown-geometry",new F("internal:geometry",`Unable to parse unknown geometry type '${n}'`)),null}}function Fr(r,n){for(const t of n)r.push({attributes:t.attributes});return r}function er(r,n,t,o,u){if(T(r),t==null)return Fr(r,n);switch(t){case"esriGeometryPoint":return br(r,n,o,u);case"esriGeometryMultipoint":return Ir(r,n,o,u);case"esriGeometryPolyline":return xr(r,n,o,u);case"esriGeometryPolygon":return kr(r,n,o,u);default:R().error("convertToFeatureSet:unknown-geometry",new F("internal:geometry",`Unable to parse unknown geometry type '${t}'`))}return r}function Or(r){const{spatialReference:n,transform:t,fields:o,hasM:u,hasZ:e,features:s,geometryType:c,exceededTransferLimit:i,queryGeometry:l,queryGeometryType:a}=r,f={features:er([],s,c,e,u),fields:o,geometryType:c,spatialReference:n,queryGeometry:Er(l,a,!1,!1)};return t&&(f.transform=t),i&&(f.exceededTransferLimit=i),u&&(f.hasM=u),e&&(f.hasZ=e),f}function Qr(r,n){const t=new dr,{hasM:o,hasZ:u,features:e,spatialReference:s,geometryType:c,exceededTransferLimit:i,transform:l,fields:a}=r;return a&&(t.fields=a),t.geometryType=c??null,t.spatialReference=s??null,e&&or(t.features,e,c,u,o,n),i&&(t.exceededTransferLimit=i),o&&(t.hasM=o),u&&(t.hasZ=u),l&&(t.transform=l),t}function jr(r){const{transform:n,features:t,hasM:o,hasZ:u}=r;if(!n)return r;for(const e of t)e.geometry!=null&&H(e.geometry,e.geometry,o,u,n),e.centroid!=null&&H(e.centroid,e.centroid,o,u,n);return r.transform=null,r}function Br(r,n){const{geometryType:t,features:o,hasM:u,hasZ:e}=n;if(!r)return n;for(let s=0;s<o.length;s++){const c=o[s],i=c.weakClone();i.geometry=new P,B(i.geometry,c.geometry,u,e,t,r),c.centroid&&(i.centroid=new P,B(i.centroid,c.centroid,u,e,"esriGeometryPoint",r)),o[s]=i}return n.transform=r,n}function B(r,n,t,o,u,e,s=t,c=o){if(Z(r),!n?.coords.length)return null;const i=q[u],{coords:l,lengths:a}=n,f=w(t,o),h=w(t&&s,o&&c),d=A(t,o,s,c);if(!a.length)return d(r.coords,l,0,0,V(e,l[0]),Y(e,l[1])),Z(r,f,0),r;let g,y,M,b,p=0,m=0,G=m;for(const x of a){if(x<i)continue;let I=0;m=G,M=g=V(e,l[p]),b=y=Y(e,l[p+1]),d(r.coords,l,m,p,M,b),I++,p+=f,m+=h;for(let N=1;N<x;N++,p+=f)M=V(e,l[p]),b=Y(e,l[p+1]),M===g&&b===y||(d(r.coords,l,m,p,M-g,b-y),m+=h,I++,g=M,y=b);I>=i&&(r.lengths.push(I),G=m)}return T(r.coords,G),r.coords.length?r:null}function Hr(r,n,t,o,u,e,s=t,c=o){if(Z(r),!n?.coords.length)return null;const i=q[u],{coords:l,lengths:a}=n,f=w(t,o),h=w(t&&s,o&&c),d=A(t,o,s,c);if(!a.length)return d(r.coords,l,0,0,l[0],l[1]),Z(r,f,0),r;let g=0;const y=e*e;for(const M of a){if(M<i){g+=M*f;continue}const b=r.coords.length/h,p=g,m=g+(M-1)*f;d(r.coords,l,r.coords.length,p,l[p],l[p+1]),_(r.coords,l,f,y,d,p,m),d(r.coords,l,r.coords.length,m,l[m],l[m+1]);const G=r.coords.length/h-b;G>=i?r.lengths.push(G):T(r.coords,b*h),g+=M*f}return r.coords.length?r:null}function Rr(r,n,t,o){const u=r[n],e=r[n+1],s=r[t],c=r[t+1],i=r[o],l=r[o+1];let a=s,f=c,h=i-a,d=l-f;if(h!==0||d!==0){const g=((u-a)*h+(e-f)*d)/(h*h+d*d);g>1?(a=i,f=l):g>0&&(a+=h*g,f+=d*g)}return h=u-a,d=e-f,h*h+d*d}function _(r,n,t,o,u,e,s){let c,i=o,l=0;for(let a=e+t;a<s;a+=t)c=Rr(n,a,e,s),c>i&&(l=a,i=c);i>o&&(l-e>t&&_(r,n,t,o,u,e,l),u(r,n,r.length,l,n[l],n[l+1]),s-l>t&&_(r,n,t,o,u,l,s))}function Jr(r,n,t,o){if(!n?.coords?.length)return null;const u=w(t,o);let e=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(n&&n.coords){const l=n.coords;for(let a=0;a<l.length;a+=u){const f=l[a],h=l[a+1];e=Math.min(e,f),c=Math.max(c,f),s=Math.min(s,h),i=Math.max(i,h)}}return ar(r)?fr(r,e,s,c,i):hr(e,s,c,i,r),r}function H(r,n,t,o,u){const{coords:e,lengths:s}=n,c=w(t,o);if(!e.length)return r!==n&&Z(r),r;gr(u);const{originPosition:i,scale:l,translate:a}=u,f=Yr;f.originPosition=i;const h=f.scale;h[0]=l[0]??1,h[1]=-(l[1]??1),h[2]=l[2]??1,h[3]=l[3]??1;const d=f.translate;if(d[0]=a[0]??0,d[1]=a[1]??0,d[2]=a[2]??0,d[3]=a[3]??0,!s.length){for(let y=0;y<c;++y)r.coords[y]=S(f,e[y],y);return r!==n&&Z(r,c,0),r}let g=0;for(let y=0;y<s.length;y++){const M=s[y];r.lengths[y]=M;for(let m=0;m<c;++m)r.coords[g+m]=S(f,e[g+m],m);let b=r.coords[g],p=r.coords[g+1];g+=c;for(let m=1;m<M;m++,g+=c){b+=e[g]*h[0],p+=e[g+1]*h[1],r.coords[g]=b,r.coords[g+1]=p;for(let G=2;G<c;++G)r.coords[g+G]=S(f,e[g+G],G)}}return r!==n&&Z(r,e.length,s.length),r}function Kr(r,n,t,o,u,e){if(Z(r),r.lengths.push(...n.lengths),t===u&&o===e)for(let s=0;s<n.coords.length;s++)r.coords.push(n.coords[s]);else{const s=w(t,o),c=A(t,o,u,e),i=n.coords;for(let l=0;l<i.length;l+=s)c(r.coords,i,r.coords.length,l,i[l],i[l+1])}return r}function Ur(r,n,t,o){let u=0,e=r[o*n],s=r[o*(n+1)];for(let c=1;c<t;c++){const i=e+r[o*(n+c)],l=s+r[o*(n+c)+1],a=(i-e)*(l+s);e=i,s=l,u+=a}return .5*u}function Wr(r,n){const{coords:t,lengths:o}=r;let u=0,e=0;for(let s=0;s<o.length;s++){const c=o[s];e+=Ur(t,u,c,n),u+=c}return Math.abs(e)}function Vr(r,n,t,o){return r*o-t*n===0&&r*t+n*o>0}function Xr(r,n,t,o,u){const e=w(o,u);if(!r.lengths.length){if(r.coords.length<2)return null;const[f,h]=r.coords,d=$(n,f),g=z(n,h);return new P([],[d,g])}const s=new P([],[0,0]),c=q[t],i=t==="esriGeometryPolygon"||t==="esriGeometryPolyline";let l=0,a=0;for(let f=0;f<r.lengths.length;f++){const h=r.lengths[f],d=a;let g=$(n,r.coords[e*l]),y=z(n,r.coords[e*l+1]);s.coords[a++]=g,s.coords[a++]=y;let M=0,b=0,p=1;for(let m=1;m<h;m++){const G=$(n,r.coords[e*(m+l)]),x=z(n,r.coords[e*(m+l)+1]);if(G!==g||x!==y){const I=G-g,N=x-y;i&&Vr(M,b,I,N)?(s.coords[a-2]+=I,s.coords[a-1]+=N,g+=I,y+=N):(s.coords[a++]=G,s.coords[a++]=x,g=G,y=x,M=I,b=N,p+=1)}}p<c?a=d:s.lengths.push(p),l+=h}return s.lengths.length===0?null:s}function Z(r,n=0,t=0){T(r.lengths,t),T(r.coords,n)}function T(r,n=0){r.length!==n&&(r.length=n)}const Yr={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};export{Jr as A,K as B,Qr as C,Kr as D,X as H,nr as J,Ar as L,tr as Q,Cr as R,Or as S,Dr as U,jr as V,H as W,or as X,Br as Y,Hr as _,V as a,qr as b,Y as c,Wr as d,Xr as e,B as j,Tr as o,vr as r,Er as u};
