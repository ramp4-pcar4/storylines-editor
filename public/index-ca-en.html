<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="width=device-width,initial-scale=1" name="viewport" />

        <title>RAMP Storylines</title>

        <!-- replace `rn` in the url with a version number ("v4_0_30" for example) if desired -->
        <script
            type="text/javascript"
            src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/rn/cdts/compiled/soyutils.js"
        ></script>
        <script
            type="text/javascript"
            src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/rn/cdts/compiled/wet-en.js"
        ></script>
        <link rel="stylesheet" href="scripts/multi-ramp/rv-styles.css" />

        <!-- top reference links and no-script fallback -->
        <noscript> <%= require('html-loader!../src/assets/static/cdts/refTop.html') %> </noscript>
        <script type="text/javascript">
            document.write(wet.builder.refTop({}));
        </script>
    </head>
    <body>
        <!-- template top and no-script fallback -->
        <div id="def-top">d<%= require('html-loader!../src/assets/static/cdts/top-en.html') %></div>

        <div id="wb-cont">
            <div id="app"></div>
        </div>

        <!-- template footer and no-script fallback -->
        <div id="def-footer"><%= require('html-loader!../src/assets/static/cdts/footer-en.html') %></div>

        <script type="text/javascript">
            // URL Parsing for Language Switch
            var url = new URL(window.location.href);
            var hashParams = url.hash.split('/');

            // If there's an empty item at the end of the paramater list (occurs if there's a trailing slash in the URL), clear it.
            if (hashParams.at(-1).length === 0) {
                hashParams.pop();
            }

            // If content after the last slash in the URL is an anchor, clear it.
            if (hashParams.at(-1).startsWith('#')) {
                hashParams.pop();
            }

            // Finally, extract the StoryRAMP ID from the URL. If it has an anchor tag in it, remove it since it's not useful on the new page.
            var productID = hashParams.pop();

            if (productID.includes('#')) {
                productID = productID.split('#')[0];
            }

            var defTop = document.getElementById('def-top');
            defTop.outerHTML = wet.builder.top({
                lngLinks: [
                    {
                        lang: 'fr',
                        href: 'index-ca-fr.html#/fr/' + productID,
                        text: 'Fran√ßais'
                    }
                ],
                breadcrumbs: [
                    {
                        title: 'Environment and natural resources',
                        href: 'https://www.canada.ca/en/services/environment.html'
                    }
                ]
            });
            document.querySelectorAll('.wb-sl').forEach(function (skipLink) {
                skipLink.setAttribute('href', url.href.split(/#[^\/]/)[0] + '#' + skipLink.href.split('#')[1]);
            });
            var interval = setInterval(function () {
                var links = document.querySelectorAll('.wb-sl');
                if (links.length === 3) {
                    clearInterval(interval);
                    links[2].setAttribute('href', url.href.split(/#[^\/]/)[0] + '?' + links[2].href.split('?')[1]);
                }
            }, 200);
        </script>

        <script>
            var defFooter = document.getElementById('def-footer');
            defFooter.outerHTML = wet.builder.footer({});
        </script>

        <script>
            document.write(wet.builder.refFooter({}));
        </script>

        <script src="scripts/multi-ramp/legacy-api.js"></script>
        <script src="scripts/multi-ramp/rv-main.js"></script>

        <style>
            html {
                font-size: 16px;
            }
        </style>
    </body>
</html>
<!-- START OF SmartSource Data Collector TAG -->
<!-- Copyright (c) 1996-2021 Webtrends Inc.  All rights reserved. -->
<!-- Version: 9.4.0 -->
<script src="scripts/webtrends.js" type="text/javascript"></script>
<!-- ----------------------------------------------------------------------------------- -->
<!-- Warning: The two script blocks below must remain inline. Moving them to an external -->
<!-- JavaScript include file can cause serious problems with cross-domain tracking.      -->
<!-- ----------------------------------------------------------------------------------- -->
<script type="text/javascript">
    //<![CDATA[
    var _tag = new WebTrends();
    _tag.dcsGetId();
    //]]>
</script>
<script type="text/javascript">
    //<![CDATA[
    _tag.dcsCustom = function () {
        // Add custom parameters here.
        //_tag.DCSext.param_name=param_value;
    };
    _tag.dcsCollect();
    //]]>
</script>
<noscript>
    <div>
        <img
            alt="DCSIMG"
            id="DCSIMG"
            width="1"
            height="1"
            src="https://sdc.ncr.ec.gc.ca/dcs2kf7dq10000kzg8kpqz5gp_3q4i/njs.gif?dcsuri=/nojavascript&amp;WT.js=No&amp;WT.tv=9.4.0&amp;dcssip=www.environmental-maps.canada.ca"
        />
    </div>
</noscript>
<!-- END OF SmartSource Data Collector TAG -->
